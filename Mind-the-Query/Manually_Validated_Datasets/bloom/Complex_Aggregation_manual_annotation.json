[
    {
        "id": 0,
        "original_index": 0,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_0",
        "NL Question": "What is the average balance of BankAccounts associated with FinancialInstitutes that have names starting with 'S', and what is the total number of such BankAccounts?",
        "Cypher": "MATCH (ba:BankAccount)-[:FROM]->(fi:FinancialInstitute) WHERE fi.name STARTS WITH 'S' WITH ba, fi RETURN avg(ba.balance) AS averageBalance, count(ba) AS totalAccounts",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 1,
        "original_index": 1,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_1",
        "NL Question": "For each provider of PhoneNumber, what is the average amount of MoneyTransfer transactions associated with those phone numbers, and what is the total count of MoneyTransfer transactions?",
        "Cypher": "MATCH (mt:MoneyTransfer)-[:WITH]->(pn:PhoneNumber) WITH pn.provider AS provider, mt RETURN provider, avg(mt.amount) AS averageAmount, count(mt) AS totalTransactions",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 2,
        "original_index": 2,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_2",
        "NL Question": "What is the average balance of CreditCards associated with AccountHolders named 'Vanda Belsey', and what is the sum of their latePayments?",
        "Cypher": "MATCH (ah:AccountHolder)-[:HAS_CREDITCARD]->(cc:CreditCard) WHERE ah.fullName = 'Vanda Belsey' WITH cc RETURN avg(cc.balance) AS averageBalance, sum(cc.latePayments) AS totalLatePayments",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 3,
        "original_index": 3,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_3",
        "NL Question": "What is the average amount spent in Purchases delivered to addresses in 'Michigan', and what is the total number of those purchases?",
        "Cypher": "MATCH (p:Purchase)-[:DELIVERED_AT]->(da:DeliveryAddress) WHERE da.state = 'Michigan' WITH p RETURN avg(p.amount) AS averageAmount, count(p) AS totalPurchases",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 4,
        "original_index": 4,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_4",
        "NL Question": "For each state where an IP address is located, calculate the average purchase amount made from those IPs and the total number of purchases.",
        "Cypher": "MATCH (p:Purchase)-[:FROM_IP]->(ip:IP)-[:LOCATED_IN]->(s:State) WITH s.name AS state, p RETURN state, avg(p.amount) AS averageAmount, count(p) AS totalPurchases",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 5,
        "original_index": 5,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_7",
        "NL Question": "What is the average balance of BankAccounts that are associated with FinancialInstitutes whose names contain the word 'Hudson'?",
        "Cypher": "MATCH (b:BankAccount)-[:FROM]->(f:FinancialInstitute) WHERE f.name CONTAINS 'Hudson' WITH b.balance AS balance RETURN avg(balance) AS AverageBalance",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 6,
        "original_index": 6,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_8",
        "NL Question": "What is the average amount of MoneyTransfers associated with PhoneNumbers from the provider 'B Tee'?",
        "Cypher": "MATCH (mt:MoneyTransfer)-[:WITH]->(pn:PhoneNumber) WHERE pn.provider = 'B Tee' WITH mt.amount AS transferAmount RETURN avg(transferAmount) AS AverageTransferAmount",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 7,
        "original_index": 7,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_9",
        "NL Question": "What is the average purchase amount for purchases delivered to addresses in the state of 'New York'?",
        "Cypher": "MATCH (p:Purchase)-[:DELIVERED_AT]->(da:DeliveryAddress) WHERE da.state = 'New York' WITH p.amount AS purchaseAmount RETURN avg(purchaseAmount) AS AveragePurchaseAmount",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 8,
        "original_index": 8,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_10",
        "NL Question": "What is the average balance of CreditCards that are associated with AccountHolders whose last name is 'Golas'?",
        "Cypher": "MATCH (c:CreditCard)<-[:HAS_CREDITCARD]-(a:AccountHolder) WHERE a.lastName = 'Golas' WITH c.balance AS creditCardBalance RETURN avg(creditCardBalance) AS AverageCreditCardBalance",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 9,
        "original_index": 9,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_11",
        "NL Question": "For each state, what is the average balance of BankAccounts associated with AccountHolders who have addresses in that state?",
        "Cypher": "MATCH (a:AccountHolder)-[:HAS_ADDRESS]->(addr:Address) WITH a, addr.state AS state MATCH (a)-[:HAS_BANKACCOUNT]->(ba:BankAccount) WITH state, ba.balance AS balance RETURN state, avg(balance) AS AverageBalancePerState",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 10,
        "original_index": 10,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_14",
        "NL Question": "What is the average balance of BankAccounts associated with AccountHolders who have a birth date of '1960-08-13'?",
        "Cypher": "MATCH (ah:AccountHolder {birthDate: '1960-08-13'})-[:HAS_BANKACCOUNT]->(ba:BankAccount) RETURN avg(ba.balance) AS AverageBalance",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 11,
        "original_index": 11,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_15",
        "NL Question": "What is the average amount of MoneyTransfers sent from BankAccounts associated with the FinancialInstitute named 'Greenholt, Greenholt and Greenholt'?",
        "Cypher": "MATCH (fi:FinancialInstitute {name: 'Greenholt, Greenholt and Greenholt'})<-[:FROM]-(ba:BankAccount)-[:SEND]->(mt:MoneyTransfer) RETURN avg(mt.amount) AS AverageTransferAmount",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 12,
        "original_index": 12,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_16",
        "NL Question": "What is the average balance of CreditCards held by Flagged individuals with the last name 'Pelyo'?",
        "Cypher": "MATCH (f:Flagged {lastName: 'Pelyo'})-[:HAS_CREDITCARD]->(cc:CreditCard) RETURN avg(cc.balance) AS AverageCreditCardBalance",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 13,
        "original_index": 13,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_17",
        "NL Question": "What is the total amount spent in Purchases made from the IP address '72.4.147.84'?",
        "Cypher": "MATCH (p:Purchase)-[:FROM_IP]->(ip:IP {ip: '72.4.147.84'}) RETURN sum(p.amount) AS TotalPurchaseAmount",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 14,
        "original_index": 14,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_18",
        "NL Question": "What is the average loan amount of UnsecuredLoans held by Flagged individuals whose first name is 'Sofia'?",
        "Cypher": "MATCH (f:Flagged {firstName: 'Sofia'})-[:HAS_UNSECUREDLOAN]->(ul:UnsecuredLoan) RETURN avg(ul.loanAmount) AS AverageLoanAmount",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 15,
        "original_index": 15,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_21",
        "NL Question": "What is the average purchase amount for purchases delivered to each city?",
        "Cypher": "MATCH (p:Purchase)-[:DELIVERED_AT]->(d:DeliveryAddress) WITH d.city AS city, p.amount AS amount RETURN city, AVG(amount) AS averagePurchaseAmount",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 16,
        "original_index": 16,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_22",
        "NL Question": "For each financial institution, what is the average balance of bank accounts associated with it, and how many bank accounts does each institution have?",
        "Cypher": "MATCH (b:BankAccount)-[:FROM]->(f:FinancialInstitute) WITH f.name AS institutionName, b.balance AS balance, COUNT(b) AS accountCount RETURN institutionName, AVG(balance) AS averageBalance, accountCount",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 17,
        "original_index": 17,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_23",
        "NL Question": "For each state, what is the average amount of money transfers that used phone numbers from the 'Loud and Clear' provider?",
        "Cypher": "MATCH (m:MoneyTransfer)-[:WITH]->(p:PhoneNumber) WHERE p.provider = 'Loud and Clear' MATCH (i:IP)-[:LOCATED_IN]->(s:State) WITH s.name AS stateName, m.amount AS transferAmount RETURN stateName, AVG(transferAmount) AS averageTransferAmount",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 18,
        "original_index": 18,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_24",
        "NL Question": "What is the average balance of bank accounts held by account holders with a birth date in '1972-12-25'?",
        "Cypher": "MATCH (a:AccountHolder {birthDate: '1972-12-25'})-[:HAS_BANKACCOUNT]->(b:BankAccount) WITH b.balance AS balance RETURN AVG(balance) AS averageBalance",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 19,
        "original_index": 19,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_25",
        "NL Question": "For each shop, what is the total amount spent in purchases made with logins associated with that shop?",
        "Cypher": "MATCH (p:Purchase)-[:WITH_LOGIN]->(l:Login)-[:FOR_SHOP]->(s:Shop) WITH s.name AS shopName, p.amount AS purchaseAmount RETURN shopName, SUM(purchaseAmount) AS totalSpent",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 20,
        "original_index": 20,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_28",
        "NL Question": "What is the average balance of BankAccounts grouped by the name of the FinancialInstitute they belong to, and how many BankAccounts are associated with each FinancialInstitute?",
        "Cypher": "MATCH (ba:BankAccount)-[:FROM]->(fi:FinancialInstitute) WITH fi.name AS instituteName, AVG(ba.balance) AS averageBalance, COUNT(ba) AS accountCount RETURN instituteName, averageBalance, accountCount",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 21,
        "original_index": 21,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_29",
        "NL Question": "For each state, what is the average amount of purchases made from IPs located in that state, and how many distinct IPs are associated with those purchases?",
        "Cypher": "MATCH (p:Purchase)-[:FROM_IP]->(ip:IP)-[:LOCATED_IN]->(s:State) WITH s.name AS stateName, AVG(p.amount) AS averagePurchaseAmount, COUNT(DISTINCT ip) AS distinctIPCount RETURN stateName, averagePurchaseAmount, distinctIPCount",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 22,
        "original_index": 22,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_30",
        "NL Question": "What is the average balance of CreditCards held by AccountHolders, grouped by the state where the AccountHolder's address is located, and how many AccountHolders are in each state?",
        "Cypher": "MATCH (ah:AccountHolder)-[:HAS_CREDITCARD]->(cc:CreditCard), (ah)-[:HAS_ADDRESS]->(a:Address) WITH a.state AS stateName, AVG(cc.balance) AS averageCreditCardBalance, COUNT(DISTINCT ah) AS accountHolderCount RETURN stateName, averageCreditCardBalance, accountHolderCount",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 23,
        "original_index": 23,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_31",
        "NL Question": "For each FinancialInstitute, calculate the total amount of money transferred to BankAccounts at that institute and the average amount of each individual MoneyTransfer.",
        "Cypher": "MATCH (mt:MoneyTransfer)-[:SEND]->(ba:BankAccount)-[:FROM]->(fi:FinancialInstitute) WITH fi.name AS instituteName, SUM(mt.amount) AS totalTransferAmount, AVG(mt.amount) AS averageTransferAmount RETURN instituteName, totalTransferAmount, averageTransferAmount",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 24,
        "original_index": 24,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_32",
        "NL Question": "What is the average loan amount of UnsecuredLoans held by AccountHolders, grouped by the provider of their PhoneNumbers, and how many AccountHolders use each phone provider?",
        "Cypher": "MATCH (ah:AccountHolder)-[:HAS_UNSECUREDLOAN]->(ul:UnsecuredLoan), (ah)-[:HAS_PHONENUMBER]->(pn:PhoneNumber) WITH pn.provider AS phoneProvider, AVG(ul.loanAmount) AS averageLoanAmount, COUNT(DISTINCT ah) AS accountHolderCount RETURN phoneProvider, averageLoanAmount, accountHolderCount",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 25,
        "original_index": 25,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_35",
        "NL Question": "What is the average balance of BankAccounts for each FinancialInstitute, and how many BankAccounts does each institute have?",
        "Cypher": "MATCH (b:BankAccount)-[:FROM]->(f:FinancialInstitute) WITH f, AVG(b.balance) AS avgBalance, COUNT(b) AS accountCount RETURN f.name, avgBalance, accountCount",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 26,
        "original_index": 26,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_36",
        "NL Question": "For each AccountHolder, what is the average balance of their BankAccounts and CreditCards combined, and how many total accounts (BankAccounts and CreditCards) do they possess?",
        "Cypher": "MATCH (ah:AccountHolder) OPTIONAL MATCH (ah)-[:HAS_BANKACCOUNT]->(ba:BankAccount) OPTIONAL MATCH (ah)-[:HAS_CREDITCARD]->(cc:CreditCard) WITH ah, COLLECT(ba.balance) AS bankBalances, COLLECT(cc.balance) AS creditCardBalances, SIZE(COLLECT(ba)) + SIZE(COLLECT(cc)) AS totalAccounts WITH ah, bankBalances + creditCardBalances AS allBalances, totalAccounts RETURN ah.fullName, AVG(toFloat(x) IN allBalances WHERE x IS NOT NULL) AS averageBalance, totalAccounts",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "Throws Syntax error: Incorrect, Cypher doesn’t support AVG(toFloat(x) IN allBalances WHERE x IS NOT NULL) directly, so you must UNWIND the combined balances and then aggregate. Relying on list concatenation and casting still surfaces non‑numeric entries. A more robust approach is to aggregate sums and counts separately, then compute the average in Cypher arithmetic."
    },
    {
        "id": 27,
        "original_index": 27,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_37",
        "NL Question": "What is the average purchase amount for purchases made with BankCards, grouped by the provider of the PhoneNumber associated with the MoneyTransfer that used the BankCard?",
        "Cypher": "MATCH (p:Purchase)-[:WITH_CARD]->(bc:BankCard)<-[:SEND]-(mt:MoneyTransfer)-[:WITH]->(pn:PhoneNumber) WITH pn.provider AS provider, p.amount AS amount RETURN provider, AVG(amount) AS averagePurchaseAmount",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "Incorrect: there is no SEND (or any) relationship between MoneyTransfer and BankCard in the schema, so you can’t tie transfers to cards."
    },
    {
        "id": 28,
        "original_index": 28,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_38",
        "NL Question": "For each state, what is the average balance of BankAccounts held by AccountHolders who have an address in that state, and how many such AccountHolders are there?",
        "Cypher": "MATCH (ah:AccountHolder)-[:HAS_ADDRESS]->(a:Address) WHERE a.state IS NOT NULL WITH a.state AS state, ah OPTIONAL MATCH (ah)-[:HAS_BANKACCOUNT]->(ba:BankAccount) WITH state, ah, COLLECT(ba.balance) AS balances WHERE state IS NOT NULL RETURN state, AVG(toFloat(x) IN balances WHERE x IS NOT NULL) AS averageBalance, COUNT(DISTINCT ah) AS accountHolderCount",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "The cypher gives no result but the results can be extracted.Incorrect: Cypher doesn’t support AVG(toFloat(x) IN balances WHERE x IS NOT NULL) on a list comprehension."
    },
    {
        "id": 29,
        "original_index": 29,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_39",
        "NL Question": "For each FinancialInstitute, calculate the total amount of MoneyTransfers sent to BankAccounts at that institute, and also determine the average amount of each individual MoneyTransfer.",
        "Cypher": "MATCH (mt:MoneyTransfer)-[:SEND]->(ba:BankAccount)-[:FROM]->(fi:FinancialInstitute) WITH fi, mt.amount AS amount WITH fi, SUM(amount) AS totalAmount, AVG(amount) AS averageAmount RETURN fi.name, totalAmount, averageAmount",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": "cypher is correct but return no results because there are no MoneyTransfers in the dataset that match the criteria. The query is logically correct, but it returns no results due to the absence of matching data."
    },
    {
        "id": 30,
        "original_index": 30,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_42",
        "NL Question": "What is the average amount of money transfers associated with each phone provider, and how many transfers are associated with each provider?",
        "Cypher": "MATCH (mt:MoneyTransfer)-[w:WITH]->(pn:PhoneNumber) WITH pn.provider AS provider, COUNT(mt) AS transferCount, AVG(mt.amount) AS averageAmount RETURN provider, transferCount, averageAmount",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 31,
        "original_index": 31,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_43",
        "NL Question": "For each state, what is the average balance of bank accounts held by account holders residing in that state, and how many accounts contribute to that average?",
        "Cypher": "MATCH (ah:AccountHolder)-[:HAS_ADDRESS]->(ad:Address) WITH ah, ad MATCH (ah)-[:HAS_BANKACCOUNT]->(ba:BankAccount) WITH ad.state AS state, COUNT(ba) AS accountCount, AVG(ba.balance) AS averageBalance RETURN state, accountCount, averageBalance",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 32,
        "original_index": 32,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_44",
        "NL Question": "Calculate the average purchase amount for each shop, considering only purchases made with bank cards, and also show the total number of purchases contributing to each average.",
        "Cypher": "MATCH (p:Purchase)-[:WITH_CARD]->(bc:BankCard) WITH p MATCH (p)-[:WITH_LOGIN]->(l:Login)-[:FOR_SHOP]->(s:Shop) WITH s.name AS shopName, COUNT(p) AS purchaseCount, AVG(p.amount) AS averageAmount RETURN shopName, purchaseCount, averageAmount",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 33,
        "original_index": 33,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_45",
        "NL Question": "For each financial institute, what is the average balance of the bank accounts associated with it, and what is the total number of bank accounts contributing to that average?",
        "Cypher": "MATCH (ba:BankAccount)-[:FROM]->(fi:FinancialInstitute) WITH fi.name AS instituteName, COUNT(ba) AS accountCount, AVG(ba.balance) AS averageBalance RETURN instituteName, accountCount, averageBalance",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 34,
        "original_index": 34,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_46",
        "NL Question": "What is the average balance of credit cards held by flagged account holders, and how many credit cards are included in this average?",
        "Cypher": "MATCH (f:Flagged)-[:HAS_CREDITCARD]->(cc:CreditCard) WITH COUNT(cc) AS creditCardCount, AVG(cc.balance) AS averageBalance RETURN creditCardCount, averageBalance",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 35,
        "original_index": 35,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_49",
        "NL Question": "What is the average amount of money transfers associated with phone numbers from each provider?",
        "Cypher": "MATCH (mt:MoneyTransfer)-[:WITH]->(pn:PhoneNumber) WITH pn.provider AS provider, mt.amount AS amount RETURN provider, avg(amount) AS averageAmount",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 36,
        "original_index": 36,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_50",
        "NL Question": "What is the average balance of bank accounts for each financial institute?",
        "Cypher": "MATCH (ba:BankAccount)-[:FROM]->(fi:FinancialInstitute) WITH fi.name AS instituteName, ba.balance AS balance RETURN instituteName, avg(balance) AS averageBalance",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 37,
        "original_index": 37,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_51",
        "NL Question": "For each state, what is the average amount of purchases made from IPs located in that state?",
        "Cypher": "MATCH (p:Purchase)-[:FROM_IP]->(ip:IP)-[:LOCATED_IN]->(s:State) WITH s.name AS stateName, p.amount AS purchaseAmount RETURN stateName, avg(purchaseAmount) AS averagePurchaseAmount",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 38,
        "original_index": 38,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_52",
        "NL Question": "What is the average balance of credit cards and bank cards held by each account holder?",
        "Cypher": "MATCH (ah:AccountHolder)-[:HAS_CREDITCARD]->(cc:CreditCard) WITH ah, cc.balance AS cardBalance UNION ALL MATCH (ah:AccountHolder)-[:HAS_BANKCARD]->(bc:BankCard) WITH ah, bc.balance AS cardBalance WITH ah, collect(cardBalance) AS balances RETURN ah.fullName, avg(cardBalance) AS averageCardBalance",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "Incorrect: the query misuses UNION ALL and aggregates after it incorrectly — the final WITH ah, collect(cardBalance) doesn’t have access to all records across both matches."
    },
    {
        "id": 39,
        "original_index": 39,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_53",
        "NL Question": "What is the average amount of money transfers sent from bank accounts associated with each financial institute, and what is the total amount of those transfers?",
        "Cypher": "MATCH (mt:MoneyTransfer)-[:SEND]->(ba:BankAccount)-[:FROM]->(fi:FinancialInstitute) WITH fi.name AS instituteName, mt.amount AS transferAmount RETURN instituteName, avg(transferAmount) AS averageTransferAmount, sum(transferAmount) AS totalTransferAmount",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 40,
        "original_index": 40,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_56",
        "NL Question": "What is the average balance of BankAccounts that are associated with FinancialInstitutes whose name starts with 'Considine'?",
        "Cypher": "MATCH (fi:FinancialInstitute)<-[:FROM]-(ba:BankAccount) WHERE fi.name STARTS WITH 'Considine' RETURN avg(ba.balance) AS AverageBalance",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 41,
        "original_index": 41,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_57",
        "NL Question": "What is the average amount of MoneyTransfers associated with each PhoneNumber, and what is the count of those MoneyTransfers?",
        "Cypher": "MATCH (mt:MoneyTransfer)-[:WITH]->(pn:PhoneNumber) RETURN pn.phone, avg(mt.amount) AS AverageAmount, count(mt) AS TransferCount",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 42,
        "original_index": 42,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_58",
        "NL Question": "For each AccountHolder, what is the average balance of their BankAccounts and the total limit of their CreditCards?",
        "Cypher": "MATCH (ah:AccountHolder)-[:HAS_BANKACCOUNT]->(ba:BankAccount) WITH ah, avg(ba.balance) AS AverageBalance MATCH (ah)-[:HAS_CREDITCARD]->(cc:CreditCard) RETURN ah.fullName, AverageBalance, sum(cc.limit) AS TotalCreditLimit",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 43,
        "original_index": 43,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_59",
        "NL Question": "What is the average purchase amount for purchases delivered to each city, and how many distinct shops were involved in those purchases?",
        "Cypher": "MATCH (p:Purchase)-[:DELIVERED_AT]->(da:DeliveryAddress) MATCH (p)-[:WITH_LOGIN]->(l:Login)-[:FOR_SHOP]->(s:Shop) RETURN da.city, avg(p.amount) AS AveragePurchaseAmount, count(DISTINCT s.shopID) AS DistinctShopCount",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 44,
        "original_index": 44,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_60",
        "NL Question": "For each state, calculate the average balance of BankAccounts held by AccountHolders residing in that state, and also calculate the total loan amount of UnsecuredLoans held by those same AccountHolders.",
        "Cypher": "MATCH (ah:AccountHolder)-[:HAS_ADDRESS]->(a:Address) WITH ah, a.state AS State MATCH (ah)-[:HAS_BANKACCOUNT]->(ba:BankAccount) WITH State, ah, avg(ba.balance) AS AverageBalance OPTIONAL MATCH (ah)-[:HAS_UNSECUREDLOAN]->(ul:UnsecuredLoan) RETURN State, AverageBalance, COALESCE(sum(ul.loanAmount), 0) AS TotalLoanAmount",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 45,
        "original_index": 45,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_63",
        "NL Question": "What is the average balance of BankAccounts associated with FinancialInstitutes that have a website containing 'co' in their URL, and how many such BankAccounts exist?",
        "Cypher": "MATCH (b:BankAccount)-[:FROM]->(f:FinancialInstitute) WHERE f.website CONTAINS 'co' WITH AVG(b.balance) AS averageBalance, COUNT(b) AS bankAccountCount RETURN averageBalance, bankAccountCount",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 46,
        "original_index": 46,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_64",
        "NL Question": "For each state, what is the average amount of purchases made from IPs located in that state, and how many distinct IPs contributed to these purchases?",
        "Cypher": "MATCH (p:Purchase)-[:FROM_IP]->(ip:IP)-[:LOCATED_IN]->(s:State) WITH s.name AS stateName, p.amount AS purchaseAmount, ip WITH stateName, AVG(purchaseAmount) AS averagePurchaseAmount, COUNT(DISTINCT ip) AS distinctIpCount RETURN stateName, averagePurchaseAmount, distinctIpCount",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 47,
        "original_index": 47,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_65",
        "NL Question": "What is the average balance of CreditCards held by AccountHolders, grouped by the number of late payments on those CreditCards?",
        "Cypher": "MATCH (a:AccountHolder)-[:HAS_CREDITCARD]->(c:CreditCard) WITH c.latePayments AS latePayments, c.balance AS creditCardBalance WITH latePayments, AVG(creditCardBalance) AS averageBalance RETURN latePayments, averageBalance ORDER BY latePayments",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 48,
        "original_index": 48,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_66",
        "NL Question": "What is the average loan amount of UnsecuredLoans associated with AccountHolders, and how does this average vary based on the APR range (e.g., APR < 0.1, 0.1 <= APR < 0.2, APR >= 0.2)?",
        "Cypher": "MATCH (a:AccountHolder)-[:HAS_UNSECUREDLOAN]->(u:UnsecuredLoan) WITH u.loanAmount AS loanAmount,toFloat(u.APR) AS apr,  CASE WHEN toFloat(u.APR) < 0.1 THEN 'APR < 0.1' WHEN toFloat(u.APR) >= 0.1 AND toFloat(u.APR) < 0.2 THEN '0.1 <= APR < 0.2' ELSE 'APR >= 0.2' END AS aprRange WITH aprRange, AVG(loanAmount) AS averageLoanAmount RETURN aprRange, averageLoanAmount",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 49,
        "original_index": 49,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_67",
        "NL Question": "For each provider of PhoneNumber, what is the average amount of MoneyTransfers that used that phone number, and what is the total number of distinct MoneyTransfers involved?",
        "Cypher": "MATCH (m:MoneyTransfer)-[:WITH]->(p:PhoneNumber) WITH p.provider AS provider, m.amount AS transferAmount, m WITH provider, AVG(transferAmount) AS averageTransferAmount, COUNT(DISTINCT m) AS distinctTransferCount RETURN provider, averageTransferAmount, distinctTransferCount",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 50,
        "original_index": 50,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_70",
        "NL Question": "What is the average balance of BankAccounts that are associated with FinancialInstitutes whose names contain 'Doyle'?",
        "Cypher": "MATCH (b:BankAccount)-[:FROM]->(f:FinancialInstitute) WHERE f.name CONTAINS 'Doyle' WITH b.balance AS balance RETURN avg(balance)",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 51,
        "original_index": 51,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_72",
        "NL Question": "What is the average balance of CreditCards held by AccountHolders with a birthdate in 1965?",
        "Cypher": "MATCH (ah:AccountHolder)-[:HAS_CREDITCARD]->(cc:CreditCard) WHERE ah.birthDate STARTS WITH '1965' WITH cc.balance AS creditCardBalance RETURN avg(creditCardBalance)",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 52,
        "original_index": 52,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_73",
        "NL Question": "What is the average amount of money transfers sent to BankAccounts associated with the FinancialInstitute named 'Doyle-Doyle'?",
        "Cypher": "MATCH (mt:MoneyTransfer)-[:SEND]->(ba:BankAccount)-[:FROM]->(fi:FinancialInstitute {name: 'Doyle-Doyle'}) WITH mt.amount AS transferAmount RETURN avg(transferAmount)",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 53,
        "original_index": 53,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_74",
        "NL Question": "For each provider of phone numbers, what is the average purchase amount made with bank cards and money transfers that used those phone numbers?",
        "Cypher": "MATCH (p:Purchase)-[:WITH_CARD]->(bc:BankCard) MATCH (mt:MoneyTransfer)-[:WITH]->(pn:PhoneNumber) WITH pn.provider AS provider, p.amount AS purchaseAmount, mt.amount AS transferAmount RETURN provider, avg(purchaseAmount + transferAmount)",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 54,
        "original_index": 54,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_77",
        "NL Question": "What is the average amount of money transferred through transactions involving phone numbers provided by 'Interstate Mob'?",
        "Cypher": "MATCH (mt:MoneyTransfer)-[r:WITH]->(pn:PhoneNumber {provider: 'Interstate Mob'}) RETURN avg(mt.amount) AS AverageTransferAmount",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 55,
        "original_index": 55,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_78",
        "NL Question": "What is the average balance of bank accounts associated with financial institutes whose names contain the word 'Hayes'?",
        "Cypher": "MATCH (ba:BankAccount)-[:FROM]->(fi:FinancialInstitute) WHERE fi.name CONTAINS 'Hayes' RETURN avg(ba.balance) AS AverageBalance",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 56,
        "original_index": 56,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_79",
        "NL Question": "What is the average amount spent on purchases made from IP addresses located in 'New Hampshire'?",
        "Cypher": "MATCH (p:Purchase)-[:FROM_IP]->(ip:IP)-[:LOCATED_IN]->(s:State {name: 'New Hampshire'}) RETURN avg(p.amount) AS AveragePurchaseAmount",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 57,
        "original_index": 57,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_80",
        "NL Question": "For each state, what is the average balance of unsecured loans held by flagged account holders residing in that state?",
        "Cypher": "MATCH (f:Flagged)-[:HAS_ADDRESS]->(a:Address)-[:HAS_UNSECUREDLOAN]->(ul:UnsecuredLoan) WITH a.state AS State, ul.balance AS LoanBalance RETURN State, avg(LoanBalance) AS AverageLoanBalance",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "Incorrect: UnsecuredLoan is not connected to Address; it’s connected to Flagged via HAS_UNSECUREDLOAN, and Flagged is connected to Address via HAS_ADDRESS. You reversed the direction of relationships."
    },
    {
        "id": 58,
        "original_index": 58,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_81",
        "NL Question": "What is the average amount of money transferred in transactions that used phone numbers from 'B Tee', and what is the maximum amount transferred in those same transactions?",
        "Cypher": "MATCH (mt:MoneyTransfer)-[:WITH]->(pn:PhoneNumber {provider: 'B Tee'}) RETURN avg(mt.amount) AS AverageTransferAmount, max(mt.amount) AS MaximumTransferAmount",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 59,
        "original_index": 59,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_84",
        "NL Question": "What is the average balance of BankAccounts that are associated with FinancialInstitutes whose names contain 'Prosacco'?",
        "Cypher": "MATCH (b:BankAccount)-[:FROM]->(f:FinancialInstitute) WHERE f.name CONTAINS 'Prosacco' WITH b RETURN avg(b.balance) AS AverageBalance",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 60,
        "original_index": 60,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_86",
        "NL Question": "What is the average balance of CreditCards held by AccountHolders who have a birthDate before '1970-01-01'?",
        "Cypher": "MATCH (ah:AccountHolder)-[:HAS_CREDITCARD]->(cc:CreditCard) WHERE date(ah.birthDate) < date('1970-01-01') RETURN avg(cc.balance) AS AverageCreditCardBalance",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 61,
        "original_index": 61,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_87",
        "NL Question": "Calculate the average loanAmount of UnsecuredLoans associated with Flagged individuals, grouped by the state of their address.",
        "Cypher": "MATCH (f:Flagged)-[:HAS_UNSECUREDLOAN]->(ul:UnsecuredLoan), (f)-[:HAS_ADDRESS]->(a:Address) WITH a.state AS stateName, ul.loanAmount AS loanAmount RETURN stateName, avg(loanAmount) AS averageLoanAmount",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 62,
        "original_index": 62,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_88",
        "NL Question": "What is the average amount of MoneyTransfers made with PhoneNumbers provided by 'Loud and Clear'?",
        "Cypher": "MATCH (mt:MoneyTransfer)-[:WITH]->(pn:PhoneNumber) WHERE pn.provider = 'Loud and Clear' RETURN avg(mt.amount) AS AverageTransferAmount",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 63,
        "original_index": 63,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_91",
        "NL Question": "What is the average amount of money transfers sent from bank accounts associated with the financial institute named 'Wunsch-Wunsch'?",
        "Cypher": "MATCH (fi:FinancialInstitute {name: 'Wunsch-Wunsch'})<-[:FROM]-(ba:BankAccount)-[:SEND]->(mt:MoneyTransfer) RETURN avg(mt.amount) AS AverageMoneyTransferAmount",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 64,
        "original_index": 64,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_92",
        "NL Question": "For each provider of phone numbers, what is the average amount of money transferred using those phone numbers?",
        "Cypher": "MATCH (mt:MoneyTransfer)-[:WITH]->(pn:PhoneNumber) RETURN pn.provider, avg(mt.amount) AS AverageTransferAmount",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 65,
        "original_index": 65,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_93",
        "NL Question": "What is the average balance of bank accounts held by account holders who also have an unsecured loan?",
        "Cypher": "MATCH (ah:AccountHolder)-[:HAS_UNSECUREDLOAN]->(ul:UnsecuredLoan) WITH ah MATCH (ah)-[:HAS_BANKACCOUNT]->(ba:BankAccount) RETURN avg(ba.balance) AS AverageBankAccountBalance",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 66,
        "original_index": 66,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_94",
        "NL Question": "What is the average purchase amount for purchases delivered to addresses in 'Montana'?",
        "Cypher": "MATCH (p:Purchase)-[:DELIVERED_AT]->(da:DeliveryAddress {state: 'Montana'}) RETURN avg(p.amount) AS AveragePurchaseAmount",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 67,
        "original_index": 67,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_95",
        "NL Question": "For each state, what is the average balance of credit cards held by account holders who have an address in that state?",
        "Cypher": "MATCH (ah:AccountHolder)-[:HAS_ADDRESS]->(a:Address)-[:HAS_ADDRESS]-(s:State) WITH ah, s MATCH (ah)-[:HAS_CREDITCARD]->(cc:CreditCard) RETURN s.name, avg(cc.balance) AS AverageCreditCardBalance",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "Incorrect: there is no State node in your schema connected to Address; the state is a property of the Address node, not a separate node."
    },
    {
        "id": 68,
        "original_index": 68,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_98",
        "NL Question": "What is the average balance of all BankAccounts that are associated with FinancialInstitutes whose website contains 'net'?",
        "Cypher": "MATCH (ba:BankAccount)-[:FROM]->(fi:FinancialInstitute) WHERE fi.website CONTAINS 'net' WITH ba.balance AS balance RETURN avg(balance) AS AverageBalance",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 69,
        "original_index": 69,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_99",
        "NL Question": "For each provider of PhoneNumber, what is the average amount of MoneyTransfer transactions associated with those phone numbers?",
        "Cypher": "MATCH (mt:MoneyTransfer)-[:WITH]->(pn:PhoneNumber) WITH pn.provider AS provider, mt.amount AS amount RETURN provider, avg(amount) AS AverageTransferAmount",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 70,
        "original_index": 70,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_100",
        "NL Question": "What is the average balance of CreditCards held by AccountHolders born before 1975, based on their birthDate?",
        "Cypher": "MATCH (ah:AccountHolder)-[:HAS_CREDITCARD]->(cc:CreditCard) WHERE date(ah.birthDate) < date('1975-01-01') WITH cc.balance AS balance RETURN avg(balance) AS AverageCreditCardBalance",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 71,
        "original_index": 71,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_101",
        "NL Question": "What is the average amount of Purchases made using BankCards with a limit greater than 5000, grouped by the expirationDate of the BankCard?",
        "Cypher": "MATCH (p:Purchase)-[:WITH_CARD]->(bc:BankCard) WHERE bc.limit > 5000 WITH bc.expirationDate AS expirationDate, p.amount AS amount RETURN expirationDate, avg(amount) AS AveragePurchaseAmount",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 72,
        "original_index": 72,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_102",
        "NL Question": "For each state, what is the average balance of BankAccounts held by AccountHolders who have an address in that state?",
        "Cypher": "MATCH (ah:AccountHolder)-[:HAS_ADDRESS]->(ad:Address) WITH ah, ad.state AS state MATCH (ah)-[:HAS_BANKACCOUNT]->(ba:BankAccount) WITH state, ba.balance AS balance RETURN state, avg(balance) AS AverageBankAccountBalance",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 73,
        "original_index": 73,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_106",
        "NL Question": "For each state, what is the average amount of purchases delivered there?",
        "Cypher": "MATCH (p:Purchase)-[:DELIVERED_AT]->(da:DeliveryAddress) RETURN da.state, AVG(p.amount) AS averagePurchaseAmount",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 74,
        "original_index": 74,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_108",
        "NL Question": "What is the total amount of purchases made with bank cards, grouped by the expiration date of the bank card?",
        "Cypher": "MATCH (p:Purchase)-[:WITH_CARD]->(bc:BankCard) RETURN bc.expirationDate, SUM(p.amount) AS totalPurchaseAmount",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 75,
        "original_index": 75,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_109",
        "NL Question": "For each shop, what is the average purchase amount made by users who logged in to that shop?",
        "Cypher": "MATCH (p:Purchase)-[:WITH_LOGIN]->(l:Login)-[:FOR_SHOP]->(s:Shop) RETURN s.name, AVG(p.amount) AS averagePurchaseAmount",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 76,
        "original_index": 76,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_112",
        "NL Question": "What is the average balance of BankAccounts associated with each FinancialInstitute?",
        "Cypher": "MATCH (b:BankAccount)-[:FROM]->(f:FinancialInstitute) WITH f, AVG(b.balance) AS averageBalance RETURN f.name, averageBalance",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 77,
        "original_index": 77,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_113",
        "NL Question": "For each state, what is the average purchase amount made by purchases originating from IPs located in that state?",
        "Cypher": "MATCH (p:Purchase)-[:FROM_IP]->(ip:IP)-[:LOCATED_IN]->(s:State) WITH s, AVG(p.amount) AS averagePurchaseAmount RETURN s.name, averagePurchaseAmount",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 78,
        "original_index": 78,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_114",
        "NL Question": "What is the average balance of CreditCards held by AccountHolders, grouped by the state of the AccountHolder's address?",
        "Cypher": "MATCH (ah:AccountHolder)-[:HAS_CREDITCARD]->(cc:CreditCard) MATCH (ah)-[:HAS_ADDRESS]->(addr:Address) WITH addr.state AS state, AVG(cc.balance) AS averageBalance RETURN state, averageBalance",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 79,
        "original_index": 79,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_115",
        "NL Question": "Calculate the average amount of MoneyTransfers associated with each PhoneNumber provider.",
        "Cypher": "MATCH (mt:MoneyTransfer)-[:WITH]->(pn:PhoneNumber) WITH pn.provider AS provider, AVG(mt.amount) AS averageAmount RETURN provider, averageAmount",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 80,
        "original_index": 80,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_116",
        "NL Question": "What is the average balance of UnsecuredLoans associated with AccountHolders, grouped by the city of their address?",
        "Cypher": "MATCH (ah:AccountHolder)-[:HAS_UNSECUREDLOAN]->(ul:UnsecuredLoan) MATCH (ah)-[:HAS_ADDRESS]->(addr:Address) WITH addr.city AS city, AVG(ul.balance) AS averageBalance RETURN city, averageBalance",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 81,
        "original_index": 81,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_119",
        "NL Question": "What is the average balance of BankAccounts associated with FinancialInstitutes that have names starting with 'Muller', and what is the total number of such BankAccounts?",
        "Cypher": "MATCH (ba:BankAccount)-[:FROM]->(fi:FinancialInstitute) WHERE fi.name STARTS WITH 'Muller' WITH ba, fi RETURN avg(ba.balance) AS averageBalance, count(ba) AS totalAccounts",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 82,
        "original_index": 82,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_120",
        "NL Question": "For each provider of PhoneNumbers, what is the average amount of MoneyTransfers associated with those PhoneNumbers, and how many MoneyTransfers are associated with each provider?",
        "Cypher": "MATCH (mt:MoneyTransfer)-[:WITH]->(pn:PhoneNumber) WITH pn.provider AS provider, mt RETURN provider, avg(mt.amount) AS averageAmount, count(mt) AS totalTransfers ORDER BY provider",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 83,
        "original_index": 83,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_121",
        "NL Question": "What is the average balance of CreditCards held by AccountHolders with the last name 'Breckenridge', and what is the total limit of those CreditCards?",
        "Cypher": "MATCH (ah:AccountHolder)-[:HAS_CREDITCARD]->(cc:CreditCard) WHERE ah.lastName = 'Breckenridge' WITH cc RETURN avg(cc.balance) AS averageBalance, sum(cc.limit) AS totalLimit",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 84,
        "original_index": 84,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_122",
        "NL Question": "For each state, calculate the average purchase amount made by purchases originating from IPs located in that state, and also count the number of purchases.",
        "Cypher": "MATCH (p:Purchase)-[:FROM_IP]->(ip:IP)-[:LOCATED_IN]->(s:State) WITH s.name AS state, p RETURN state, avg(p.amount) AS averagePurchaseAmount, count(p) AS numberOfPurchases ORDER BY state",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 85,
        "original_index": 85,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_123",
        "NL Question": "What is the average balance across all BankAccounts, and what is the average loan amount for all UnsecuredLoans associated with AccountHolders?",
        "Cypher": "MATCH (ba:BankAccount) WITH avg(ba.balance) AS avgBankAccountBalance MATCH (ah:AccountHolder)-[:HAS_UNSECUREDLOAN]->(ul:UnsecuredLoan) RETURN avgBankAccountBalance, avg(ul.loanAmount) AS avgLoanAmount",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 86,
        "original_index": 86,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_126",
        "NL Question": "What is the average amount of money transfers associated with phone numbers provided by 'Interstate Mob', and what is the total number of such transfers?",
        "Cypher": "MATCH (mt:MoneyTransfer)-[r:WITH]->(pn:PhoneNumber {provider: 'Interstate Mob'}) WITH AVG(mt.amount) AS averageAmount, COUNT(mt) AS totalTransfers RETURN averageAmount, totalTransfers",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 87,
        "original_index": 87,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_127",
        "NL Question": "For each AccountHolder, what is the average balance of their BankAccounts and the total number of BankAccounts they possess?",
        "Cypher": "MATCH (ah:AccountHolder)-[:HAS_BANKACCOUNT]->(ba:BankAccount) WITH ah, AVG(ba.balance) AS averageBalance, COUNT(ba) AS totalAccounts RETURN ah.fullName, averageBalance, totalAccounts",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 88,
        "original_index": 88,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_128",
        "NL Question": "What is the average and maximum purchase amount made by purchases delivered to addresses in 'Ohio'?",
        "Cypher": "MATCH (p:Purchase)-[:DELIVERED_AT]->(da:DeliveryAddress {state: 'Ohio'}) WITH AVG(p.amount) AS averageAmount, MAX(p.amount) AS maximumAmount RETURN averageAmount, maximumAmount",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 89,
        "original_index": 89,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_129",
        "NL Question": "For each FinancialInstitute, what is the average balance of the BankAccounts associated with them, and what is the total number of BankAccounts associated with them?",
        "Cypher": "MATCH (fi:FinancialInstitute)<-[:FROM]-(ba:BankAccount) WITH fi, AVG(ba.balance) AS averageBalance, COUNT(ba) AS totalAccounts RETURN fi.name, averageBalance, totalAccounts",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 90,
        "original_index": 90,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_130",
        "NL Question": "What is the average balance of CreditCards held by AccountHolders, and what is the total number of CreditCards linked to these AccountHolders?",
        "Cypher": "MATCH (ah:AccountHolder)-[:HAS_CREDITCARD]->(cc:CreditCard) WITH AVG(cc.balance) AS averageBalance, COUNT(cc) AS totalCreditCards RETURN averageBalance, totalCreditCards",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 91,
        "original_index": 91,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_133",
        "NL Question": "What is the average balance of BankAccounts that are associated with FinancialInstitutes whose website contains 'com'?",
        "Cypher": "MATCH (ba:BankAccount)-[:FROM]->(fi:FinancialInstitute) WHERE fi.website CONTAINS 'com' WITH ba.balance AS balance RETURN avg(balance) AS AverageBalance",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 92,
        "original_index": 92,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_134",
        "NL Question": "What is the average amount of money transferred through MoneyTransfers that used phone numbers from the provider 'B Tee'?",
        "Cypher": "MATCH (mt:MoneyTransfer)-[:WITH]->(pn:PhoneNumber) WHERE pn.provider = 'B Tee' WITH mt.amount AS transferAmount RETURN avg(transferAmount) AS AverageTransferAmount",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 93,
        "original_index": 93,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_135",
        "NL Question": "What is the average balance of CreditCards held by AccountHolders born after 1975?",
        "Cypher": "MATCH (ah:AccountHolder)-[:HAS_CREDITCARD]->(cc:CreditCard) WHERE ah.birthDate > '1975-01-01' WITH cc.balance AS creditCardBalance RETURN avg(creditCardBalance) AS AverageCreditCardBalance",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 94,
        "original_index": 94,
        "source_dataset": "bloom50",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_136",
        "NL Question": "What is the average loan amount of UnsecuredLoans held by Flagged individuals with last name 'Pelyo'?",
        "Cypher": "MATCH (f:Flagged)-[:HAS_UNSECUREDLOAN]->(ul:UnsecuredLoan) WHERE f.lastName = 'Pelyo' WITH ul.loanAmount AS loanAmount RETURN avg(loanAmount) AS AverageLoanAmount",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    }
]