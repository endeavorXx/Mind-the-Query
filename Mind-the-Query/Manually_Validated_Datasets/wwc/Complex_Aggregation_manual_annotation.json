[
    {
        "id": 0,
        "original_index": 0,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_0",
        "NL Question": "For each tournament, calculate the average number of goals scored per match and the total number of matches played. Return the tournament name, average goals per match, and total matches played.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)\nOPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m)\nWITH tour, m, COUNT(sg) AS goals\nWITH tour, COUNT(m) AS totalMatches, SUM(goals) AS totalGoals\nRETURN tour.name AS tournamentName, toFloat(SUM(totalGoals))/totalMatches AS avgGoalsPerMatch, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 1,
        "original_index": 1,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_1",
        "NL Question": "For each team that participated in the 'China 2007' tournament, find the average number of goals scored by their players in all matches. Return the team name and the average goals scored by their players.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'China 2007'}) \nMATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match)<-[:PLAYED_IN]-(t)\nWITH t, COUNT(sg) AS totalGoals, COUNT(DISTINCT m) AS totalMatches\nRETURN t.name AS teamName, toFloat(totalGoals) / totalMatches AS avgGoals",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 2,
        "original_index": 2,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_2",
        "NL Question": "For each person, calculate the total number of matches they played in and the average 'score' property value from the 'PLAYED_IN' relationships. Return the person's name, total matches played, and average score.",
        "Cypher": "MATCH (p:Person)-[r:PLAYED_IN]->(m:Match)\nWITH p, COUNT(m) AS totalMatches, AVG(toInt(r.score)) AS avgScore\nRETURN p.name AS personName, totalMatches, avgScore",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "There is no function toInt() in Cypher Query language, grammatical validator failed !!"
    },
    {
        "id": 3,
        "original_index": 3,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_3",
        "NL Question": "For each squad, determine the total number of players in the squad and the average number of matches played by those players. Return the squad ID, the total number of players, and the average number of matches played.",
        "Cypher": "MATCH (s:Squad)<-[:IN_SQUAD]-(p:Person)-[:PLAYED_IN]->(m:Match)\nWITH s, p, COUNT(m) AS matchesPlayed\nWITH s, COUNT(DISTINCT p) AS totalPlayers, AVG(matchesPlayed) AS avgMatchesPlayed\nRETURN s.id AS squadId, totalPlayers, avgMatchesPlayed",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 4,
        "original_index": 4,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_4",
        "NL Question": "For each tournament, find the average number of players from each team participating in that tournament and the total number of teams that participated. Return the tournament name, the average number of players per team, and the total number of teams.",
        "Cypher": "MATCH (tour:Tournament)<-[:PARTICIPATED_IN]-(t:Team)<-[:REPRESENTS]-(p:Person)\nWITH tour, t, COUNT(p) AS playerCount\nWITH tour, AVG(playerCount) AS avgPlayersPerTeam, COUNT(DISTINCT t) AS totalTeams\nRETURN tour.name AS tournamentName, avgPlayersPerTeam, totalTeams",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 5,
        "original_index": 5,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_7",
        "NL Question": "For each team, calculate the total number of matches they played and the average score in those matches. Return the team's name, total matches played, and average score.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match) WHERE r.score IS NOT NULL WITH t, COUNT(m) AS totalMatches, SUM(r.score) AS totalScore RETURN t.name AS teamName, totalMatches, CASE WHEN totalMatches > 0 THEN toFloat(totalScore) / totalMatches ELSE 0 END AS averageScore",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 6,
        "original_index": 6,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_8",
        "NL Question": "For each tournament, determine the average number of players per squad and the total number of teams that participated. Return the tournament name, average players per squad, and total teams.",
        "Cypher": "MATCH (tour:Tournament)<-[:FOR]-(s:Squad)<-[:IN_SQUAD]-(p:Person) WITH tour, s, COUNT(p) AS playerCount MATCH (t:Team)-[:PARTICIPATED_IN]->(tour) WITH tour, AVG(playerCount) AS avgPlayersPerSquad, COUNT(DISTINCT t) AS totalTeams RETURN tour.name AS tournamentName, avgPlayersPerSquad, totalTeams",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 7,
        "original_index": 7,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_9",
        "NL Question": "For each player, find the total number of matches they played and the average number of goals they scored per match where they scored at least one goal. Return the player's name, total matches played, and average goals per match.",
        "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match) WITH p, COUNT(DISTINCT m) AS totalMatches OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m2:Match) WITH p, totalMatches, COUNT(sg) AS totalGoals WHERE totalGoals > 0 RETURN p.name AS playerName, totalMatches, CASE WHEN totalMatches > 0 THEN toFloat(totalGoals) / totalMatches ELSE 0 END AS avgGoalsPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 8,
        "original_index": 8,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_10",
        "NL Question": "For each tournament, calculate the total number of goals scored, the total number of matches played, and then determine the average goals scored per match. Return the tournament name, total goals, total matches, and average goals per match.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[sg:SCORED_GOAL]-(p:Person) WITH tour, m, COUNT(sg) AS goalsPerMatch WITH tour, SUM(goalsPerMatch) AS totalGoals, COUNT(DISTINCT m) AS totalMatches RETURN tour.name AS tournamentName, totalGoals, totalMatches, CASE WHEN totalMatches > 0 THEN toFloat(totalGoals) / totalMatches ELSE 0 END AS avgGoalsPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 9,
        "original_index": 9,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_11",
        "NL Question": "For each team that participated in the 'Germany 2011' tournament, find the average age of the players and the total number of matches they played. Return the team name, average player age, and total matches played.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'Germany 2011'}) MATCH (p:Person)-[:REPRESENTS]->(t)-[:PLAYED_IN]->(m:Match) WHERE p.dob IS NOT NULL WITH t, p, tour, COUNT(m) AS totalMatchesPerPlayer, tour.year - p.dob.year AS playerAge WITH t, AVG(playerAge) AS avgPlayerAge, SUM(totalMatchesPerPlayer) AS totalMatchesPlayed RETURN t.name AS teamName, avgPlayerAge, totalMatchesPlayed",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 10,
        "original_index": 10,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_14",
        "NL Question": "For each tournament, calculate the total number of teams that participated and the average number of players per team across all squads. Return the tournament name, total teams, and average players per team.",
        "Cypher": "MATCH (tour:Tournament)<-[:PARTICIPATED_IN]-(t:Team)-[:NAMED]->(s:Squad)<-[:IN_SQUAD]-(p:Person) WITH tour, t, s, COUNT(DISTINCT p) AS playersPerSquad WITH tour, t, AVG(playersPerSquad) AS avgPlayersPerSquadPerTeam WITH tour, COUNT(DISTINCT t) AS totalTeams, AVG(avgPlayersPerSquadPerTeam) AS avgPlayersPerTeam RETURN tour.name AS tournamentName, totalTeams, avgPlayersPerTeam",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 11,
        "original_index": 11,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_15",
        "NL Question": "For each team, find the total number of matches they played and the average number of goals scored in those matches where goal information is available. Return the team name, total matches, and average goals per match.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match) WHERE r.score IS NOT NULL WITH t, COUNT(m) AS totalMatches, SUM(r.score) AS totalGoals RETURN t.name AS teamName, totalMatches, CASE WHEN totalMatches > 0 THEN toFloat(totalGoals) / totalMatches ELSE 0 END AS avgGoalsPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 12,
        "original_index": 12,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_16",
        "NL Question": "For each person, determine the number of tournaments they participated in and the average number of matches they played per tournament. Return the person's name, the number of tournaments, and the average matches per tournament.",
        "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament) WITH p, tour, COUNT(m) AS matchesPerTournament WITH p, COUNT(DISTINCT tour) AS totalTournaments, COLLECT(matchesPerTournament) AS matchesList RETURN p.name AS personName, totalTournaments, CASE WHEN totalTournaments > 0 THEN REDUCE(s = 0, x IN matchesList | s + x) * 1.0 / totalTournaments ELSE 0 END AS avgMatchesPerTournament",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 13,
        "original_index": 13,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_17",
        "NL Question": "For each squad, calculate the total number of players and the average number of goals scored by players in matches played in the 'France 2019' tournament. Return the squad ID, total players, and average goals per player.",
        "Cypher": "MATCH (s:Squad)-[:FOR]->(tour:Tournament {name: 'France 2019'}) MATCH (p:Person)-[:IN_SQUAD]->(s)-[:FOR]->(tour) OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(tour) WITH s, p, COUNT(sg) AS goalsPerPlayer WITH s, COUNT(DISTINCT p) AS totalPlayers, AVG(goalsPerPlayer) AS avgGoalsPerPlayer RETURN s.id AS squadId, totalPlayers, avgGoalsPerPlayer",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 14,
        "original_index": 14,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_18",
        "NL Question": "For each tournament, find the team with the highest average score in matches. Return the tournament name, the team name, and the team's average score in that tournament.",
        "Cypher": "MATCH (tour:Tournament)<-[:PARTICIPATED_IN]-(t:Team)-[r:PLAYED_IN]->(m:Match) WITH tour, t, AVG(r.score) AS avgScore WHERE avgScore IS NOT NULL WITH tour, t, avgScore ORDER BY tour.id, avgScore DESC WITH tour, COLLECT({team: t, avgScore: avgScore}) AS teamScores RETURN tour.name AS tournamentName, teamScores[0].team.name AS teamName, teamScores[0].avgScore AS averageScore",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 15,
        "original_index": 15,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_21",
        "NL Question": "For each tournament, calculate the total number of teams that participated and the average number of players per team. Return the tournament name, total teams, and average players per team.",
        "Cypher": "MATCH (t:Tournament)<-[:PARTICIPATED_IN]-(team:Team)<-[:NAMED]-(s:Squad)<-[:IN_SQUAD]-(p:Person) WITH t, team, COUNT(DISTINCT p) AS playerCount WITH t, COUNT(DISTINCT team) AS teamCount, AVG(playerCount) AS avgPlayersPerTeam RETURN t.name AS tournamentName, teamCount, avgPlayersPerTeam",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "This is incorrect because playerCount is per team, but you are trying to compute AVG(playerCount) after collapsing all rows with COUNT(DISTINCT team) â€” this leads to incorrect aggregation."
    },
    {
        "id": 16,
        "original_index": 16,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_22",
        "NL Question": "For each team that played in the 'USA 2003' tournament, find the average number of goals scored per match. Return the team name and the average goals scored.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'USA 2003'}) WHERE r.score IS NOT NULL WITH t, AVG(r.score) AS avgGoals RETURN t.name AS teamName, avgGoals",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 17,
        "original_index": 17,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_23",
        "NL Question": "For each person, find the total number of goals they scored and the number of tournaments they played in. Return the person's name, total goals, and number of tournaments.",
        "Cypher": "MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament) WITH p, COUNT(sg) AS totalGoals, COLLECT(DISTINCT tour.id) AS tournamentsPlayed RETURN p.name AS playerName, totalGoals, SIZE(tournamentsPlayed) AS numberOfTournaments",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 18,
        "original_index": 18,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_24",
        "NL Question": "For each tournament, determine the average age of the players who participated. Return the tournament name and the average age of the players.",
        "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament) WHERE p.dob IS NOT NULL WITH t, p.dob AS dob, t.year AS year RETURN t.name AS tournamentName, avg(year - dob.year) AS averageAge",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 19,
        "original_index": 19,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_25",
        "NL Question": "For each team, find the average number of players in their squads across all tournaments they participated in. Return the team name and the average squad size.",
        "Cypher": "MATCH (team:Team)-[:NAMED]->(s:Squad)<-[:IN_SQUAD]-(p:Person)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament) WITH team, s, COUNT(DISTINCT p) AS squadSize WITH team, AVG(squadSize) AS avgSquadSize RETURN team.name AS teamName, avgSquadSize",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 20,
        "original_index": 20,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_28",
        "NL Question": "For the 'Germany 2011' tournament, what is the average number of goals scored per match, and what is the total number of matches played?",
        "Cypher": "MATCH (tour:Tournament {name: 'Germany 2011'})<-[:IN_TOURNAMENT]-(m:Match)\nOPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m)\nWITH tour, m, COUNT(sg) AS goals\nWITH tour, COUNT(m) AS totalMatches, SUM(goals) AS totalGoals\nRETURN tour.name AS tournamentName, toFloat(totalGoals) / totalMatches AS avgGoalsPerMatch, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 21,
        "original_index": 21,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_29",
        "NL Question": "For each team that participated in the 'Germany 2011' tournament, what is the average number of players in their squads, and what is the total number of goals scored by those teams in the tournament's matches?",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'Germany 2011'})\nMATCH (t)-[:NAMED]->(s:Squad)-[:FOR]->(tour)\nOPTIONAL MATCH (p:Person)-[:IN_SQUAD]->(s)-[:FOR]->(tour)\nOPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(tour)\nWITH t, COUNT(DISTINCT p) AS squadSize, COUNT(sg) AS goalsScored\nRETURN t.name AS teamName, AVG(squadSize) AS avgSquadSize, SUM(goalsScored) AS totalGoalsScored",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 22,
        "original_index": 22,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_30",
        "NL Question": "For each player who played in a match during the 'Germany 2011' tournament, calculate the total number of goals they scored and the average number of minutes they played. Return the player's name, total goals, and average minutes played.",
        "Cypher": "MATCH (p:Person)-[pi:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'Germany 2011'})\nWITH p, pi, m\nOPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m)\nWITH p, SUM(toInt(sg.minute)) AS totalGoals, AVG(toInt(pi.minuteOn)) AS avgMinutesPlayed\nRETURN p.name AS playerName, totalGoals, avgMinutesPlayed",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "Grammatical error: there is no function toInt() in Cypher Query language, it should be toInteger() or just use the property directly if it's already an integer."
    },
    {
        "id": 23,
        "original_index": 23,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_31",
        "NL Question": "In the 'Germany 2011' tournament, what is the average age of the players, and what is the total number of players who scored at least one goal?",
        "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'Germany 2011'})\nWHERE p.dob IS NOT NULL\nWITH p, tour\nOPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m)-[:IN_TOURNAMENT]->(tour)\nWITH p, tour, COUNT(sg) AS goalsScored\nWITH AVG(tour.year - p.dob.year) AS avgAge, SUM(CASE WHEN goalsScored > 0 THEN 1 ELSE 0 END) AS playersWithGoals\nRETURN avgAge, playersWithGoals",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 24,
        "original_index": 24,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_32",
        "NL Question": "For each team that participated in a match in the 'Germany 2011' tournament, what is the average number of goals scored by players from that team, and what is the total number of yellow cards received by those players in the tournament?",
        "Cypher": "MATCH (t:Team)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'Germany 2011'})\nOPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m)\nWHERE (p)-[:REPRESENTS]->(t)\nWITH t, COUNT(sg) AS goalsScored\nRETURN t.name AS teamName, AVG(goalsScored) AS avgGoalsScored",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 25,
        "original_index": 25,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_35",
        "NL Question": "For each tournament, calculate the total number of teams that participated and the average number of players per team across all squads participating in that tournament. Return the tournament name, total participating teams, and the average number of players per team.",
        "Cypher": "MATCH (tour:Tournament)<-[:PARTICIPATED_IN]-(team:Team)-[:NAMED]->(squad:Squad)  MATCH (squad)<-[:IN_SQUAD]-(person:Person) WITH tour, team, COUNT(DISTINCT person) AS playerCount  WITH tour, team, AVG(playerCount) AS avgPlayersPerTeam  WITH tour, COUNT(DISTINCT team) AS totalTeams, AVG(avgPlayersPerTeam) AS finalAvgPlayersPerTeam RETURN tour.name AS tournamentName, totalTeams, finalAvgPlayersPerTeam",
        "result [0/1]": "1",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "cypher query is logically incorrect because it does not correctly aggregate the average number of players per team across all squads participating in that tournament. It calculates the average number of players per team for each team separately, which does not yield the correct average across all teams in the tournament. The aggregation should be done after collecting all teams and their player counts."
    },
    {
        "id": 26,
        "original_index": 26,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_36",
        "NL Question": "For each team, find the total number of matches they played and calculate the average number of goals scored in those matches, considering only matches where goal information is available. Return the team name, total matches played, and average goals scored per match.",
        "Cypher": "MATCH (team:Team)-[playedIn:PLAYED_IN]->(match:Match) WHERE playedIn.score IS NOT NULL WITH team, COUNT(match) AS totalMatches, SUM(playedIn.score) AS totalGoals RETURN team.name AS teamName, totalMatches, CASE WHEN totalMatches > 0 THEN toFloat(totalGoals) / totalMatches ELSE 0 END AS averageGoalsPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 27,
        "original_index": 27,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_37",
        "NL Question": "For each person, determine the total number of tournaments they participated in and the average number of goals they scored per tournament. Return the person's name, the number of tournaments, and the average goals per tournament.",
        "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament) OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m) WITH p, t, COUNT(sg) AS goalsPerTournament WITH p, COUNT(DISTINCT t) AS totalTournaments, COLLECT(goalsPerTournament) AS goalsList RETURN p.name AS personName, totalTournaments, CASE WHEN totalTournaments > 0 THEN REDUCE(s = 0, x IN goalsList | s + x) * 1.0 / totalTournaments ELSE 0 END AS avgGoalsPerTournament",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 28,
        "original_index": 28,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_38",
        "NL Question": "For each tournament in the year 2019, find the team that scored the highest total goals. Return the tournament name, the team's name, and the total goals scored by that team in the tournament.",
        "Cypher": "MATCH (t:Tournament {year: 2019})<-[:IN_TOURNAMENT]-(m:Match)<-[played_in:PLAYED_IN]-(team:Team) WHERE played_in.score IS NOT NULL WITH t, team, SUM(played_in.score) AS totalGoals ORDER BY t.name, totalGoals DESC WITH t, COLLECT({team: team, totalGoals: totalGoals}) AS teamGoalsList RETURN t.name AS tournamentName, teamGoalsList[0].team.name AS winningTeam, teamGoalsList[0].totalGoals AS totalGoals",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 29,
        "original_index": 29,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_39",
        "NL Question": "For each squad, calculate the average age of the players in the squad as of the year the tournament associated with that squad took place. Return the squad ID, tournament year, and the average player age.",
        "Cypher": "MATCH (s:Squad)-[:FOR]->(t:Tournament) MATCH (p:Person)-[:IN_SQUAD]->(s) WHERE p.dob IS NOT NULL WITH s, t, p, t.year - p.dob.year AS playerAge WITH s, t, AVG(playerAge) AS avgAge RETURN s.id AS squadId, t.year AS tournamentYear, avgAge",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 30,
        "original_index": 30,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_42",
        "NL Question": "For the tournament 'USA 1999', what is the average number of goals scored per match, and what is the total number of matches played?",
        "Cypher": "MATCH (m:Match)-[:IN_TOURNAMENT]->(t:Tournament {name: 'USA 1999'}) OPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m) WITH t, m, COUNT(sg) AS goalsPerMatch WITH t, COUNT(m) AS totalMatches, SUM(goalsPerMatch) AS totalGoals RETURN t.name AS tournamentName, toFloat(SUM(totalGoals)) / totalMatches AS avgGoalsPerMatch, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 31,
        "original_index": 31,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_43",
        "NL Question": "For each team that participated in the 'USA 1999' tournament, what is the average number of players who scored goals and the total number of matches they played?",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'USA 1999'}) MATCH (t)-[:PLAYED_IN]->(m:Match)<-[sg:SCORED_GOAL]-(p:Person) WITH t, m, COLLECT(DISTINCT p) AS scoringPlayers WITH t, COUNT(DISTINCT m) AS totalMatches, SIZE(scoringPlayers) AS numScoringPlayers RETURN t.name AS teamName, toFloat(numScoringPlayers) / totalMatches AS avgScoringPlayersPerMatch, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 32,
        "original_index": 32,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_44",
        "NL Question": "What is the average age of players who scored goals in matches during the 'USA 1999' tournament, and how many total goals were scored?",
        "Cypher": "MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament {name: 'USA 1999'}) WHERE p.dob IS NOT NULL WITH p, t, sg, m.date AS matchDate WITH p, t, sg, date(matchDate) AS matchDateObj WITH p, t, sg, duration.between(date(p.dob), matchDateObj).years AS age RETURN avg(age) AS averageAge, count(sg) AS totalGoalsScored",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 33,
        "original_index": 33,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_45",
        "NL Question": "For each team that participated in the 'USA 1999' tournament, calculate the average number of goals scored per match where the score property is available, and also find the total number of matches played by each team.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'USA 1999'}) MATCH (t)-[r:PLAYED_IN]->(m:Match) WHERE r.score IS NOT NULL WITH t, m, r.score AS scorePerMatch WITH t, COUNT(m) AS totalMatches, COLLECT(scorePerMatch) AS scores RETURN t.name AS teamName, toFloat(SUM(scores))/totalMatches AS avgGoalsPerMatch, totalMatches",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "grammatical eror: Type mismatch: expected Float, Integer or Duration but was List<Boolean>, List<Float>, List<Integer>, List<Number>, List<Point>, List<String>, List<Duration>, List<Date>, List<Time>, List<LocalTime>, List<LocalDateTime>, List<DateTime>, List<List<Boolean>>, List<List<Float>>, List<List<Integer>>, List<List<Number>>, List<List<Point>>, List<List<String>>, List<List<Duration>>, List<List<Date>>, List<List<Time>>, List<List<LocalTime>>, List<List<LocalDateTime>> or List<List<DateTime>> (line 1, column 276 (offset: 275))"
    },
    {
        "id": 34,
        "original_index": 34,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_46",
        "NL Question": "For each player who played in the 'USA 1999' tournament, what is the total number of goals they scored, and what is the average number of minutes they played in each match?",
        "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament {name: 'USA 1999'}) OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m) WITH p, m, COUNT(sg) AS goalsScored OPTIONAL MATCH (p)-[pi:PLAYED_IN]->(m) WHERE pi.minuteOn IS NOT NULL WITH p, m, goalsScored, pi.minuteOn AS minuteOnField WITH p, goalsScored, COLLECT(toInt(replace(minuteOnField, '''', ''))) AS minutesPlayedList WITH p, goalsScored, REDUCE(total = 0, minute IN minutesPlayedList | total + minute) AS totalMinutesPlayed, SIZE(minutesPlayedList) AS matchesPlayed RETURN p.name AS playerName, SUM(goalsScored) AS totalGoals, CASE WHEN matchesPlayed > 0 THEN toFloat(totalMinutesPlayed) / matchesPlayed ELSE 0 END AS avgMinutesPlayed",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "grammatical error: Invalid input '''': expected an expression, ')' or ',' (line 1, column 353 (offset: 352)), also toInt() is not a valid function in Cypher, it should be toInteger() or just use the property directly if it's already an integer."
    },
    {
        "id": 35,
        "original_index": 35,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_49",
        "NL Question": "For each tournament, calculate the total number of goals scored and the average number of players per squad. Return the tournament name, total goals scored, and average players per squad.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[:SCORED_GOAL]-(p:Person)\nWITH tour, COUNT(p) AS totalGoals, m\nMATCH (tour)<-[:FOR]-(s:Squad)<-[:IN_SQUAD]-(player:Person)\nWITH tour, totalGoals, COUNT(DISTINCT player) AS squadSize\nRETURN tour.name AS tournamentName, SUM(totalGoals) AS totalGoalsScored, AVG(squadSize) AS avgPlayersPerSquad",
        "result [0/1]": "1",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "cypher query don't give the expected result because it does not correctly aggregate the average number of players per squad across all squads participating in that tournament. It calculates the average number of players per squad for each squad separately, which does not yield the correct average across all squads in the tournament. The aggregation should be done after collecting all squads and their player counts. Total players per squad are roughly 19-20, then how can avg be 330 ?"
    },
    {
        "id": 36,
        "original_index": 36,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_50",
        "NL Question": "For each team, determine the number of tournaments they participated in and the average number of goals scored by their players across all matches. Return the team name, tournament count, and average goals scored.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament)\nWITH t, COUNT(DISTINCT tour) AS tournamentCount\nMATCH (t)-[:PLAYED_IN]->(m:Match)<-[:SCORED_GOAL]-(p:Person)\nWITH t, tournamentCount, COUNT(p) AS totalGoals, COUNT(DISTINCT m) AS totalMatches\nRETURN t.name AS teamName, tournamentCount, CASE WHEN totalMatches = 0 THEN 0 ELSE toFloat(totalGoals) / totalMatches END AS avgGoalsScored",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 37,
        "original_index": 37,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_51",
        "NL Question": "For each tournament, find the average age of players who scored goals. Return the tournament name and the average age of goal scorers.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[:SCORED_GOAL]-(p:Person)\nWHERE p.dob IS NOT NULL\nWITH tour, p, tour.year - p.dob.year AS playerAge\nRETURN tour.name AS tournamentName, AVG(playerAge) AS averageAgeOfGoalScorers",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 38,
        "original_index": 38,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_52",
        "NL Question": "For each squad, calculate the total number of players and the average number of matches played by players in that squad. Return the squad ID, total player count, and average matches played.",
        "Cypher": "MATCH (s:Squad)<-[:IN_SQUAD]-(p:Person)-[:PLAYED_IN]->(m:Match)\nWITH s, p, COUNT(DISTINCT m) AS matchesPlayed\nWITH s, COUNT(DISTINCT p) AS totalPlayers, AVG(matchesPlayed) AS avgMatchesPlayed\nRETURN s.id AS squadId, totalPlayers, avgMatchesPlayed",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 39,
        "original_index": 39,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_53",
        "NL Question": "For each tournament, determine the team with the highest average 'score' in the 'PLAYED_IN' relationship. Return the tournament name, team name, and the highest average score.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[r:PLAYED_IN]-(t:Team)\nWHERE r.score IS NOT NULL\nWITH tour, t, AVG(r.score) AS avgScore\nORDER BY tour.name, avgScore DESC\nWITH tour, COLLECT({team: t.name, avgScore: avgScore}) AS teamScores\nRETURN tour.name AS tournamentName, teamScores[0].team AS teamName, teamScores[0].avgScore AS highestAverageScore",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 40,
        "original_index": 40,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_56",
        "NL Question": "For each tournament, calculate the total number of goals scored and the average age of players who scored in matches within that tournament. Return the tournament name, total goals scored, and average player age.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[sg:SCORED_GOAL]-(p:Person) WHERE p.dob IS NOT NULL WITH tour, p, COUNT(sg) AS goalsPerPlayer, m.date AS matchDate WITH tour, p, goalsPerPlayer, date(matchDate).year AS matchYear WITH tour, p, goalsPerPlayer, matchYear, p.dob AS playerDob WITH tour, p, goalsPerPlayer, matchYear, playerDob.year AS playerYear, playerDob.month AS playerMonth, playerDob.day AS playerDay WITH tour, p, goalsPerPlayer, matchYear, date({year: playerYear, month: playerMonth, day: playerDay}) AS birthDate WITH tour, p, goalsPerPlayer, matchYear, birthDate, matchYear - playerYear AS playerAge  WITH tour, p, goalsPerPlayer, playerAge WITH tour, SUM(goalsPerPlayer) AS totalGoals, AVG(playerAge) AS avgPlayerAge RETURN tour.name AS tournamentName, totalGoals, avgPlayerAge",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "Grammatical error: Syntx error : Variable `playerYear` not defined (line 1, column 602 (offset: 601))"
    },
    {
        "id": 41,
        "original_index": 41,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_57",
        "NL Question": "For each team that participated in the 'Germany 2011' tournament, find the average number of goals scored per match and the total number of players who played for the team in those matches. Return the team name, average goals per match, and total players.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'Germany 2011'}) MATCH (t)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour) WITH t, m, r.score AS matchScore OPTIONAL MATCH (p:Person)-[:PLAYED_IN]->(m) WHERE p-[:REPRESENTS]->(t) WITH t, m, SUM(matchScore) AS totalScore, COUNT(DISTINCT p) AS totalPlayers WHERE totalScore IS NOT NULL WITH t, toFloat(SUM(totalScore)) AS totalGoals, COUNT(DISTINCT m) AS totalMatches, SUM(totalPlayers) AS totalPlayersPlayed RETURN t.name AS teamName, CASE WHEN totalMatches = 0 THEN 0 ELSE totalGoals / totalMatches END AS avgGoalsPerMatch, totalPlayersPlayed",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "grammatical error: Invalid input ':': expected an expression (line 1, column 223 (offset: 222))"
    },
    {
        "id": 42,
        "original_index": 42,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_58",
        "NL Question": "For each player, calculate the total number of tournaments they participated in and the average number of goals they scored per tournament. Return the player's name, total tournaments, and average goals per tournament.",
        "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament) OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m) WITH p, tour, COUNT(sg) AS goalsPerMatch WITH p, COUNT(DISTINCT tour) AS totalTournaments, COLLECT(goalsPerMatch) AS goalsList WITH p, totalTournaments, REDUCE(s = 0, i IN goalsList | s + i) AS totalGoals RETURN p.name AS playerName, totalTournaments, CASE WHEN totalTournaments = 0 THEN 0 ELSE toFloat(totalGoals) / totalTournaments END AS avgGoalsPerTournament",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 43,
        "original_index": 43,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_59",
        "NL Question": "For each squad, determine the average age of players in the squad and the total number of matches in which players from that squad scored goals. Return the squad ID, average player age, and total matches with goals.",
        "Cypher": "MATCH (s:Squad)<-[:IN_SQUAD]-(p:Person) WHERE p.dob IS NOT NULL WITH s, p, p.dob AS playerDob WITH s, p, playerDob.year AS playerYear, playerDob.month AS playerMonth, playerDob.day AS playerDay WITH s, p, date({year: playerYear, month: playerMonth, day: playerDay}) AS birthDate WITH s, p, date() AS currentDate, duration.between(birthDate, currentDate).years AS playerAge OPTIONAL MATCH (p)-[:SCORED_GOAL]->(m:Match) WITH s, AVG(playerAge) AS avgPlayerAge, COUNT(DISTINCT m) AS matchesWithGoals RETURN s.id AS squadId, avgPlayerAge, matchesWithGoals",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "grammatical error: Variable `currentDate` not defined (line 1, column 342 (offset: 341))"
    },
    {
        "id": 44,
        "original_index": 44,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_60",
        "NL Question": "For each tournament in 2011, calculate the average number of players per team and the total number of goals scored across all matches. Return the tournament name, average players per team, and total goals scored.",
        "Cypher": "MATCH (tour:Tournament {year: 2011})<-[:IN_TOURNAMENT]-(m:Match)<-[sg:SCORED_GOAL]-(p:Person)-[:REPRESENTS]->(t:Team)-[:PARTICIPATED_IN]->(tour) WITH tour, t, p, COUNT(sg) AS goalsPerPlayer  WITH tour, t, COUNT(DISTINCT p) AS playersPerTeam, SUM(goalsPerPlayer) AS totalGoalsPerTeam WITH tour, AVG(playersPerTeam) AS avgPlayersPerTeam, SUM(totalGoalsPerTeam) AS totalGoals RETURN tour.name AS tournamentName, avgPlayersPerTeam, totalGoals",
        "result [0/1]": "1",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "There is one tournament in 2011 - 'Gernmany 2011', only 84 goals were scored in total but the query returns 1344 goals in total."
    },
    {
        "id": 45,
        "original_index": 45,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_63",
        "NL Question": "For each tournament, calculate the average number of goals scored per match and the total number of teams that participated. Return the tournament name, average goals per match, and total participating teams.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)\nOPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m)\nWITH tour, m, COUNT(sg) AS goalsPerMatch\nWITH tour, AVG(goalsPerMatch) AS avgGoalsPerMatch, COLLECT(DISTINCT m) AS matches\nWITH tour, avgGoalsPerMatch, SIZE(matches) AS totalMatches\nMATCH (t:Team)-[:PARTICIPATED_IN]->(tour)\nWITH tour, avgGoalsPerMatch, totalMatches, COUNT(DISTINCT t) AS totalTeams\nRETURN tour.name AS tournamentName, avgGoalsPerMatch, totalTeams",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 46,
        "original_index": 46,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_64",
        "NL Question": "For each team, determine the total number of matches played and the average number of goals scored by players representing that team. Return the team name, total matches, and average goals per player.",
        "Cypher": "MATCH (t:Team)<-[:REPRESENTS]-(p:Person)-[:PLAYED_IN]->(m:Match)\nOPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m)\nWITH t, m, p, COUNT(sg) AS goalsPerPlayer\nWITH t, m, SUM(goalsPerPlayer) AS totalGoalsPerMatch\nWITH t, COUNT(DISTINCT m) AS totalMatches, SUM(totalGoalsPerMatch) AS totalGoals\nRETURN t.name AS teamName, totalMatches, CASE WHEN totalMatches > 0 THEN toFloat(totalGoals) / totalMatches ELSE 0 END AS avgGoalsPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 47,
        "original_index": 47,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_65",
        "NL Question": "For each tournament after 2000, find the average age of players who scored goals and the total number of goals scored. Return the tournament name, average player age, and total goals.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[:SCORED_GOAL]-(p:Person)\nWHERE tour.year > 2000 AND p.dob IS NOT NULL\nWITH tour, p, m\nWITH tour, p, m.date.year - p.dob.year AS playerAge\nWITH tour, AVG(playerAge) AS avgPlayerAge, COUNT(m) AS totalGoals\nRETURN tour.name AS tournamentName, avgPlayerAge, totalGoals",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "grammatical error: Variable `m` not defined (line 1, column 242 (offset: 241))"
    },
    {
        "id": 48,
        "original_index": 48,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_66",
        "NL Question": "For each squad, compute the total number of players and the average number of matches played by each player in the squad. Return the squad ID, total player count, and average matches played per player.",
        "Cypher": "MATCH (s:Squad)<-[:IN_SQUAD]-(p:Person)-[:PLAYED_IN]->(m:Match)\nWITH s, p, COUNT(m) AS matchesPlayed\nWITH s, p, matchesPlayed\nWITH s, COUNT(DISTINCT p) AS totalPlayers, AVG(matchesPlayed) AS avgMatchesPerPlayer\nRETURN s.id AS squadId, totalPlayers, avgMatchesPerPlayer",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 49,
        "original_index": 49,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_67",
        "NL Question": "For each team that participated in the 'China 2007' tournament, determine the average number of goals scored in matches they played and the total number of players representing that team. Return the team name, average goals scored, and total players.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'China 2007'})<-[:IN_TOURNAMENT]-(m:Match)\nOPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m)\nWHERE (p)-[:REPRESENTS]->(t)\nWITH t, m, COUNT(sg) AS goalsPerMatch\nWITH t, AVG(goalsPerMatch) AS avgGoalsPerMatch, COLLECT(DISTINCT m) AS matches\nWITH t, avgGoalsPerMatch, SIZE(matches) AS totalMatches\nMATCH (p:Person)-[:REPRESENTS]->(t)\nWITH t, avgGoalsPerMatch, totalMatches, COUNT(DISTINCT p) AS totalPlayers\nRETURN t.name AS teamName, avgGoalsPerMatch, totalPlayers",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 50,
        "original_index": 50,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_70",
        "NL Question": "For each team that participated in the 'USA 1999' tournament, calculate the average number of goals scored per match and the total number of matches played. Return the team name, average goals per match, and total matches played.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'USA 1999'}) WHERE r.score IS NOT NULL WITH t, m, r.score AS scorePerMatch WITH t, COUNT(m) AS totalMatches, AVG(scorePerMatch) AS avgGoalsPerMatch RETURN t.name AS teamName, avgGoalsPerMatch, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 51,
        "original_index": 51,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_71",
        "NL Question": "For each person who played in a match, determine the total number of goals they scored and the number of tournaments they participated in. Return the person's name, total goals scored, and the number of tournaments.",
        "Cypher": "MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament) WITH p, m, t OPTIONAL MATCH (p)-[:SCORED_GOAL]->(m) WITH p, COUNT(DISTINCT m) AS totalGoals, COLLECT(DISTINCT t.name) AS tournaments RETURN p.name AS playerName, totalGoals, SIZE(tournaments) AS numberOfTournaments",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 52,
        "original_index": 52,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_72",
        "NL Question": "For each tournament, calculate the total number of goals scored by all players and the average age of the players who scored in those matches. Return the tournament name, total goals, and average player age.",
        "Cypher": "MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament) WHERE p.dob IS NOT NULL WITH t, p, sg, m, p.dob AS PlayerDOB WITH t, date().year - PlayerDOB.year AS PlayerAge, COUNT(sg) AS GoalsScoredPerPlayer WITH t, AVG(PlayerAge) AS AvgAge, SUM(GoalsScoredPerPlayer) AS TotalGoalsScored RETURN t.name AS TournamentName, TotalGoalsScored, AvgAge",
        "result [0/1]": "1",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "The query is not logical because the avg age calculation shouldbe done on the basis of the payer dob and tournament year, the query is taking difference of player's dob year and current year, which is incorrect."
    },
    {
        "id": 53,
        "original_index": 53,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_73",
        "NL Question": "For each team, determine the total number of matches played and the average number of players who scored goals in those matches. Return the team's name, the total matches played, and the average number of goal-scoring players per match.",
        "Cypher": "MATCH (t:Team)-[:PLAYED_IN]->(m:Match)<-[sg:SCORED_GOAL]-(p:Person) WITH t, m, COLLECT(DISTINCT p) AS playersPerMatch WITH t, m, SIZE(playersPerMatch) AS numPlayersPerMatch WITH t, COUNT(m) AS totalMatches, AVG(numPlayersPerMatch) AS avgPlayersPerMatch RETURN t.name AS teamName, totalMatches, avgPlayersPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 54,
        "original_index": 54,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_74",
        "NL Question": "For each squad, calculate the total number of players and, considering only matches in the 'USA 1999' tournament, the average number of goals scored by players in the squad. Return the squad ID, total players, and average goals scored per player in 'USA 1999'.",
        "Cypher": "MATCH (s:Squad)<-[:IN_SQUAD]-(p:Person)-[sg:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament {name: 'USA 1999'}) WITH s, p, sg, m OPTIONAL MATCH (s)<-[:IN_SQUAD]-(p) WITH s, COUNT(DISTINCT p) AS totalPlayers, COUNT(sg) AS goalsPerPlayer WITH s, totalPlayers, AVG(goalsPerPlayer) AS avgGoalsPerPlayer RETURN s.id AS squadId, totalPlayers, avgGoalsPerPlayer",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 55,
        "original_index": 55,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_77",
        "NL Question": "For each team, calculate the total number of matches they played in and the average number of goals scored in those matches. Return the team's name, the total number of matches, and the average goals scored per match.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match) WHERE r.score IS NOT NULL WITH t, COUNT(m) AS matchCount, SUM(r.score) AS totalGoals RETURN t.name AS teamName, matchCount AS totalMatches, toFloat(totalGoals)/matchCount AS avgGoalsPerMatch;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 56,
        "original_index": 56,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_79",
        "NL Question": "For each player, find the total number of tournaments they participated in and calculate the average number of goals they scored per tournament. Return the player's name, total tournaments, and average goals per tournament.",
        "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament) OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m) WITH p, t, COUNT(sg) AS goalsPerTournament, COLLECT(DISTINCT t.id) AS tournamentsPerPlayer WITH p, SIZE(tournamentsPerPlayer) AS totalTournaments, AVG(goalsPerTournament) AS avgGoalsPerTournament RETURN p.name AS playerName, totalTournaments, avgGoalsPerTournament;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 57,
        "original_index": 57,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_80",
        "NL Question": "For each team that participated in the 'Canada 2015' tournament, calculate the average age of the players in the team and the total number of matches they played. Return the team name, average player age, and total matches played.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'Canada 2015'}) MATCH (p:Person)-[:REPRESENTS]->(t)-[:PLAYED_IN]->(m:Match) WHERE p.dob IS NOT NULL WITH t, p, tour, m, tour.year - p.dob.year AS playerAge WITH t, AVG(playerAge) AS avgPlayerAge, COUNT(DISTINCT m) AS totalMatches RETURN t.name AS teamName, avgPlayerAge, totalMatches;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 58,
        "original_index": 58,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_81",
        "NL Question": "For each tournament, determine the team with the highest average score per match. Return the tournament name, team name, and the average score per match for that team.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[r:PLAYED_IN]-(t:Team) WHERE r.score IS NOT NULL WITH tour, t, AVG(r.score) AS avgScorePerMatch ORDER BY tour.name, avgScorePerMatch DESC WITH tour, COLLECT({team: t, avgScore: avgScorePerMatch}) AS teamScores RETURN tour.name AS tournamentName, teamScores[0].team.name AS teamName, teamScores[0].avgScore AS avgScorePerMatch;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 59,
        "original_index": 59,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_84",
        "NL Question": "For each tournament, what is the average number of players participating and the total number of goals scored across all matches? Return the tournament name, average number of players, and total goals.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[:PLAYED_IN]-(p:Person) OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m) WITH tour, m, p, COUNT(sg) AS goalsPerPlayer WITH tour, m, COUNT(DISTINCT p) AS playersPerMatch, SUM(goalsPerPlayer) AS totalGoalsPerMatch WITH tour, AVG(playersPerMatch) AS avgPlayers, SUM(totalGoalsPerMatch) AS totalGoals RETURN tour.name AS tournamentName, avgPlayers, totalGoals",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 60,
        "original_index": 60,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_85",
        "NL Question": "For each team, calculate the total number of matches they played and the average penalty score across those matches. Return the team name, total matches played, and average penalty score.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match) WHERE r.penaltyScore IS NOT NULL WITH t, COUNT(m) AS totalMatches, AVG(toInt(r.penaltyScore)) AS avgPenaltyScore RETURN t.name AS teamName, totalMatches, avgPenaltyScore",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "grammatical error: There is no function toInt(), tointeger() should be used."
    },
    {
        "id": 61,
        "original_index": 61,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_86",
        "NL Question": "For each person, compute the total number of tournaments they participated in and the average number of goals they scored per tournament. Return the person's name, the total number of tournaments, and their average goals per tournament.",
        "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament) OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m) WITH p, t, COUNT(sg) AS goalsPerTournament WITH p, COUNT(DISTINCT t) AS totalTournaments, AVG(goalsPerTournament) AS avgGoalsPerTournament RETURN p.name AS personName, totalTournaments, avgGoalsPerTournament",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 62,
        "original_index": 62,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_87",
        "NL Question": "For the tournament 'China PR 1991', what is the average number of goals scored by players who started the match, and what is the total number of players who started the match? Return the average goals and total players.",
        "Cypher": "MATCH (tour:Tournament {name: 'China PR 1991'})<-[:IN_TOURNAMENT]-(m:Match)<-[r:PLAYED_IN {type: 'Started'}]-(p:Person) OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m) WITH tour, p, COUNT(sg) AS goalsPerPlayer, r WITH COUNT(DISTINCT p) AS totalPlayers, SUM(goalsPerPlayer) AS totalGoals RETURN toFloat(totalGoals) / totalPlayers AS avgGoals, totalPlayers",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 63,
        "original_index": 63,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_88",
        "NL Question": "For each tournament, find the average age of players who participated and the total number of teams that participated. Return the tournament name, average player age, and total team count.",
        "Cypher": "MATCH (t:Tournament)<-[:PARTICIPATED_IN]-(team:Team)-[:PLAYED_IN]->(m:Match)<-[:PLAYED_IN]-(p:Person) WHERE p.dob IS NOT NULL WITH t, team, p, t.year - p.dob.year AS playerAge WITH t, AVG(playerAge) AS avgPlayerAge, COUNT(DISTINCT team) AS totalTeams RETURN t.name AS tournamentName, avgPlayerAge, totalTeams",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 64,
        "original_index": 64,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_91",
        "NL Question": "For each team that participated in the tournament 'USA 2003', find the average number of players who scored goals in their matches. Return the team name and the average number of goal scorers.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'USA 2003'}) MATCH (t)-[:PLAYED_IN]->(m:Match)<-[:SCORED_GOAL]-(p:Person) WITH t, m, COLLECT(DISTINCT p) AS goalScorersPerMatch WITH t, AVG(SIZE(goalScorersPerMatch)) AS avgGoalScorers RETURN t.name AS teamName, avgGoalScorers",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 65,
        "original_index": 65,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_92",
        "NL Question": "For each tournament, determine the average age of the players who scored goals and participated in matches. Return the tournament name and the average age of the goal-scoring players.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[:PLAYED_IN]-(p:Person)-[:SCORED_GOAL]->(m) WHERE p.dob IS NOT NULL WITH tour, p, m.date.year - p.dob.year AS playerAge WITH tour, AVG(playerAge) AS avgAge RETURN tour.name AS tournamentName, avgAge",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 66,
        "original_index": 66,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_93",
        "NL Question": "For each team, calculate the total number of goals scored by all players representing that team across all matches, and then determine the average number of goals scored per player. Return the team name and the average goals per player.",
        "Cypher": "MATCH (t:Team)<-[:REPRESENTS]-(p:Person)-[sg:SCORED_GOAL]->(m:Match) WITH t, p, COUNT(sg) AS goalsPerPlayer WITH t, AVG(goalsPerPlayer) AS avgGoalsPerPlayer RETURN t.name AS teamName, avgGoalsPerPlayer",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 67,
        "original_index": 67,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_94",
        "NL Question": "For each tournament, find the team with the highest average 'score' in the PLAYED_IN relationships across all its matches in that tournament. Return the tournament name and the name of the team with the highest average score.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[r:PLAYED_IN]-(t:Team) WHERE r.score IS NOT NULL WITH tour, t, AVG(r.score) AS avgScore ORDER BY tour.id, avgScore DESC WITH tour, COLLECT({team: t, avgScore: avgScore}) AS teamScores RETURN tour.name AS tournamentName, teamScores[0].team.name AS teamWithHighestAvgScore",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 68,
        "original_index": 68,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_95",
        "NL Question": "For each tournament, calculate the total number of players who both played in a match and were in a squad for that tournament. Return the tournament name and the total count of such players.",
        "Cypher": "MATCH (tour:Tournament)<-[:FOR]-(s:Squad)<-[:IN_SQUAD]-(p:Person)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour) WITH tour, p RETURN tour.name AS tournamentName, COUNT(DISTINCT p) AS totalPlayers",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 69,
        "original_index": 69,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_98",
        "NL Question": "For each tournament, calculate the total number of goals scored and the average number of players who scored in each match. Return the tournament name, total goals scored, and average scorers per match.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[sg:SCORED_GOAL]-(p:Person) WITH tour, m, COUNT(DISTINCT p) AS scorers, COUNT(sg) AS goalsPerMatch WITH tour, SUM(goalsPerMatch) AS totalGoals, AVG(scorers) AS avgScorersPerMatch RETURN tour.name AS tournamentName, totalGoals, avgScorersPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 70,
        "original_index": 70,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_99",
        "NL Question": "For each team that participated in the 'USA 1999' tournament, calculate the total number of matches played and the average goals scored per match. Return the team name, total matches, and average goals per match.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'USA 1999'})-[r:PLAYED_IN]-(m:Match) WHERE r.score IS NOT NULL WITH t, COUNT(m) AS matchCount, SUM(r.score) AS totalGoals RETURN t.name AS teamName, matchCount AS totalMatches, toFloat(totalGoals)/matchCount AS avgGoalsPerMatch",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "The query was incorrect because it mistakenly used the `PLAYED_IN` relationship between `Tournament` and `Match`, whereas `PLAYED_IN` should connect `Team` to `Match`, and `Match` connects to `Tournament` via `IN_TOURNAMENT`."
    },
    {
        "id": 71,
        "original_index": 71,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_100",
        "NL Question": "For each player who played in the 'Germany 2011' tournament, calculate the total number of goals they scored and the average number of minutes they played per match. Return the player's name, total goals, and average minutes played.",
        "Cypher": "MATCH (p:Person)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'Germany 2011'}) WHERE r.score IS NOT NULL WITH p, m, r.score AS goals, toInteger(replace(r.minuteOn, '''', '')) AS minutesPlayed WITH p, SUM(goals) AS totalGoals, AVG(minutesPlayed) AS avgMinutesPlayed RETURN p.name AS playerName, totalGoals, avgMinutesPlayed",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "You're treating r as a unique relationship per match per player. If a player can have multiple PLAYED_IN entries per match, this might overcount."
    },
    {
        "id": 72,
        "original_index": 72,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_101",
        "NL Question": "For each squad in the 'France 2019' tournament, determine the average age of the players in the squad at the time of the tournament. Return the squad ID and the average age of the players.",
        "Cypher": "MATCH (s:Squad)-[:FOR]->(tour:Tournament {name: 'France 2019'}) MATCH (p:Person)-[:IN_SQUAD]->(s) WHERE p.dob IS NOT NULL WITH s, p, tour.year - p.dob.year AS age RETURN s.id AS squadId, AVG(age) AS averageAge",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 73,
        "original_index": 73,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_102",
        "NL Question": "For each team that played in a match during the year 2019, calculate the total number of goals scored and the average number of goals scored per match. Return the team's name, total goals scored, and average goals per match.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match) WHERE m.date.year = 2019 AND r.score IS NOT NULL WITH t, COUNT(m) AS matchCount, SUM(r.score) AS totalGoals RETURN t.name AS teamName, totalGoals, toFloat(totalGoals)/matchCount AS avgGoalsPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 74,
        "original_index": 74,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_105",
        "NL Question": "For each tournament, determine the average number of goals scored by players per match. Return the tournament name, the total number of matches, and the average goals per match.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[sg:SCORED_GOAL]-(p:Person) WITH tour, m, COUNT(sg) AS goalsPerMatch WITH tour, COUNT(m) AS totalMatches, AVG(goalsPerMatch) AS avgGoalsPerMatch RETURN tour.name AS tournamentName, totalMatches, avgGoalsPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 75,
        "original_index": 75,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_106",
        "NL Question": "For each team, calculate the total number of matches they played and the average 'score' value recorded in the PLAYED_IN relationships for those matches. Return the team name, total matches played, and average score.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match) WHERE r.score IS NOT NULL WITH t, COUNT(m) AS totalMatches, AVG(r.score) AS averageScore RETURN t.name AS teamName, totalMatches, averageScore",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 76,
        "original_index": 76,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_107",
        "NL Question": "For each person, determine the total number of goals they scored and the average number of minutes they played in each match where the 'minuteOn' property is available. Return the person's name, total goals scored, and average minutes played.",
        "Cypher": "MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match) WITH p, COUNT(sg) AS totalGoals OPTIONAL MATCH (p)-[pi:PLAYED_IN]->(m) WHERE pi.minuteOn IS NOT NULL WITH p, totalGoals, AVG(toFloat(replace(pi.minuteOn, '''', ''))) AS avgMinutesPlayed RETURN p.name AS personName, totalGoals, avgMinutesPlayed",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "There is no way, we can find out for how long the player played in the match, as the minuteOn property is not available in the PLAYED_IN relationship. It is only available in the SCORED_GOAL relationship."
    },
    {
        "id": 77,
        "original_index": 77,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_108",
        "NL Question": "For each tournament, compute the total number of teams that participated and the average number of players in the squads representing those teams. Return the tournament name, total teams, and average squad size.",
        "Cypher": "MATCH (tour:Tournament)<-[:FOR]-(s:Squad)<-[:NAMED]-(t:Team) WITH tour, s, t MATCH (s)<-[:IN_SQUAD]-(p:Person) WITH tour, t, COUNT(DISTINCT p) AS squadSize WITH tour, COUNT(DISTINCT t) AS totalTeams, AVG(squadSize) AS avgSquadSize RETURN tour.name AS tournamentName, totalTeams, avgSquadSize",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 78,
        "original_index": 78,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_109",
        "NL Question": "For each team that participated in the 'Sweden 1995' tournament, calculate the total number of goals scored by all players from that team and the average number of minutes played by those players. Return the team name, total goals scored, and average minutes played.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'Sweden 1995'}) MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match)<-[:PLAYED_IN]-(t) WITH t, p, COUNT(sg) AS goalsByPlayer OPTIONAL MATCH (p)-[pi:PLAYED_IN]->(m) WHERE pi.minuteOn IS NOT NULL WITH t, SUM(goalsByPlayer) AS totalGoals, AVG(toFloat(replace(pi.minuteOn, '''', ''))) AS avgMinutesPlayed RETURN t.name AS teamName, totalGoals, avgMinutesPlayed",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "grammatical error: Invalid input '''': expected an expression, ')' or ',' (line 1, column 323 (offset: 322))"
    },
    {
        "id": 79,
        "original_index": 79,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_113",
        "NL Question": "For each team that participated in 'China 2007', find the average number of players in their squads and the total number of matches they played. Return the team name, average squad size, and total matches played.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'China 2007'})\nMATCH (t)-[:NAMED]->(s:Squad)\nOPTIONAL MATCH (s)<-[:IN_SQUAD]-(p:Person)\nWITH t,s, COUNT(p) AS squadSize\nWITH t, AVG(squadSize) AS avgSquadSize\nOPTIONAL MATCH (t)-[:PLAYED_IN]->(m:Match)\nWITH t, avgSquadSize, COUNT(m) AS totalMatchesPlayed\nRETURN t.name AS teamName, avgSquadSize, totalMatchesPlayed",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 80,
        "original_index": 80,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_114",
        "NL Question": "For each player, calculate the total number of goals they scored and the number of tournaments in which they scored at least one goal. Return the player's name, total goals scored, and the number of tournaments with goals.",
        "Cypher": "MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament)\nWITH p, t, COUNT(sg) AS goalsInTournament\nWHERE goalsInTournament > 0\nWITH p, COUNT(DISTINCT t) AS tournamentsWithGoals\nOPTIONAL MATCH (p)-[sg2:SCORED_GOAL]->(:Match)\nWITH p, tournamentsWithGoals, COUNT(sg2) AS totalGoals\nRETURN p.name AS playerName, totalGoals, tournamentsWithGoals",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 81,
        "original_index": 81,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_115",
        "NL Question": "For each tournament, determine the average age of the players who participated and the total number of players who played in at least one match. Return the tournament name, average player age, and total number of participating players.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[:PLAYED_IN]-(p:Person)\nWHERE p.dob IS NOT NULL\nWITH tour, p, tour.year - p.dob.year AS playerAge\nWITH tour, AVG(playerAge) AS avgPlayerAge, COUNT(DISTINCT p) AS totalPlayers\nRETURN tour.name AS tournamentName, avgPlayerAge, totalPlayers",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 82,
        "original_index": 82,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_116",
        "NL Question": "For each team, calculate the average number of goals scored by players representing that team and the total number of matches where at least one of their players scored a goal. Return the team name, average goals per player, and total matches with goals.",
        "Cypher": "MATCH (t:Team)<-[:REPRESENTS]-(p:Person)-[sg:SCORED_GOAL]->(m:Match\n)\nWITH t, m, p, COUNT(sg) AS goalsPerPlayer\nWITH t, m, AVG(goalsPerPlayer) AS avgGoalsPerPlayer\nWITH t, avgGoalsPerPlayer, COUNT(DISTINCT m) AS totalMatchesWithGoals\nRETURN t.name AS teamName, avgGoalsPerPlayer, totalMatchesWithGoals",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 83,
        "original_index": 83,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_119",
        "NL Question": "For each tournament, calculate the average number of goals scored per match and the total number of teams that participated. Return the tournament name, average goals per match, and the total number of participating teams.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament) WITH tour, t MATCH (m:Match)-[:IN_TOURNAMENT]->(tour) OPTIONAL MATCH (:Person)-[sg:SCORED_GOAL]->(m) WITH tour, t, m, COUNT(sg) AS matchGoals WITH tour, t, SUM(matchGoals) AS totalGoals, COUNT(m) AS totalMatches WITH tour, AVG(toFloat(totalGoals) / totalMatches) AS avgGoalsPerMatch, COUNT(DISTINCT t) AS totalTeams RETURN tour.name AS tournamentName, avgGoalsPerMatch, totalTeams",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 84,
        "original_index": 84,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_120",
        "NL Question": "For each team, determine the total number of matches they played and the average number of players who scored goals in those matches. Return the team name, total matches played, and average number of goal scorers per match.",
        "Cypher": "MATCH (t:Team)-[:PLAYED_IN]->(m:Match) WITH t, m MATCH (p:Person)-[sg:SCORED_GOAL]->(m) WITH t, m, COUNT(DISTINCT p) AS goalScorersPerMatch WITH t, COUNT(m) AS totalMatches, AVG(goalScorersPerMatch) AS avgGoalScorersPerMatch RETURN t.name AS teamName, totalMatches, avgGoalScorersPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 85,
        "original_index": 85,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_122",
        "NL Question": "For each tournament held after 1990, find the average number of teams participating and the maximum number of players from any single team in that tournament. Return the tournament name, average teams, and maximum players from a team.",
        "Cypher": "MATCH (tour:Tournament) WHERE tour.year > 1990 MATCH (t:Team)-[:PARTICIPATED_IN]->(tour) WITH tour, t MATCH (p:Person)-[:REPRESENTS]->(t) WITH tour, t, COUNT(p) AS playersPerTeam WITH tour, AVG(1.0) AS avgTeams, MAX(playersPerTeam) AS maxPlayersFromTeam RETURN tour.name AS tournamentName, avgTeams, maxPlayersFromTeam",
        "result [0/1]": "1",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "The intent of the query is not correctly mapped, it should be nothing but the total teams participating in the tournament, not the average number of teams participating. The average number of teams participating is always 1, as there is only one team per tournament."
    },
    {
        "id": 86,
        "original_index": 86,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_123",
        "NL Question": "For each squad, determine the number of distinct tournaments they participated in and the average number of goals scored by players in the squad across all matches. Return the squad ID, number of tournaments, and average goals per player.",
        "Cypher": "MATCH (s:Squad)-[:FOR]->(tour:Tournament) WITH s, tour MATCH (p:Person)-[:IN_SQUAD]->(s)-[:FOR]->(tour) OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(tour) WITH s, tour, p, COUNT(sg) AS goalsPerPlayer WITH s, COUNT(DISTINCT tour) AS totalTournaments, COLLECT(goalsPerPlayer) AS goalsList RETURN s.id AS squadId, totalTournaments, REDUCE(s = 0, x IN goalsList | s + x) / toFloat(SIZE(COLLECT(DISTINCT p))) AS avgGoalsPerPlayer",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "grammatical error: Variable `p` not defined (line 1, column 421 (offset: 420))"
    },
    {
        "id": 87,
        "original_index": 87,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_126",
        "NL Question": "For each team, calculate the total number of matches they played and the average number of goals scored per match where goals are recorded. Return the team name, total matches played, and average goals per match.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match) WHERE r.score IS NOT NULL WITH t, COUNT(m) AS matchCount, SUM(r.score) AS totalGoals RETURN t.name AS teamName, matchCount AS totalMatches, toFloat(totalGoals)/matchCount AS avgGoalsPerMatch;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 88,
        "original_index": 88,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_127",
        "NL Question": "For each tournament, compute the total number of teams that participated and the average number of players per team. Return the tournament name, total teams, and average players per team.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament) WITH tour, t MATCH (p:Person)-[:REPRESENTS]->(t) WITH tour, t, COUNT(p) AS playerCount WITH tour, COLLECT(playerCount) AS playerCounts, COUNT(DISTINCT t) AS totalTeams RETURN tour.name AS tournamentName, totalTeams, REDUCE(s = 0, pc IN playerCounts | s + pc * 1.0) / SIZE(playerCounts) AS avgPlayersPerTeam;",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "grammatical error: Type mismatch: expected Float, Integer or Duration but was Number (line 1, column 270 (offset: 269))"
    },
    {
        "id": 89,
        "original_index": 89,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_128",
        "NL Question": "For each person who scored a goal, find the average number of goals they scored per match and the total number of matches they played in. Return the person's name, average goals per match, and total matches played, only if they played in more than 0 matches.",
        "Cypher": "MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match) WITH p, COUNT(sg) AS totalGoals, COLLECT(DISTINCT m) AS matchesPlayed WITH p, totalGoals, SIZE(matchesPlayed) AS totalMatches WHERE totalMatches > 0 RETURN p.name AS playerName, toFloat(totalGoals) / totalMatches AS avgGoalsPerMatch, totalMatches;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 90,
        "original_index": 90,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_129",
        "NL Question": "For each tournament, determine the average number of goals scored by players from each team participating in that tournament. Return the tournament name and the average goals scored per team.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[sg:SCORED_GOAL]-(p:Person)-[:REPRESENTS]->(t:Team)-[:PARTICIPATED_IN]->(tour) WITH tour, t, COUNT(sg) AS teamGoalsPerMatch WITH tour, COLLECT(teamGoalsPerMatch) AS teamGoals RETURN tour.name AS tournamentName, REDUCE(s = 0, goals IN teamGoals | s + goals * 1.0) / SIZE(teamGoals) AS avgGoalsPerTeam;",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "grammatical error: Type mismatch: expected Float, Integer or Duration but was Number (line 1, column 265 (offset: 264)) and The error was due to overcounting goals per team per match instead of per tournament, leading to inflated goal totals and an incorrect average. "
    },
    {
        "id": 91,
        "original_index": 91,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_130",
        "NL Question": "For each tournament, calculate the average age of players who scored at least one goal in a match during that tournament. Return the tournament name and the average age of the goal scorers.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[sg:SCORED_GOAL]-(p:Person) WHERE p.dob IS NOT NULL WITH tour, p, tour.year - p.dob.year AS playerAge WITH tour, COLLECT(playerAge) AS playerAges RETURN tour.name AS tournamentName, REDUCE(s = 0, age IN playerAges | s + age * 1.0) / SIZE(playerAges) AS avgAgeOfGoalScorers;",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "grammatical error: Type mismatch: expected Float, Integer or Duration but was Number (line 1, column 236 (offset: 235))"
    },
    {
        "id": 92,
        "original_index": 92,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_133",
        "NL Question": "For the 'USA 2003' tournament, calculate the average number of goals scored per match and the total number of matches played. Return the average goals per match and the total matches.",
        "Cypher": "MATCH (tour:Tournament {name: 'USA 2003'})<-[:IN_TOURNAMENT]-(m:Match)<-[sg:SCORED_GOAL]-(:Person) WITH tour, m, COUNT(sg) AS goalsPerMatch WITH tour, AVG(goalsPerMatch) AS avgGoalsPerMatch, COUNT(m) AS totalMatches RETURN avgGoalsPerMatch, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 93,
        "original_index": 93,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_134",
        "NL Question": "For each team that participated in the 'USA 2003' tournament, find the average number of players in their squads and the total number of matches they played. Return the team name, average squad size, and total matches played.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'USA 2003'}) MATCH (t)-[:NAMED]->(s:Squad)<-[:IN_SQUAD]-(p:Person) WITH t, s, COUNT(p) AS squadSize MATCH (t)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour) WITH t, AVG(squadSize) AS avgSquadSize, COUNT(m) AS totalMatches RETURN t.name AS teamName, avgSquadSize, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 94,
        "original_index": 94,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_135",
        "NL Question": "For each person who played in a match, determine the average number of goals they scored per match and the total number of matches they played in. Return the person's name, average goals per match, and total matches played.",
        "Cypher": "MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match) WITH p, COUNT(sg) AS goals, COUNT(DISTINCT m) AS totalMatches RETURN p.name AS playerName,toFloat(goals)/totalMatches AS avgGoalsPerMatch, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 95,
        "original_index": 95,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_136",
        "NL Question": "For each stage of matches in the 'USA 2003' tournament, find the average number of goals scored per match and the total number of matches played. Return the match stage, average goals per match, and total matches.",
        "Cypher": "MATCH (tour:Tournament {name: 'USA 2003'})<-[:IN_TOURNAMENT]-(m:Match)<-[sg:SCORED_GOAL]-(:Person) WITH tour, m.stage AS matchStage, m, COUNT(sg) AS goalsPerMatch WITH matchStage, AVG(goalsPerMatch) AS avgGoalsPerMatch, COUNT(m) AS totalMatches RETURN matchStage, avgGoalsPerMatch, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 96,
        "original_index": 96,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_137",
        "NL Question": "For each year a tournament was held, calculate the average number of teams that participated and the total number of matches played. Return the year, average teams participating, and total matches played.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament) WITH tour.year AS tournamentYear, tour, t MATCH (t)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour) WITH tournamentYear, COUNT(DISTINCT t) AS teamCount, COUNT(DISTINCT m) AS totalMatches RETURN tournamentYear, AVG(teamCount) AS avgTeamsParticipating, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 97,
        "original_index": 97,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_140",
        "NL Question": "For each team that participated in the 'Canada 2015' tournament, calculate the average number of goals scored per match and the total number of matches played. Return the team name, average goals per match, and total matches played.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'Canada 2015'}) WHERE r.score IS NOT NULL WITH t, m, r.score AS score  WITH t, m, SUM(score) AS total_score  WITH t, COUNT(DISTINCT m) AS totalMatches, SUM(total_score) AS totalGoals  RETURN t.name AS teamName, toFloat(totalGoals)/totalMatches AS avgGoalsPerMatch, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 98,
        "original_index": 98,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_141",
        "NL Question": "For each player who scored goals in matches within the 'China PR 1991' tournament, determine the average number of goals scored per match they played in that tournament. Return the player's name and the average goals per match.",
        "Cypher": "MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'China PR 1991'}) WITH p, m, COUNT(sg) AS goalsPerMatch WITH p, AVG(goalsPerMatch) AS avgGoalsPerMatch RETURN p.name AS playerName, avgGoalsPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 99,
        "original_index": 99,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_142",
        "NL Question": "For each team that participated in a tournament, find the average number of players in their squads. Return the team name and the average squad size.",
        "Cypher": "MATCH (t:Team)-[:NAMED]->(s:Squad)<-[:IN_SQUAD]-(p:Person) WITH t, s, COUNT(p) AS squadSize WITH t, AVG(squadSize) AS avgSquadSize RETURN t.name AS teamName, avgSquadSize",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 100,
        "original_index": 100,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_143",
        "NL Question": "For each tournament, calculate the total number of teams that participated and the average number of matches played by each team. Return the tournament name, total teams, and average matches per team.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament) WITH tour, t MATCH (t)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour) WITH tour, t, COUNT(m) AS matchesPerTeam WITH tour, COUNT(DISTINCT t) AS totalTeams, AVG(matchesPerTeam) AS avgMatchesPerTeam RETURN tour.name AS tournamentName, totalTeams, avgMatchesPerTeam",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 101,
        "original_index": 101,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_144",
        "NL Question": "For each team, compute the average number of goals scored in matches played during the 'Canada 2015' tournament, considering only matches where goals were actually recorded. Return the team's name and the average goals scored.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'Canada 2015'}) WHERE r.score IS NOT NULL WITH t, AVG(r.score) AS avgGoals RETURN t.name AS teamName, avgGoals",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 102,
        "original_index": 102,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_147",
        "NL Question": "For each tournament, calculate the total number of teams that participated and the average number of players per team. Return the tournament name, the total number of participating teams, and the average number of players per team.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament) WITH tour, t MATCH (p:Person)-[:REPRESENTS]->(t) WITH tour, t, count(p) AS numPlayersPerTeam WITH tour, count(t) AS numTeams, avg(numPlayersPerTeam) AS avgPlayersPerTeam RETURN tour.name AS tournamentName, numTeams, avgPlayersPerTeam",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 103,
        "original_index": 103,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_148",
        "NL Question": "For each team that played in the 'France 2019' tournament, determine the total number of matches they played and the average score they achieved in those matches. Return the team name, the total matches played, and the average score.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'France 2019'}) WHERE r.score IS NOT NULL WITH t, COUNT(m) AS totalMatches, AVG(r.score) AS avgScore RETURN t.name AS teamName, totalMatches, avgScore",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 104,
        "original_index": 104,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_149",
        "NL Question": "For each tournament, find the average number of goals scored per match and the total number of unique players who scored goals. Return the tournament name, average goals per match, and the count of unique goal scorers.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[sg:SCORED_GOAL]-(p:Person) WITH tour, m, p, COUNT(sg) AS goalsPerPlayerPerMatch WITH tour, m, SUM(goalsPerPlayerPerMatch) AS totalGoalsPerMatch, collect(DISTINCT p.id) AS uniquePlayerIds WITH tour, AVG(totalGoalsPerMatch) AS avgGoalsPerMatch, SIZE(uniquePlayerIds) AS uniqueGoalScorerCount RETURN tour.name AS tournamentName, avgGoalsPerMatch, uniqueGoalScorerCount",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 105,
        "original_index": 105,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_150",
        "NL Question": "For each team, calculate the total number of matches where they scored more than 1 goal and the average number of minutes played by players from that team in those matches. Return the team name, the count of high-scoring matches, and the average minutes played.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match) WHERE r.score > 1 WITH t, r, m MATCH (p:Person)-[r2:PLAYED_IN]->(m) WHERE r2.minuteOn IS NOT NULL AND r2.minuteOn <> '' WITH t, m, toInteger(r2.minuteOn) AS minutesOnTeam RETURN t.name AS teamName, count(DISTINCT m) AS highScoringMatches, avg(minutesOnTeam) AS avgMinutesPlayed",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 106,
        "original_index": 106,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_151",
        "NL Question": "For each player born before 1975, determine the number of tournaments they participated in and the average number of goals they scored per tournament. Return the player's name, the number of tournaments, and the average goals per tournament.",
        "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament) WHERE p.dob IS NOT NULL AND p.dob.year < 1975 OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m) WITH p, tour, COUNT(sg) AS goalsPerTournament OPTIONAL MATCH (p)-[:PLAYED_IN]->(m2:Match)-[:IN_TOURNAMENT]->(tour2:Tournament) WITH p, COLLECT(DISTINCT tour2.id) AS tournaments, AVG(goalsPerTournament) AS avgGoalsPerTournament RETURN p.name AS playerName, SIZE(tournaments) AS numberOfTournaments, avgGoalsPerTournament",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 107,
        "original_index": 107,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_154",
        "NL Question": "For each team, calculate the average number of goals scored in matches they played and the total number of matches they participated in. Return the team name, average goals, and total matches.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match) WHERE r.score IS NOT NULL WITH t, COUNT(m) AS totalMatches, AVG(r.score) AS avgGoalsPerMatch RETURN t.name AS teamName, avgGoalsPerMatch, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 108,
        "original_index": 108,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_155",
        "NL Question": "For each tournament, determine the average number of teams that participated and the total number of matches played. Return the tournament name, average teams, and total matches.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament) WITH tour, COUNT(t) AS teamCount MATCH (m:Match)-[:IN_TOURNAMENT]->(tour) WITH tour, teamCount, COUNT(m) AS totalMatches RETURN tour.name AS tournamentName, AVG(teamCount), totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 109,
        "original_index": 109,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_156",
        "NL Question": "For each person, determine the number of tournaments they played in and the average number of goals they scored per match. Return the person's name, the number of tournaments, and their average goals per match.",
        "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament) OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m) WITH p, COUNT(DISTINCT tour) AS tournamentCount, COUNT(sg) AS totalGoals, COUNT(DISTINCT m) AS totalMatches RETURN p.name AS personName, tournamentCount, CASE WHEN totalMatches = 0 THEN 0 ELSE toFloat(totalGoals) / totalMatches END AS avgGoalsPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 110,
        "original_index": 110,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_157",
        "NL Question": "For each squad, find the average number of players and the total number of matches played by those players. Return the squad ID, average players, and total matches.",
        "Cypher": "MATCH (s:Squad)<-[:IN_SQUAD]-(p:Person)-[:PLAYED_IN]->(m:Match) WITH s, COUNT(DISTINCT p) AS playerCount, COUNT(m) AS totalMatches RETURN s.id AS squadId, AVG(playerCount), SUM(totalMatches)",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 111,
        "original_index": 111,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_158",
        "NL Question": "For each tournament, calculate the total number of goals scored and the average number of goals scored by players who represent 'Australia'. Return the tournament name, total goals, and average goals for 'Australia' representatives.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[sg:SCORED_GOAL]-(p:Person)-[:REPRESENTS]->(t:Team {name: 'Australia'}) WITH tour, COUNT(sg) AS ausGoals MATCH (tour)<-[:IN_TOURNAMENT]-(match:Match)<-[scored:SCORED_GOAL]-(player:Person) WITH tour, ausGoals, COUNT(scored) AS totalGoals RETURN tour.name AS tournamentName, totalGoals, AVG(ausGoals)",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 112,
        "original_index": 112,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_161",
        "NL Question": "For each team, calculate the total number of matches they played and the average number of goals scored in those matches. Return the team name, total matches, and average goals per match.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match) WHERE r.score IS NOT NULL WITH t, COUNT(m) AS matchCount, SUM(r.score) AS totalGoals RETURN t.name AS teamName, matchCount AS totalMatches, toFloat(totalGoals)/matchCount AS avgGoalsPerMatch;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 113,
        "original_index": 113,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_162",
        "NL Question": "For the tournament 'China 2007', find the average number of goals scored per match. Return the tournament name and the average goals scored.",
        "Cypher": "MATCH (m:Match)-[:IN_TOURNAMENT]->(t:Tournament {name: 'China 2007'}) OPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m) WITH t, m, COUNT(sg) AS goalsPerMatch WITH t, AVG(goalsPerMatch) AS avgGoals RETURN t.name AS tournamentName, avgGoals;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 114,
        "original_index": 114,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_163",
        "NL Question": "For each squad, compute the total number of players and the average number of goals scored by players in that squad across all matches. Return the squad ID, total player count, and average goals per player.",
        "Cypher": "MATCH (s:Squad)<-[:IN_SQUAD]-(p:Person) OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(:Match) WITH s, p, COUNT(sg) AS goalsPerPlayer WITH s, COUNT(DISTINCT p) AS totalPlayers, AVG(goalsPerPlayer) AS avgGoalsPerPlayer RETURN s.id AS squadId, totalPlayers, avgGoalsPerPlayer;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 115,
        "original_index": 115,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_164",
        "NL Question": "For each tournament, determine the team that participated and scored the highest total goals. Return the tournament name, team name and total goals scored by the team in that tournament.",
        "Cypher": "MATCH (tour:Tournament) MATCH (t:Team)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour) WITH tour, t, SUM(r.score) AS totalGoals ORDER BY tour.id, totalGoals DESC WITH tour, COLLECT({team: t, totalGoals: totalGoals}) AS scorers RETURN tour.name AS tournamentName, scorers[0].team.name AS teamName, scorers[0].totalGoals AS totalGoals;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 116,
        "original_index": 116,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_165",
        "NL Question": "For each player who played in a match during the 'China 2007' tournament, calculate the average number of minutes they played. Return the player's name and the average minutes played.",
        "Cypher": "MATCH (p:Person)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament {name: 'China 2007'}) WHERE r.minuteOn IS NOT NULL WITH p, r.minuteOn AS minuteOn, m, t WITH p, SPLIT(minuteOn, '''')[0] AS minuteNumber WHERE all(c in split(minuteNumber, '') where c in ['0','1','2','3','4','5','6','7','8','9']) WITH p, toInteger(minuteNumber) AS minuteOnInt RETURN p.name AS playerName, avg(minuteOnInt) AS averageMinutesPlayed",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "grammatical error"
    },
    {
        "id": 117,
        "original_index": 117,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_168",
        "NL Question": "For each tournament, calculate the average number of players from each team that participated and the total number of teams that participated. Return the tournament name, average players per team, and total teams.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament) \nMATCH (p:Person)-[:REPRESENTS]->(t) \nWITH tour, t, count(p) AS playerCount\nWITH tour, AVG(playerCount) AS avgPlayersPerTeam, count(t) AS totalTeams\nRETURN tour.name AS tournamentName, avgPlayersPerTeam, totalTeams",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 118,
        "original_index": 118,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_169",
        "NL Question": "For each team, compute the total number of matches they played and the average score they achieved in those matches. Return the team's name, total matches, and average score.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match)\nWHERE r.score IS NOT NULL\nWITH t, COUNT(m) AS totalMatches, AVG(r.score) AS averageScore\nRETURN t.name AS teamName, totalMatches, averageScore",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 119,
        "original_index": 119,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_170",
        "NL Question": "For each tournament, find the average number of goals scored per match and the total number of matches played. Return the tournament name, average goals per match, and total matches played.",
        "Cypher": "MATCH (m:Match)-[:IN_TOURNAMENT]->(t:Tournament)\nOPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m)\nWITH t, m, COUNT(sg) AS goalsPerMatch\nWITH t, AVG(goalsPerMatch) AS avgGoalsPerMatch, COUNT(m) AS totalMatches\nRETURN t.name AS tournamentName, avgGoalsPerMatch, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 120,
        "original_index": 120,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_171",
        "NL Question": "For each squad, determine the total number of players and calculate the average number of matches played by the players in that squad. Return the squad ID, total players, and average matches played per player.",
        "Cypher": "MATCH (s:Squad)<-[:IN_SQUAD]-(p:Person)-[:PLAYED_IN]->(m:Match)\nWITH s, p, COUNT(m) AS matchesPlayed\nWITH s, COUNT(DISTINCT p) AS totalPlayers, AVG(matchesPlayed) AS avgMatchesPerPlayer\nRETURN s.id AS squadId, totalPlayers, avgMatchesPerPlayer",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 121,
        "original_index": 121,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_172",
        "NL Question": "For each person, find the average number of goals scored per tournament they participated in and the total number of tournaments they participated in. Return the person's name, average goals per tournament, and total tournaments.",
        "Cypher": "MATCH (p:Person)-[:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament)\nWITH p, t, COUNT(m) AS goalsPerTournament\nWITH p, AVG(goalsPerTournament) AS avgGoalsPerTournament, COUNT(t) AS totalTournaments\nRETURN p.name AS personName, avgGoalsPerTournament, totalTournaments",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 122,
        "original_index": 122,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_175",
        "NL Question": "For each tournament, calculate the total number of teams that participated and the average number of players from each team who scored goals. Return the tournament name, total teams, and average goals per team.",
        "Cypher": "MATCH (tour:Tournament)<-[:PARTICIPATED_IN]-(t:Team) OPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(tour) WHERE (p)-[:REPRESENTS]->(t) WITH tour, t, COUNT(sg) AS goalsPerTeam WITH tour, COUNT(DISTINCT t) AS totalTeams, AVG(goalsPerTeam) AS avgGoalsPerTeam RETURN tour.name AS tournamentName, totalTeams, avgGoalsPerTeam",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 123,
        "original_index": 123,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_176",
        "NL Question": "For each team, determine the total number of matches played and the average number of minutes played by players on that team. Return the team's name, total matches played, and the average minutes played by players.",
        "Cypher": "MATCH (t:Team)-[:PLAYED_IN]->(m:Match) OPTIONAL MATCH (p:Person)-[r:PLAYED_IN]->(m) WHERE (p)-[:REPRESENTS]->(t) AND r.minuteOn IS NOT NULL WITH t, m, toInteger(substring(r.minuteOn,0,size(r.minuteOn)-1)) as minuteOn  WITH t, COUNT(DISTINCT m) AS totalMatches, AVG(minuteOn) AS avgMinutesPlayed RETURN t.name AS teamName, totalMatches, avgMinutesPlayed",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 124,
        "original_index": 124,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_177",
        "NL Question": "For each tournament, find the team with the highest average score in matches. Return the tournament name, the team's name, and the team's average score.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[r:PLAYED_IN]-(t:Team) WHERE r.score IS NOT NULL WITH tour, t, AVG(r.score) AS avgScore ORDER BY tour.id, avgScore DESC WITH tour, COLLECT({team: t, avgScore: avgScore}) AS teamScores RETURN tour.name AS tournamentName, teamScores[0].team.name AS teamName, teamScores[0].avgScore AS averageScore",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 125,
        "original_index": 125,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_178",
        "NL Question": "For each player who scored a goal, calculate the total number of goals scored and the average number of goals scored per tournament. Return the player's name, total goals scored, and average goals per tournament.",
        "Cypher": "MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament) WITH p, tour, COUNT(sg) AS goalsPerTournament WITH p, COUNT(tour) AS tournamentCount, SUM(goalsPerTournament) AS totalGoals RETURN p.name AS playerName, totalGoals, toFloat(totalGoals) / tournamentCount AS avgGoalsPerTournament",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 126,
        "original_index": 126,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_179",
        "NL Question": "For each team that participated in the 'Germany 2011' tournament, determine the average number of goals scored per match and the total number of players who played for that team in the tournament. Return the team name, average goals per match, and total players.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'Germany 2011'}) MATCH (t)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour) OPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m) WHERE (p)-[:REPRESENTS]->(t) WITH t, m, COUNT(sg) AS goalsPerMatch, p WITH t,m, goalsPerMatch, count(distinct p) as totalPlayers  WITH t, AVG(goalsPerMatch) AS avgGoalsPerMatch, max(totalPlayers) as totalPlayers RETURN t.name AS teamName, avgGoalsPerMatch, totalPlayers",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 127,
        "original_index": 127,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_183",
        "NL Question": "For each team, determine the total number of matches they played and the average score they achieved in those matches. Return the team's name, total matches played, and the average score per match.",
        "Cypher": "MATCH (team:Team)-[r:PLAYED_IN]->(m:Match) WHERE r.score IS NOT NULL WITH team, COUNT(m) AS totalMatches, AVG(r.score) AS avgScorePerMatch RETURN team.name AS teamName, totalMatches, avgScorePerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 128,
        "original_index": 128,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_184",
        "NL Question": "For each player, calculate the total number of tournaments they participated in and the average number of goals they scored per tournament. Return the player's name, the total number of tournaments, and the average goals per tournament.",
        "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament) OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m) WITH p, t, COUNT(sg) AS goalsPerTournament WITH p, COUNT(DISTINCT t) AS totalTournaments, AVG(goalsPerTournament) AS avgGoalsPerTournament RETURN p.name AS playerName, totalTournaments, avgGoalsPerTournament",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 129,
        "original_index": 129,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_185",
        "NL Question": "For each tournament, find the team with the highest average score across all matches. Return the tournament name, the team name, and the team's average score.",
        "Cypher": "MATCH (t:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[r:PLAYED_IN]-(team:Team) WHERE r.score IS NOT NULL WITH t, team, AVG(r.score) AS avgScore ORDER BY avgScore DESC WITH t, COLLECT({team: team.name, avgScore: avgScore}) AS teamScores RETURN t.name AS tournamentName, teamScores[0].team AS topTeam, teamScores[0].avgScore AS topTeamAvgScore",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 130,
        "original_index": 130,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_186",
        "NL Question": "For each squad, determine the average age of players in the squad during the year 2000. Return the squad ID and the average age of players in that squad.",
        "Cypher": "MATCH (s:Squad)<-[:IN_SQUAD]-(p:Person) WHERE p.dob IS NOT NULL WITH s, p, 2000 - p.dob.year AS age RETURN s.id AS squadId, AVG(age) AS averageAge",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 131,
        "original_index": 131,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_189",
        "NL Question": "For each team that participated in the 'Canada 2015' tournament, calculate the total number of matches they played and the average number of goals scored in those matches. Return the team name, total matches, and average goals per match.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'Canada 2015'}) MATCH (t)-[r:PLAYED_IN]->(m:Match) WITH t, COUNT(m) AS totalMatches, SUM(r.score) AS totalGoals WHERE r.score IS NOT NULL RETURN t.name AS teamName, totalMatches, CASE WHEN totalMatches > 0 THEN toFloat(totalGoals) / totalMatches ELSE 0 END AS avgGoalsPerMatch",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "grammatical error: In a WITH/RETURN with DISTINCT or an aggregation, it is not possible to access variables declared before the WITH/RETURN: r (line 1, column 178 (offset: 177))"
    },
    {
        "id": 132,
        "original_index": 132,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_190",
        "NL Question": "For each tournament, determine the average number of players in each squad and the total number of teams that participated. Return the tournament name, average squad size, and total teams.",
        "Cypher": "MATCH (tour:Tournament)<-[:FOR]-(s:Squad)<-[:IN_SQUAD]-(p:Person) WITH tour, s, COUNT(p) AS squadSize MATCH (team:Team)-[:PARTICIPATED_IN]->(tour) WITH tour, AVG(squadSize) AS avgSquadSize, COUNT(DISTINCT team) AS totalTeams RETURN tour.name AS tournamentName, avgSquadSize, totalTeams",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 133,
        "original_index": 133,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_191",
        "NL Question": "For each player, calculate the total number of goals they scored and the number of tournaments in which they scored at least one goal. Return the player's name, total goals, and number of tournaments with goals.",
        "Cypher": "MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament) WITH p, t, COUNT(sg) AS goalsPerTournament WHERE goalsPerTournament > 0 WITH p, COUNT(t) AS tournamentsWithGoals, SUM(goalsPerTournament) AS totalGoals RETURN p.name AS playerName, totalGoals, tournamentsWithGoals",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 134,
        "original_index": 134,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_192",
        "NL Question": "For each team, find the average number of players who scored goals in each of their matches and the total number of matches they played. Return the team name, average players with goals per match, and total matches.",
        "Cypher": "MATCH (t:Team)-[:PLAYED_IN]->(m:Match)<-[sg:SCORED_GOAL]-(p:Person) WITH t, m, COUNT(DISTINCT p) AS playersWithGoals MATCH (t)-[:PLAYED_IN]->(m2:Match) WITH t, AVG(playersWithGoals) AS avgPlayersWithGoals, COUNT(m2) AS totalMatches RETURN t.name AS teamName, avgPlayersWithGoals, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 135,
        "original_index": 135,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_193",
        "NL Question": "For each tournament, calculate the average number of goals scored per match and the total number of players who played in at least one match. Return the tournament name, average goals per match, and total players.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match) OPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m) WITH tour, m, COUNT(sg) AS matchGoals MATCH (tour)<-[:IN_TOURNAMENT]-(m2:Match)<-[:PLAYED_IN]-(p2:Person) WITH tour, AVG(matchGoals) AS avgGoalsPerMatch, COUNT(DISTINCT p2) AS totalPlayers RETURN tour.name AS tournamentName, avgGoalsPerMatch, totalPlayers",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 136,
        "original_index": 136,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_196",
        "NL Question": "For each team, calculate the total number of matches they played in and the average score across all their matches. Return the team name, total matches, and average score.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match) WHERE r.score IS NOT NULL WITH t, COUNT(m) AS totalMatches, SUM(r.score) AS totalScore RETURN t.name AS teamName, totalMatches, toFloat(totalScore) / totalMatches AS averageScore",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 137,
        "original_index": 137,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_197",
        "NL Question": "For each tournament, determine the average number of goals scored per match and the total number of teams that participated. Return the tournament name, average goals per match, and total teams.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[r:PLAYED_IN]-(:Person) WHERE r.score IS NOT NULL WITH tour, m, SUM(r.score) AS totalGoals OPTIONAL MATCH (team:Team)-[:PARTICIPATED_IN]->(tour) WITH tour, AVG(totalGoals) AS avgGoalsPerMatch, COUNT(DISTINCT team) AS totalTeams RETURN tour.name AS tournamentName, avgGoalsPerMatch, totalTeams",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "totalGoals was already aggregated per tournament, not per match, so AVG(totalGoals) incorrectly computed the average of one value per tournament â€” not average goals per match â€” and OPTIONAL MATCH broke the grouping, possibly leading to empty results."
    },
    {
        "id": 138,
        "original_index": 138,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_198",
        "NL Question": "For each person, find the total number of matches they played in and the average number of goals they scored per match where they scored at least one goal. Return the person's name, total matches played, and average goals per match.",
        "Cypher": "MATCH (p:Person)-[r:PLAYED_IN]->(m:Match) WITH p, COUNT(m) AS totalMatches OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m2:Match) WITH p, totalMatches, COUNT(sg) AS totalGoals WHERE totalGoals > 0 RETURN p.name AS personName, totalMatches, toFloat(totalGoals) / totalMatches AS averageGoalsPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 139,
        "original_index": 139,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_199",
        "NL Question": "For each team that participated in the 'Canada 2015' tournament, calculate the total number of goals scored by the team's players and the average age of the players in the team. Return the team name, total goals, and average player age.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'Canada 2015'}) MATCH (p:Person)-[:REPRESENTS]->(t)-[:PLAYED_IN]->(m:Match) WHERE p.dob IS NOT NULL WITH t, p, tour, m OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m) WITH t, p, tour, COUNT(sg) AS goalsPerPlayer, tour.year - p.dob.year AS playerAge WITH t, SUM(goalsPerPlayer) AS totalGoals, AVG(playerAge) AS averageAge RETURN t.name AS teamName, totalGoals, averageAge",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 140,
        "original_index": 140,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_200",
        "NL Question": "For each squad, determine the total number of players who scored goals and the average number of matches played by these players. Return the squad ID, total goal-scoring players, and average matches played.",
        "Cypher": "MATCH (s:Squad)<-[:IN_SQUAD]-(p:Person)-[sg:SCORED_GOAL]->(m:Match) WITH s, p, COUNT(DISTINCT m) AS matchesPlayed OPTIONAL MATCH (s)<-[:IN_SQUAD]-(allPlayers:Person) WITH s, COUNT(DISTINCT p) AS goalScoringPlayers, AVG(matchesPlayed) AS avgMatchesPlayed RETURN s.id AS squadId, goalScoringPlayers, avgMatchesPlayed",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 141,
        "original_index": 141,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_203",
        "NL Question": "For each team that participated in the 'Canada 2015' tournament, calculate the average number of goals scored per match played in that tournament. Return the team name and the average goals scored per match.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'Canada 2015'}) WHERE r.score IS NOT NULL WITH t, m, r.score AS goalsPerMatch WITH t, COUNT(m) AS totalMatches, SUM(goalsPerMatch) AS totalGoals WHERE totalMatches > 0 RETURN t.name AS teamName, toFloat(totalGoals) / totalMatches AS avgGoalsPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 142,
        "original_index": 142,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_204",
        "NL Question": "For each person, calculate the total number of goals scored in matches played in the 'Canada 2015' tournament and the average number of goals scored per match. Return the person's name, total goals scored, and average goals per match.",
        "Cypher": "MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'Canada 2015'}) WITH p, m, COUNT(sg) AS goalsPerMatch WITH p, SUM(goalsPerMatch) AS totalGoals, COUNT(m) AS totalMatches RETURN p.name AS personName, totalGoals, CASE WHEN totalMatches > 0 THEN toFloat(totalGoals) / totalMatches ELSE 0 END AS avgGoalsPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 143,
        "original_index": 143,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_205",
        "NL Question": "For each team, determine the number of players who represent them and the average number of matches played by those players. Return the team's name, player count, and average matches played per player.",
        "Cypher": "MATCH (t:Team)<-[:REPRESENTS]-(p:Person)-[:PLAYED_IN]->(m:Match) WITH t, p, COUNT(m) AS matchesPlayedPerPlayer WITH t, COUNT(DISTINCT p) AS playerCount, AVG(matchesPlayedPerPlayer) AS avgMatchesPlayedPerPlayer RETURN t.name AS teamName, playerCount, avgMatchesPlayedPerPlayer",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 144,
        "original_index": 144,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_206",
        "NL Question": "For each tournament, find the average age of players who played in matches and the total number of matches. Return the tournament name, average player age, and total match count.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[:PLAYED_IN]-(p:Person) WHERE p.dob IS NOT NULL WITH tour, p, m, tour.year - p.dob.year AS playerAge WITH tour, AVG(playerAge) AS avgPlayerAge, COUNT(DISTINCT m) AS totalMatches RETURN tour.name AS tournamentName, avgPlayerAge, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 145,
        "original_index": 145,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_207",
        "NL Question": "For each squad, calculate the total number of goals scored by players in the squad and the average number of goals scored per player in matches. Return the squad ID, total goals scored, and average goals per player.",
        "Cypher": "MATCH (s:Squad)<-[:IN_SQUAD]-(p:Person)-[sg:SCORED_GOAL]->(m:Match) WITH s, p, COUNT(sg) AS goalsPerPlayer WITH s, COUNT(DISTINCT p) AS totalPlayers, SUM(goalsPerPlayer) AS totalGoals RETURN s.id AS squadId, totalGoals, CASE WHEN totalPlayers > 0 THEN toFloat(totalGoals) / totalPlayers ELSE 0 END AS avgGoalsPerPlayer",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 146,
        "original_index": 146,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_210",
        "NL Question": "For the 'France 2019' tournament, what is the average number of goals scored per match, and what is the total number of matches played?",
        "Cypher": "MATCH (tour:Tournament {name: 'France 2019'})<-[:IN_TOURNAMENT]-(m:Match)\nOPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m)\nWITH tour, m, COUNT(sg) AS goals\nWITH tour, COUNT(m) AS totalMatches, SUM(goals) AS totalGoals\nRETURN tour.name AS tournamentName, toFloat(totalGoals) / totalMatches AS avgGoalsPerMatch, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 147,
        "original_index": 147,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_211",
        "NL Question": "For each team that participated in a tournament, calculate the total number of goals scored across all matches and the average number of goals scored per match. Return the team name, total goals, and average goals per match.",
        "Cypher": "MATCH (t:Team)-[:PLAYED_IN]->(m:Match)\nOPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m)\nWITH t, m, COUNT(sg) AS goals\nWITH t, COUNT(m) AS totalMatches, SUM(goals) AS totalGoals\nRETURN t.name AS teamName, totalGoals, toFloat(totalGoals) / totalMatches AS avgGoalsPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 148,
        "original_index": 148,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_212",
        "NL Question": "For each tournament, determine the average age of players who scored goals and the total number of players who scored goals. Return the tournament name, average player age, and total number of goal-scoring players.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[sg:SCORED_GOAL]-(p:Person)\nWHERE p.dob IS NOT NULL\nWITH tour, p, m\nWITH tour, p, tour.year - p.dob.year AS playerAge\nWITH tour, AVG(playerAge) AS avgAge, COUNT(DISTINCT p) AS totalPlayers\nRETURN tour.name AS tournamentName, avgAge, totalPlayers",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 149,
        "original_index": 149,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_213",
        "NL Question": "What is the average number of goals scored by players representing 'Argentina' in all matches, and what is the total number of matches they played?",
        "Cypher": "MATCH (t:Team {name: 'Argentina'})<-[:REPRESENTS]-(p:Person)-[sg:SCORED_GOAL]->(m:Match)\nWITH t, p, m\nWITH t, COUNT(sg) AS goals, COUNT(DISTINCT m) AS matches\nRETURN t.name AS teamName, toFloat(SUM(goals))/matches AS avgGoalsPerMatch, matches AS totalMatchesPlayed",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "The variable sg is used in COUNT(sg) after it's not in scope anymore, because the second WITH doesnâ€™t include it â€” leading to incorrect aggregation or an error."
    },
    {
        "id": 150,
        "original_index": 150,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_214",
        "NL Question": "For each team, calculate the total number of players who scored at least one goal and the average number of goals scored by those players. Return the team's name, the number of goal-scoring players, and the average goals scored by those players.",
        "Cypher": "MATCH (t:Team)<-[:REPRESENTS]-(p:Person)-[sg:SCORED_GOAL]->(m:Match)\nWITH t, p, COUNT(sg) AS goals\nWHERE goals > 0\nWITH t, COUNT(DISTINCT p) AS goalScoringPlayers, AVG(goals) AS avgGoals\nRETURN t.name AS teamName, goalScoringPlayers, avgGoals",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 151,
        "original_index": 151,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_217",
        "NL Question": "For each tournament, calculate the average number of players from each team participating and the total number of teams that participated. Return the tournament name, average players per team, and total teams.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament) \nMATCH (t)-[:REPRESENTS]-(p:Person)\nWITH tour, t, count(p) as numPlayers\nWITH tour, AVG(numPlayers) AS avgPlayersPerTeam, count(distinct t) as totalTeams\nRETURN tour.name AS tournamentName, avgPlayersPerTeam, totalTeams",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 152,
        "original_index": 152,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_218",
        "NL Question": "For each tournament, determine the average age of players who scored goals and the total number of goals scored. Return the tournament name, average player age, and total goals scored.",
        "Cypher": "MATCH (p:Person)-[:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament)\nWHERE p.dob IS NOT NULL\nWITH tour, p, m\nWITH tour, avg(tour.year - p.dob.year) AS avgAge, count(m) as totalGoals\nRETURN tour.name AS tournamentName, avgAge, totalGoals",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 153,
        "original_index": 153,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_219",
        "NL Question": "For each team that participated in the 'Germany 2011' tournament, find the average number of goals scored by its players in all matches. Return the team name and the average goals scored per player.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'Germany 2011'}) \nMATCH (p:Person)-[:REPRESENTS]->(t)-[:PLAYED_IN]->(m:Match)\nOPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m)\nWITH t, p, COUNT(sg) AS goalsPerPlayer\nWITH t, AVG(goalsPerPlayer) AS avgGoalsPerPlayer\nRETURN t.name AS teamName, avgGoalsPerPlayer",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 154,
        "original_index": 154,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_220",
        "NL Question": "For each player who played in a match during the 'Germany 2011' tournament, calculate the total number of matches they played in that tournament and the average 'score' value from the 'PLAYED_IN' relationships. Return the player's name, the total matches played, and the average score.",
        "Cypher": "MATCH (p:Person)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament {name: 'Germany 2011'})\nWITH p, COUNT(m) AS totalMatches, AVG(toInt(r.score)) AS avgScore\nRETURN p.name AS playerName, totalMatches, avgScore",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "The query does not filter out NULL scores, so AVG(toInt(r.score)) can fail or include nulls, leading to incorrect averages, should have used team based played_in relationship instead of person based played_in relationship."
    },
    {
        "id": 155,
        "original_index": 155,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_221",
        "NL Question": "For each squad, calculate the total number of players who are coaches and the average number of goals scored by all players in matches. Return the squad ID, the number of coach players, and the average goals per player.",
        "Cypher": "MATCH (s:Squad)<-[:IN_SQUAD]-(p:Person)\nOPTIONAL MATCH (p)-[:COACH_FOR]->(s)\nWITH s, p, CASE WHEN p-[:COACH_FOR]->(s) THEN 1 ELSE 0 END AS isCoach\nOPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(:Match)\nWITH s,SUM(isCoach) AS coachCount, p, COUNT(sg) AS goalsPerPlayer\nWITH s, coachCount, AVG(goalsPerPlayer) AS avgGoalsPerPlayer\nRETURN s.id AS squadId, coachCount, avgGoalsPerPlayer",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "grammatical error: You're using a pattern predicate (p-[:COACH_FOR]->(s)) inside a CASE clause without EXISTS(...), which is not allowed and will cause a syntax error."
    },
    {
        "id": 156,
        "original_index": 156,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_224",
        "NL Question": "For each team, calculate the total number of matches they played in the 'Sweden 1995' tournament and the average number of goals scored per match by that team. Return the team name, total matches, and average goals per match.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'Sweden 1995'}) WHERE r.score IS NOT NULL WITH t, m, r, tour COUNT(m) AS matchCount, SUM(r.score) AS totalGoals RETURN t.name AS teamName, matchCount AS totalMatches, toFloat(totalGoals)/matchCount AS avgGoalsPerMatch;",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "grammatical error: You missed a WITH or a comma â€” WITH t, m, r, tour COUNT(m) AS matchCount is invalid Cypher syntax."
    },
    {
        "id": 157,
        "original_index": 157,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_225",
        "NL Question": "For each person who played in a match, find the total number of matches they played and the average score in those matches. Return the person's name, the total number of matches, and the average score, ordering by the average score in descending order.",
        "Cypher": "MATCH (p:Person)-[r:PLAYED_IN]->(m:Match) WHERE r.score IS NOT NULL WITH p, COUNT(m) AS matchCount, AVG(r.score) AS avgScore RETURN p.name AS playerName, matchCount, avgScore ORDER BY avgScore DESC;",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "The query didn't work because in your schema, Person nodes do not have [:PLAYED_IN] relationships with Match nodes â€” only Team nodes do â€” so the pattern (p:Person)-[r:PLAYED_IN]->(m:Match) matches nothing."
    },
    {
        "id": 158,
        "original_index": 158,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_226",
        "NL Question": "For the 'Canada 2015' tournament, calculate the average number of goals scored in matches for each stage of the tournament. Return the stage and the average goals scored.",
        "Cypher": "MATCH (m:Match)-[:IN_TOURNAMENT]->(t:Tournament {name: 'Canada 2015'}) OPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m) WITH m.stage AS stage, COUNT(sg) AS totalGoalsPerMatch WITH stage, AVG(totalGoalsPerMatch) AS avgGoalsPerStage RETURN stage, avgGoalsPerStage;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 159,
        "original_index": 159,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_227",
        "NL Question": "For each tournament, determine the total number of teams that participated and the average number of players per team across all squads in that tournament. Return the tournament name, total teams, and average players per team.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament) MATCH (t)-[:NAMED]->(s:Squad)-[:FOR]->(tour) MATCH (s)<-[:IN_SQUAD]-(p:Person) WITH tour, t, s, COUNT(DISTINCT p) AS playersPerSquad WITH tour, t, AVG(playersPerSquad) AS avgPlayersPerSquad WITH tour, COUNT(DISTINCT t) AS totalTeams, AVG(avgPlayersPerSquad) AS avgPlayersPerTeam RETURN tour.name AS tournamentName, totalTeams, avgPlayersPerTeam;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 160,
        "original_index": 160,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_228",
        "NL Question": "For each team that played in a match during the year 1995, calculate the total number of matches they played and the average number of players who scored goals in those matches. Return the team's name, total matches played, and the average number of goal scorers per match.",
        "Cypher": "MATCH (t:Team)-[:PLAYED_IN]->(m:Match) WHERE m.date.year = 1995 OPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m) WITH t, m, COUNT(DISTINCT p) AS goalScorersPerMatch WITH t, COUNT(m) AS totalMatches, AVG(goalScorersPerMatch) AS avgGoalScorersPerMatch RETURN t.name AS teamName, totalMatches, avgGoalScorersPerMatch;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 161,
        "original_index": 161,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_231",
        "NL Question": "For each team, calculate the total number of goals scored and the average number of goals scored per match they played in France 2019. Return the team name, total goals, and average goals per match.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'France 2019'}) OPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m) WHERE p-[:REPRESENTS]->(t) WITH t, m, COUNT(sg) AS goalsPerMatch, tour WITH t, SUM(goalsPerMatch) AS totalGoals, COUNT(m) AS totalMatches RETURN t.name AS teamName, totalGoals, CASE WHEN totalMatches > 0 THEN toFloat(totalGoals) / totalMatches ELSE 0 END AS avgGoalsPerMatch;",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "grammatical error: The query counts each match once per Person who scored, leading to overcounting of matches and incorrect averaging."
    },
    {
        "id": 162,
        "original_index": 162,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_232",
        "NL Question": "For each tournament, determine the team that scored the most goals. Return the tournament name, the team's name, and the total goals scored by that team in the tournament.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[r:PLAYED_IN]-(team:Team) OPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m) WHERE p-[:REPRESENTS]->(team) WITH tour, team, COUNT(sg) AS totalGoals ORDER BY tour.name, totalGoals DESC WITH tour, COLLECT({team: team, totalGoals: totalGoals}) AS scorers RETURN tour.name AS tournamentName, scorers[0].team.name AS teamName, scorers[0].totalGoals AS totalGoals;",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "The WHERE p-[:REPRESENTS]->(team) clause is not properly scoped to the OPTIONAL MATCH, so it behaves like a filter on the entire query and can block valid results."
    },
    {
        "id": 163,
        "original_index": 163,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_233",
        "NL Question": "For each player who played in a match during the 'Canada 2015' tournament, calculate the average score of the matches they played in. Return the player's name and the average score.",
        "Cypher": "MATCH (p:Person)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament {name: 'Canada 2015'}) WHERE r.score IS NOT NULL WITH p, AVG(toInt(r.score)) AS avgScore RETURN p.name AS playerName, avgScore;",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "In your schema, PLAYED_IN relationships with a score property likely exist between Team and Match, not between Person and Match, so (p:Person)-[r:PLAYED_IN]->(m:Match) does not match anything."
    },
    {
        "id": 164,
        "original_index": 164,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_234",
        "NL Question": "For each squad, compute the total number of players and the average number of minutes played by its players across all matches. Return the squad ID, total player count, and average minutes played.",
        "Cypher": "MATCH (s:Squad)<-[:IN_SQUAD]-(p:Person)-[r:PLAYED_IN]->(m:Match) WHERE r.minuteOn IS NOT NULL WITH s, p, toInteger(r.minuteOn) AS minutesPlayed WITH s, p, AVG(minutesPlayed) AS avgMinutesPerPlayer OPTIONAL MATCH (s)<-[:IN_SQUAD]-(player:Person) WITH s, COUNT(DISTINCT player) AS totalPlayers, AVG(avgMinutesPerPlayer) AS avgMinutesPlayed RETURN s.id AS squadId, totalPlayers, avgMinutesPlayed;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 165,
        "original_index": 165,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_235",
        "NL Question": "For each tournament year, find the average number of goals scored per match and the total number of teams that participated. Return the tournament year, average goals per match, and total participating teams.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament) OPTIONAL MATCH (m:Match)-[:IN_TOURNAMENT]->(tour)<-[sg:SCORED_GOAL]-(p:Person) WITH tour, COUNT(DISTINCT t) AS totalTeams, COUNT(sg) AS totalGoals, COUNT(DISTINCT m) AS totalMatches WHERE tour.year IS NOT NULL WITH tour.year AS tournamentYear, totalTeams, totalGoals, totalMatches RETURN tournamentYear, CASE WHEN totalMatches > 0 THEN toFloat(totalGoals) / totalMatches ELSE 0 END AS avgGoalsPerMatch, totalTeams;",
        "result [0/1]": "1",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "You're counting goals from the SCORED_GOAL relationship between Person and Match, but not matching the correct pattern that ensures Match nodes (m) are bound â€” so totalMatches becomes 0, making the average always 0."
    },
    {
        "id": 166,
        "original_index": 166,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_239",
        "NL Question": "For each team that played in a match during the 'USA 1999' tournament, determine the average number of goals scored per match and the total number of matches played. Return the team name, average goals per match, and total matches played.",
        "Cypher": "MATCH (t:Team)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'USA 1999'})\nOPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m)\nWITH t, m, COUNT(sg) AS goalsPerMatch\nWITH t, COUNT(m) AS totalMatches, SUM(goalsPerMatch) AS totalGoals\nRETURN t.name AS teamName, toFloat(totalGoals) / totalMatches AS avgGoalsPerMatch, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 167,
        "original_index": 167,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_240",
        "NL Question": "For each person, find the tournaments they played in and calculate the average number of goals they scored per tournament. Return the person's name and the average goals per tournament.",
        "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament)\nOPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m)\nWITH p, tour, COUNT(sg) AS goalsPerTournament\nWITH p, AVG(goalsPerTournament) AS avgGoalsPerTournament\nRETURN p.name AS playerName, avgGoalsPerTournament",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 168,
        "original_index": 168,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_241",
        "NL Question": "For the 'USA 1999' tournament, calculate the average age of players at the time of the tournament and the total number of players who participated. Return the average age and the total player count.",
        "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'USA 1999'})\nWHERE p.dob IS NOT NULL\nWITH p, tour.year - p.dob.year AS age\nWITH AVG(age) AS averageAge, COUNT(DISTINCT p) AS totalPlayers\nRETURN averageAge, totalPlayers",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 169,
        "original_index": 169,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_242",
        "NL Question": "For each team, determine the average number of players in their squads and the total number of tournaments in which those squads participated. Return the team name, average squad size, and total tournaments.",
        "Cypher": "MATCH (t:Team)-[:NAMED]->(s:Squad)-[:FOR]->(tour:Tournament)\nMATCH (p:Person)-[:IN_SQUAD]->(s)\nWITH t, s, COUNT(p) AS squadSize, tour\nWITH t, AVG(squadSize) AS avgSquadSize, COUNT(DISTINCT tour) AS totalTournaments\nRETURN t.name AS teamName, avgSquadSize, totalTournaments",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 170,
        "original_index": 170,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_245",
        "NL Question": "For each tournament, calculate the average number of teams that participated and the total number of matches played. Return the tournament name, average teams, and total matches.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament) WITH tour, COUNT(t) AS teamCount MATCH (m:Match)-[:IN_TOURNAMENT]->(tour) WITH tour, teamCount, COUNT(m) AS matchCount RETURN tour.name AS tournamentName, AVG(teamCount) AS avgTeams, SUM(matchCount) AS totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 171,
        "original_index": 171,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_246",
        "NL Question": "For each team, find the average number of goals scored per match and the total number of matches played. Return the team name, the average goals per match, and the total matches played.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match) WHERE r.score IS NOT NULL WITH t, COUNT(m) AS totalMatches, SUM(r.score) AS totalGoals RETURN t.name AS teamName, toFloat(totalGoals) / totalMatches AS avgGoalsPerMatch, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 172,
        "original_index": 172,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_247",
        "NL Question": "For each person who scored goals, calculate the average number of goals scored per match and the total number of matches in which they scored. Return the person's name, average goals per match, and total matches with goals.",
        "Cypher": "MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match) WITH p, COUNT(sg) AS totalGoals, COUNT(DISTINCT m) AS totalMatchesWithGoals RETURN p.name AS playerName, toFloat(totalGoals) / totalMatchesWithGoals AS avgGoalsPerMatch, totalMatchesWithGoals",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 173,
        "original_index": 173,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_248",
        "NL Question": "For each tournament, find the team with the highest average score in matches. Return the tournament name, the team name, and the average score for that team in the tournament.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament) WHERE r.score IS NOT NULL WITH tour, t, AVG(r.score) AS avgScore ORDER BY tour.name, avgScore DESC WITH tour, COLLECT({team: t, avgScore: avgScore}) AS teamScores RETURN tour.name AS tournamentName, teamScores[0].team.name AS teamName, teamScores[0].avgScore AS highestAvgScore",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 174,
        "original_index": 174,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_249",
        "NL Question": "For each squad, calculate the total number of players and the average number of matches played by each player in the squad. Return the squad ID, total players, and average matches played per player.",
        "Cypher": "MATCH (s:Squad)<-[:IN_SQUAD]-(p:Person)-[:PLAYED_IN]->(m:Match) WITH s, p, COUNT(m) AS matchesPlayedPerPlayer WITH s, COUNT(DISTINCT p) AS totalPlayers, AVG(matchesPlayedPerPlayer) AS avgMatchesPlayedPerPlayer RETURN s.id AS squadId, totalPlayers, avgMatchesPlayedPerPlayer",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 175,
        "original_index": 175,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_252",
        "NL Question": "For each tournament, what is the average number of players per squad and the total number of teams that participated?",
        "Cypher": "MATCH (tour:Tournament)<-[:FOR]-(s:Squad)<-[:IN_SQUAD]-(p:Person) WITH tour, s, COUNT(p) AS playerCount MATCH (tour)<-[:PARTICIPATED_IN]-(t:Team) WITH tour, AVG(playerCount) AS avgPlayersPerSquad, COUNT(DISTINCT t) AS totalTeams RETURN tour.name AS tournamentName, avgPlayersPerSquad, totalTeams",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 176,
        "original_index": 176,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_253",
        "NL Question": "For each team, calculate the total number of matches played and the average number of goals scored per match, considering only matches in tournaments after the year 2000. Return the team name, total matches, and average goals per match.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament) WHERE tour.year > 2000 WITH t, m, tour, r.score AS score WHERE score IS NOT NULL WITH t, COUNT(DISTINCT m) AS matchCount, SUM(score) AS totalGoals RETURN t.name AS teamName, matchCount AS totalMatches, CASE WHEN matchCount > 0 THEN toFloat(totalGoals) / matchCount ELSE 0 END AS avgGoalsPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 177,
        "original_index": 177,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_254",
        "NL Question": "For each person who has coached a squad, find the average number of goals scored by players in their squads and the total number of matches where their squad participated. Return the coach's name, average goals scored, and total matches played by the squad.",
        "Cypher": "MATCH (p:Person)-[:COACH_FOR]->(s:Squad) MATCH (s)<-[:IN_SQUAD]-(player:Person)-[sg:SCORED_GOAL]->(m:Match) WITH p, s, COUNT(sg) AS goalsPerPlayer, m MATCH (s)-[:FOR]->(tour:Tournament) WITH p, AVG(goalsPerPlayer) AS avgGoals, COUNT(DISTINCT m) AS totalMatches RETURN p.name AS coachName, avgGoals, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 178,
        "original_index": 178,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_255",
        "NL Question": "For each tournament, determine the team with the highest average player age participating in the tournament. Return the tournament name, the team name, and the average age of players in that team.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament) MATCH (p:Person)-[:REPRESENTS]->(t) WHERE p.dob IS NOT NULL WITH tour, t, AVG(tour.year - p.dob.year) AS avgAge ORDER BY tour.id, avgAge DESC WITH tour, COLLECT({team: t, avgAge: avgAge}) AS teamsByAge RETURN tour.name AS tournamentName, teamsByAge[0].team.name AS teamName, teamsByAge[0].avgAge AS averageAge",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 179,
        "original_index": 179,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_256",
        "NL Question": "For each tournament, calculate the average number of goals scored by players who were 'Subbed On' and the average number of goals scored by players who 'Started'. Return the tournament name, average goals for 'Subbed On' players, and average goals for players who 'Started'.",
        "Cypher": "MATCH (p:Person)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament) WITH p, r, m, tour OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m) WHERE r.type = 'Subbed On' WITH tour, COUNT(sg) AS subbedOnGoals, r.type AS type OPTIONAL MATCH (p)-[r2:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour) OPTIONAL MATCH (p)-[sg2:SCORED_GOAL]->(m) WHERE r2.type = 'Started' WITH tour, subbedOnGoals, COUNT(sg2) AS startedGoals RETURN tour.name AS tournamentName, subbedOnGoals, startedGoals",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 180,
        "original_index": 180,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_259",
        "NL Question": "For each tournament, calculate the average number of players from each team participating in matches and the total number of matches played. Return the tournament name, average players per team, and total matches.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[:PLAYED_IN]-(t:Team)<-[:REPRESENTS]-(p:Person)\nWITH tour, t, COUNT(DISTINCT p) AS playersPerTeam, COUNT(DISTINCT m) AS totalMatches\nWITH tour, AVG(playersPerTeam) AS avgPlayersPerTeam, SUM(totalMatches) AS totalMatchesPlayed\nRETURN tour.name AS tournamentName, avgPlayersPerTeam, totalMatchesPlayed",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 181,
        "original_index": 181,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_260",
        "NL Question": "For each team, determine the total number of goals scored in all matches and the average number of goals scored per match. Return the team's name, total goals, and average goals per match.",
        "Cypher": "MATCH (t:Team)-[:PLAYED_IN]->(m:Match)<-[sg:SCORED_GOAL]-(p:Person)\nWITH t, m, SUM(toInt(sg.minute)) AS totalGoalsPerMatch\nWITH t, COUNT(DISTINCT m) AS totalMatches, SUM(totalGoalsPerMatch) AS totalGoals\nRETURN t.name AS teamName, totalGoals, CASE WHEN totalMatches > 0 THEN toFloat(totalGoals) / totalMatches ELSE 0 END AS avgGoalsPerMatch",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "grammatical error: toInt() is not correct operator and You're summing sg.minute to count goals, but minute is not a goal count, it represents when the goal was scored in the match â€” so SUM(sg.minute) doesn't give total goals."
    },
    {
        "id": 182,
        "original_index": 182,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_261",
        "NL Question": "For each player, find the total number of tournaments they participated in and the average number of matches they played per tournament. Return the player's name, tournament count, and average matches per tournament.",
        "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament)\nWITH p, tour, COUNT(m) AS matchesPerTournament\nWITH p, COUNT(DISTINCT tour) AS tournamentCount, COLLECT(matchesPerTournament) AS matchesList\nRETURN p.name AS playerName, tournamentCount, CASE WHEN tournamentCount > 0 THEN REDUCE(s = 0, x IN matchesList | s + x) * 1.0 / tournamentCount ELSE 0 END AS avgMatchesPerTournament",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 183,
        "original_index": 183,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_262",
        "NL Question": "For the tournament 'USA 2003', what is the average age of players who scored a goal in the matches? Return the average age.",
        "Cypher": "MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'USA 2003'})\nWHERE p.dob IS NOT NULL\nWITH p, tour\nRETURN avg(tour.year - p.dob.year) AS averageAge",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 184,
        "original_index": 184,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_263",
        "NL Question": "For each squad, find the average number of goals scored by players in matches and the total number of players in the squad. Return the squad ID, average goals per player, and total player count.",
        "Cypher": "MATCH (s:Squad)<-[:IN_SQUAD]-(p:Person)\nOPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m:Match)\nWITH s, p, COUNT(sg) AS goalsPerPlayer\nWITH s, COUNT(DISTINCT p) AS totalPlayers, AVG(goalsPerPlayer) AS avgGoalsPerPlayer\nRETURN s.id AS squadId, avgGoalsPerPlayer, totalPlayers",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 185,
        "original_index": 185,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_266",
        "NL Question": "For each tournament, calculate the average number of players who scored goals in matches and the total number of matches played. Return the tournament name, average players with goals, and total matches.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[:SCORED_GOAL]-(p:Person) WITH tour, m, COLLECT(DISTINCT p) AS playersWithGoals, COUNT(DISTINCT m) AS totalMatches RETURN tour.name AS tournamentName, AVG(SIZE(playersWithGoals)) AS avgPlayersWithGoals, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 186,
        "original_index": 186,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_267",
        "NL Question": "For each team that participated in a tournament, determine the average number of goals scored per match and the total number of matches played. Return the team name, average goals per match, and total matches played.",
        "Cypher": "MATCH (t:Team)-[:PLAYED_IN]->(m:Match) WHERE m.id IN [(t)-[:PLAYED_IN]->(m2:Match) RETURN m2.id] WITH t, m OPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m) WITH t, COUNT(DISTINCT m) AS totalMatches, SUM(CASE WHEN sg IS NOT NULL THEN 1 ELSE 0 END) AS totalGoals RETURN t.name AS teamName, CASE WHEN totalMatches > 0 THEN toFloat(totalGoals) / totalMatches ELSE 0 END AS avgGoalsPerMatch, totalMatches",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "You cannot use a RETURN clause inside a list comprehension ([...]) in Cypher."
    },
    {
        "id": 187,
        "original_index": 187,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_268",
        "NL Question": "For each person, calculate the total number of matches they played and the average number of goals scored in those matches. Return the person's name, total matches, and average goals per match, only for people who have played at least one match.",
        "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match) WITH p, COUNT(m) AS totalMatches OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m) WITH p, totalMatches, COUNT(sg) AS totalGoals WHERE totalMatches > 0 RETURN p.name AS personName, totalMatches, CASE WHEN totalMatches > 0 THEN toFloat(totalGoals) / totalMatches ELSE 0 END AS avgGoalsPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 188,
        "original_index": 188,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_269",
        "NL Question": "For each tournament, find the average age of players who participated and the total number of teams that participated. Return the tournament name, average player age, and total teams.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[:PLAYED_IN]-(p:Person) WHERE p.dob IS NOT NULL WITH tour, p, m, tour.year - p.dob.year AS playerAge WITH tour, AVG(playerAge) AS avgPlayerAge MATCH (tour)<-[:PARTICIPATED_IN]-(t:Team) WITH tour, avgPlayerAge, COUNT(DISTINCT t) AS totalTeams RETURN tour.name AS tournamentName, avgPlayerAge, totalTeams",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 189,
        "original_index": 189,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_270",
        "NL Question": "For each team, calculate the total number of players who represent the team and the average number of matches played by those players. Return the team name, total players, and average matches per player.",
        "Cypher": "MATCH (t:Team)<-[:REPRESENTS]-(p:Person)-[:PLAYED_IN]->(m:Match) WITH t, p, COUNT(m) AS matchesPlayed WITH t, COUNT(DISTINCT p) AS totalPlayers, AVG(matchesPlayed) AS avgMatchesPerPlayer RETURN t.name AS teamName, totalPlayers, avgMatchesPerPlayer",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 190,
        "original_index": 190,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_274",
        "NL Question": "For each team, find the average number of goals scored per match and the total number of matches they played in the 'China 2007' tournament. Return the team name, average goals, and total matches.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'China 2007'})\nWHERE r.score IS NOT NULL\nWITH t, m, r.score AS goals\nWITH t, COUNT(m) AS totalMatches, AVG(goals) AS avgGoals\nRETURN t.name AS teamName, avgGoals, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 191,
        "original_index": 191,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_275",
        "NL Question": "For each player born before 1985, calculate the total number of goals they scored and the average number of minutes they played in matches. Return the player's name, total goals, and average minutes played.",
        "Cypher": "MATCH (p:Person)-[r:PLAYED_IN]->(m:Match)\nWHERE p.dob IS NOT NULL AND p.dob.year < 1985\nOPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m)\nWITH p, COUNT(sg) AS totalGoals, toInteger(r.minuteOn) as minuteOn\nWITH p, totalGoals, avg(minuteOn) AS avgMinutes\nRETURN p.name AS playerName, totalGoals, avgMinutes",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 192,
        "original_index": 192,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_276",
        "NL Question": "For each squad that participated in the 'Canada 2015' tournament, find the average age of players in the squad during the tournament year. Return the squad ID and the average age.",
        "Cypher": "MATCH (s:Squad)-[:FOR]->(t:Tournament {name: 'Canada 2015'})\nMATCH (p:Person)-[:IN_SQUAD]->(s)\nWHERE p.dob IS NOT NULL\nWITH s, p, t.year - p.dob.year AS age\nWITH s, AVG(age) AS avgAge\nRETURN s.id AS squadId, avgAge",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 193,
        "original_index": 193,
        "source_dataset": "wwc",
        "source_chunk": "data_3_1_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_277",
        "NL Question": "For each stage of matches in the 'China 2007' tournament, determine the average number of goals scored per match and the total number of matches played. Return the stage, average goals per match, and total matches.",
        "Cypher": "MATCH (m:Match)-[:IN_TOURNAMENT]->(t:Tournament {name: 'China 2007'})\nOPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m)\nWITH m.stage AS matchStage, m, COUNT(sg) AS goalsPerMatch\nWITH matchStage, AVG(goalsPerMatch) AS avgGoalsPerMatch, COUNT(m) AS totalMatches\nRETURN matchStage, avgGoalsPerMatch, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 194,
        "original_index": 194,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_0",
        "NL Question": "For each team, calculate the total number of matches they played and the average number of goals scored in those matches. Return the team name, the total matches played, and the average goals scored, only for teams that have played at least one match.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match) WHERE r.score IS NOT NULL WITH t, COUNT(m) AS totalMatches, SUM(r.score) AS totalGoals WHERE totalMatches > 0 RETURN t.name AS teamName, totalMatches, toFloat(totalGoals) / totalMatches AS averageGoals ORDER BY totalMatches DESC",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 195,
        "original_index": 195,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_1",
        "NL Question": "For each tournament, determine the average number of goals scored per match and the total number of teams that participated. Return the tournament name, average goals per match, and total participating teams.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament) WITH tour, COUNT(DISTINCT t) AS totalTeams MATCH (m:Match)-[:IN_TOURNAMENT]->(tour) OPTIONAL MATCH (:Person)-[sg:SCORED_GOAL]->(m) WITH tour, totalTeams, m, COUNT(sg) AS matchGoals WITH tour, totalTeams, SUM(matchGoals) AS totalGoals, COUNT(m) AS totalMatches RETURN tour.name AS tournamentName, totalTeams, CASE WHEN totalMatches > 0 THEN toFloat(totalGoals) / totalMatches ELSE 0 END AS avgGoalsPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 196,
        "original_index": 196,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_2",
        "NL Question": "For each player who scored goals, find the average number of goals they scored per match and the total number of matches they played in. Return the player's name, average goals per match, and total matches played, only for players who have played at least one match.",
        "Cypher": "MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match) WITH p, COUNT(sg) AS totalGoals, COLLECT(DISTINCT m) AS matchesPlayed WITH p, totalGoals, SIZE(matchesPlayed) AS totalMatches WHERE totalMatches > 0 RETURN p.name AS playerName, toFloat(totalGoals) / totalMatches AS avgGoalsPerMatch, totalMatches ORDER BY avgGoalsPerMatch DESC",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 197,
        "original_index": 197,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_3",
        "NL Question": "For the tournament 'France 2019', calculate the average number of goals scored by players in each squad. Return the squad ID and the average goals scored by its players.",
        "Cypher": "MATCH (tour:Tournament {name: 'France 2019'}) MATCH (s:Squad)-[:FOR]->(tour) MATCH (p:Person)-[:IN_SQUAD]->(s) OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(tour) WITH s, p, COUNT(sg) AS goalsPerPlayer WITH s, AVG(goalsPerPlayer) AS avgGoalsPerPlayer RETURN s.id AS squadId, avgGoalsPerPlayer",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 198,
        "original_index": 198,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_4",
        "NL Question": "For each team, find the average number of players who scored goals in their matches and the total number of matches played. Return the team name, average number of goal-scoring players per match, and the total number of matches played.",
        "Cypher": "MATCH (t:Team)-[:PLAYED_IN]->(m:Match)<-[sg:SCORED_GOAL]-(p:Person) WITH t, m, COUNT(DISTINCT p) AS goalScorersPerMatch WITH t, AVG(goalScorersPerMatch) AS avgGoalScorers, COUNT(m) AS totalMatches RETURN t.name AS teamName, avgGoalScorers, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 199,
        "original_index": 199,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_7",
        "NL Question": "For each tournament, calculate the total number of goals scored and the average number of players who scored in each match. Return the tournament name, total goals, and average scorers per match.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[sg:SCORED_GOAL]-(p:Person)\nWITH tour, m, COUNT(DISTINCT p) AS scorersPerMatch\nWITH tour, m, scorersPerMatch, SUM(CASE WHEN sg IS NOT NULL THEN 1 ELSE 0 END) AS goalsScored\nWITH tour, AVG(scorersPerMatch) AS avgScorersPerMatch, SUM(goalsScored) AS totalGoals\nRETURN tour.name AS tournamentName, totalGoals, avgScorersPerMatch",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "Your Cypher query has a logical issue: you're mixing aggregation (SUM(goalsScored)) with variables that are only defined inside previous WITH scopes. Specifically, you're trying to calculate SUM(CASE WHEN sg IS NOT NULL...) after already aggregating by m and p, which causes sg to be out of scope."
    },
    {
        "id": 200,
        "original_index": 200,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_8",
        "NL Question": "For each team that participated in a tournament, determine the total number of matches they played and the average number of goals scored per match. Return the team name, total matches played, and average goals per match.",
        "Cypher": "MATCH (t:Team)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament)\nOPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m)\nWITH t, m, COUNT(sg) AS goalsPerMatch\nWITH t, COUNT(DISTINCT m) AS totalMatches, AVG(goalsPerMatch) AS avgGoalsPerMatch\nRETURN t.name AS teamName, totalMatches, avgGoalsPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 201,
        "original_index": 201,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_9",
        "NL Question": "For each tournament, find the average age of players who scored goals and the total number of matches played. Return the tournament name, average age of goal scorers, and total matches played.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[sg:SCORED_GOAL]-(p:Person)\nWHERE p.dob IS NOT NULL\nWITH tour, m, p, sg, duration.between(date(p.dob), date(m.date)).years AS playerAge\nWITH tour, m, AVG(playerAge) AS avgAgeOfScorers\nWITH tour, COUNT(DISTINCT m) AS totalMatches, AVG(avgAgeOfScorers) AS avgAge\nRETURN tour.name AS tournamentName, avgAge, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 202,
        "original_index": 202,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_10",
        "NL Question": "For each team, calculate the total number of goals scored by players representing that team and the average number of matches played by those players. Return the team name, total goals scored, and average matches played.",
        "Cypher": "MATCH (t:Team)<-[:REPRESENTS]-(p:Person)-[sg:SCORED_GOAL]->(m:Match)\nWITH t, p, COUNT(sg) AS goalsScored, COLLECT(DISTINCT m) AS matchesPlayed\nWITH t, SUM(goalsScored) AS totalGoals, AVG(SIZE(matchesPlayed)) AS avgMatchesPlayed\nRETURN t.name AS teamName, totalGoals, avgMatchesPlayed",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 203,
        "original_index": 203,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_11",
        "NL Question": "For each player who played in the 'Canada 2015' tournament, find the average score in the matches they played and the total number of matches they participated in. Return the player's name, average score, and total matches played.",
        "Cypher": "MATCH (p:Person)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament {name: 'Canada 2015'})\nWITH p, m, r.score AS matchScore\nWITH p, AVG(matchScore) AS avgScore, COUNT(DISTINCT m) AS totalMatches\nRETURN p.name AS playerName, avgScore, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 204,
        "original_index": 204,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_14",
        "NL Question": "For each tournament, calculate the average number of players who scored goals and the total number of matches played. Return the tournament name, average players with goals, and total matches.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[:SCORED_GOAL]-(p:Person) WITH tour, m, COLLECT(DISTINCT p) AS playersWithGoalsPerMatch WITH tour, COUNT(DISTINCT m) AS totalMatches, AVG(SIZE(playersWithGoalsPerMatch)) AS avgPlayersWithGoals RETURN tour.name AS tournamentName, avgPlayersWithGoals, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 205,
        "original_index": 205,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_15",
        "NL Question": "For each team that participated in the 'USA 1999' tournament, find the average number of goals scored per match and the total number of matches played. Return the team name, average goals per match, and total matches played.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'USA 1999'}) WHERE r.score IS NOT NULL WITH t, m, r.score AS goalsPerMatch WITH t, COUNT(m) AS totalMatches, AVG(toFloat(goalsPerMatch)) AS avgGoalsPerMatch RETURN t.name AS teamName, avgGoalsPerMatch, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 206,
        "original_index": 206,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_16",
        "NL Question": "For each person, calculate the total number of goals they scored and the average number of tournaments they participated in. Return the person's name, total goals scored, and average tournaments participated.",
        "Cypher": "MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament) WITH p, COUNT(sg) AS totalGoals, COLLECT(DISTINCT tour) AS tournamentsParticipated RETURN p.name AS personName, totalGoals, SIZE(tournamentsParticipated) AS numberOfTournaments",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 207,
        "original_index": 207,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_17",
        "NL Question": "For each tournament, determine the average number of players per team and the total number of teams participating. Return the tournament name, average players per team, and total teams.",
        "Cypher": "MATCH (tour:Tournament)<-[:PARTICIPATED_IN]-(t:Team)<-[:REPRESENTS]-(p:Person) WITH tour, t, COLLECT(DISTINCT p) AS playersPerTeam WITH tour, COUNT(DISTINCT t) AS totalTeams, AVG(SIZE(playersPerTeam)) AS avgPlayersPerTeam RETURN tour.name AS tournamentName, avgPlayersPerTeam, totalTeams",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 208,
        "original_index": 208,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_18",
        "NL Question": "For each team, calculate the total number of matches played and the average 'score' value in the 'PLAYED_IN' relationship across all matches. Return the team's name, total matches played, and the average score.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match) WHERE r.score IS NOT NULL WITH t, COUNT(m) AS totalMatches, AVG(toFloat(r.score)) AS avgScore RETURN t.name AS teamName, totalMatches, avgScore",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 209,
        "original_index": 209,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_22",
        "NL Question": "For each team that participated in the 'France 2019' tournament, calculate the total number of goals scored and the average number of goals scored per match. Return the team name, total goals scored, and average goals per match.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'France 2019'})\nOPTIONAL MATCH (t)-[:PLAYED_IN]->(m:Match)<-[sg:SCORED_GOAL]-(p:Person)\nWITH t, m, COUNT(sg) AS goalsPerMatch\nWITH t, SUM(goalsPerMatch) AS totalGoals, COUNT(DISTINCT m) AS totalMatches\nRETURN t.name AS teamName, totalGoals, CASE WHEN totalMatches > 0 THEN toFloat(totalGoals) / totalMatches ELSE 0 END AS avgGoalsPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 210,
        "original_index": 210,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_23",
        "NL Question": "For each player, find the total number of matches they played in and the average number of goals they scored per match in the 'France 2019' tournament. Return the player's name, total matches played, and average goals per match.",
        "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'France 2019'})\nOPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m)\nWITH p, COUNT(DISTINCT m) AS totalMatches, COUNT(sg) AS totalGoals\nRETURN p.name AS playerName, totalMatches, CASE WHEN totalMatches > 0 THEN toFloat(totalGoals) / totalMatches ELSE 0 END AS avgGoalsPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 211,
        "original_index": 211,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_24",
        "NL Question": "For each team, what is the average number of players in their squads, and what is the total number of tournaments they participated in?",
        "Cypher": "MATCH (t:Team)-[:NAMED]->(s:Squad)\nOPTIONAL MATCH (s)<-[:IN_SQUAD]-(p:Person)\nWITH t, s, COUNT(p) AS squadSize\nWITH t, AVG(squadSize) AS avgSquadSize\nOPTIONAL MATCH (t)-[:PARTICIPATED_IN]->(tour:Tournament)\nWITH t, avgSquadSize, COUNT(DISTINCT tour) AS totalTournaments\nRETURN t.name AS teamName, avgSquadSize, totalTournaments",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 212,
        "original_index": 212,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_25",
        "NL Question": "For matches in the 'France 2019' tournament, calculate the average 'score' property of the 'PLAYED_IN' relationships and the total number of matches where the 'score' property is not null.",
        "Cypher": "MATCH (m:Match)-[:IN_TOURNAMENT]->(t:Tournament {name: 'France 2019'})\nOPTIONAL MATCH (p:Person)-[r:PLAYED_IN]->(m)\nWHERE r.score IS NOT NULL\nWITH m, r.score AS score\nWITH m, AVG(score) AS avgScore\nWITH m, COUNT(DISTINCT m) AS matchesWithScore\nRETURN avgScore, matchesWithScore",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "Question itself is vague"
    },
    {
        "id": 213,
        "original_index": 213,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_29",
        "NL Question": "For each team that participated in the 'China 2007' tournament, find the average number of goals scored per match and the total number of matches played. Return the team name, average goals per match, and total matches played.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'China 2007'}) WHERE r.score IS NOT NULL WITH t, m, r.score AS scorePerMatch WITH t, COUNT(DISTINCT m) AS totalMatches, AVG(scorePerMatch) AS avgGoalsPerMatch RETURN t.name AS teamName, avgGoalsPerMatch, totalMatches;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 214,
        "original_index": 214,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_30",
        "NL Question": "For each person who played in a match, calculate the total number of goals they scored and the average number of minutes they played. Return the person's name, total goals scored, and average minutes played.",
        "Cypher": "MATCH (p:Person)-[pi:PLAYED_IN]->(m:Match) OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m) WITH p, pi, COUNT(sg) AS totalGoals, toInteger(replace(substring(pi.minuteOn,0,size(pi.minuteOn)-1),'','')) AS minuteOn WITH p, totalGoals, AVG(minuteOn) AS avgMinutesPlayed RETURN p.name AS playerName, totalGoals, avgMinutesPlayed;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 215,
        "original_index": 215,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_31",
        "NL Question": "For each squad participating in the 'France 2019' tournament, find the average age of players in the squad at the time of the tournament. Return the squad ID and the average player age.",
        "Cypher": "MATCH (s:Squad)-[:FOR]->(t:Tournament {name: 'France 2019'})<-[:PARTICIPATED_IN]-(team:Team)-[:NAMED]->(s)<-[:IN_SQUAD]-(p:Person) WHERE p.dob IS NOT NULL WITH s, p, t.year - p.dob.year AS playerAge RETURN s.id AS squadId, AVG(playerAge) AS averagePlayerAge;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 216,
        "original_index": 216,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_32",
        "NL Question": "For each team, determine the total number of tournaments they participated in and the average number of matches they played per tournament. Return the team name, total tournaments, and average matches per tournament.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament) WITH t, COUNT(DISTINCT tour) AS totalTournaments MATCH (t)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament) WITH t, totalTournaments, tour, COUNT(m) AS matchesPerTournament WITH t, totalTournaments, AVG(matchesPerTournament) AS avgMatchesPerTournament RETURN t.name AS teamName, totalTournaments, avgMatchesPerTournament;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 217,
        "original_index": 217,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_35",
        "NL Question": "For each team that participated in the 'USA 1999' tournament, calculate the average number of goals scored per match. Return the team name and the average goals scored.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'USA 1999'}) MATCH (t)-[r:PLAYED_IN]->(m:Match) WHERE r.score IS NOT NULL WITH t, COUNT(m) AS matchCount, SUM(r.score) AS totalGoals RETURN t.name AS teamName, CASE WHEN matchCount = 0 THEN 0 ELSE toFloat(totalGoals)/matchCount END AS avgGoalsPerMatch;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 218,
        "original_index": 218,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_36",
        "NL Question": "For each tournament, find the team that scored the highest total goals. Return the tournament name, team name, and the total goals scored by that team in the tournament.",
        "Cypher": "MATCH (tour:Tournament)<-[:PARTICIPATED_IN]-(t:Team)-[r:PLAYED_IN]->(m:Match) WHERE r.score IS NOT NULL WITH tour, t, SUM(r.score) AS totalGoals ORDER BY tour.name, totalGoals DESC WITH tour, COLLECT({team: t, totalGoals: totalGoals}) AS scorers UNWIND scorers[0..0] AS topScorer RETURN tour.name AS tournamentName, topScorer.team.name AS teamName, topScorer.totalGoals AS totalGoals;",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "Proper logical error while taking joins"
    },
    {
        "id": 219,
        "original_index": 219,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_37",
        "NL Question": "For each player who played in a match during the 'USA 1999' tournament, calculate the total number of goals they scored and the average time (in minutes) at which they scored their goals. Return the player's name, total goals, and average scoring minute.",
        "Cypher": "MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'USA 1999'}) WITH p, sg, m WHERE sg.minute IS NOT NULL AND toInteger(replace(sg.minute, \"'+.*\", '')) > 0 WITH p, toInteger(replace(sg.minute, \"'+.*\", '')) AS scoringMinute, m WITH p, AVG(scoringMinute) AS avgScoringMinute, COUNT(m) AS totalGoals RETURN p.name AS playerName, totalGoals, avgScoringMinute;",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "Your Cypher query has a syntax issue in the replace function inside toInteger(replace(...)) â€” specifically, you're trying to use a regular expression pattern like '+.*' with replace, which in Cypher does not support regex in replace() â€” it only replaces exact substrings."
    },
    {
        "id": 220,
        "original_index": 220,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_38",
        "NL Question": "For each squad that participated in the 'USA 1999' tournament, determine the number of players in the squad and the average age of the players in that squad at the time of the tournament. Return the squad ID, player count, and average age.",
        "Cypher": "MATCH (s:Squad)-[:FOR]->(tour:Tournament {name: 'USA 1999'}) MATCH (s)<-[:IN_SQUAD]-(p:Person) WHERE p.dob IS NOT NULL WITH s, p, tour.year - p.dob.year AS age WITH s, COUNT(p) AS playerCount, AVG(age) AS avgAge RETURN s.id AS squadId, playerCount, avgAge;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 221,
        "original_index": 221,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_39",
        "NL Question": "For each team that participated in the 'USA 1999' tournament, find the number of matches they played and the average number of goals scored in each of their matches where the 'minuteOn' property is not null. Return the team name, the number of matches played, and the average goals scored.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'USA 1999'}) MATCH (t)-[r:PLAYED_IN]->(m:Match) WHERE r.minuteOn IS NOT NULL WITH t, COUNT(m) AS matchCount, AVG(r.score) AS avgGoalsScored RETURN t.name AS teamName, matchCount, avgGoalsScored;",
        "result [0/1]": "0",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": "The query returns no output if none of the PLAYED_IN relationships for teams in the 'USA 1999' tournament have both minuteOn and score properties populated."
    },
    {
        "id": 222,
        "original_index": 222,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_42",
        "NL Question": "For each tournament, calculate the average number of goals scored per match and the total number of matches played. Return the tournament name, average goals per match, and total matches.",
        "Cypher": "MATCH (m:Match)-[:IN_TOURNAMENT]->(tour:Tournament)\nOPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m)\nWITH tour, m, COUNT(sg) AS goalsPerMatch\nWITH tour, SUM(goalsPerMatch) AS totalGoals, COUNT(m) AS totalMatches\nRETURN tour.name AS tournamentName, CASE WHEN totalMatches > 0 THEN toFloat(totalGoals) / totalMatches ELSE 0 END AS avgGoalsPerMatch, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 223,
        "original_index": 223,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_43",
        "NL Question": "For each team that participated in the 'China 2007' tournament, find the average number of goals scored per match and the total number of matches they played. Return the team name, average goals per match, and total matches.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'China 2007'}) \nMATCH (t)-[:PLAYED_IN]->(m:Match)\nOPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m)\nWITH t, m, COUNT(sg) AS goalsPerMatch\nWITH t, SUM(goalsPerMatch) AS totalGoals, COUNT(m) AS totalMatches\nRETURN t.name AS teamName, CASE WHEN totalMatches > 0 THEN toFloat(totalGoals) / totalMatches ELSE 0 END AS avgGoalsPerMatch, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 224,
        "original_index": 224,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_44",
        "NL Question": "For each player who played in a match with a 'Group Matches' stage, calculate the total number of goals they scored and the average number of minutes they played. Return the player's name, total goals scored, and average minutes played.",
        "Cypher": "MATCH (p:Person)-[r:PLAYED_IN]->(m:Match {stage: 'Group Matches'})\nOPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m)\nWITH p, r, COUNT(sg) AS totalGoalsScored, toInteger(r.minuteOn) AS minuteOn\nWITH p, SUM(totalGoalsScored) AS totalGoals, AVG(minuteOn) AS avgMinutesPlayed\nRETURN p.name AS playerName, totalGoals, avgMinutesPlayed",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 225,
        "original_index": 225,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_45",
        "NL Question": "For each squad, determine the total number of players and the average number of goals scored by players in matches played in the 'China 2007' tournament. Return the squad ID, total player count, and average goals per player.",
        "Cypher": "MATCH (s:Squad)-[:FOR]->(tour:Tournament {name: 'China 2007'}) \nMATCH (s)<-[:IN_SQUAD]-(p:Person)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour)\nOPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m)\nWITH s, p, COUNT(sg) AS goalsPerPlayer\nWITH s, COUNT(DISTINCT p) AS totalPlayers, AVG(goalsPerPlayer) AS avgGoalsPerPlayer\nRETURN s.id AS squadId, totalPlayers, avgGoalsPerPlayer",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 226,
        "original_index": 226,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_46",
        "NL Question": "For each team, calculate the average number of players who scored goals in their matches and the total number of matches they played. Return the team name, average number of goal-scoring players per match, and total matches played.",
        "Cypher": "MATCH (t:Team)-[:PLAYED_IN]->(m:Match)\nOPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m)\nWITH t, m, COLLECT(DISTINCT p.id) AS goalScorers\nWITH t, m, SIZE(goalScorers) AS numGoalScorers\nWITH t, AVG(numGoalScorers) AS avgGoalScorers, COUNT(m) AS totalMatches\nRETURN t.name AS teamName, avgGoalScorers, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 227,
        "original_index": 227,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_49",
        "NL Question": "For each tournament, calculate the total number of teams that participated and the average number of players per team who scored goals. Return the tournament name, total teams, and average goals-scoring players per team.",
        "Cypher": "MATCH (tour:Tournament)<-[:PARTICIPATED_IN]-(team:Team) OPTIONAL MATCH (team)-[:PLAYED_IN]->(m:Match)<-[:SCORED_GOAL]-(p:Person) WITH tour, team, COLLECT(DISTINCT p) AS scoringPlayers, COUNT(DISTINCT team) AS totalTeams WITH tour, totalTeams, AVG(SIZE(scoringPlayers)) AS avgScoringPlayersPerTeam RETURN tour.name AS tournamentName, totalTeams, avgScoringPlayersPerTeam",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 228,
        "original_index": 228,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_50",
        "NL Question": "For each team that participated in the 'Canada 2015' tournament, find the average age of the players who played in matches during that tournament. Return the team name and the average player age.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'Canada 2015'}) MATCH (t)-[:PLAYED_IN]->(m:Match)<-[:PLAYED_IN]-(p:Person) WHERE p.dob IS NOT NULL WITH t, p, tour.year - p.dob.year AS playerAge WITH t, AVG(playerAge) AS avgPlayerAge RETURN t.name AS teamName, avgPlayerAge",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 229,
        "original_index": 229,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_51",
        "NL Question": "For each player, determine the number of tournaments they have played in and the average number of goals they scored per tournament. Return the player's name, the number of tournaments, and the average goals per tournament.",
        "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament) OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m) WITH p, tour, COUNT(sg) AS goalsPerMatch, COLLECT(DISTINCT tour) AS tournamentsPlayed WITH p, SIZE(tournamentsPlayed) AS numTournaments, REDUCE(s = 0, x IN COLLECT(goalsPerMatch) | s + x) AS totalGoals RETURN p.name AS playerName, numTournaments, CASE WHEN numTournaments = 0 THEN 0 ELSE toFloat(totalGoals) / numTournaments END AS avgGoalsPerTournament",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 230,
        "original_index": 230,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_52",
        "NL Question": "For each team, calculate the total number of matches played in the 'Group Matches' stage and the average score achieved in those matches. Return the team name, total matches, and average score.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match {stage: 'Group Matches'}) WHERE r.score IS NOT NULL WITH t, COUNT(m) AS totalMatches, SUM(r.score) AS totalScore RETURN t.name AS teamName, totalMatches, CASE WHEN totalMatches = 0 THEN 0 ELSE toFloat(totalScore) / totalMatches END AS avgScore",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 231,
        "original_index": 231,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_53",
        "NL Question": "For each tournament, determine the team with the highest average player age. Return the tournament name, the team's name, and the average age of its players.",
        "Cypher": "MATCH (tour:Tournament)<-[:PARTICIPATED_IN]-(team:Team)-[:PLAYED_IN]->(m:Match)<-[:PLAYED_IN]-(p:Person) WHERE p.dob IS NOT NULL WITH tour, team, AVG(tour.year - p.dob.year) AS avgAge ORDER BY tour.id, avgAge DESC WITH tour, COLLECT({team: team, avgAge: avgAge}) AS teamAges RETURN tour.name AS tournamentName, teamAges[0].team.name AS teamName, teamAges[0].avgAge AS avgAge",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 232,
        "original_index": 232,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_56",
        "NL Question": "For each team that participated in the tournament 'China PR 1991', calculate the total number of matches they played and the average score in those matches. Return the team name, total matches, and average score.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'China PR 1991'}) WHERE r.score IS NOT NULL WITH t, COUNT(m) AS matchCount, AVG(r.score) AS avgScore RETURN t.name AS teamName, matchCount AS totalMatches, avgScore",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 233,
        "original_index": 233,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_57",
        "NL Question": "For each player, determine the total number of goals scored and the number of tournaments they played in. Then calculate the average goals scored per tournament. Return the player's name, total goals, total tournaments, and average goals per tournament.",
        "Cypher": "MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament) WITH p, COUNT(sg) AS totalGoals, COLLECT(DISTINCT t.id) AS tournaments PLAYED_IN MATCH (p)-[:PLAYED_IN]->(m2:Match) WITH p,totalGoals, tournaments RETURN p.name AS playerName, totalGoals, SIZE(tournaments) AS totalTournaments, CASE WHEN SIZE(tournaments) = 0 THEN 0 ELSE toFloat(totalGoals) / SIZE(tournaments) END AS avgGoalsPerTournament",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "The Cypher query has a syntax error due to the space in the alias name tournaments PLAYED_IN, which is invalid."
    },
    {
        "id": 234,
        "original_index": 234,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_58",
        "NL Question": "For the team 'Australia', what is the average number of players in each squad they have been NAMED in? Return the average number of players.",
        "Cypher": "MATCH (t:Team {name: 'Australia'})-[:NAMED]->(s:Squad)<-[:IN_SQUAD]-(p:Person) WITH s, COUNT(p) AS playerCount RETURN avg(playerCount) AS averagePlayersPerSquad",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 235,
        "original_index": 235,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_59",
        "NL Question": "For each tournament, find the average number of goals scored by players who represent teams that participated in the tournament. Return the tournament name and the average goals scored.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[sg:SCORED_GOAL]-(p:Person)-[:REPRESENTS]->(t:Team)-[:PARTICIPATED_IN]->(tour) WITH tour, p, COUNT(sg) AS playerGoalsPerMatch WITH tour, AVG(playerGoalsPerMatch) AS avgGoals RETURN tour.name AS tournamentName, avgGoals",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 236,
        "original_index": 236,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_60",
        "NL Question": "For each stage of matches, determine the average penalty score and the total number of matches played in that stage. Return the stage name, the average penalty score, and the total matches.",
        "Cypher": "MATCH (m:Match) WHERE m.stage IS NOT NULL WITH m.stage AS matchStage, m OPTIONAL MATCH (p:Person)-[r:PLAYED_IN]->(m) WHERE r.penaltyScore IS NOT NULL WITH matchStage, COUNT(m) AS totalMatches, AVG(toInt(r.penaltyScore)) AS avgPenaltyScore RETURN matchStage, avgPenaltyScore, totalMatches",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "It uses deprecated function toInt() instead of toInteger() for converting penaltyScore to an integer, which is not supported in the latest versions of Neo4j."
    },
    {
        "id": 237,
        "original_index": 237,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_63",
        "NL Question": "For each team, calculate the total number of matches they played in and the average number of goals scored in those matches. Return the team's name, the total matches played, and the average goals scored per match.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match) WHERE r.score IS NOT NULL WITH t, COUNT(m) AS totalMatches, SUM(r.score) AS totalGoals RETURN t.name AS teamName, totalMatches, CASE WHEN totalMatches > 0 THEN toFloat(totalGoals) / totalMatches ELSE 0 END AS avgGoalsPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 238,
        "original_index": 238,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_64",
        "NL Question": "For each tournament, determine the average number of players from each team that participated in matches and the total number of matches played. Return the tournament name, average players per team, and total matches.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament) MATCH (p:Person)-[:REPRESENTS]->(t)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour) WITH tour, t, COUNT(DISTINCT p) AS playerCount, COUNT(DISTINCT m) AS matchCount WITH tour, AVG(playerCount) AS avgPlayersPerTeam, SUM(matchCount) AS totalMatches RETURN tour.name AS tournamentName, avgPlayersPerTeam, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 239,
        "original_index": 239,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_65",
        "NL Question": "For each squad, find the average number of goals scored by players in the squad and the total number of players in that squad. Return the squad ID, average goals per player, and total player count.",
        "Cypher": "MATCH (s:Squad)<-[:IN_SQUAD]-(p:Person) OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m:Match) WITH s, p, COUNT(sg) AS goalsPerPlayer WITH s, COUNT(DISTINCT p) AS totalPlayers, AVG(goalsPerPlayer) AS avgGoalsPerPlayer RETURN s.id AS squadId, avgGoalsPerPlayer, totalPlayers",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 240,
        "original_index": 240,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_66",
        "NL Question": "For each tournament, what is the average number of teams that participated, and what is the total number of matches played? Return the tournament name, average team count, and total match count.",
        "Cypher": "MATCH (tour:Tournament)<-[:PARTICIPATED_IN]-(t:Team) WITH tour, COUNT(DISTINCT t) AS teamCount MATCH (tour)<-[:IN_TOURNAMENT]-(m:Match) WITH tour, teamCount, COUNT(DISTINCT m) AS matchCount RETURN tour.name AS tournamentName, AVG(teamCount) AS avgTeamCount, SUM(matchCount) AS totalMatchCount",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 241,
        "original_index": 241,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_67",
        "NL Question": "For each player born before 1975, calculate the average number of matches they played in each tournament and the total number of goals they scored across all tournaments. Return the player's name, the average matches per tournament, and the total goals scored.",
        "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament) WHERE p.dob.year < 1975 OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m2:Match) WITH p, tour, COUNT(DISTINCT m) AS matchesPlayed, COUNT(sg) AS goalsScoredPerMatch WITH p, AVG(matchesPlayed) AS avgMatchesPerTournament, SUM(goalsScoredPerMatch) AS totalGoalsScored RETURN p.name AS playerName, avgMatchesPerTournament, totalGoalsScored",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 242,
        "original_index": 242,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_70",
        "NL Question": "For each team that participated in the 'Sweden 1995' tournament, calculate the total number of matches they played and the average score in those matches. Return the team name, total matches, and average score.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'Sweden 1995'}) WHERE r.score IS NOT NULL WITH t, COUNT(m) AS matchCount, AVG(r.score) AS avgScore RETURN t.name AS teamName, matchCount AS totalMatches, avgScore;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 243,
        "original_index": 243,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_71",
        "NL Question": "For each tournament, determine the average number of goals scored per match and the total number of teams that participated. Return the tournament name, average goals per match, and the count of participating teams.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match) OPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m) WITH tour, m, COUNT(sg) AS goalsPerMatch MATCH (t:Team)-[:PARTICIPATED_IN]->(tour) WITH tour, AVG(goalsPerMatch) AS avgGoalsPerMatch, COUNT(DISTINCT t) AS teamCount RETURN tour.name AS tournamentName, avgGoalsPerMatch, teamCount;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 244,
        "original_index": 244,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_72",
        "NL Question": "For each person who scored a goal, find the average number of goals they scored per match and the total number of tournaments in which they scored. Return the person's name, average goals per match, and the number of tournaments.",
        "Cypher": "MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament) WITH p, m, tour, COUNT(sg) AS goalsPerMatchInTournament WITH p, tour, SUM(goalsPerMatchInTournament) AS totalGoalsInTournament MATCH (p)-[sg:SCORED_GOAL]->(match:Match) WITH p, toFloat(SUM(totalGoalsInTournament)) / COUNT(DISTINCT match) AS avgGoalsPerMatch, COUNT(DISTINCT tour) AS tournamentCount RETURN p.name AS personName, avgGoalsPerMatch, tournamentCount;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 245,
        "original_index": 245,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_73",
        "NL Question": "For each team, calculate the average number of players in their squads and the total number of tournaments they participated in. Return the team name, average squad size, and total tournaments.",
        "Cypher": "MATCH (t:Team)-[:NAMED]->(s:Squad) MATCH (s)<-[:IN_SQUAD]-(p:Person) WITH t, s, COUNT(p) AS squadSize MATCH (t)-[:PARTICIPATED_IN]->(tour:Tournament) WITH t, AVG(squadSize) AS avgSquadSize, COUNT(DISTINCT tour) AS tournamentCount RETURN t.name AS teamName, avgSquadSize, tournamentCount;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 246,
        "original_index": 246,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_74",
        "NL Question": "For each tournament in 1995, calculate the average number of goals scored by players who were coached for squads in that tournament. Return the tournament name and the average number of goals.",
        "Cypher": "MATCH (tour:Tournament)<-[:FOR]-(s:Squad)<-[:COACH_FOR]-(coach:Person)-[:IN_SQUAD]->(player:Person)-[sg:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(tour) WHERE tour.year = 1995 WITH tour, coach, COUNT(sg) AS goalsScored RETURN tour.name AS tournamentName, AVG(goalsScored) AS averageGoalsScored;",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "The Cypher query you posted will not return results because of a semantic error in the pattern: Copy Edit (coach:Person)-[:IN_SQUAD]->(player:Person) This implies a Person is in a squad through another Person, which is not valid in most graph schemas."
    },
    {
        "id": 247,
        "original_index": 247,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_77",
        "NL Question": "For each tournament, calculate the average number of goals scored per match and the total number of teams that participated. Return the tournament name, average goals per match, and the number of participating teams.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)\nOPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m)\nWITH tour, m, COUNT(sg) AS goalsPerMatch\nWITH tour, AVG(goalsPerMatch) AS avgGoalsPerMatch, COUNT(DISTINCT m) AS totalMatches\nMATCH (t:Team)-[:PARTICIPATED_IN]->(tour)\nWITH tour, avgGoalsPerMatch, totalMatches, COUNT(DISTINCT t) AS totalTeams\nRETURN tour.name AS tournamentName, avgGoalsPerMatch, totalTeams",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 248,
        "original_index": 248,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_78",
        "NL Question": "For each team, determine the total number of matches played and the average number of minutes played per match. Return the team name, total matches, and average minutes played.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match)\nWHERE r.minuteOn IS NOT NULL\nWITH t, COUNT(m) AS totalMatches, COLLECT(toInt(r.minuteOn)) AS minutesPlayed\nWITH t, totalMatches, REDUCE(s = 0, x IN minutesPlayed | s + x) AS totalMinutes\nRETURN t.name AS teamName, totalMatches, CASE WHEN totalMatches > 0 THEN toFloat(totalMinutes) / totalMatches ELSE 0 END AS avgMinutesPlayed",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "grammatical error"
    },
    {
        "id": 249,
        "original_index": 249,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_79",
        "NL Question": "For each player who scored goals, calculate the total number of goals scored and the average number of goals scored per tournament. Return the player's name, total goals, and average goals per tournament.",
        "Cypher": "MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament)\nWITH p, tour, COUNT(sg) AS goalsPerTournament\nWITH p, COLLECT(goalsPerTournament) AS goalsByTournament\nWITH p, SIZE(goalsByTournament) AS tournamentCount, REDUCE(s = 0, x IN goalsByTournament | s + x) AS totalGoals\nRETURN p.name AS playerName, totalGoals, CASE WHEN tournamentCount > 0 THEN toFloat(totalGoals) / tournamentCount ELSE 0 END AS avgGoalsPerTournament",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 250,
        "original_index": 250,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_80",
        "NL Question": "For each tournament held after 2000, determine the average number of players per squad and the total number of matches played. Return the tournament name, average players per squad, and total matches.",
        "Cypher": "MATCH (tour:Tournament)\nWHERE tour.year > 2000\nMATCH (s:Squad)-[:FOR]->(tour)\nOPTIONAL MATCH (s)<-[:IN_SQUAD]-(p:Person)\nWITH tour, s, COUNT(p) AS playersPerSquad\nWITH tour, AVG(playersPerSquad) AS avgPlayersPerSquad\nMATCH (m:Match)-[:IN_TOURNAMENT]->(tour)\nWITH tour, avgPlayersPerSquad, COUNT(m) AS totalMatches\nRETURN tour.name AS tournamentName, avgPlayersPerSquad, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 251,
        "original_index": 251,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_81",
        "NL Question": "For the teams that participated in France 2019, what is the average number of players who scored goals in each team's matches, and what is the total number of matches played by these teams?",
        "Cypher": "MATCH (tour:Tournament {name: 'France 2019'})<-[:PARTICIPATED_IN]-(t:Team)-[:PLAYED_IN]->(m:Match)\nOPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m)\nWITH t, m, COLLECT(DISTINCT p) AS goalScorers\nWITH t, COUNT(goalScorers) AS numGoalScorers, COUNT(DISTINCT m) AS totalMatches\nRETURN t.name AS teamName, AVG(toFloat(numGoalScorers)) AS avgGoalScorersPerMatch, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 252,
        "original_index": 252,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_84",
        "NL Question": "For each team, calculate the total number of matches they played and the average number of goals scored by their players in those matches. Return the team name, total matches played, and average goals scored per match.",
        "Cypher": "MATCH (t:Team)-[:PLAYED_IN]->(m:Match)<-[sg:SCORED_GOAL]-(p:Person) WITH t, m, SUM(toInt(sg.minute)) AS totalGoals WHERE totalGoals IS NOT NULL WITH t, COUNT(DISTINCT m) AS matchCount, totalGoals RETURN t.name AS teamName, matchCount AS totalMatches, toFloat(totalGoals)/matchCount AS avgGoalsPerMatch",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "grammatical error: toInt() function"
    },
    {
        "id": 253,
        "original_index": 253,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_85",
        "NL Question": "For the tournament 'China PR 1991', find the average number of goals scored per match and the total number of matches played. Return the tournament name, average goals per match, and total matches.",
        "Cypher": "MATCH (m:Match)-[:IN_TOURNAMENT]->(t:Tournament {name: 'China PR 1991'}) OPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m) WITH t, m, COUNT(sg) AS goalsPerMatch WITH t, SUM(goalsPerMatch) AS totalGoals, COUNT(m) AS totalMatches RETURN t.name AS tournamentName, toFloat(totalGoals) / totalMatches AS avgGoalsPerMatch, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 254,
        "original_index": 254,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_86",
        "NL Question": "For each person, determine the total number of tournaments in which they played and the average number of goals they scored across all matches. Return the person's name, total tournaments played, and average goals per match.",
        "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament) OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m) WITH p, tour, m, COUNT(sg) AS goalsPerMatch WITH p, COLLECT(DISTINCT tour.id) AS tournaments, SUM(goalsPerMatch) AS totalGoals, COUNT(m) AS totalMatches RETURN p.name AS playerName, SIZE(tournaments) AS totalTournaments, CASE WHEN totalMatches = 0 THEN 0 ELSE toFloat(totalGoals) / totalMatches END AS avgGoalsPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 255,
        "original_index": 255,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_87",
        "NL Question": "For each squad, calculate the total number of players and the average age of the players in the squad. Return the squad ID, total player count, and average player age.",
        "Cypher": "MATCH (s:Squad)<-[:IN_SQUAD]-(p:Person) WHERE p.dob IS NOT NULL WITH s, p, duration.between(date(p.dob), date()).years AS age WITH s, AVG(age) AS avgAge, COUNT(p) AS totalPlayers RETURN s.id AS squadId, totalPlayers, avgAge",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 256,
        "original_index": 256,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_88",
        "NL Question": "For each tournament, find the team that played the most matches and calculate the average number of goals scored by that team across all their matches in the tournament. Return the tournament name, the team name, and the average goals scored.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[:PLAYED_IN]-(t:Team) WITH tour, t, COUNT(m) AS matchCount ORDER BY tour.id, matchCount DESC WITH tour, COLLECT({team: t, matchCount: matchCount}) AS teams MATCH (teams[0].team)-[:PLAYED_IN]->(m2:Match)-[:IN_TOURNAMENT]->(tour) OPTIONAL MATCH (teams[0].team)-[sg:SCORED_GOAL]->(m2) WITH tour, teams[0].team AS topTeam, COUNT(sg) AS totalGoals, COUNT(m2) AS totalMatches RETURN tour.name AS tournamentName, topTeam.name AS teamName, CASE WHEN totalMatches = 0 THEN 0 ELSE toFloat(totalGoals) / totalMatches END AS avgGoals",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "Cypher does not support using teams[0] (list indexing) inside a MATCH clause â€” that syntax is invalid outside of WITH/RETURN."
    },
    {
        "id": 257,
        "original_index": 257,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_91",
        "NL Question": "For each tournament, calculate the average number of players who scored goals in a match and the total number of matches played. Return the tournament name, average players with goals, and total matches.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[:SCORED_GOAL]-(p:Person) WITH tour, m, COLLECT(DISTINCT p) AS playersWithGoalsPerMatch WITH tour, COUNT(DISTINCT m) AS totalMatches, AVG(SIZE(playersWithGoalsPerMatch)) AS avgPlayersWithGoals RETURN tour.name AS tournamentName, avgPlayersWithGoals, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 258,
        "original_index": 258,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_92",
        "NL Question": "For each team, determine the total number of matches played and the average number of goals scored per player in those matches. Return the team name, total matches, and average goals per player.",
        "Cypher": "MATCH (t:Team)-[:PLAYED_IN]->(m:Match)<-[sg:SCORED_GOAL]-(p:Person) WITH t, m, p, COUNT(sg) AS goalsPerPlayerPerMatch WITH t, COUNT(DISTINCT m) AS totalMatches, AVG(goalsPerPlayerPerMatch) AS avgGoalsPerPlayer RETURN t.name AS teamName, totalMatches, avgGoalsPerPlayer",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 259,
        "original_index": 259,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_93",
        "NL Question": "For each squad, compute the total number of players and the average number of matches played by each player in the squad. Return the squad ID, total players, and average matches played per player.",
        "Cypher": "MATCH (s:Squad)<-[:IN_SQUAD]-(p:Person)-[:PLAYED_IN]->(m:Match) WITH s, p, COUNT(DISTINCT m) AS matchesPlayedPerPlayer WITH s, COUNT(DISTINCT p) AS totalPlayers, AVG(matchesPlayedPerPlayer) AS avgMatchesPerPlayer RETURN s.id AS squadId, totalPlayers, avgMatchesPerPlayer",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 260,
        "original_index": 260,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_94",
        "NL Question": "For the tournament 'Canada 2015', calculate the average number of goals scored per match and the total number of players who participated. Return the tournament name, average goals per match, and total players.",
        "Cypher": "MATCH (tour:Tournament {name: 'Canada 2015'})<-[:IN_TOURNAMENT]-(m:Match)<-[sg:SCORED_GOAL]-(p:Person) WITH tour, m, COUNT(sg) AS goalsPerMatch, p WITH tour, m, goalsPerMatch, COLLECT(DISTINCT p) AS playersPerMatch WITH tour, AVG(goalsPerMatch) AS avgGoalsPerMatch, SIZE(COLLECT(DISTINCT playersPerMatch)) AS totalPlayers RETURN tour.name AS tournamentName, avgGoalsPerMatch, totalPlayers",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 261,
        "original_index": 261,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_95",
        "NL Question": "For each team that participated in a tournament, find the average number of players in their squads and the total number of goals scored by the team in all matches. Return the team name, average squad size, and total goals scored.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament)<-[:FOR]-(s:Squad) MATCH (s)<-[:IN_SQUAD]-(p:Person) WITH t, s, COUNT(DISTINCT p) AS squadSize OPTIONAL MATCH (t)-[:PLAYED_IN]->(m:Match)<-[sg:SCORED_GOAL]-(:Person) WITH t, AVG(squadSize) AS avgSquadSize, COUNT(sg) AS totalGoals RETURN t.name AS teamName, avgSquadSize, totalGoals",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 262,
        "original_index": 262,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_98",
        "NL Question": "For each tournament, calculate the total number of teams that participated and the average number of players per team across all squads in the tournament. Return the tournament name, total teams, and average players per team.",
        "Cypher": "MATCH (tour:Tournament)<-[:FOR]-(s:Squad)<-[:IN_SQUAD]-(p:Person)\nWITH tour, s, COUNT(DISTINCT p) AS playerCount\nWITH tour, s, playerCount\nMATCH (t:Team)-[:NAMED]->(s)\nWITH tour, COUNT(DISTINCT t) AS totalTeams, AVG(playerCount) AS avgPlayersPerTeam\nRETURN tour.name AS tournamentName, totalTeams, avgPlayersPerTeam",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 263,
        "original_index": 263,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_99",
        "NL Question": "For each team that participated in the 'Sweden 1995' tournament, determine the number of matches they played and the average score in those matches. Return the team name, match count, and average score.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'Sweden 1995'})\nMATCH (t)-[r:PLAYED_IN]->(m:Match)\nWITH t, COUNT(m) AS matchCount, AVG(toInt(r.score)) AS avgScore\nRETURN t.name AS teamName, matchCount, avgScore",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "it does not filter the matches to only those in the 'Sweden 1995' tournament. So, even though teams are correctly filtered for participation, their matches may include others outside the target tournament."
    },
    {
        "id": 264,
        "original_index": 264,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_100",
        "NL Question": "For each player who played in a match during the 'Sweden 1995' tournament, find the total number of goals they scored and the average number of minutes they played. Return the player's name, total goals, and average minutes.",
        "Cypher": "MATCH (p:Person)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'Sweden 1995'})\nOPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m)\nWITH p, COUNT(sg) AS totalGoals, AVG(toInt(r.minuteOn)) AS avgMinutes\nRETURN p.name AS playerName, totalGoals, avgMinutes",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "Your Cypher query is almost correct, but there's a subtle issue: you're mixing two separate patterns across the same match variable m, without making sure both relationships refer to the same match in each subquery."
    },
    {
        "id": 265,
        "original_index": 265,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_101",
        "NL Question": "For each tournament, calculate the total number of players who participated and the average number of matches played by each player. Return the tournament name, total players, and average matches per player.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[:PLAYED_IN]-(p:Person)\nWITH tour, p, COUNT(m) AS matchesPlayed\nWITH tour, COUNT(DISTINCT p) AS totalPlayers, AVG(matchesPlayed) AS avgMatchesPerPlayer\nRETURN tour.name AS tournamentName, totalPlayers, avgMatchesPerPlayer",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 266,
        "original_index": 266,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_102",
        "NL Question": "For each team, determine the total number of players who represent them and the average number of tournaments each player has participated in. Return the team name, total players, and average tournaments per player.",
        "Cypher": "MATCH (t:Team)<-[:REPRESENTS]-(p:Person)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament)\nWITH t, p, COUNT(DISTINCT tour) AS tournamentsPlayed\nWITH t, COUNT(DISTINCT p) AS totalPlayers, AVG(tournamentsPlayed) AS avgTournamentsPerPlayer\nRETURN t.name AS teamName, totalPlayers, avgTournamentsPerPlayer",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 267,
        "original_index": 267,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_106",
        "NL Question": "For each team, determine the average number of players who scored goals in matches they played in, and the total number of matches played. Return the team's name, average number of goal-scoring players per match, and total matches played.",
        "Cypher": "MATCH (t:Team)-[:PLAYED_IN]->(m:Match)<-[sg:SCORED_GOAL]-(p:Person) WITH t, m, COUNT(DISTINCT p) AS goalScorersPerMatch WITH t, AVG(goalScorersPerMatch) AS avgGoalScorers, COUNT(m) AS totalMatchesPlayed RETURN t.name AS teamName, avgGoalScorers, totalMatchesPlayed",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 268,
        "original_index": 268,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_107",
        "NL Question": "For each tournament, find the average age of players who played in matches and the total number of matches played. Return the tournament name, average player age, and total matches played.",
        "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament) WHERE p.dob IS NOT NULL WITH tour, p, m, tour.year - p.dob.year AS playerAge WITH tour, AVG(playerAge) AS avgPlayerAge, COUNT(DISTINCT m) AS totalMatchesPlayed RETURN tour.name AS tournamentName, avgPlayerAge, totalMatchesPlayed",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 269,
        "original_index": 269,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_108",
        "NL Question": "For each squad, calculate the average number of goals scored by players in matches and the total number of players in the squad. Return the squad ID, average goals scored per player, and total player count.",
        "Cypher": "MATCH (s:Squad)<-[:IN_SQUAD]-(p:Person)-[sg:SCORED_GOAL]->(m:Match) WITH s, p, COUNT(sg) AS goalsPerPlayer OPTIONAL MATCH (s)<-[:IN_SQUAD]-(pl:Person) WITH s, AVG(goalsPerPlayer) AS avgGoalsPerPlayer, COUNT(DISTINCT pl) AS totalPlayers RETURN s.id AS squadId, avgGoalsPerPlayer, totalPlayers",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 270,
        "original_index": 270,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_109",
        "NL Question": "For each tournament, determine the average number of goals scored by teams and the total number of teams that participated. Return the tournament name, average goals scored per team, and the total number of participating teams.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament) MATCH (t)-[pi:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour) WITH tour, t, SUM(pi.score) AS teamGoals OPTIONAL MATCH (t)-[:PARTICIPATED_IN]->(tour) WITH tour, AVG(teamGoals) AS avgGoalsPerTeam, COUNT(DISTINCT t) AS totalTeams RETURN tour.name AS tournamentName, avgGoalsPerTeam, totalTeams",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 271,
        "original_index": 271,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_112",
        "NL Question": "For each team, calculate the total number of matches they played and the average penalty score across all matches. Return the team name, total matches, and average penalty score.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match) WHERE r.penaltyScore IS NOT NULL WITH t, COUNT(m) AS totalMatches, AVG(toInt(r.penaltyScore)) AS avgPenaltyScore RETURN t.name AS teamName, totalMatches, avgPenaltyScore",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "grammatical error: toInt() function"
    },
    {
        "id": 272,
        "original_index": 272,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_114",
        "NL Question": "For each person, find the total number of matches they played and the average number of minutes they played in each match. Return the person's name, total matches played, and average minutes played.",
        "Cypher": "MATCH (p:Person)-[r:PLAYED_IN]->(m:Match) WHERE r.minuteOn IS NOT NULL WITH p, COUNT(m) AS totalMatches, AVG(toInt(r.minuteOn)) AS avgMinutesPlayed RETURN p.name AS personName, totalMatches, avgMinutesPlayed",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "grammatical error: toInt() function"
    },
    {
        "id": 273,
        "original_index": 273,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_115",
        "NL Question": "For each tournament, calculate the number of teams that participated and the average number of players in each squad that participated in the tournament. Return the tournament name, number of teams, and average squad size.",
        "Cypher": "MATCH (tour:Tournament)<-[:FOR]-(s:Squad)<-[:NAMED]-(t:Team) WITH tour, s, COUNT(t) AS totalTeams MATCH (s)<-[:IN_SQUAD]-(p:Person) WITH tour, totalTeams, COUNT(DISTINCT p) AS squadSize RETURN tour.name AS tournamentName, totalTeams, AVG(squadSize) AS avgSquadSize",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 274,
        "original_index": 274,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_116",
        "NL Question": "For each team that participated in the 'China 2007' tournament, calculate the total number of matches played and the average score they achieved in those matches. Return the team's name, total matches played, and average score.",
        "Cypher": "MATCH (t:Team)-[r:PARTICIPATED_IN]->(tour:Tournament {name: 'China 2007'})-[<-:IN_TOURNAMENT]-(m:Match) WHERE r.score IS NOT NULL WITH t, COUNT(m) AS totalMatches, AVG(toInt(r.score)) AS avgScore RETURN t.name AS teamName, totalMatches, avgScore",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "grammatical error: toInt() function"
    },
    {
        "id": 275,
        "original_index": 275,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_120",
        "NL Question": "For each team, find the average number of goals scored in matches they played and the total number of players who represented them. Return the team name, average goals scored, and total players.",
        "Cypher": "MATCH (t:Team)-[:PLAYED_IN]->(m:Match)\nOPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m)\nWHERE (p)-[:REPRESENTS]->(t)\nWITH t, m, COUNT(sg) AS goalsPerMatch\nWITH t, AVG(goalsPerMatch) AS avgGoalsPerMatch\nMATCH (p:Person)-[:REPRESENTS]->(t)\nWITH t, avgGoalsPerMatch, p\nWITH t, avgGoalsPerMatch, COUNT(DISTINCT p) AS totalPlayers\nRETURN t.name AS teamName, avgGoalsPerMatch, totalPlayers",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 276,
        "original_index": 276,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_121",
        "NL Question": "For each person, determine the total number of tournaments they participated in and the average number of goals they scored per tournament. Return the person's name, total tournaments, and average goals per tournament.",
        "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament)\nOPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m)\nWITH p, tour, COUNT(sg) AS goalsPerTournament\nWITH p, COUNT(DISTINCT tour) AS totalTournaments, COLLECT(goalsPerTournament) AS goalsList\nRETURN p.name AS personName, totalTournaments, REDUCE(s = 0, x IN goalsList | s + x) / toFloat(totalTournaments) AS avgGoalsPerTournament",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 277,
        "original_index": 277,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_122",
        "NL Question": "For each tournament, find the average age of the players who participated and the total number of matches played. Return the tournament name, average player age, and total matches.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[:PLAYED_IN]-(p:Person)\nWHERE p.dob IS NOT NULL\nWITH tour, m, p\nWITH tour, m, p.dob AS dob\nWITH tour, m, date(dob) AS birthDate, tour.year AS tournamentYear\nWITH tour, m, birthDate, tournamentYear\nWITH tour, m, tournamentYear - birthDate.year AS age\nWITH tour, AVG(age) AS avgAge, COUNT(DISTINCT m) AS totalMatches\nRETURN tour.name AS tournamentName, avgAge, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 278,
        "original_index": 278,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_123",
        "NL Question": "For each squad, calculate the average number of players who scored goals and the total number of matches played by the team. Return the squad ID, average goal-scoring players, and total matches.",
        "Cypher": "MATCH (s:Squad)<-[:IN_SQUAD]-(p:Person)-[sg:SCORED_GOAL]->(m:Match)\nWITH s, p, COUNT(sg) AS goalsPerPlayer, m\nWITH s, COUNT(DISTINCT p) AS goalScorers, m\nWITH s, AVG(goalScorers) AS avgGoalScorers\nMATCH (team:Team)-[:NAMED]->(s)-[:FOR]->(tour:Tournament)\nMATCH (team)-[:PLAYED_IN]->(match:Match)\nWITH s, avgGoalScorers, COUNT(DISTINCT match) AS totalMatches\nRETURN s.id AS squadId, avgGoalScorers, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 279,
        "original_index": 279,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_126",
        "NL Question": "For each tournament, calculate the average number of goals scored by players in matches and the total number of matches played. Return the tournament name, average goals per match, and total matches.",
        "Cypher": "MATCH (m:Match)-[:IN_TOURNAMENT]->(tour:Tournament) OPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m) WITH tour, m, COUNT(sg) AS matchGoals WITH tour, SUM(matchGoals) AS totalGoals, COUNT(m) AS totalMatches RETURN tour.name AS tournamentName, CASE WHEN totalMatches > 0 THEN toFloat(totalGoals) / totalMatches ELSE 0 END AS avgGoalsPerMatch, totalMatches;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 280,
        "original_index": 280,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_127",
        "NL Question": "For each team that participated in the 'Canada 2015' tournament, find the average number of goals scored per match and the total number of matches played. Return the team name, average goals per match, and total matches.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'Canada 2015'}) MATCH (t)-[r:PLAYED_IN]->(m:Match) WHERE r.score IS NOT NULL WITH t, COUNT(m) AS matchCount, SUM(r.score) AS totalGoals RETURN t.name AS teamName, toFloat(totalGoals)/matchCount AS avgGoalsPerMatch, matchCount AS totalMatches;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 281,
        "original_index": 281,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_128",
        "NL Question": "For each squad, calculate the total number of players and the average number of matches played by each player in the squad. Return the squad ID, total player count, and average matches per player.",
        "Cypher": "MATCH (s:Squad)<-[:IN_SQUAD]-(p:Person)-[:PLAYED_IN]->(m:Match) WITH s, p, COUNT(m) AS matchesPerPlayer WITH s, COUNT(DISTINCT p) AS totalPlayers, AVG(matchesPerPlayer) AS avgMatchesPerPlayer RETURN s.id AS squadId, totalPlayers, avgMatchesPerPlayer;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 282,
        "original_index": 282,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_129",
        "NL Question": "For each person who has scored goals, find the average number of goals they scored per match and the total number of matches they played. Return the person's name, average goals per match, and total matches played.",
        "Cypher": "MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match) WITH p, COUNT(sg) AS totalGoals, COLLECT(DISTINCT m) AS matchesPlayed WITH p, totalGoals, SIZE(matchesPlayed) AS totalMatches RETURN p.name AS playerName, CASE WHEN totalMatches > 0 THEN toFloat(totalGoals) / totalMatches ELSE 0 END AS avgGoalsPerMatch, totalMatches;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 283,
        "original_index": 283,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_130",
        "NL Question": "For each tournament, determine the average age of players who played in matches and the total number of players. Return the tournament name, average player age, and total player count.",
        "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament) WHERE p.dob IS NOT NULL WITH tour, p, m.date.year - p.dob.year AS playerAge WITH tour, AVG(playerAge) AS avgPlayerAge, COUNT(DISTINCT p) AS totalPlayers RETURN tour.name AS tournamentName, avgPlayerAge, totalPlayers;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 284,
        "original_index": 284,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_133",
        "NL Question": "For each team, compute the total number of matches they played and the average number of goals scored in those matches. Return the team's name, the total matches played, and the average goals scored per match.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match) WHERE r.score IS NOT NULL WITH t, COUNT(m) AS matchCount, SUM(r.score) AS totalGoals RETURN t.name AS teamName, matchCount AS totalMatches, CASE WHEN matchCount > 0 THEN toFloat(totalGoals)/matchCount ELSE 0 END AS avgGoalsPerMatch;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 285,
        "original_index": 285,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_134",
        "NL Question": "For the 'France 2019' tournament, calculate the average number of goals scored per match and the total number of matches played. Return the tournament name, average goals per match, and total matches played.",
        "Cypher": "MATCH (m:Match)-[:IN_TOURNAMENT]->(t:Tournament {name: 'France 2019'}) OPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m) WITH t, m, COUNT(sg) AS goalsPerMatch WITH t, COUNT(m) AS totalMatches, SUM(goalsPerMatch) AS totalGoals RETURN t.name AS tournamentName, CASE WHEN totalMatches > 0 THEN toFloat(totalGoals) / totalMatches ELSE 0 END AS avgGoalsPerMatch, totalMatches;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 286,
        "original_index": 286,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_135",
        "NL Question": "For each person, calculate the number of matches they played in and the total number of goals they scored. Then, find the average goals scored per match for each person. Return the person's name, total matches played, total goals scored, and the average goals per match.",
        "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match) OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m) WITH p, COUNT(DISTINCT m) AS totalMatches, COUNT(sg) AS totalGoals RETURN p.name AS personName, totalMatches, totalGoals, CASE WHEN totalMatches > 0 THEN toFloat(totalGoals) / totalMatches ELSE 0 END AS avgGoalsPerMatch;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 287,
        "original_index": 287,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_136",
        "NL Question": "For each tournament, find the team that played the most matches. Return the tournament name, the team name, and the number of matches played by that team.",
        "Cypher": "MATCH (t:Team)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament) WITH tour, t, COUNT(m) AS matchCount ORDER BY tour.id, matchCount DESC WITH tour, COLLECT({team: t, matchCount: matchCount}) AS teamMatches RETURN tour.name AS tournamentName, teamMatches[0].team.name AS teamName, teamMatches[0].matchCount AS matchesPlayed;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 288,
        "original_index": 288,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_137",
        "NL Question": "For each squad, determine the average age of the players in the squad at the time of the 'France 2019' tournament. Return the squad ID and the average age of the players.",
        "Cypher": "MATCH (s:Squad)-[:IN_SQUAD]-(p:Person) MATCH (s)-[:FOR]->(t:Tournament {name: 'France 2019'}) WHERE p.dob IS NOT NULL WITH s, p, t.year - p.dob.year AS age RETURN s.id AS squadId, AVG(age) AS averageAge;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 289,
        "original_index": 289,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_140",
        "NL Question": "For each team, calculate the total number of matches they played and the average number of goals scored in those matches. Return the team name, the total number of matches, and the average goals per match.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match) WHERE r.score IS NOT NULL WITH t, COUNT(m) AS totalMatches, SUM(r.score) AS totalGoals RETURN t.name AS teamName, totalMatches, CASE WHEN totalMatches > 0 THEN toFloat(totalGoals) / totalMatches ELSE 0 END AS avgGoalsPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 290,
        "original_index": 290,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_141",
        "NL Question": "For the 'USA 1999' tournament, find the average number of goals scored per match. Return the tournament name and the average goals per match.",
        "Cypher": "MATCH (t:Tournament {name: 'USA 1999'})<-[:IN_TOURNAMENT]-(m:Match)<-[r:SCORED_GOAL]-(:Person) WITH t, m, COUNT(r) AS goalsPerMatch WITH t, AVG(goalsPerMatch) AS avgGoalsPerMatch RETURN t.name AS tournamentName, avgGoalsPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 291,
        "original_index": 291,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_142",
        "NL Question": "For each person, find the number of tournaments they participated in and the average number of goals they scored per tournament. Return the person's name, the number of tournaments, and the average goals per tournament.",
        "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament) OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m) WITH p, t, COUNT(sg) AS goalsPerTournament WITH p, COUNT(DISTINCT t) AS numTournaments, COLLECT(goalsPerTournament) AS goalsList RETURN p.name AS personName, numTournaments, CASE WHEN numTournaments > 0 THEN REDUCE(total = 0, goal in goalsList | total + goal) / toFloat(numTournaments) ELSE 0 END AS avgGoalsPerTournament",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 292,
        "original_index": 292,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_143",
        "NL Question": "For each tournament, determine the team that played the most matches. Return the tournament name, the team name, and the number of matches played by that team.",
        "Cypher": "MATCH (t:Team)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament) WITH tour, t, COUNT(m) AS matchCount ORDER BY tour.name, matchCount DESC WITH tour, COLLECT({team: t.name, matches: matchCount}) AS teamMatches RETURN tour.name AS tournamentName, teamMatches[0].team AS teamName, teamMatches[0].matches AS matchCount",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 293,
        "original_index": 293,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_144",
        "NL Question": "For each squad, calculate the number of players born before 1990 and the average number of goals scored by those players. Return the squad ID, the count of players born before 1990, and the average goals scored by those players.",
        "Cypher": "MATCH (s:Squad)<-[:IN_SQUAD]-(p:Person) WHERE p.dob IS NOT NULL AND p.dob.year < 1990 OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(:Match) WITH s, p, COUNT(sg) AS goalsPerPlayer WITH s, COUNT(DISTINCT p) AS totalPlayers, COLLECT(goalsPerPlayer) AS goalsList RETURN s.id AS squadId, totalPlayers, CASE WHEN totalPlayers > 0 THEN REDUCE(total = 0, goal in goalsList | total + goal) / toFloat(totalPlayers) ELSE 0 END AS avgGoalsPerPlayer",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 294,
        "original_index": 294,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_147",
        "NL Question": "For each team that participated in the 'Sweden 1995' tournament, calculate the average number of goals scored per match by that team. Return the team name and the average goals per match.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'Sweden 1995'}) WHERE r.score IS NOT NULL WITH t, m, r.score AS goalsPerMatch WITH t, AVG(goalsPerMatch) AS avgGoalsPerMatch RETURN t.name AS teamName, avgGoalsPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 295,
        "original_index": 295,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_148",
        "NL Question": "For each tournament, determine the team with the highest average number of goals scored per match. Return the tournament name, the team name, and the average goals scored.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament) WHERE r.score IS NOT NULL WITH tour, t, AVG(r.score) AS avgGoalsPerMatch ORDER BY tour.name, avgGoalsPerMatch DESC WITH tour, COLLECT({team: t.name, avgGoals: avgGoalsPerMatch}) AS teamStats RETURN tour.name AS tournamentName, teamStats[0].team AS topTeam, teamStats[0].avgGoals AS topAvgGoals",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 296,
        "original_index": 296,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_149",
        "NL Question": "For each player, calculate the number of tournaments they participated in and the average number of matches they played per tournament. Return the player's name, the number of tournaments, and the average matches per tournament.",
        "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament) WITH p, tour, COUNT(m) AS matchesPerTournament WITH p, COUNT(DISTINCT tour) AS numTournaments, AVG(matchesPerTournament) AS avgMatchesPerTournament RETURN p.name AS playerName, numTournaments, avgMatchesPerTournament",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 297,
        "original_index": 297,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_150",
        "NL Question": "For each team, find the average number of goals scored by players representing that team across all matches. Return the team name and the average goals scored by its players.",
        "Cypher": "MATCH (p:Person)-[:REPRESENTS]->(t:Team)-[:PLAYED_IN]->(m:Match) OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m) WITH t, p, COUNT(sg) AS goalsPerPlayer WITH t, AVG(goalsPerPlayer) AS avgGoalsPerPlayer RETURN t.name AS teamName, avgGoalsPerPlayer",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 298,
        "original_index": 298,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_151",
        "NL Question": "For each tournament, calculate the total number of players who scored at least one goal and the average number of goals scored by those players. Return the tournament name, the count of players who scored, and the average goals scored by them.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[sg:SCORED_GOAL]-(p:Person) WITH tour, p, COUNT(sg) AS goalsScored WHERE goalsScored > 0 WITH tour, COUNT(DISTINCT p) AS playersWhoScored, AVG(goalsScored) AS avgGoalsScored RETURN tour.name AS tournamentName, playersWhoScored, avgGoalsScored",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 299,
        "original_index": 299,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_154",
        "NL Question": "For each tournament, calculate the total number of teams that participated and the average number of players per team who scored goals. Return the tournament name, total teams, and average goals per team.",
        "Cypher": "MATCH (tour:Tournament)<-[:PARTICIPATED_IN]-(t:Team)\nOPTIONAL MATCH (p:Person)-[:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(tour)\nWHERE (p)-[:REPRESENTS]->(t)\nWITH tour, t, COUNT(DISTINCT p) AS goalScorers\nWITH tour, COUNT(DISTINCT t) AS totalTeams, AVG(goalScorers) AS avgGoalsPerTeam\nRETURN tour.name AS tournamentName, totalTeams, avgGoalsPerTeam",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 300,
        "original_index": 300,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_155",
        "NL Question": "For each team, find the total number of matches they played and the average number of goals scored in those matches where the score is available. Return the team name, total matches, and average score.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match)\nWHERE r.score IS NOT NULL\nWITH t, COUNT(m) AS totalMatches, AVG(r.score) AS avgScore\nRETURN t.name AS teamName, totalMatches, avgScore",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 301,
        "original_index": 301,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_156",
        "NL Question": "For each person, determine the number of tournaments they have played in and the average number of goals they scored per tournament. Return the person's name, the number of tournaments, and their average goals per tournament.",
        "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament)\nOPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m)\nWITH p, t, COUNT(sg) AS goals\nWITH p, COUNT(DISTINCT t) AS numTournaments, COLLECT(goals) AS goalsList\nWITH p, numTournaments, REDUCE(total = 0, goal IN goalsList | total + goal) AS totalGoals\nRETURN p.name AS personName, numTournaments, CASE WHEN numTournaments = 0 THEN 0 ELSE toFloat(totalGoals) / numTournaments END AS avgGoalsPerTournament",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 302,
        "original_index": 302,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_157",
        "NL Question": "For each tournament, find the average age of players who played in matches during the 'Group Matches' stage. Return the tournament name and the average player age.",
        "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament)\nWHERE m.stage = 'Group Matches' AND p.dob IS NOT NULL\nWITH t, p, t.year - p.dob.year AS age\nRETURN t.name AS tournamentName, AVG(age) AS averagePlayerAge",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 303,
        "original_index": 303,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_158",
        "NL Question": "For each team that participated in the 'USA 2003' tournament, calculate the total number of players and the average number of goals scored by each player in matches. Return the team name, total players, and average goals per player.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'USA 2003'})\nOPTIONAL MATCH (p:Person)-[:REPRESENTS]->(t)-[:PLAYED_IN]->(m:Match)\nOPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m)\nWITH t, COUNT(DISTINCT p) AS totalPlayers, COUNT(sg) AS totalGoals,totalPlayers\nRETURN t.name AS teamName, totalPlayers, CASE WHEN totalPlayers = 0 THEN 0 ELSE toFloat(totalGoals) / totalPlayers END AS avgGoalsPerPlayer",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "syntax error"
    },
    {
        "id": 304,
        "original_index": 304,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_161",
        "NL Question": "For each team, calculate the total number of matches they played and the average number of goals scored per match where the score is not null. Return the team name, total matches played, and average goals per match.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match) WHERE r.score IS NOT NULL WITH t, COUNT(m) AS matchCount, SUM(r.score) AS totalGoals RETURN t.name AS teamName, matchCount AS totalMatches, toFloat(totalGoals)/matchCount AS avgGoalsPerMatch;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 305,
        "original_index": 305,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_162",
        "NL Question": "For the tournament 'Germany 2011', find the player who scored the most goals. Return the player's name, ID, and the total number of goals scored by that player in the tournament.",
        "Cypher": "MATCH (tour:Tournament {name: 'Germany 2011'}) MATCH (m:Match)-[:IN_TOURNAMENT]->(tour) MATCH (p:Person)-[sg:SCORED_GOAL]->(m) WITH tour, p, COUNT(sg) AS totalGoals ORDER BY tour.id, totalGoals DESC WITH tour, COLLECT({player: p, totalGoals: totalGoals}) AS scorers RETURN tour.name AS tournamentName, scorers[0].player.name AS playerName, scorers[0].player.id AS playerId, scorers[0].totalGoals AS totalGoals;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 306,
        "original_index": 306,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_163",
        "NL Question": "For each squad, compute the total number of players and the average number of goals scored by its players in matches. Return the squad ID, total player count, and average goals per player.",
        "Cypher": "MATCH (s:Squad)<-[:IN_SQUAD]-(p:Person) OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(:Match) WITH s, p, COUNT(sg) AS goalsPerPlayer WITH s, COUNT(DISTINCT p) AS totalPlayers, AVG(goalsPerPlayer) AS avgGoalsPerPlayer RETURN s.id AS squadId, totalPlayers, avgGoalsPerPlayer;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 307,
        "original_index": 307,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_164",
        "NL Question": "For each tournament, calculate the total number of goals scored and determine the average goals per match. Return the tournament name, total goals, total matches, and average goals per match.",
        "Cypher": "MATCH (m:Match)-[:IN_TOURNAMENT]->(tour:Tournament) OPTIONAL MATCH (:Person)-[sg:SCORED_GOAL]->(m) WITH tour, m, COUNT(sg) AS matchGoals WITH tour, SUM(matchGoals) AS totalGoals, COUNT(m) AS totalMatches RETURN tour.name AS tournamentName, totalGoals, totalMatches, CASE WHEN totalMatches > 0 THEN toFloat(totalGoals) / totalMatches ELSE 0 END AS avgGoalsPerMatch;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 308,
        "original_index": 308,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_165",
        "NL Question": "For matches played in 2019, identify the player who was substituted on the most times. Return the player's name and the number of matches in which they were subbed on.",
        "Cypher": "MATCH (p:Person)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament) WHERE r.type = 'Subbed On' AND tour.year = 2019 WITH p, COUNT(DISTINCT m) AS matchCount RETURN p.name AS playerName, matchCount ORDER BY matchCount DESC LIMIT 1;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 309,
        "original_index": 309,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_168",
        "NL Question": "For each team that participated in the 'Canada 2015' tournament, calculate the total number of goals scored by their players and the average number of goals scored per match. Return the team name, total goals scored, and average goals per match.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'Canada 2015'}) MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match)<-[:PLAYED_IN]-(t) WITH t, p, COUNT(sg) AS totalGoalsPerPlayer MATCH (t)-[:PLAYED_IN]->(m) WITH t, SUM(totalGoalsPerPlayer) AS totalGoals, COUNT(DISTINCT m) AS totalMatches RETURN t.name AS teamName, totalGoals, CASE WHEN totalMatches > 0 THEN toFloat(totalGoals) / totalMatches ELSE 0 END AS avgGoalsPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 310,
        "original_index": 310,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_169",
        "NL Question": "For each player who participated in matches, determine the total number of matches they played and the average score in those matches. Return the player's name, total matches played, and average score, ordering by average score in descending order.",
        "Cypher": "MATCH (p:Person)-[r:PLAYED_IN]->(m:Match) WHERE r.score IS NOT NULL WITH p, COUNT(m) AS totalMatches, SUM(r.score) AS totalScore RETURN p.name AS playerName, totalMatches, CASE WHEN totalMatches > 0 THEN toFloat(totalScore) / totalMatches ELSE 0 END AS avgScore ORDER BY avgScore DESC",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "COUNT function ahould be used for r.score"
    },
    {
        "id": 311,
        "original_index": 311,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_171",
        "NL Question": "For each tournament, determine the average number of goals scored per match and the total number of matches played. Return the tournament name, average goals per match, and total matches played.",
        "Cypher": "MATCH (m:Match)-[:IN_TOURNAMENT]->(tour:Tournament) OPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m) WITH tour, m, COUNT(sg) AS goalsPerMatch WITH tour, AVG(goalsPerMatch) AS avgGoalsPerMatch, COUNT(m) AS totalMatches RETURN tour.name AS tournamentName, avgGoalsPerMatch, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 312,
        "original_index": 312,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_172",
        "NL Question": "For each team, calculate the total number of matches they played and the average number of players who scored goals in those matches. Return the team's name, total matches played, and average number of goal-scoring players per match.",
        "Cypher": "MATCH (t:Team)-[:PLAYED_IN]->(m:Match) WITH t, COUNT(m) AS totalMatches OPTIONAL MATCH (t)-[:PLAYED_IN]->(m)<-[sg:SCORED_GOAL]-(p:Person) WITH t, totalMatches, m, COLLECT(DISTINCT p) AS goalScorersPerMatch WITH t, totalMatches, AVG(SIZE(goalScorersPerMatch)) AS avgGoalScorersPerMatch RETURN t.name AS teamName, totalMatches, avgGoalScorersPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 313,
        "original_index": 313,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_175",
        "NL Question": "For the 'France 2019' tournament, what is the average number of players per squad and the total number of matches played?",
        "Cypher": "MATCH (tour:Tournament {name: 'France 2019'})<-[:FOR]-(s:Squad)<-[:IN_SQUAD]-(p:Person) WITH tour, s, count(p) AS playersPerSquad MATCH (m:Match)-[:IN_TOURNAMENT]->(tour) WITH tour, avg(playersPerSquad) AS avgPlayers, count(m) AS totalMatches RETURN tour.name AS Tournament, avgPlayers, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 314,
        "original_index": 314,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_176",
        "NL Question": "For each team that participated in the 'Canada 2015' tournament, what is the average number of goals scored per match and the total number of matches played?",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'Canada 2015'}) MATCH (t)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour) WHERE r.score IS NOT NULL WITH t, COUNT(m) AS totalMatches, AVG(r.score) AS avgGoalsPerMatch RETURN t.name AS teamName, totalMatches, avgGoalsPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 315,
        "original_index": 315,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_177",
        "NL Question": "What is the average number of goals scored by 'Petra Damm' in matches and the total number of matches she played in?",
        "Cypher": "MATCH (p:Person {name: 'Petra Damm'})-[r:SCORED_GOAL]->(m:Match) WITH p, COUNT(m) AS totalMatches, AVG(toInt(r.minute)) AS avgGoalsPerMatch RETURN p.name AS playerName, totalMatches, avgGoalsPerMatch",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "Your current query incorrectly interprets goals as matches played, and averages the minute (time of scoring) instead of actual goal count per match."
    },
    {
        "id": 316,
        "original_index": 316,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_178",
        "NL Question": "For each tournament, what is the average number of teams that participated and the total number of squads?",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament) WITH tour, count(t) AS teamsPerTournament MATCH (s:Squad)-[:FOR]->(tour) WITH tour, teamsPerTournament, count(s) AS totalSquads RETURN tour.name AS tournamentName, avg(teamsPerTournament), totalSquads",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 317,
        "original_index": 317,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_179",
        "NL Question": "Considering matches where 'Chen Yufeng' played, what is the average 'score' in those matches and the total number of matches where 'Chen Yufeng' started?",
        "Cypher": "MATCH (p:Person {name: 'Chen Yufeng'})-[r:PLAYED_IN]->(m:Match) WITH p, r, m WHERE r.type = 'Started' WITH p, COUNT(m) AS totalMatchesStarted, AVG(toInt(r.score)) AS avgScoreInMatches RETURN p.name AS playerName, totalMatchesStarted, avgScoreInMatches",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "grammatical error: toInt() function"
    },
    {
        "id": 318,
        "original_index": 318,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_183",
        "NL Question": "For each team that participated in the 'Canada 2015' tournament, determine the total number of goals scored by all players representing that team and the average number of goals scored per player. Return the team name, total goals, and average goals per player.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'Canada 2015'})\nMATCH (p:Person)-[:REPRESENTS]->(t)-[:PLAYED_IN]->(m:Match)\nOPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m)\nWITH t, p, COUNT(sg) AS goalsPerPlayer\nWITH t, SUM(goalsPerPlayer) AS totalGoals, COUNT(DISTINCT p) AS totalPlayers\nRETURN t.name AS teamName, totalGoals, CASE WHEN totalPlayers = 0 THEN 0 ELSE toFloat(totalGoals) / totalPlayers END AS avgGoalsPerPlayer",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 319,
        "original_index": 319,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_184",
        "NL Question": "For each player who played in a match during the year 2011, calculate the total number of matches they played and the average score in those matches. Return the player's name, total matches played, and average score.",
        "Cypher": "MATCH (p:Person)-[r:PLAYED_IN]->(m:Match)\nWHERE m.date.year = 2011\nWITH p, m, r\nWITH p, COUNT(m) AS totalMatches, SUM(toInt(r.score)) AS totalScore\nRETURN p.name AS playerName, totalMatches, CASE WHEN totalMatches = 0 THEN 0 ELSE toFloat(totalScore) / totalMatches END AS averageScore",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "It uses deprecated function toInt() instead of toInteger() for converting penaltyScore to an integer, which is not supported in the latest versions of Neo4j."
    },
    {
        "id": 320,
        "original_index": 320,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_185",
        "NL Question": "For each tournament, find the team with the highest average 'score' in the 'PLAYED_IN' relationship. Return the tournament name, the team name, and the average score.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament)\nWITH tour, t, AVG(toInt(r.score)) AS avgScore\nORDER BY tour.name, avgScore DESC\nWITH tour, COLLECT({team: t, avgScore: avgScore}) AS teamScores\nRETURN tour.name AS tournamentName, teamScores[0].team.name AS teamName, teamScores[0].avgScore AS averageScore",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "grammatical error: toInt() function"
    },
    {
        "id": 321,
        "original_index": 321,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_186",
        "NL Question": "For each squad, determine the total number of players in the squad and the average number of matches played by each player. Return the squad ID, total players, and average matches played per player.",
        "Cypher": "MATCH (s:Squad)<-[:IN_SQUAD]-(p:Person)-[:PLAYED_IN]->(m:Match)\nWITH s, p, COUNT(m) AS matchesPlayed\nWITH s, COUNT(DISTINCT p) AS totalPlayers, AVG(matchesPlayed) AS avgMatchesPerPlayer\nRETURN s.id AS squadId, totalPlayers, avgMatchesPerPlayer",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 322,
        "original_index": 322,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_190",
        "NL Question": "For each team that participated in the 'USA 1999' tournament, calculate the total number of goals scored and the average number of goals scored per match. Return the team name, total goals, and average goals per match.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'USA 1999'}) MATCH (t)-[r:PLAYED_IN]->(m:Match) OPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m) WHERE t-[:PLAYED_IN]->m WITH t, m, COUNT(sg) AS matchGoals WITH t, SUM(matchGoals) AS totalGoals, COUNT(m) AS totalMatches RETURN t.name AS teamName, totalGoals, CASE WHEN totalMatches > 0 THEN toFloat(totalGoals) / totalMatches ELSE 0 END AS avgGoalsPerMatch",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "Your query has a logic error in the WHERE t-[:PLAYED_IN]->m clause â€” Cypher does not support relationship patterns in WHERE like that. This condition is redundant anyway since you've already matched (t)-[r:PLAYED_IN]->(m) earlier."
    },
    {
        "id": 323,
        "original_index": 323,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_191",
        "NL Question": "For matches played on '2011-07-05', determine the average number of minutes played by each player and the total number of players who played in those matches.",
        "Cypher": "MATCH (m:Match {date: date('2011-07-05')})<-[r:PLAYED_IN]-(p:Person) WITH p, toInteger(r.minuteOn) AS minuteOn  WITH p, AVG(minuteOn) AS avgMinutesPlayed RETURN p.name AS playerName, avgMinutesPlayed, COUNT(p) AS totalPlayers",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 324,
        "original_index": 324,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_192",
        "NL Question": "For each squad, find the average age of the players in the squad during the 'USA 1999' tournament and the total number of players in that squad.",
        "Cypher": "MATCH (s:Squad)-[:FOR]->(tour:Tournament {name: 'USA 1999'}) MATCH (p:Person)-[:IN_SQUAD]->(s) WHERE p.dob IS NOT NULL WITH s, p, tour.year - p.dob.year AS playerAge WITH s, AVG(playerAge) AS avgAge, COUNT(p) AS totalPlayers RETURN s.id AS squadId, avgAge, totalPlayers",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 325,
        "original_index": 325,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_193",
        "NL Question": "For each tournament, determine the average number of teams that participated and the total number of players who scored goals. Return the tournament name, average number of teams, and total number of goal-scoring players.",
        "Cypher": "MATCH (tour:Tournament)<-[:PARTICIPATED_IN]-(t:Team) WITH tour, COUNT(DISTINCT t) AS teamCount MATCH (tour)<-[:IN_TOURNAMENT]-(m:Match)<-[sg:SCORED_GOAL]-(p:Person) WITH tour, teamCount, COUNT(DISTINCT p) AS goalScorerCount RETURN tour.name AS tournamentName, AVG(teamCount) AS avgTeams, SUM(goalScorerCount) AS totalGoalScorers",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 326,
        "original_index": 326,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_196",
        "NL Question": "For each tournament, calculate the average number of players in each squad participating and the total number of teams that participated. Return the tournament name, average squad size, and total team count.",
        "Cypher": "MATCH (t:Tournament)<-[:FOR]-(s:Squad)<-[:IN_SQUAD]-(p:Person) WITH t, s, COUNT(p) AS squadSize WITH t, AVG(squadSize) AS avgSquadSize MATCH (team:Team)-[:PARTICIPATED_IN]->(t) WITH t, avgSquadSize, COUNT(DISTINCT team) AS totalTeams RETURN t.name AS tournamentName, avgSquadSize, totalTeams",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 327,
        "original_index": 327,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_197",
        "NL Question": "For each team, find the average number of goals scored per match and the total number of matches played. Return the team's name, average goals per match, and total matches played.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match) WHERE r.score IS NOT NULL WITH t, m, r.score AS scorePerMatch WITH t, COUNT(m) AS totalMatches, AVG(toFloat(scorePerMatch)) AS avgGoalsPerMatch RETURN t.name AS teamName, avgGoalsPerMatch, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 328,
        "original_index": 328,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_198",
        "NL Question": "For each tournament, calculate the average number of goals scored in each match and the total number of matches played. Return the tournament name, average goals per match, and total matches.",
        "Cypher": "MATCH (t:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[r:SCORED_GOAL]-(p:Person) WITH t, m, COUNT(r) AS goalsPerMatch WITH t, AVG(goalsPerMatch) AS avgGoalsPerMatch, COUNT(m) AS totalMatches RETURN t.name AS tournamentName, avgGoalsPerMatch, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 329,
        "original_index": 329,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_199",
        "NL Question": "For each person, determine the total number of goals they scored and the average number of minutes they played per match. Return the person's name, total goals, and average minutes played.",
        "Cypher": "MATCH (p:Person)-[r:PLAYED_IN]->(m:Match) WHERE r.minuteOn IS NOT NULL WITH p, m, r.minuteOn AS minutesPlayed, r OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m) WITH p, m, minutesPlayed, COUNT(sg) AS goalsScoredPerMatch WITH p, SUM(goalsScoredPerMatch) AS totalGoals, AVG(toFloat(minutesPlayed)) AS avgMinutesPlayed RETURN p.name AS personName, totalGoals, avgMinutesPlayed",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 330,
        "original_index": 330,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_200",
        "NL Question": "For each team that participated in the 'Sweden 1995' tournament, compute the average number of goals scored by its players and the total number of players in the team. Return the team's name, average goals per player, and total player count.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'Sweden 1995'}) MATCH (p:Person)-[:REPRESENTS]->(t)-[:PLAYED_IN]->(m:Match) OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m) WITH t, p, COUNT(sg) AS goalsPerPlayer WITH t, AVG(goalsPerPlayer) AS avgGoalsPerPlayer, COUNT(DISTINCT p) AS totalPlayers RETURN t.name AS teamName, avgGoalsPerPlayer, totalPlayers",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 331,
        "original_index": 331,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_203",
        "NL Question": "For each tournament, calculate the total number of goals scored and the average number of goals scored per team. Return the tournament name, total goals scored, and average goals per team.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[sg:SCORED_GOAL]-(p:Person)\nWITH tour, m, COUNT(sg) AS goalsPerMatch\nWITH tour, SUM(goalsPerMatch) AS totalGoals\nMATCH (t:Team)-[:PARTICIPATED_IN]->(tour)\nWITH tour, totalGoals, COUNT(t) AS totalTeams\nRETURN tour.name AS tournamentName, totalGoals, toFloat(totalGoals) / totalTeams AS avgGoalsPerTeam;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 332,
        "original_index": 332,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_204",
        "NL Question": "For each team, determine the total number of matches they played and calculate the average number of goals scored by players from that team in those matches. Return the team name, total matches played, and average goals scored by team players.",
        "Cypher": "MATCH (t:Team)-[:PLAYED_IN]->(m:Match)\nWITH t, COUNT(m) AS totalMatches\nOPTIONAL MATCH (p:Person)-[:REPRESENTS]->(t)-[:PLAYED_IN]->(m2:Match)\nOPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m2)\nWITH t, totalMatches, COUNT(sg) AS totalGoals\nRETURN t.name AS teamName, totalMatches, CASE WHEN totalMatches = 0 THEN 0 ELSE toFloat(totalGoals) / totalMatches END AS avgGoalsByTeamPlayers;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 333,
        "original_index": 333,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_205",
        "NL Question": "For each person, calculate the total number of tournaments they participated in and the average number of matches they played per tournament. Return the person's name, total tournaments, and average matches per tournament.",
        "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament)\nWITH p, t, COUNT(m) AS matchCount\nWITH p, COLLECT({tournament: t, matches: matchCount}) AS tournamentData\nWITH p, SIZE(tournamentData) AS totalTournaments, REDUCE(s = 0, td IN tournamentData | s + td.matches) AS totalMatches\nRETURN p.name AS personName, totalTournaments, CASE WHEN totalTournaments = 0 THEN 0 ELSE toFloat(totalMatches) / totalTournaments END AS avgMatchesPerTournament;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 334,
        "original_index": 334,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_206",
        "NL Question": "For each team that participated in the 'Germany 2011' tournament, find the average number of goals scored by their players in each match. Return the team name and the average goals scored per match.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'Germany 2011'}) \nMATCH (p:Person)-[:REPRESENTS]->(t)-[:PLAYED_IN]->(m:Match)\nOPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m)\nWITH t, m, COUNT(sg) AS goalsPerMatch\nWITH t, AVG(goalsPerMatch) AS avgGoalsPerMatch\nRETURN t.name AS teamName, avgGoalsPerMatch;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 335,
        "original_index": 335,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_207",
        "NL Question": "For each tournament year, calculate the total number of matches played and the average number of teams participating in those matches. Return the tournament year, total matches, and average teams per match.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)\nWITH tour.year AS tournamentYear, m\nMATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {year: tournamentYear})\nWITH tournamentYear, m, COUNT(t) AS teamsPerMatch\nWITH tournamentYear, COUNT(m) AS totalMatches, AVG(teamsPerMatch) AS avgTeamsPerMatch\nRETURN tournamentYear, totalMatches, avgTeamsPerMatch;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 336,
        "original_index": 336,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_210",
        "NL Question": "For each tournament, calculate the average number of players per squad and the total number of teams that participated. Return the tournament name, the average number of players per squad, and the total number of participating teams.",
        "Cypher": "MATCH (t:Tournament)<-[:FOR]-(s:Squad)<-[:IN_SQUAD]-(p:Person)\nWITH t, s, COUNT(p) AS playerCount\nWITH t, AVG(playerCount) AS avgPlayersPerSquad, COUNT(DISTINCT s) AS totalSquads\nMATCH (team:Team)-[:PARTICIPATED_IN]->(t)\nWITH t, avgPlayersPerSquad, COUNT(DISTINCT team) AS totalTeams\nRETURN t.name AS tournamentName, avgPlayersPerSquad, totalTeams",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 337,
        "original_index": 337,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_211",
        "NL Question": "For each team, find the average number of goals scored per match and the total number of tournaments they participated in. Return the team's name, average goals per match, and total tournaments.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match)\nWHERE r.score IS NOT NULL\nWITH t, COUNT(m) AS matchCount, SUM(r.score) AS totalGoals\nWITH t, toFloat(totalGoals) / matchCount AS avgGoalsPerMatch\nMATCH (t)-[:PARTICIPATED_IN]->(tour:Tournament)\nWITH t, avgGoalsPerMatch, COUNT(DISTINCT tour) AS totalTournaments\nRETURN t.name AS teamName, avgGoalsPerMatch, totalTournaments",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 338,
        "original_index": 338,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_212",
        "NL Question": "For each tournament, calculate the average age of players who scored goals and the total number of matches played. Return the tournament name, average age of goal-scoring players, and the total number of matches.",
        "Cypher": "MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament)\nWHERE p.dob IS NOT NULL\nWITH t, p, m\nWITH t, AVG(t.year - p.dob.year) AS avgAgeOfGoalScorers, COUNT(DISTINCT m) AS totalMatches\nRETURN t.name AS tournamentName, avgAgeOfGoalScorers, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 339,
        "original_index": 339,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_213",
        "NL Question": "For each squad, find the average number of goals scored by players and the total number of players who represent a team. Return the squad ID, the average goals scored by players, and the total number of team representatives.",
        "Cypher": "MATCH (s:Squad)<-[:IN_SQUAD]-(p:Person)\nOPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m:Match)\nWITH s, p, COUNT(sg) AS goalsPerPlayer\nWITH s, AVG(goalsPerPlayer) AS avgGoalsPerPlayer\nMATCH (p)-[:REPRESENTS]->(team:Team)\nWITH s, avgGoalsPerPlayer, COUNT(DISTINCT p) AS totalTeamRepresentatives\nRETURN s.id AS squadId, avgGoalsPerPlayer, totalTeamRepresentatives",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 340,
        "original_index": 340,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_214",
        "NL Question": "For the tournament 'China PR 1991', what is the average number of goals scored by players who were 'Started' in matches, and how many players 'Started' in at least one match?",
        "Cypher": "MATCH (p:Person)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament {name: 'China PR 1991'})\nWHERE r.type = 'Started'\nWITH p, m, r\nOPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m)\nWITH p, COUNT(sg) AS totalGoals, COUNT(DISTINCT m) as matchesPlayed\nWITH AVG(totalGoals) AS avgGoals, COUNT(p) AS playersStarted\nRETURN avgGoals, playersStarted",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 341,
        "original_index": 341,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_217",
        "NL Question": "For each team that participated in the tournament 'Canada 2015', calculate the average number of goals scored per match by the team. Return the team name and the average goals scored.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'Canada 2015'}) WHERE r.score IS NOT NULL WITH t, AVG(r.score) AS avgGoals RETURN t.name AS teamName, avgGoals",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 342,
        "original_index": 342,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_218",
        "NL Question": "For each tournament, determine the average number of players in each squad that participated. Return the tournament name and the average squad size.",
        "Cypher": "MATCH (tour:Tournament)<-[:FOR]-(s:Squad)<-[:IN_SQUAD]-(p:Person) WITH tour, s, COUNT(p) AS squadSize WITH tour, AVG(squadSize) AS avgSquadSize RETURN tour.name AS tournamentName, avgSquadSize",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 343,
        "original_index": 343,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_219",
        "NL Question": "For each person who played in a match, find the average number of goals they scored per tournament. Return the person's name and their average goals per tournament.",
        "Cypher": "MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament) WITH p, t, COUNT(sg) AS goalsPerTournament WITH p, AVG(goalsPerTournament) AS avgGoalsPerTournament RETURN p.name AS playerName, avgGoalsPerTournament",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 344,
        "original_index": 344,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_220",
        "NL Question": "For each team, calculate the total number of matches they played and the average number of minutes played by players from that team across all matches. Return the team name, total matches played, and the average minutes played.",
        "Cypher": "MATCH (t:Team)-[:PLAYED_IN]->(m:Match)<-[r:PLAYED_IN]-(p:Person) WITH t, m, toInteger(r.minuteOn) AS minuteOn, r WHERE r.minuteOn IS NOT NULL WITH t, COUNT(DISTINCT m) AS totalMatches, AVG(minuteOn) AS avgMinutesPlayed RETURN t.name AS teamName, totalMatches, avgMinutesPlayed",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 345,
        "original_index": 345,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_221",
        "NL Question": "For each tournament, find the team with the highest average score across all matches played in that tournament. Return the tournament name and the name of the team with the highest average score.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[r:PLAYED_IN]-(t:Team) WHERE r.score IS NOT NULL WITH tour, t, AVG(r.score) AS avgScore ORDER BY tour.name, avgScore DESC WITH tour, COLLECT({team: t.name, avgScore: avgScore}) AS teamScores RETURN tour.name AS tournamentName, teamScores[0].team AS teamWithHighestAvgScore",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 346,
        "original_index": 346,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_224",
        "NL Question": "For each tournament, calculate the average number of players per team and the total number of teams that participated. Return the tournament name, average players per team, and total teams.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament) WITH tour, t MATCH (p:Person)-[:REPRESENTS]->(t) WITH tour, t, COUNT(p) AS playerCount WITH tour, AVG(playerCount) AS avgPlayersPerTeam, COUNT(t) AS totalTeams RETURN tour.name AS tournamentName, avgPlayersPerTeam, totalTeams",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 347,
        "original_index": 347,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_226",
        "NL Question": "For each tournament, determine the average number of goals scored per match and the total number of matches played. Return the tournament's name, average goals per match, and total matches played.",
        "Cypher": "MATCH (m:Match)-[:IN_TOURNAMENT]->(tour:Tournament) OPTIONAL MATCH (:Person)-[sg:SCORED_GOAL]->(m) WITH tour, m, COUNT(sg) AS matchGoals WITH tour, SUM(matchGoals) AS totalGoals, COUNT(m) AS totalMatches RETURN tour.name AS tournamentName, CASE WHEN totalMatches > 0 THEN toFloat(totalGoals) / totalMatches ELSE 0 END AS avgGoalsPerMatch, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 348,
        "original_index": 348,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_227",
        "NL Question": "For each squad, calculate the average number of goals scored by players in matches and the total number of players in the squad. Return the squad ID, average goals per player, and total players.",
        "Cypher": "MATCH (s:Squad)<-[:IN_SQUAD]-(p:Person) OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(:Match) WITH s, p, COUNT(sg) AS goalsPerPlayer WITH s, COUNT(DISTINCT p) AS totalPlayers, AVG(goalsPerPlayer) AS avgGoalsPerPlayer RETURN s.id AS squadId, avgGoalsPerPlayer, totalPlayers",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 349,
        "original_index": 349,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_228",
        "NL Question": "For each tournament, find the average age of players who played in matches and the total number of matches played. Return the tournament name, average player age, and total matches.",
        "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament) WHERE p.dob IS NOT NULL WITH tour, p, m, tour.year - p.dob.year AS playerAge WITH tour, AVG(playerAge) AS avgPlayerAge, COUNT(DISTINCT m) AS totalMatches RETURN tour.name AS tournamentName, avgPlayerAge, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 350,
        "original_index": 350,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_231",
        "NL Question": "For each tournament, calculate the total number of matches and the average number of goals scored per match. Return the tournament name, total matches, and average goals per match.",
        "Cypher": "MATCH (m:Match)-[:IN_TOURNAMENT]->(tour:Tournament) OPTIONAL MATCH (:Person)-[sg:SCORED_GOAL]->(m) WITH tour, m, COUNT(sg) AS matchGoals WITH tour, SUM(matchGoals) AS totalGoals, COUNT(m) AS totalMatches RETURN tour.name AS tournamentName, totalMatches, CASE WHEN totalMatches > 0 THEN toFloat(totalGoals) / totalMatches ELSE 0 END AS avgGoalsPerMatch;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 351,
        "original_index": 351,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_232",
        "NL Question": "For each team that participated in the 'France 2019' tournament, determine the total number of matches they played and the average number of goals scored in those matches. Return the team name, total matches played, and average goals per match.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'France 2019'}) MATCH (t)-[r:PLAYED_IN]->(m:Match) WHERE r.score IS NOT NULL WITH t, COUNT(m) AS matchCount, SUM(r.score) AS totalGoals RETURN t.name AS teamName, matchCount AS totalMatches, toFloat(totalGoals)/matchCount AS avgGoalsPerMatch;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 352,
        "original_index": 352,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_234",
        "NL Question": "For each player who played in a match during the 'China 2007' tournament, determine the total number of goals they scored and the average time (in minutes) when they scored a goal. Return the player's name, total goals, and average goal time.",
        "Cypher": "MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'China 2007'}) WITH p, m, sg WHERE sg.minute IS NOT NULL WITH p, COLLECT(toFloat(replace(sg.minute, \"'\", ''))) AS goalTimes, COUNT(sg) AS totalGoals RETURN p.name AS playerName, totalGoals, avg(goalTimes) AS averageGoalTime;",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "You cannot pass a list (goalTimes) directly to avg(). avg() expects a stream of numbers, not a list."
    },
    {
        "id": 353,
        "original_index": 353,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_235",
        "NL Question": "For each team, calculate the total number of players who represent them and the average age of those players. Return the team name, total player count, and average age.",
        "Cypher": "MATCH (p:Person)-[:REPRESENTS]->(t:Team) WHERE p.dob IS NOT NULL WITH t, p, date() - date(p.dob) AS ageInDays WITH t, p, ageInDays.years AS ageInYears WITH t, COUNT(DISTINCT p) AS totalPlayers, AVG(ageInYears) AS averageAge RETURN t.name AS teamName, totalPlayers, averageAge;",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "date() - date(p.dob) is not the correct way to calculate difference betweeen two dates in Cypher. You should use duration.between() or similar functions to get the age in years."
    },
    {
        "id": 354,
        "original_index": 354,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_238",
        "NL Question": "For each team that participated in the tournament 'China 2007', calculate the average number of goals scored by its players across all matches. Return the team name and the average goals scored.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'China 2007'}) MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match) WHERE (p)-[:REPRESENTS]->(t) WITH t, p, COUNT(sg) AS goalsPerPlayer WITH t, AVG(goalsPerPlayer) AS avgGoalsPerPlayer RETURN t.name AS teamName, avgGoalsPerPlayer",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 355,
        "original_index": 355,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_239",
        "NL Question": "For each tournament, determine the average number of teams that participated and the total number of matches played. Return the tournament name, average team count, and total match count.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament) WITH tour, t MATCH (t)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour) WITH tour,COUNT(DISTINCT t) AS teamCount, COUNT(DISTINCT m) AS matchCount RETURN tour.name AS tournamentName, avg(teamCount) AS avgTeamCount, SUM(matchCount) AS totalMatchCount",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 356,
        "original_index": 356,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_240",
        "NL Question": "For each player who played in a match during the 'Canada 2015' tournament, calculate the total number of goals they scored and the average time (in minutes) at which they scored their goals. Return the player's name, total goals, and average scoring minute.",
        "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'Canada 2015'}) OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m) WITH p, m,sg,toFloat(replace(sg.minute, '''','')) AS minute where sg.minute is not null WITH p, COUNT(sg) AS totalGoals, AVG(minute) AS avgScoringMinute RETURN p.name AS playerName, totalGoals, avgScoringMinute",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "You're using sg.minute before checking if sg is null, which can cause errors.You're using sg even if the OPTIONAL MATCH didn't succeed, which leads to potential nulls."
    },
    {
        "id": 357,
        "original_index": 357,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_241",
        "NL Question": "For each team, calculate the total number of players who represent them and the average number of matches each player has played. Return the team name, total player count, and average matches per player.",
        "Cypher": "MATCH (t:Team)<-[:REPRESENTS]-(p:Person) WITH t, COUNT(DISTINCT p) AS totalPlayers OPTIONAL MATCH (p)-[:PLAYED_IN]->(m:Match) WITH t, totalPlayers, COUNT(DISTINCT m) AS matchesPlayedPerPlayer RETURN t.name AS teamName, totalPlayers, CASE WHEN totalPlayers = 0 THEN 0 ELSE toFloat(matchesPlayedPerPlayer) / totalPlayers END AS avgMatchesPerPlayer",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 358,
        "original_index": 358,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_242",
        "NL Question": "For the 'China 2007' tournament, determine the average number of goals scored per match and the average number of players participating in each match. Return the tournament name, average goals per match, and average players per match.",
        "Cypher": "MATCH (tour:Tournament {name: 'China 2007'})<-[:IN_TOURNAMENT]-(m:Match) OPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m) WITH tour, m, COUNT(sg) AS goalsPerMatch OPTIONAL MATCH (p:Person)-[:PLAYED_IN]->(m) WITH tour, m, goalsPerMatch, COUNT(DISTINCT p) AS playersPerMatch WITH tour, AVG(goalsPerMatch) AS avgGoalsPerMatch, AVG(playersPerMatch) AS avgPlayersPerMatch RETURN tour.name AS tournamentName, avgGoalsPerMatch, avgPlayersPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 359,
        "original_index": 359,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_245",
        "NL Question": "For each tournament, calculate the average number of goals scored per match and the total number of matches played. Return the tournament name, the average goals per match, and the total matches.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)\nOPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m)\nWITH tour, m, COUNT(sg) AS goals\nWITH tour, COUNT(m) AS totalMatches, SUM(goals) AS totalGoals\nRETURN tour.name AS tournamentName, toFloat(totalGoals) / totalMatches AS avgGoalsPerMatch, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 360,
        "original_index": 360,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_246",
        "NL Question": "For each team, calculate the total number of matches played and the average number of goals scored by players of that team per match. Return the team name, total matches, and average goals per match.",
        "Cypher": "MATCH (t:Team)-[:PLAYED_IN]->(m:Match)\nOPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m)\nWHERE (p)-[:REPRESENTS]->(t)\nWITH t, m, COUNT(sg) AS goals\nWITH t, COUNT(m) AS totalMatches, SUM(goals) AS totalGoals\nRETURN t.name AS teamName, totalMatches, toFloat(totalGoals) / totalMatches AS avgGoalsPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 361,
        "original_index": 361,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_247",
        "NL Question": "For each player who played in a match, find the average score in matches where they played and the total number of matches they played. Return the player's name, average score, and total matches played.",
        "Cypher": "MATCH (p:Person)-[r:PLAYED_IN]->(m:Match)\nWHERE r.score IS NOT NULL\nWITH p, COUNT(m) AS totalMatches, AVG(toInt(r.score)) AS avgScore\nRETURN p.name AS playerName, avgScore, totalMatches",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "grammatical error: toInt() function"
    },
    {
        "id": 362,
        "original_index": 362,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_248",
        "NL Question": "For each tournament, determine the team that scored the highest total goals and calculate the average goals scored by that team across all matches in the tournament. Return the tournament name, team name, total goals scored by the team, and the average goals per match for that team.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[:PLAYED_IN]-(t:Team)\nOPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m)\nWHERE (p)-[:REPRESENTS]->(t)\nWITH tour, t, m, COUNT(sg) AS goals\nWITH tour, t, SUM(goals) AS totalGoals, COUNT(m) AS totalMatches\nORDER BY tour.name, totalGoals DESC\nWITH tour, COLLECT({team: t, totalGoals: totalGoals, totalMatches: totalMatches}) AS teamScores\nRETURN tour.name AS tournamentName, teamScores[0].team.name AS winningTeam, teamScores[0].totalGoals AS totalGoals, toFloat(teamScores[0].totalGoals) / teamScores[0].totalMatches AS avgGoalsPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 363,
        "original_index": 363,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_249",
        "NL Question": "For each team that participated in the 'Sweden 1995' tournament, calculate the average number of goals scored per match and the total number of players who scored at least one goal. Return the team's name, the average goals per match, and the total number of goal-scoring players.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'Sweden 1995'}) \nMATCH (t)-[:PLAYED_IN]->(m:Match)<-[sg:SCORED_GOAL]-(p:Person)\nWHERE (p)-[:REPRESENTS]->(t)\nWITH t, m, p, COUNT(sg) AS goalsPerPlayer\nWHERE goalsPerPlayer > 0\nWITH t, m, COUNT(DISTINCT p) AS goalScorers\nWITH t, COUNT(m) AS totalMatches, SUM(goalScorers) AS totalGoalScorers\nRETURN t.name AS teamName, toFloat(totalGoalScorers) / totalMatches AS avgGoalsPerMatch, totalGoalScorers",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 364,
        "original_index": 364,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_252",
        "NL Question": "For each team, calculate the average number of goals scored per match they played in and the total number of matches they participated in. Return the team name, average goals per match, and total matches.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match) WHERE r.score IS NOT NULL WITH t, m, r.score AS scorePerMatch WITH t, COUNT(m) AS totalMatches, AVG(toFloat(scorePerMatch)) AS avgGoalsPerMatch RETURN t.name AS teamName, avgGoalsPerMatch, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 365,
        "original_index": 365,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_253",
        "NL Question": "For the 'Sweden 1995' tournament, determine the average age of all players who participated in matches and the total number of matches played. Return the average age and the total matches.",
        "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament {name: 'Sweden 1995'}) WHERE p.dob IS NOT NULL WITH p, m, t.year AS tournamentYear RETURN avg(tournamentYear - p.dob.year) AS averageAge, count(DISTINCT m) AS totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 366,
        "original_index": 366,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_254",
        "NL Question": "For each team that participated in the 'Sweden 1995' tournament, find the average number of players in their squads and the total number of goals scored by the team's players across all matches. Return the team name, average squad size, and total goals.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'Sweden 1995'}) MATCH (t)-[:NAMED]->(s:Squad)<-[:IN_SQUAD]-(p:Person) OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m:Match) WHERE t-[:PLAYED_IN]->m WITH t, COUNT(DISTINCT p) AS squadSize, SUM(CASE WHEN sg IS NOT NULL THEN 1 ELSE 0 END) AS totalGoals RETURN t.name AS teamName, AVG(squadSize) AS avgSquadSize, totalGoals",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "Your Cypher query is mostly correct in structure, but the issue is with how you're aggregating squadSize and computing AVG(squadSize) â€” because you're collecting only one value per team, AVG(squadSize) returns just that single number (or errors out). Also, the WHERE t-[:PLAYED_IN]->m clause is invalid â€” WHERE cannot contain a pattern match."
    },
    {
        "id": 367,
        "original_index": 367,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_256",
        "NL Question": "For each player, determine the number of tournaments they played in and the average number of goals they scored per tournament. Return the player's name, total tournaments played, and average goals per tournament.",
        "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament) OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m) WITH p, tour, COUNT(sg) AS goalsPerTournament WITH p, COLLECT(DISTINCT tour.id) AS tournaments, AVG(goalsPerTournament) AS avgGoalsPerTournament RETURN p.name AS playerName, SIZE(tournaments) AS tournamentsPlayed, avgGoalsPerTournament",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 368,
        "original_index": 368,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_259",
        "NL Question": "For each tournament, calculate the average number of goals scored per match and the total number of teams that participated. Return the tournament name, average goals per match, and total teams.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament) \nOPTIONAL MATCH (m:Match)-[:IN_TOURNAMENT]->(tour)<-[:PLAYED_IN]-(team:Team) \nOPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m) \nWITH tour, COUNT(DISTINCT t) AS totalTeams, m, COUNT(sg) AS goalsPerMatch\nWITH tour, totalTeams, AVG(goalsPerMatch) AS avgGoalsPerMatch\nRETURN tour.name AS tournamentName, avgGoalsPerMatch, totalTeams",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 369,
        "original_index": 369,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_260",
        "NL Question": "For each team, find the total number of matches they played in and the average number of goals scored by players representing that team across all matches. Return the team name, total matches, and average goals per player.",
        "Cypher": "MATCH (t:Team)-[:PLAYED_IN]->(m:Match)\nOPTIONAL MATCH (p:Person)-[:REPRESENTS]->(t)-[:PLAYED_IN]->(m) \nOPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m)\nWITH t, COUNT(DISTINCT m) AS totalMatches, COUNT(sg) AS totalGoals\nWITH t, totalMatches, AVG(totalGoals) AS avgGoalsPerPlayer\nRETURN t.name AS teamName, totalMatches, avgGoalsPerPlayer",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 370,
        "original_index": 370,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_261",
        "NL Question": "For each player born before '1980-01-01', calculate the total number of goals they scored and the average number of matches they played in each tournament. Return the player's name, total goals, and average matches per tournament.",
        "Cypher": "MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament)\nWHERE date(p.dob) < date('1980-01-01')\nWITH p, tour, COUNT(DISTINCT m) AS matchesPerTournament, COUNT(sg) AS totalGoals\nWITH p, AVG(matchesPerTournament) AS avgMatchesPerTournament, SUM(totalGoals) AS totalGoals\nRETURN p.name AS playerName, totalGoals, avgMatchesPerTournament",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 371,
        "original_index": 371,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_262",
        "NL Question": "For each tournament held after the year 2000, determine the average number of players per squad and the total number of matches played. Return the tournament name, average players per squad, and total matches.",
        "Cypher": "MATCH (tour:Tournament)<-[:FOR]-(s:Squad)<-[:IN_SQUAD]-(p:Person)\nWHERE tour.year > 2000\nWITH tour, COUNT(DISTINCT p) AS playersPerSquad\nWITH tour, AVG(playersPerSquad) AS avgPlayersPerSquad\nOPTIONAL MATCH (m:Match)-[:IN_TOURNAMENT]->(tour)\nWITH tour, avgPlayersPerSquad, COUNT(DISTINCT m) AS totalMatches\nRETURN tour.name AS tournamentName, avgPlayersPerSquad, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 372,
        "original_index": 372,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_263",
        "NL Question": "For each team that participated in the 'Germany 2011' tournament, calculate the total number of goals scored and the average number of players who scored those goals. Return the team name, total goals, and average scorers.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'Germany 2011'})<-[:IN_TOURNAMENT]-(m:Match)<-[sg:SCORED_GOAL]-(p:Person)\nWHERE (p)-[:REPRESENTS]->(t)\nWITH t, COUNT(sg) AS totalGoals, COUNT(DISTINCT p) AS scorers\nWITH t, totalGoals, AVG(scorers) AS avgScorers\nRETURN t.name AS teamName, totalGoals, avgScorers",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 373,
        "original_index": 373,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_266",
        "NL Question": "For each team that participated in the 'China PR 1991' tournament, calculate the total number of matches they played and the average score in those matches. Return the team name, total matches, and average score.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'China PR 1991'}) WHERE r.score IS NOT NULL WITH t, COUNT(m) AS totalMatches, AVG(r.score) AS averageScore RETURN t.name AS teamName, totalMatches, averageScore",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 374,
        "original_index": 374,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_267",
        "NL Question": "For each tournament, find the average number of players per squad and the total number of goals scored by players in those squads. Return the tournament name, average players per squad, and total goals scored.",
        "Cypher": "MATCH (tour:Tournament)<-[:FOR]-(s:Squad)<-[:IN_SQUAD]-(p:Person) OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(tour) WITH tour, s, p, COUNT(sg) AS goalsPerPlayerPerPerson WITH tour, s, COUNT(DISTINCT p) AS playersPerSquad, SUM(goalsPerPlayerPerPerson) AS totalGoalsPerSquad WITH tour, AVG(playersPerSquad) AS avgPlayersPerSquad, SUM(totalGoalsPerSquad) AS totalGoals RETURN tour.name AS tournamentName, avgPlayersPerSquad, totalGoals",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 375,
        "original_index": 375,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_268",
        "NL Question": "For each player, calculate the total number of matches they played and the total number of goals they scored. Then, find the average number of goals scored per match for players who have played more than one match. Return the player's name and the average goals per match.",
        "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match) WITH p, COUNT(m) AS totalMatches OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m2:Match) WITH p, totalMatches, COUNT(sg) AS totalGoals WHERE totalMatches > 1 RETURN p.name AS playerName, CASE WHEN totalMatches > 0 THEN toFloat(totalGoals) / totalMatches ELSE 0 END AS avgGoalsPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 376,
        "original_index": 376,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_269",
        "NL Question": "For each team, determine the number of players who represent them and calculate the average number of matches played by those players. Return the team name, the number of representing players, and the average matches played by those players.",
        "Cypher": "MATCH (p:Person)-[:REPRESENTS]->(t:Team) WITH t, COUNT(DISTINCT p) AS numPlayers OPTIONAL MATCH (p)-[:PLAYED_IN]->(m:Match) WITH t, numPlayers, COUNT(DISTINCT m) AS totalMatchesPerPlayer WHERE numPlayers > 0 RETURN t.name AS teamName, numPlayers, CASE WHEN numPlayers > 0 THEN toFloat(totalMatchesPerPlayer) / numPlayers ELSE 0 END AS avgMatchesPerPlayer",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 377,
        "original_index": 377,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_270",
        "NL Question": "For the 'China PR 1991' tournament, find the average age of the players who scored goals and the total number of goals scored by those players. Return the average age and total goals.",
        "Cypher": "MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'China PR 1991'}) WHERE p.dob IS NOT NULL WITH p, tour, sg.minute AS goalMinute, tour.year - p.dob.year AS playerAge WITH AVG(playerAge) AS averageAge, COUNT(goalMinute) AS totalGoals RETURN averageAge, totalGoals",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 378,
        "original_index": 378,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_273",
        "NL Question": "For the 'Canada 2015' tournament, what is the average number of goals scored per match, considering only matches where goals were actually scored?",
        "Cypher": "MATCH (tour:Tournament {name: 'Canada 2015'})<-[:IN_TOURNAMENT]-(m:Match)<-[sg:SCORED_GOAL]-(:Person) WITH tour, m, COUNT(sg) AS goalsPerMatch WHERE goalsPerMatch > 0 WITH tour, AVG(goalsPerMatch) AS avgGoalsPerMatch RETURN tour.name AS tournamentName, avgGoalsPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 379,
        "original_index": 379,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_274",
        "NL Question": "For each team that participated in a tournament, calculate the total number of matches they played and the average score in those matches. Return the team name, total matches, and average score.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match) WITH t, COUNT(m) AS matchCount, SUM(toInt(r.score)) AS totalScore RETURN t.name AS teamName, matchCount AS totalMatches, CASE WHEN matchCount > 0 THEN toFloat(totalScore) / matchCount ELSE 0 END AS avgScore",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "grammatical error: toInt() function"
    },
    {
        "id": 380,
        "original_index": 380,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_275",
        "NL Question": "For each tournament, find the team with the highest average score across all matches they played in that tournament. Return the tournament name, the team name, and the average score.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[r:PLAYED_IN]-(t:Team) WITH tour, t, AVG(toInt(r.score)) AS avgScore ORDER BY tour.name, avgScore DESC WITH tour, COLLECT({team: t.name, avgScore: avgScore}) AS teamScores RETURN tour.name AS tournamentName, teamScores[0].team AS teamName, teamScores[0].avgScore AS avgScore",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "grammatical error: toInt() function"
    },
    {
        "id": 381,
        "original_index": 381,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_276",
        "NL Question": "For each person who scored a goal in a match, find the average number of goals they scored per match in the 'Canada 2015' tournament. Return the person's name and their average goals per match.",
        "Cypher": "MATCH (tour:Tournament {name: 'Canada 2015'})<-[:IN_TOURNAMENT]-(m:Match)<-[sg:SCORED_GOAL]-(p:Person) WITH p, m, COUNT(sg) AS goalsPerMatch WITH p, AVG(goalsPerMatch) AS avgGoalsPerMatch RETURN p.name AS playerName, avgGoalsPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 382,
        "original_index": 382,
        "source_dataset": "wwc",
        "source_chunk": "data_3_2_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_277",
        "NL Question": "For each team, calculate the number of players who represent the team and the average number of goals scored by those players in all matches. Return the team name, the number of players, and the average goals scored per player.",
        "Cypher": "MATCH (t:Team)<-[:REPRESENTS]-(p:Person)-[sg:SCORED_GOAL]->(m:Match) WITH t, p, COUNT(sg) AS goalsPerPlayer WITH t, COUNT(DISTINCT p) AS playerCount, AVG(goalsPerPlayer) AS avgGoalsPerPlayer RETURN t.name AS teamName, playerCount, avgGoalsPerPlayer",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 383,
        "original_index": 383,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_0",
        "NL Question": "For each tournament, calculate the total number of teams that participated and the average number of players per team who scored goals. Return the tournament name, total teams, and average goals per player.",
        "Cypher": "MATCH (tour:Tournament)<-[:PARTICIPATED_IN]-(t:Team) WITH tour, t MATCH (t)-[:PLAYED_IN]->(m:Match)<-[:SCORED_GOAL]-(p:Person) WITH tour, t, COUNT(DISTINCT p) AS playersPerTeam WITH tour, COUNT(DISTINCT t) AS totalTeams, AVG(playersPerTeam) AS avgPlayersPerTeam RETURN tour.name AS tournamentName, totalTeams, avgPlayersPerTeam",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 384,
        "original_index": 384,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_1",
        "NL Question": "For each team, determine the total number of matches played and the average number of goals scored per match where the score is available. Return the team's name, total matches played, and average goals scored.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match) WHERE r.score IS NOT NULL WITH t, COUNT(m) AS matchCount, SUM(r.score) AS totalGoals RETURN t.name AS teamName, matchCount AS totalMatches, toFloat(totalGoals)/matchCount AS avgGoalsPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 385,
        "original_index": 385,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_2",
        "NL Question": "For the 'France 2019' tournament, find the average number of goals scored by each team in the 'First Stage' matches. Return the team name and the average goals scored.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'France 2019'}) WHERE m.stage = 'First Stage' WITH t, m,r WHERE r.score IS NOT NULL WITH t, AVG(r.score) AS avgGoals RETURN t.name AS teamName, avgGoals",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 386,
        "original_index": 386,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_3",
        "NL Question": "For each person who played in a match, calculate the total number of goals they scored and the total number of matches they played. Then, determine the average goals scored per match for each player. Return the player's name, the total matches played, and the average goals per match.",
        "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match) WITH p, COUNT(DISTINCT m) AS totalMatches OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m2:Match) WITH p, totalMatches, COUNT(sg) AS totalGoals RETURN p.name AS playerName, totalMatches, CASE WHEN totalMatches = 0 THEN 0 ELSE toFloat(totalGoals)/totalMatches END AS avgGoalsPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 387,
        "original_index": 387,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_4",
        "NL Question": "For each tournament, find the average number of goals scored per match and the total number of players who scored at least one goal. Return the tournament name, average goals per match, and total number of scoring players.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match) OPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m) WITH tour, m, COUNT(sg) AS matchGoals, COLLECT(DISTINCT p) AS playersPerMatch WITH tour, SUM(matchGoals) AS totalGoals, COUNT(m) AS totalMatches, SIZE(apoc.coll.toSet(REDUCE (s = [], p IN playersPerMatch | s + p.id))) AS totalScoringPlayers RETURN tour.name AS tournamentName, CASE WHEN totalMatches > 0 THEN toFloat(totalGoals) / totalMatches ELSE 0 END AS avgGoalsPerMatch, totalScoringPlayers",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 388,
        "original_index": 388,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_7",
        "NL Question": "For the 'USA 1999' tournament, calculate the average number of players per squad and the total number of players across all squads. Return the tournament name, average players per squad, and total players.",
        "Cypher": "MATCH (t:Tournament {name: 'USA 1999'})<-[:FOR]-(s:Squad)<-[:IN_SQUAD]-(p:Person) WITH t, s, COUNT(p) AS playerCountPerSquad WITH t, AVG(playerCountPerSquad) AS avgPlayersPerSquad, SUM(playerCountPerSquad) AS totalPlayersInTournament RETURN t.name AS tournamentName, avgPlayersPerSquad, totalPlayersInTournament",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 389,
        "original_index": 389,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_8",
        "NL Question": "For each team, calculate the total number of matches they played and the average score in those matches. Return the team name, total matches played, and average score.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match) WITH t, COUNT(m) AS totalMatches, AVG(toInt(r.score)) AS avgScore RETURN t.name AS teamName, totalMatches, avgScore",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "grammatical error: toInt() function"
    },
    {
        "id": 390,
        "original_index": 390,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_10",
        "NL Question": "For each tournament, find the team with the highest average 'score' in the PLAYED_IN relationships. Return the tournament name, team name, and the highest average score.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament) WITH tour, t, AVG(toInt(r.score)) AS avgScorePerTeam ORDER BY tour.name, avgScorePerTeam DESC WITH tour, COLLECT({team: t, avgScore: avgScorePerTeam}) AS teamScores RETURN tour.name AS tournamentName, teamScores[0].team.name AS teamName, teamScores[0].avgScore AS highestAvgScore",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "grammatical error: toInt() function"
    },
    {
        "id": 391,
        "original_index": 391,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_11",
        "NL Question": "For each tournament, calculate the average age of the players who played in it, considering their date of birth. Return the tournament name and the average player age.",
        "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament) WHERE p.dob IS NOT NULL WITH tour, p, tour.year - p.dob.year AS playerAge WITH tour, AVG(playerAge) AS avgPlayerAge RETURN tour.name AS tournamentName, avgPlayerAge",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 392,
        "original_index": 392,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_15",
        "NL Question": "For each team, determine the total number of matches they played and the average number of goals scored in those matches where the score is available. Return the team name, total matches, and average goal score.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match) WHERE r.score IS NOT NULL WITH t, COUNT(m) AS totalMatches, SUM(r.score) AS totalScore RETURN t.name AS teamName, totalMatches, CASE WHEN totalMatches > 0 THEN toFloat(totalScore) / totalMatches ELSE 0 END AS avgScore",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 393,
        "original_index": 393,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_16",
        "NL Question": "For the tournament 'China 2007', calculate the average age of players who scored goals and the total number of goals scored. Return the average age and the total goals.",
        "Cypher": "MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament {name: 'China 2007'}) WHERE p.dob IS NOT NULL WITH p, t, sg MATCH (p)-[sg:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament {name: 'China 2007'}) WITH avg(t.year - p.dob.year) AS avgAge, count(sg) as totalGoals return avgAge, totalGoals",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 394,
        "original_index": 394,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_17",
        "NL Question": "For each squad, determine the average age of players and the total number of matches played by players in that squad. Return the squad ID, average player age, and total matches played.",
        "Cypher": "MATCH (s:Squad)<-[:IN_SQUAD]-(p:Person) WHERE p.dob IS NOT NULL WITH s, p, p.dob AS birthDate MATCH (s:Squad)<-[:IN_SQUAD]-(p:Person)-[:PLAYED_IN]->(m:Match) WITH s, avg(date().year - birthDate.year) AS avgAge, count(m) AS totalMatches RETURN s.id AS squadId, avgAge, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 395,
        "original_index": 395,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_18",
        "NL Question": "For each team that participated in the tournament 'China 2007', calculate the average number of goals scored by players representing that team and the total number of players representing that team. Return the team name, average goals per player, and total players.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'China 2007'}) MATCH (p:Person)-[:REPRESENTS]->(t)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'China 2007'}) OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'China 2007'}) WITH t, p, COUNT(sg) AS goalsPerPlayer WITH t, AVG(goalsPerPlayer) AS avgGoalsPerPlayer, COUNT(DISTINCT p) AS totalPlayers RETURN t.name AS teamName, avgGoalsPerPlayer, totalPlayers",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 396,
        "original_index": 396,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_21",
        "NL Question": "For each team that participated in the 'France 2019' tournament, calculate the average number of goals scored by their players across all matches in that tournament. Return the team name and their average goals per match.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'France 2019'}) MATCH (t)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour) OPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m) WHERE (p)-[:REPRESENTS]->(t) WITH t, m, COUNT(sg) AS goalsPerMatchPerTeam WITH t, AVG(goalsPerMatchPerTeam) AS avgGoalsPerMatchPerTeam RETURN t.name AS teamName, avgGoalsPerMatchPerTeam",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 397,
        "original_index": 397,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_23",
        "NL Question": "For each team, calculate the total number of goals scored by all players representing that team in all matches and the average number of minutes played by those players. Return the team name, total goals scored, and average minutes played.",
        "Cypher": "MATCH (t:Team)<-[:REPRESENTS]-(p:Person)-[pi:PLAYED_IN]->(m:Match) OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m) WITH t, p, pi, COUNT(sg) AS goalsPerPlayer, toInteger(replace(pi.minuteOn, \"'\", '')) AS minuteOn WHERE minuteOn IS NOT NULL WITH t, SUM(goalsPerPlayer) AS totalGoals, AVG(minuteOn) AS avgMinutesPlayed RETURN t.name AS teamName, totalGoals, avgMinutesPlayed",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 398,
        "original_index": 398,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_24",
        "NL Question": "For each tournament, determine the team with the highest average score in matches and return the tournament name, team name, and the average score achieved by that team.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[r:PLAYED_IN]-(t:Team) WHERE r.score IS NOT NULL WITH tour, t, AVG(r.score) AS avgScore ORDER BY tour.name, avgScore DESC WITH tour, COLLECT({team: t, avgScore: avgScore}) AS teamScores RETURN tour.name AS tournamentName, teamScores[0].team.name AS teamName, teamScores[0].avgScore AS averageScore",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 399,
        "original_index": 399,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_25",
        "NL Question": "For each player who scored a goal in a match during the 'France 2019' tournament, calculate the average number of goals they scored per match in that tournament. Return the player's name and their average goals per match, sorted by the average in descending order.",
        "Cypher": "MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'France 2019'}) WITH p, m, COUNT(sg) AS goalsPerMatch WHERE goalsPerMatch > 0 WITH p, AVG(goalsPerMatch) AS avgGoalsPerMatch RETURN p.name AS playerName, avgGoalsPerMatch ORDER BY avgGoalsPerMatch DESC",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 400,
        "original_index": 400,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_28",
        "NL Question": "For each team that participated in the 'Germany 2011' tournament, calculate the total number of matches they played and the average number of goals scored in those matches. Return the team name, total matches, and average goals per match.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'Germany 2011'}) MATCH (t)-[r:PLAYED_IN]->(m:Match) WITH t, COUNT(m) AS matchCount, SUM(r.score) AS totalGoals RETURN t.name AS teamName, matchCount AS totalMatches, CASE WHEN matchCount > 0 THEN toFloat(totalGoals) / matchCount ELSE 0 END AS avgGoalsPerMatch;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 401,
        "original_index": 401,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_29",
        "NL Question": "For each person, find the total number of tournaments they participated in and the average number of matches they played per tournament. Return the person's name, the total number of tournaments, and the average matches per tournament.",
        "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament) WITH p, t, COUNT(m) AS matchesPerTournament WITH p, COUNT(DISTINCT t) AS totalTournaments, AVG(matchesPerTournament) AS avgMatchesPerTournament RETURN p.name AS personName, totalTournaments, avgMatchesPerTournament;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 402,
        "original_index": 402,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_30",
        "NL Question": "For each tournament, determine the average number of players from each team participating in the tournament. Return the tournament name and the average number of players per team.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament) MATCH (p:Person)-[:REPRESENTS]->(t) WITH tour, t, COUNT(DISTINCT p) AS playersPerTeam WITH tour, AVG(playersPerTeam) AS avgPlayersPerTeam RETURN tour.name AS tournamentName, avgPlayersPerTeam;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 403,
        "original_index": 403,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_31",
        "NL Question": "For each tournament, calculate the total number of goals scored by all players and the average age of the players who scored those goals. Return the tournament name, total goals scored, and average player age.",
        "Cypher": "MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament) WHERE p.dob IS NOT NULL WITH tour, p, COUNT(sg) AS goalsPerPlayer, tour.year - p.dob.year AS playerAge WITH tour, SUM(goalsPerPlayer) AS totalGoals, AVG(playerAge) AS avgPlayerAge RETURN tour.name AS tournamentName, totalGoals, avgPlayerAge;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 404,
        "original_index": 404,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_32",
        "NL Question": "For each team, calculate the total number of matches they played since the year 2000 and the average number of goals scored per match in those matches. Return the team name, total matches played, and average goals per match.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match) WHERE m.date.year >= 2000 WITH t, m, r.score AS score WHERE score IS NOT NULL WITH t, COUNT(m) AS matchCount, SUM(score) AS totalGoals RETURN t.name AS teamName, matchCount AS totalMatches, CASE WHEN matchCount > 0 THEN toFloat(totalGoals) / matchCount ELSE 0 END AS avgGoalsPerMatch;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 405,
        "original_index": 405,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_35",
        "NL Question": "For each team, calculate the average number of goals scored in matches they played and the total number of matches they participated in. Return the team name, average goals per match, and total matches played.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match) WITH t, m, r.score AS score WHERE score IS NOT NULL WITH t, COUNT(m) AS totalMatches, COLLECT(score) AS scores RETURN t.name AS teamName, toFloat(SUM(toFloat(head(scores))))/totalMatches AS avgGoalsPerMatch, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 406,
        "original_index": 406,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_36",
        "NL Question": "For each tournament, find the average number of goals scored per match and the total number of teams that participated. Return the tournament name, average goals per match, and total participating teams.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match) OPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m) WITH tour, m, COUNT(sg) AS matchGoals MATCH (t:Team)-[:PARTICIPATED_IN]->(tour) WITH tour, m, matchGoals, COUNT(DISTINCT t) AS totalTeams RETURN tour.name AS tournamentName, toFloat(SUM(matchGoals))/COUNT(DISTINCT m) AS avgGoalsPerMatch, totalTeams",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 407,
        "original_index": 407,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_37",
        "NL Question": "For each person, determine the total number of matches they played in and the average 'score' value across all 'PLAYED_IN' relationships. Return the person's name, total matches played, and average score.",
        "Cypher": "MATCH (p:Person)-[r:PLAYED_IN]->(m:Match) WITH p, COUNT(m) AS totalMatches, COLLECT(r.score) AS scores RETURN p.name AS personName, totalMatches, toFloat(SUM(toFloat(head(scores))))/totalMatches AS averageScore",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 408,
        "original_index": 408,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_38",
        "NL Question": "For each tournament, calculate the total number of matches and the average number of teams participating in each match. Return the tournament's name, total matches, and average teams per match.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[:PLAYED_IN]-(t:Team) WITH tour, m, COUNT(DISTINCT t) AS teamsPerMatch WITH tour, COUNT(DISTINCT m) AS totalMatches, AVG(teamsPerMatch) AS avgTeamsPerMatch RETURN tour.name AS tournamentName, totalMatches, avgTeamsPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 409,
        "original_index": 409,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_39",
        "NL Question": "For each team that participated in the 'USA 2003' tournament, find the average number of goals scored by their players in each match and the total number of players in the team. Return the team name, average goals per match, and total players.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'USA 2003'}) MATCH (p:Person)-[:REPRESENTS]->(t)-[:PLAYED_IN]->(m:Match) OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m) WITH t, m, COUNT(sg) AS goalsPerMatch, p MATCH (p)-[:REPRESENTS]->(t) WITH t, AVG(goalsPerMatch) AS avgGoalsPerMatch, COUNT(DISTINCT p) AS totalPlayers RETURN t.name AS teamName, avgGoalsPerMatch, totalPlayers",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 410,
        "original_index": 410,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_42",
        "NL Question": "For each tournament, what is the average number of players per team and the total number of teams that participated?",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament) WITH tour, t MATCH (p:Person)-[:REPRESENTS]->(t) WITH tour, t, COUNT(p) AS playerCount WITH tour, AVG(playerCount) AS avgPlayersPerTeam, COUNT(t) AS totalTeams RETURN tour.name AS tournamentName, avgPlayersPerTeam, totalTeams",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 411,
        "original_index": 411,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_43",
        "NL Question": "For each team, calculate the total number of matches played and the average score in those matches. Return the team's name, total matches, and average score.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match) WHERE r.score IS NOT NULL WITH t, COUNT(m) AS totalMatches, SUM(r.score) AS totalScore RETURN t.name AS teamName, totalMatches, toFloat(totalScore) / totalMatches AS averageScore",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 412,
        "original_index": 412,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_44",
        "NL Question": "For each tournament, determine the total number of goals scored and the average number of goals scored per team. Return the tournament name, total goals scored, and average goals per team.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[sg:SCORED_GOAL]-(p:Person) WITH tour, m, COUNT(sg) AS goalsPerMatch MATCH (t:Team)-[:PLAYED_IN]->(m) WITH tour, t, SUM(goalsPerMatch) AS teamGoals WHERE teamGoals IS NOT NULL WITH tour, SUM(teamGoals) AS totalGoals, COUNT(DISTINCT t) AS totalTeams RETURN tour.name AS tournamentName, totalGoals, toFloat(totalGoals) / totalTeams AS averageGoalsPerTeam",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 413,
        "original_index": 413,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_45",
        "NL Question": "For each person, find the total number of matches they played and the average number of goals they scored per match where they played. Return the person's name, total matches, and average goals per match.",
        "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match) WITH p, COUNT(m) AS totalMatches OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m) WITH p, totalMatches, COUNT(sg) AS totalGoals RETURN p.name AS personName, totalMatches, CASE WHEN totalMatches = 0 THEN 0 ELSE toFloat(totalGoals) / totalMatches END AS averageGoalsPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 414,
        "original_index": 414,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_46",
        "NL Question": "For each tournament, what is the average number of goals scored per match, and what is the total number of matches played in that tournament?",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match) OPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m) WITH tour, m, COUNT(sg) AS goalsPerMatch WITH tour, SUM(goalsPerMatch) AS totalGoals, COUNT(m) AS totalMatches RETURN tour.name AS tournamentName, toFloat(totalGoals) / totalMatches AS averageGoalsPerMatch, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 415,
        "original_index": 415,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_50",
        "NL Question": "For each team that participated in a tournament, determine the average number of players in their squads and the total number of goals scored by the team in all matches. Return the team name, average squad size, and total goals scored.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament)\nMATCH (t)-[:NAMED]->(s:Squad)-[:FOR]->(tour)\nOPTIONAL MATCH (p:Person)-[:IN_SQUAD]->(s)\nOPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m:Match)<-[:PLAYED_IN]-(t)\nWITH t, tour, s, COUNT(DISTINCT p) AS squadSize, SUM(CASE WHEN sg IS NOT NULL THEN 1 ELSE 0 END) AS goalsScored\nWITH t, AVG(squadSize) AS avgSquadSize, SUM(goalsScored) AS totalGoals\nRETURN t.name AS teamName, avgSquadSize, totalGoals",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 416,
        "original_index": 416,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_51",
        "NL Question": "For the 'France 2019' tournament, find the average number of goals scored by players who were 'Started' in matches, and also the total number of players who 'Started'. Return the average goals and total players.",
        "Cypher": "MATCH (tour:Tournament {name: 'France 2019'})<-[:IN_TOURNAMENT]-(m:Match)<-[r:PLAYED_IN]-(p:Person)\nWHERE r.type = 'Started'\nOPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m)\nWITH tour, p, COUNT(sg) AS goalsScored\nWITH tour, AVG(goalsScored) AS avgGoals, COUNT(DISTINCT p) AS totalPlayers\nRETURN avgGoals, totalPlayers",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 417,
        "original_index": 417,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_52",
        "NL Question": "For each team, determine the average number of goals scored in matches played in the 'First Stage' and the total number of matches played in that stage. Return the team name, average goals, and total matches.",
        "Cypher": "MATCH (t:Team)-[:PLAYED_IN]->(m:Match {stage: 'First Stage'})\nOPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m)\nWITH t, m, COUNT(sg) AS goalsScored\nWITH t, AVG(goalsScored) AS avgGoals, COUNT(m) AS totalMatches\nRETURN t.name AS teamName, avgGoals, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 418,
        "original_index": 418,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_53",
        "NL Question": "For each tournament, find the average age of the players who participated and the total number of players. Return the tournament name, average age, and total players.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[:PLAYED_IN]-(p:Person)\nWHERE p.dob IS NOT NULL\nWITH tour, p, tour.year - p.dob.year AS playerAge\nWITH tour, AVG(playerAge) AS avgAge, COUNT(DISTINCT p) AS totalPlayers\nRETURN tour.name AS tournamentName, avgAge, totalPlayers",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 419,
        "original_index": 419,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_57",
        "NL Question": "For each team, determine the average number of goals scored in matches they played and the total number of matches they participated in. Return the team's name, the average goals per match, and the total matches played.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match) OPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m) WITH t, m, COUNT(sg) AS matchGoals WITH t, SUM(matchGoals) AS totalGoals, COUNT(m) AS totalMatches RETURN t.name AS teamName, CASE WHEN totalMatches > 0 THEN toFloat(totalGoals) / totalMatches ELSE 0 END AS avgGoalsPerMatch, totalMatches;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 420,
        "original_index": 420,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_58",
        "NL Question": "For each player who played in a match during the 'China 2007' tournament, calculate the total number of goals they scored and the average number of minutes they played per match. Return the player's name, total goals scored, and average minutes played.",
        "Cypher": "MATCH (p:Person)-[pi:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament {name: 'China 2007'}) OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m) WITH p, pi, COUNT(sg) AS totalGoals WHERE pi.minuteOn IS NOT NULL WITH p, totalGoals, COLLECT(toFloat(replace(pi.minuteOn, \"'\", ''))) AS minutes  RETURN p.name AS playerName, totalGoals,  CASE WHEN size(minutes) > 0 THEN avg(minutes) ELSE 0 END AS avgMinutesPlayed",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "Your query is almost correct, but Neo4j Cypher does not support avg() over a COLLECT()ed list directly. The avg() function is used on a stream of values, not on a list like COLLECT(...)."
    },
    {
        "id": 421,
        "original_index": 421,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_59",
        "NL Question": "For each team that participated in the 'Sweden 1995' tournament, find the average number of players in their squads and the total number of goals scored by the team's players across all matches in the tournament. Return the team's name, average squad size, and total goals scored.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'Sweden 1995'}) MATCH (t)-[:NAMED]->(s:Squad)<-[:IN_SQUAD]-(p:Person) OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(tour) WITH t, s, p, COUNT(sg) AS goalsPerPlayer WITH t, s, COUNT(DISTINCT p) AS squadSize, SUM(goalsPerPlayer) AS totalGoalsPerSquad RETURN t.name AS teamName, avg(squadSize) AS avgSquadSize, sum(totalGoalsPerSquad) AS totalGoalsScored",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 422,
        "original_index": 422,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_60",
        "NL Question": "For each tournament, determine the average number of players who scored goals in each match and the total number of teams that participated. Return the tournament name, average players with goals per match, and total teams.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[sg:SCORED_GOAL]-(p:Person) WITH tour, m, collect(DISTINCT p) AS playersWithGoalsPerMatch MATCH (team:Team)-[:PARTICIPATED_IN]->(tour) WITH tour, size(playersWithGoalsPerMatch) as numPlayersWithGoals, count(DISTINCT team) AS totalTeams RETURN tour.name AS tournamentName, avg(numPlayersWithGoals) AS avgPlayersWithGoalsPerMatch, totalTeams",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 423,
        "original_index": 423,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_64",
        "NL Question": "For each team that participated in the 'Canada 2015' tournament, compute the average number of goals scored per match and the total number of matches played. Return the team name, average goals per match, and total matches played.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'Canada 2015'})\nMATCH (t)-[r:PLAYED_IN]->(m:Match)\nWITH t, m, r\nWHERE r.score IS NOT NULL\nWITH t, COUNT(m) AS totalMatches, SUM(r.score) AS totalGoals\nRETURN t.name AS teamName, toFloat(totalGoals) / totalMatches AS avgGoalsPerMatch, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 424,
        "original_index": 424,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_65",
        "NL Question": "For each player born before 1970, determine the number of tournaments they participated in and the average number of goals they scored per tournament. Return the player's name, the number of tournaments, and the average goals per tournament.",
        "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament)\nWHERE p.dob.year < 1970\nOPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m)\nWITH p, tour, COUNT(sg) AS goalsPerTournament\nWITH p, COUNT(DISTINCT tour) AS totalTournaments, AVG(goalsPerTournament) AS avgGoalsPerTournament\nRETURN p.name AS playerName, totalTournaments, avgGoalsPerTournament",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 425,
        "original_index": 425,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_66",
        "NL Question": "For each team, find the average number of players in their squads and the total number of goals scored by all players in those squads. Return the team's name, average squad size, and total goals scored.",
        "Cypher": "MATCH (t:Team)-[:NAMED]->(s:Squad)<-[:IN_SQUAD]-(p:Person)\nOPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m:Match)\nWITH t, s, p, COUNT(sg) AS goalsPerPlayer\nWITH t, s, COUNT(DISTINCT p) AS squadSize, SUM(goalsPerPlayer) AS totalGoals\nWITH t, AVG(squadSize) AS avgSquadSize, SUM(totalGoals) AS totalGoalsScored\nRETURN t.name AS teamName, avgSquadSize, totalGoalsScored",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 426,
        "original_index": 426,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_67",
        "NL Question": "For matches in the 'Canada 2015' tournament, calculate the average number of goals scored per match and the total number of players who played in those matches. Return the average goals per match and total players.",
        "Cypher": "MATCH (m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'Canada 2015'})\nOPTIONAL MATCH (p:Person)-[:PLAYED_IN]->(m)\nOPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m)\nWITH m, COUNT(DISTINCT p) AS totalPlayers, COUNT(sg) AS totalGoals\nWITH AVG(totalGoals) AS avgGoalsPerMatch, SUM(totalPlayers) AS totalPlayersPlayed\nRETURN avgGoalsPerMatch, totalPlayersPlayed",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 427,
        "original_index": 427,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_70",
        "NL Question": "For each team, calculate the total number of matches they played and the average score in those matches. Return the team name, total matches, and average score.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match) WHERE r.score IS NOT NULL WITH t, COUNT(m) AS totalMatches, AVG(r.score) AS averageScore RETURN t.name AS teamName, totalMatches, averageScore",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 428,
        "original_index": 428,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_71",
        "NL Question": "For each tournament, determine the average number of goals scored per match and the total number of teams that participated. Return the tournament name, average goals per match, and the total number of participating teams.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[r:SCORED_GOAL]-(:Person) WITH tour, m, COUNT(r) AS goalsPerMatch MATCH (team:Team)-[:PARTICIPATED_IN]->(tour) WITH tour, AVG(goalsPerMatch) AS avgGoalsPerMatch, COUNT(DISTINCT team) AS totalTeams RETURN tour.name AS tournamentName, avgGoalsPerMatch, totalTeams",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 429,
        "original_index": 429,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_72",
        "NL Question": "For each player who scored goals, calculate the total number of goals they scored and the average number of goals scored per match in the 'Sweden 1995' tournament. Return the player's name, total goals, and average goals per match.",
        "Cypher": "MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament {name: 'Sweden 1995'}) WITH p, m, COUNT(sg) AS goalsPerMatch WITH p, SUM(goalsPerMatch) AS totalGoals, COUNT(DISTINCT m) AS totalMatches RETURN p.name AS playerName, totalGoals, CASE WHEN totalMatches = 0 THEN 0 ELSE toFloat(totalGoals) / totalMatches END AS avgGoalsPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 430,
        "original_index": 430,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_73",
        "NL Question": "For each team that participated in the 'Canada 2015' tournament, calculate the total number of goals scored by the team's players and the average number of players per squad. Return the team's name, total goals scored, and average players per squad.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'Canada 2015'}) MATCH (p:Person)-[:REPRESENTS]->(t)-[:NAMED]->(s:Squad) OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(tour) WITH t, s, p, COUNT(sg) AS goalsPerPlayer WITH t, s, SUM(goalsPerPlayer) AS totalGoalsPerSquad, COUNT(DISTINCT p) AS playersPerSquad WITH t, AVG(playersPerSquad) AS avgPlayersPerSquad, SUM(totalGoalsPerSquad) AS totalGoals RETURN t.name AS teamName, totalGoals, avgPlayersPerSquad",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 431,
        "original_index": 431,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_74",
        "NL Question": "For each year, determine the total number of matches played and the average number of goals scored per match. Return the year, total matches, and average goals per match, ordering by year.",
        "Cypher": "MATCH (m:Match) OPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m) WITH m.date.year AS matchYear, m, COUNT(sg) AS goalsPerMatch WITH matchYear, COUNT(m) AS totalMatches, AVG(goalsPerMatch) AS avgGoalsPerMatch RETURN matchYear, totalMatches, avgGoalsPerMatch ORDER BY matchYear",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 432,
        "original_index": 432,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_77",
        "NL Question": "For the 'Sweden 1995' tournament, what is the average number of goals scored per match and the total number of matches played?",
        "Cypher": "MATCH (tour:Tournament {name: 'Sweden 1995'})<-[:IN_TOURNAMENT]-(m:Match)\nOPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m)\nWITH tour, m, COUNT(sg) AS goalsPerMatch\nWITH tour, COUNT(m) AS totalMatches, SUM(goalsPerMatch) AS totalGoals\nRETURN tour.name AS tournamentName, toFloat(totalGoals) / totalMatches AS avgGoalsPerMatch, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 433,
        "original_index": 433,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_78",
        "NL Question": "For each team that participated in the 'Sweden 1995' tournament, what is the total number of goals scored and the average number of players who scored those goals?",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'Sweden 1995'})\nMATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match)<-[:PLAYED_IN]-(t)\nWITH t, p, COUNT(sg) AS goalsPerPlayer\nWITH t, COUNT(DISTINCT p) AS numPlayers, SUM(goalsPerPlayer) AS totalGoals\nRETURN t.name AS teamName, totalGoals, toFloat(totalGoals) / numPlayers AS avgGoalsPerPlayer",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 434,
        "original_index": 434,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_79",
        "NL Question": "What is the average number of goals scored by Wu Weiying in each match they played in?",
        "Cypher": "MATCH (p:Person {name: 'Wu Weiying'})-[sg:SCORED_GOAL]->(m:Match)\nWITH p, COUNT(sg) AS goalsPerMatch, COUNT(m) AS totalMatches\nRETURN p.name AS playerName, toFloat(SUM(goalsPerMatch)) / totalMatches AS avgGoalsPerMatch",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "grammatical error: sytax error. "
    },
    {
        "id": 435,
        "original_index": 435,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_80",
        "NL Question": "For each tournament, what is the average age of the players who scored goals, and how many players scored at least one goal?",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[:PLAYED_IN]-(p:Person)-[sg:SCORED_GOAL]->(m)\nWHERE p.dob IS NOT NULL\nWITH tour, p, tour.year - p.dob.year AS playerAge\nWITH tour, AVG(playerAge) AS avgPlayerAge, COUNT(DISTINCT p) AS numGoalScorers\nRETURN tour.name AS tournamentName, avgPlayerAge, numGoalScorers",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 436,
        "original_index": 436,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_81",
        "NL Question": "For each squad, what is the total number of players and the average number of matches played by each player in that squad?",
        "Cypher": "MATCH (s:Squad)<-[:IN_SQUAD]-(p:Person)-[:PLAYED_IN]->(m:Match)\nWITH s, p, COUNT(m) AS matchesPlayed\nWITH s, COUNT(DISTINCT p) AS totalPlayers, AVG(matchesPlayed) AS avgMatchesPerPlayer\nRETURN s.id AS squadId, totalPlayers, avgMatchesPerPlayer",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 437,
        "original_index": 437,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_84",
        "NL Question": "For the 'Germany 2011' tournament, calculate the average number of goals scored per match and the total number of matches played. Return the average goals per match and total matches.",
        "Cypher": "MATCH (t:Tournament {name: 'Germany 2011'})<-[:IN_TOURNAMENT]-(m:Match)\nOPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m)\nWITH t, m, COUNT(sg) AS goalsPerMatch, COUNT(m) AS totalMatches\nWITH t, SUM(goalsPerMatch) AS totalGoals, COUNT(DISTINCT m) AS totalMatches\nRETURN toFloat(totalGoals) / totalMatches AS avgGoalsPerMatch, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 438,
        "original_index": 438,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_85",
        "NL Question": "For each team that participated in a tournament, compute the average number of players who scored goals in their matches. Return the team name and the average number of goal-scoring players.",
        "Cypher": "MATCH (t:Team)-[:PLAYED_IN]->(m:Match)<-[sg:SCORED_GOAL]-(p:Person)\nWITH t, m, COLLECT(DISTINCT p) AS goalScorers\nWITH t, SIZE(goalScorers) AS numGoalScorers\nRETURN t.name AS teamName, AVG(numGoalScorers) AS avgGoalScorers",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 439,
        "original_index": 439,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_87",
        "NL Question": "For each tournament, find the average age of players who played in the matches and the total number of goals scored in all matches. Return the tournament name, average player age, and total goals scored.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[:PLAYED_IN]-(p:Person)\nWHERE p.dob IS NOT NULL\nOPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m)\nWITH tour, p, m, sg\nWITH tour, p, tour.year - p.dob.year AS playerAge, COUNT(sg) AS goals\nWITH tour, AVG(playerAge) AS avgPlayerAge, SUM(goals) AS totalGoals\nRETURN tour.name AS tournamentName, avgPlayerAge, totalGoals",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 440,
        "original_index": 440,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_88",
        "NL Question": "For each team, determine the average number of goals scored per match and the total number of players who represented the team. Return the team name, average goals per match, and total players.",
        "Cypher": "MATCH (t:Team)<-[:REPRESENTS]-(p:Person)-[:PLAYED_IN]->(m:Match\n)\nOPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m)\nWITH t, m, p, COUNT(sg) AS goalsPerMatch\nWITH t, m, SUM(goalsPerMatch) AS totalGoals\nWITH t, COUNT(DISTINCT m) AS numMatches, SUM(totalGoals) AS totalGoalsScored\nWITH t, toFloat(totalGoalsScored) / numMatches AS avgGoalsPerMatch\nMATCH (t)<-[:REPRESENTS]-(p:Person)\nWITH t, avgGoalsPerMatch, COUNT(DISTINCT p) AS totalPlayers\nRETURN t.name AS teamName, avgGoalsPerMatch, totalPlayers",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 441,
        "original_index": 441,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_92",
        "NL Question": "For each team that participated in the 'Canada 2015' tournament, determine the average number of players in their squads and the total number of matches they played. Return the team name, average squad size, and total matches played.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'Canada 2015'}) \nMATCH (t)-[:NAMED]->(s:Squad) \nOPTIONAL MATCH (s)<-[:IN_SQUAD]-(p:Person) \nWITH t, s, COUNT(p) AS squadSize \nMATCH (t)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour) \nWITH t, AVG(squadSize) AS avgSquadSize, COUNT(m) AS totalMatches \nRETURN t.name AS teamName, avgSquadSize, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 442,
        "original_index": 442,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_93",
        "NL Question": "For each person who played in a match, find the average number of goals they scored per match and the total number of matches they played in. Return the person's name, average goals per match, and total matches played, ordering by average goals in descending order.",
        "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match)\nOPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m)\nWITH p, COUNT(DISTINCT m) AS totalMatches, COUNT(sg) AS totalGoals\nRETURN p.name AS playerName, CASE WHEN totalMatches > 0 THEN toFloat(totalGoals) / totalMatches ELSE 0 END AS avgGoalsPerMatch, totalMatches\nORDER BY avgGoalsPerMatch DESC",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 443,
        "original_index": 443,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_94",
        "NL Question": "For each tournament, find the team with the highest average score in matches played during that tournament. Return the tournament name, team name, and the team's average score.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament)\nWHERE r.score IS NOT NULL\nWITH tour, t, AVG(toFloat(r.score)) AS avgScore\nORDER BY tour.name, avgScore DESC\nWITH tour, COLLECT({team: t.name, avgScore: avgScore}) AS teamScores\nRETURN tour.name AS tournamentName, teamScores[0].team AS teamName, teamScores[0].avgScore AS averageScore",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 444,
        "original_index": 444,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_95",
        "NL Question": "For each tournament, calculate the total number of players who scored at least one goal and the average number of matches played by those players. Return the tournament name, the total number of goal-scoring players, and the average number of matches played by them.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[sg:SCORED_GOAL]-(p:Person)\nWITH tour, p, COUNT(m) AS matchesPlayed\nWITH tour, COLLECT(DISTINCT {player:p.id, matches:matchesPlayed}) AS playersWithMatches\nWITH tour, SIZE(playersWithMatches) AS totalPlayers, REDUCE(s = 0, playerInfo IN playersWithMatches | s + playerInfo.matches) AS sumOfMatches\nRETURN tour.name AS tournamentName, totalPlayers, CASE WHEN totalPlayers > 0 THEN toFloat(sumOfMatches) / totalPlayers ELSE 0 END AS avgMatchesPlayed",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 445,
        "original_index": 445,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_99",
        "NL Question": "For each team that participated in the 'France 2019' tournament, find the average number of goals scored by players representing that team in matches within that tournament. Return the team name and the average goals scored.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'France 2019'}) \nMATCH (p:Person)-[:REPRESENTS]->(t)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour) \nOPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m) \nWITH t, p, COUNT(sg) AS goalsPerPlayer\nWITH t, AVG(goalsPerPlayer) AS avgGoals\nRETURN t.name AS teamName, avgGoals",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 446,
        "original_index": 446,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_100",
        "NL Question": "For each person, calculate the number of tournaments they played in and the average number of goals they scored per tournament. Return the person's name, the number of tournaments, and the average goals per tournament.",
        "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament)\nOPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m)\nWITH p, t, COUNT(sg) AS goalsPerTournament\nWITH p, COUNT(DISTINCT t) AS numTournaments, COLLECT(goalsPerTournament) AS goalsList\nRETURN p.name AS personName, numTournaments, REDUCE(total = 0, goal in goalsList | total + goal)*1.0 / numTournaments AS avgGoalsPerTournament",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 447,
        "original_index": 447,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_101",
        "NL Question": "For each tournament, determine the team with the highest average score in matches played during that tournament. Return the tournament name, the team name, and the average score.",
        "Cypher": "MATCH (t:Team)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament)\nWITH tour, t, AVG(toFloat(m.stage)) AS avgScore\nORDER BY tour.name, avgScore DESC\nWITH tour, COLLECT({team: t, avgScore: avgScore}) AS teamScores\nRETURN tour.name AS tournamentName, teamScores[0].team.name AS teamName, teamScores[0].avgScore AS averageScore",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 448,
        "original_index": 448,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_102",
        "NL Question": "For each tournament year, calculate the total number of goals scored by all players and the average age of the players who scored those goals. Return the tournament year, total goals scored, and average player age.",
        "Cypher": "MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament)\nWHERE p.dob IS NOT NULL\nWITH tour.year AS tournamentYear, p, COUNT(sg) AS goalsScored\nWITH tournamentYear, p, goalsScored, tour.year - p.dob.year AS playerAge\nWITH tournamentYear, SUM(goalsScored) AS totalGoals, AVG(playerAge) AS avgPlayerAge\nRETURN tournamentYear, totalGoals, avgPlayerAge",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "The query uses an unweighted average of player ages and approximates age using year difference, which may misrepresent the true per-goal weighted average and precise age."
    },
    {
        "id": 449,
        "original_index": 449,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_105",
        "NL Question": "For each team, calculate the total number of matches they played and the average number of goals scored per match where the score is available. Return the team name, total matches played, and average goals per match.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match) WHERE r.score IS NOT NULL WITH t, COUNT(m) AS matchCount, SUM(r.score) AS totalGoals RETURN t.name AS teamName, matchCount AS totalMatches, toFloat(totalGoals)/matchCount AS avgGoalsPerMatch;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 450,
        "original_index": 450,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_106",
        "NL Question": "For the tournament 'France 2019', find the player who scored the most goals. Return the player's name, ID, and the total number of goals scored by that player in the specified tournament.",
        "Cypher": "MATCH (tour:Tournament {name: 'France 2019'}) MATCH (m:Match)-[:IN_TOURNAMENT]->(tour) MATCH (p:Person)-[sg:SCORED_GOAL]->(m) WITH tour, p, COUNT(sg) AS totalGoals ORDER BY tour.id, totalGoals DESC WITH tour, COLLECT({player: p, totalGoals: totalGoals}) AS scorers RETURN tour.name AS tournamentName, scorers[0].player.name AS playerName, scorers[0].player.id AS playerId, scorers[0].totalGoals AS totalGoals;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 451,
        "original_index": 451,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_109",
        "NL Question": "For the team 'England', what is the average number of goals scored in each match they played in, and how many total matches did they play in?",
        "Cypher": "MATCH (t:Team {name: 'England'})-[r:PLAYED_IN]->(m:Match) WHERE r.score IS NOT NULL WITH t, COUNT(m) AS totalMatches, AVG(r.score) AS avgGoalsPerMatch RETURN t.name AS teamName, totalMatches, avgGoalsPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 452,
        "original_index": 452,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_112",
        "NL Question": "For each team that participated in the 'USA 2003' tournament, calculate the average number of goals scored per match. Return the team name and the average goals scored.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'USA 2003'}) WHERE r.score IS NOT NULL WITH t, COUNT(m) AS matchCount, SUM(r.score) AS totalGoals RETURN t.name AS teamName, toFloat(totalGoals)/matchCount AS avgGoalsPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 453,
        "original_index": 453,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_113",
        "NL Question": "For each tournament, determine the average age of players who played in matches during that tournament. Return the tournament name and the average player age.",
        "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament) WHERE p.dob IS NOT NULL WITH p, tour, tour.year - p.dob.year AS playerAge WITH tour, AVG(playerAge) AS avgAge RETURN tour.name AS tournamentName, avgAge",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 454,
        "original_index": 454,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_114",
        "NL Question": "For each squad, calculate the total number of players and the average number of goals scored by players from that squad in all matches. Return the squad ID, player count, and average goals per player.",
        "Cypher": "MATCH (s:Squad)<-[:IN_SQUAD]-(p:Person) OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(:Match) WITH s, p, COUNT(sg) AS goalsPerPlayer WITH s, COUNT(DISTINCT p) AS totalPlayers, AVG(goalsPerPlayer) AS avgGoalsPerPlayer RETURN s.id AS squadId, totalPlayers, avgGoalsPerPlayer",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 455,
        "original_index": 455,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_115",
        "NL Question": "For the 'Germany 2011' tournament, find the team with the highest average number of goals scored per match. Return the team name and the average goals scored.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'Germany 2011'}) WHERE r.score IS NOT NULL WITH t, COUNT(m) AS matchCount, SUM(r.score) AS totalGoals RETURN t.name AS teamName, toFloat(totalGoals)/matchCount AS avgGoalsPerMatch ORDER BY avgGoalsPerMatch DESC LIMIT 1",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 456,
        "original_index": 456,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_116",
        "NL Question": "For each player, calculate the number of tournaments they participated in and the average number of goals they scored per tournament. Return the player's name, the number of tournaments, and the average goals per tournament.",
        "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament) OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m) WITH p, tour, COUNT(sg) AS goalsPerMatch, COLLECT(DISTINCT tour.id) AS tournaments  WITH p, SIZE(tournaments) AS numTournaments, REDUCE(s = 0, x IN COLLECT(goalsPerMatch) | s + x) AS totalGoals RETURN p.name AS playerName, numTournaments, CASE WHEN numTournaments = 0 THEN 0 ELSE toFloat(totalGoals) / numTournaments END AS avgGoalsPerTournament",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 457,
        "original_index": 457,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_120",
        "NL Question": "For each team that participated in the 'Germany 2011' tournament, calculate the total number of goals scored and the average number of goals scored per match. Return the team name, total goals, and average goals per match.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'Germany 2011'}) \nOPTIONAL MATCH (t)-[:PLAYED_IN]->(m:Match)<-[sg:SCORED_GOAL]-(:Person)\nWITH t, m, COUNT(sg) AS goalsPerMatch\nWITH t, SUM(goalsPerMatch) AS totalGoals, COUNT(m) AS totalMatches\nRETURN t.name AS teamName, totalGoals, CASE WHEN totalMatches > 0 THEN toFloat(totalGoals) / totalMatches ELSE 0 END AS avgGoalsPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 458,
        "original_index": 458,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_121",
        "NL Question": "For each person, find the average number of goals they scored per match and the total number of matches in which they scored at least one goal. Return the person's name, average goals per match, and total matches with goals.",
        "Cypher": "MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match)\nWITH p, m, COUNT(sg) AS goalsPerMatch\nWITH p, COUNT(m) AS totalMatchesWithGoals, AVG(goalsPerMatch) AS avgGoalsPerMatch\nRETURN p.name AS personName, avgGoalsPerMatch, totalMatchesWithGoals",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 459,
        "original_index": 459,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_122",
        "NL Question": "For each tournament, determine the team with the highest average score in 'PLAYED_IN' relationships, and return the tournament name, the team's name, and the team's average score.",
        "Cypher": "MATCH (t:Team)-[pi:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament)\nWITH tour, t, AVG(toInt(pi.score)) AS avgScore\nORDER BY tour.id, avgScore DESC\nWITH tour, COLLECT({team: t, avgScore: avgScore}) AS teamScores\nRETURN tour.name AS tournamentName, teamScores[0].team.name AS teamName, teamScores[0].avgScore AS highestAvgScore",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "grammatical error: toInt() function"
    },
    {
        "id": 460,
        "original_index": 460,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_123",
        "NL Question": "For each team, calculate the total number of goals scored by players representing that team and the average number of matches played by each of those players. Return the team's name, total goals scored, and average matches played per player.",
        "Cypher": "MATCH (p:Person)-[:REPRESENTS]->(t:Team)\nOPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(:Match)\nWITH t, p, COUNT(sg) AS goalsPerPlayer\nOPTIONAL MATCH (p)-[:PLAYED_IN]->(m:Match)\nWITH t, p, goalsPerPlayer, COUNT(m) AS matchesPlayed\nWITH t, SUM(goalsPerPlayer) AS totalGoals, AVG(matchesPlayed) AS avgMatchesPlayed\nRETURN t.name AS teamName, totalGoals, avgMatchesPlayed",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 461,
        "original_index": 461,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_126",
        "NL Question": "For each team, calculate the total number of matches they played and the average penalty score across all matches. Return the team name, total matches played, and average penalty score.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match) WHERE r.penaltyScore IS NOT NULL WITH t, COUNT(m) AS matchCount, SUM(r.penaltyScore) AS totalPenaltyScore RETURN t.name AS teamName, matchCount AS totalMatches, toFloat(totalPenaltyScore)/matchCount AS avgPenaltyScore;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 462,
        "original_index": 462,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_127",
        "NL Question": "For each tournament, find the average number of goals scored by players in matches and the total number of teams that participated. Return the tournament name, average goals per match, and total participating teams.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[sg:SCORED_GOAL]-(p:Person) WITH tour, m, COUNT(sg) AS goalsPerMatch OPTIONAL MATCH (team:Team)-[:PARTICIPATED_IN]->(tour) WITH tour, AVG(goalsPerMatch) AS avgGoalsPerMatch, COUNT(DISTINCT team) AS totalTeams RETURN tour.name AS tournamentName, avgGoalsPerMatch, totalTeams;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 463,
        "original_index": 463,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_128",
        "NL Question": "For each player, determine the total number of tournaments they participated in and the average number of matches they played per tournament. Return the player's name, total tournaments, and average matches per tournament.",
        "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament) WITH p, t, COUNT(m) AS matchesPerTournament WITH p, COUNT(t) AS totalTournaments, AVG(matchesPerTournament) AS avgMatchesPerTournament RETURN p.name AS playerName, totalTournaments, avgMatchesPerTournament;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 464,
        "original_index": 464,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_129",
        "NL Question": "For each team that participated in the 'China PR 1991' tournament, calculate the average number of goals scored per match and the total number of players who represented that team. Return the team name, average goals per match, and total player count.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'China PR 1991'}) MATCH (p:Person)-[:REPRESENTS]->(t)-[:PLAYED_IN]->(m:Match) OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m) WITH t, m, COUNT(sg) AS goalsPerMatch, p WITH t, AVG(goalsPerMatch) AS avgGoalsPerMatch, COUNT(DISTINCT p) AS totalPlayers RETURN t.name AS teamName, avgGoalsPerMatch, totalPlayers;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 465,
        "original_index": 465,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_130",
        "NL Question": "For each tournament, determine the average age of players who played in matches and the total number of matches played. Return the tournament name, average player age, and total matches played.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[:PLAYED_IN]-(p:Person) WHERE p.dob IS NOT NULL WITH tour, m, p.dob AS birthdate, tour.year AS tournamentYear WITH tour, m, birthdate, tournamentYear, tournamentYear - birthdate.year AS age OPTIONAL MATCH (m)-[:IN_TOURNAMENT]->(tour) WITH tour, AVG(age) AS avgPlayerAge, COUNT(DISTINCT m) AS totalMatches RETURN tour.name AS tournamentName, avgPlayerAge, totalMatches;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 466,
        "original_index": 466,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_133",
        "NL Question": "For each team that participated in the 'Sweden 1995' tournament, calculate the average number of goals scored per match and the total number of matches played. Return the team name, average goals, and total matches.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'Sweden 1995'}) WHERE r.score IS NOT NULL WITH t, m, r.score AS score, tour WITH t, COUNT(m) AS totalMatches, AVG(score) AS avgGoalsPerMatch RETURN t.name AS teamName, avgGoalsPerMatch, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 467,
        "original_index": 467,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_134",
        "NL Question": "For each tournament, find the average age of players who scored goals in matches within that tournament. Return the tournament name and the average player age.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[sg:SCORED_GOAL]-(p:Person) WHERE p.dob IS NOT NULL WITH tour, p, m.date AS matchDate, p.dob AS playerDOB WITH tour, p, date(matchDate).year - date(playerDOB).year AS playerAge WITH tour, AVG(playerAge) AS avgPlayerAge RETURN tour.name AS tournamentName, avgPlayerAge",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 468,
        "original_index": 468,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_135",
        "NL Question": "For each team, calculate the total number of goals scored and the total number of matches played. Then, determine the average goals scored per match for each team. Return the team name, the total goals scored, the total matches played, and the average goals per match.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match) WHERE r.score IS NOT NULL WITH t, COUNT(m) AS totalMatches, SUM(r.score) AS totalGoals RETURN t.name AS teamName, totalGoals, totalMatches, CASE WHEN totalMatches = 0 THEN 0 ELSE toFloat(totalGoals) / totalMatches END AS avgGoalsPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 469,
        "original_index": 469,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_137",
        "NL Question": "For each player who played in a match during 'Sweden 1995', calculate the average number of minutes they played. Return the player's name and their average minutes played.",
        "Cypher": "MATCH (p:Person)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament {name: 'Sweden 1995'}) WHERE r.minuteOn IS NOT NULL WITH p, r.minuteOn AS minuteOn UNWIND split(minuteOn, '''') as time WITH p, toInteger(time[0]) as minutesOn WITH p, AVG(minutesOn) AS avgMinutesPlayed RETURN p.name AS playerName, avgMinutesPlayed",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "You're using split(minuteOn, ''''), which splits on a single quote ('), but quotes don't exist in the value unless itâ€™s a string representation like 45'+2 (extra time)."
    },
    {
        "id": 470,
        "original_index": 470,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_141",
        "NL Question": "For each team, determine the total number of matches they played and the average 'score' in those matches where the 'score' property is available. Return the team name, total matches, and average score.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match)\nWHERE r.score IS NOT NULL\nWITH t, COUNT(m) AS totalMatches, AVG(r.score) AS averageScore\nRETURN t.name AS teamName, totalMatches, averageScore",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 471,
        "original_index": 471,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_142",
        "NL Question": "For each tournament, find the team with the highest average 'score' in matches. Return the tournament name, the team name, and the average 'score' for that team in that tournament.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament)\nWHERE r.score IS NOT NULL\nWITH tour, t, AVG(r.score) AS avgScore\nORDER BY tour.name, avgScore DESC\nWITH tour, COLLECT({team: t.name, avgScore: avgScore}) AS teamScores\nRETURN tour.name AS tournamentName, teamScores[0].team AS teamName, teamScores[0].avgScore AS averageScore",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 472,
        "original_index": 472,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_143",
        "NL Question": "For the tournament 'Germany 2011', calculate the average age of players who scored goals and the total number of goals scored. Return the average age and total goals.",
        "Cypher": "MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament {name: 'Germany 2011'})\nWHERE p.dob IS NOT NULL\nWITH p, t, COUNT(sg) AS goalsScored\nWITH AVG(t.year - p.dob.year) AS averageAge, SUM(goalsScored) AS totalGoals\nRETURN averageAge, totalGoals",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 473,
        "original_index": 473,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_144",
        "NL Question": "For each team that participated in the tournament 'Germany 2011', determine the average number of goals scored by players representing that team and the total number of players representing that team. Return the team name, average goals per player, and total players.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'Germany 2011'})<-[:FOR]-(s:Squad)<-[:IN_SQUAD]-(p:Person)-[sg:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(tour)\nWITH t, p, COUNT(sg) AS goalsScored\nWITH t, AVG(goalsScored) AS avgGoalsPerPlayer, COUNT(DISTINCT p) AS totalPlayers\nRETURN t.name AS teamName, avgGoalsPerPlayer, totalPlayers",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 474,
        "original_index": 474,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_147",
        "NL Question": "For each tournament, calculate the average number of players from each team that participated in matches and the total number of matches played. Return the tournament name, average players per team, and total matches.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[:PLAYED_IN]-(t:Team)<-[:REPRESENTS]-(p:Person)\nWITH tour, t, COUNT(DISTINCT p) AS playersPerTeam, COUNT(DISTINCT m) AS totalMatchesPlayed\nWITH tour, AVG(playersPerTeam) AS avgPlayersPerTeam, SUM(totalMatchesPlayed) AS sumTotalMatchesPlayed\nRETURN tour.name AS tournamentName, avgPlayersPerTeam, sumTotalMatchesPlayed",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 475,
        "original_index": 475,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_148",
        "NL Question": "For each team that participated in the 'USA 1999' tournament, calculate the average number of goals scored by players representing that team and the total number of matches they played. Return the team name, average goals per player, and total matches played.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'USA 1999'}) \nOPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match)<-[:PLAYED_IN]-(t)\nWITH t, p, COUNT(sg) AS goalsPerPlayer, COUNT(DISTINCT m) AS totalMatchesPlayed\nWITH t, AVG(goalsPerPlayer) AS avgGoalsPerPlayer, SUM(totalMatchesPlayed) AS sumTotalMatchesPlayed\nRETURN t.name AS teamName, avgGoalsPerPlayer, sumTotalMatchesPlayed",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 476,
        "original_index": 476,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_149",
        "NL Question": "For each person, find the average number of tournaments they played in per year since their birth. Return the person's name, birth year, and average tournaments per year.",
        "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament)\nWITH p, t.year AS tournamentYear, p.dob.year AS birthYear\nWITH p, COLLECT(DISTINCT tournamentYear) AS tournamentYears, birthYear\nWITH p, SIZE(tournamentYears) AS numberOfTournaments, birthYear\nWITH p, numberOfTournaments, CASE WHEN birthYear IS NOT NULL THEN (datetime().year - birthYear) ELSE 0 END AS age\nRETURN p.name AS personName, birthYear, CASE WHEN age > 0 THEN toFloat(numberOfTournaments) / age ELSE 0 END AS avgTournamentsPerYear",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "we can not take the different between dates direclty."
    },
    {
        "id": 477,
        "original_index": 477,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_150",
        "NL Question": "For each tournament, determine the average number of goals scored in matches where 'Costa Rica' participated. Return the tournament name and the average goals scored.",
        "Cypher": "MATCH (t:Team {name: 'Costa Rica'})-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament)\nOPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m)\nWITH tour, COUNT(sg) AS goalsScored, COUNT(DISTINCT m) AS matchesPlayed\nWITH tour, SUM(goalsScored) AS totalGoals, matchesPlayed\nRETURN tour.name AS tournamentName, CASE WHEN matchesPlayed > 0 THEN toFloat(totalGoals) / matchesPlayed ELSE 0 END AS avgGoals",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 478,
        "original_index": 478,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_151",
        "NL Question": "For each team, calculate the total number of matches played in tournaments after the year 2000 and the average number of players used per match. Return the team name, total matches, and average players per match.",
        "Cypher": "MATCH (t:Team)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament)\nWHERE tour.year > 2000\nWITH t, m, tour\nOPTIONAL MATCH (p:Person)-[:PLAYED_IN]->(m)\nWITH t, m, COUNT(DISTINCT p) AS playersPerMatch\nWITH t, COUNT(DISTINCT m) AS totalMatches, AVG(playersPerMatch) AS avgPlayersPerMatch\nRETURN t.name AS teamName, totalMatches, avgPlayersPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 479,
        "original_index": 479,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_155",
        "NL Question": "For each tournament, determine the average number of players from each team participating in that tournament. Return the tournament name, the average number of players per team, and the total number of teams participating.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament) MATCH (t)-[:NAMED]->(s:Squad)<-[:IN_SQUAD]-(p:Person) WITH tour, t, COUNT(DISTINCT p) AS playerCount WITH tour, AVG(playerCount) AS avgPlayersPerTeam, COUNT(DISTINCT t) AS totalTeams RETURN tour.name AS tournamentName, avgPlayersPerTeam, totalTeams",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 480,
        "original_index": 480,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_156",
        "NL Question": "For each player who scored goals in matches during the 'Canada 2015' tournament, calculate the total number of goals they scored and the average number of goals per match they played in that tournament. Return the player's name, total goals scored, total matches played, and average goals per match.",
        "Cypher": "MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'Canada 2015'}) WITH p, m, COUNT(sg) AS goalsPerMatch MATCH (p)-[:PLAYED_IN]->(m2:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'Canada 2015'}) WITH p, SUM(goalsPerMatch) AS totalGoals, COUNT(DISTINCT m2) AS totalMatches RETURN p.name AS playerName, totalGoals, totalMatches, CASE WHEN totalMatches > 0 THEN toFloat(totalGoals) / totalMatches ELSE 0 END AS avgGoalsPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 481,
        "original_index": 481,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_157",
        "NL Question": "For each tournament, find the team with the highest average 'score' in the PLAYED_IN relationships for matches played in that tournament. Return the tournament name, the team's name, and the average score.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament) WITH tour, t, AVG(r.score) AS avgScore ORDER BY tour.name, avgScore DESC WITH tour, COLLECT({team: t, avgScore: avgScore}) AS teamScores RETURN tour.name AS tournamentName, teamScores[0].team.name AS teamName, teamScores[0].avgScore AS averageScore",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 482,
        "original_index": 482,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_158",
        "NL Question": "For each player, determine the total number of tournaments they participated in as a coach and the average number of matches played by squads they coached in those tournaments. Return the player's name, the number of tournaments coached, and the average matches played by their squads.",
        "Cypher": "MATCH (p:Person)-[:COACH_FOR]->(s:Squad)-[:FOR]->(tour:Tournament) MATCH (s)-[:NAMED]->(t:Team)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour) WITH p, tour, COUNT(DISTINCT m) AS matchesPlayedPerSquad WITH p, COUNT(DISTINCT tour) AS tournamentsCoached, AVG(matchesPlayedPerSquad) AS avgMatchesPlayedBySquad RETURN p.name AS coachName, tournamentsCoached, avgMatchesPlayedBySquad",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "This second WITH clause loses the grouping by tournament, which collapses all matchesPlayedPerSquad across all tournaments into a single AVG, even if multiple rows per coach exist."
    },
    {
        "id": 483,
        "original_index": 483,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_162",
        "NL Question": "For each team, find the average number of goals scored per match and the total number of matches played. Return the team name, average goals per match, and total matches played.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match) WHERE r.score IS NOT NULL WITH t, COUNT(m) AS totalMatches, SUM(r.score) AS totalGoals RETURN t.name AS teamName, toFloat(totalGoals) / totalMatches AS avgGoalsPerMatch, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 484,
        "original_index": 484,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_163",
        "NL Question": "For the tournament 'China PR 1991', determine the average age of players at the time of the tournament and the total number of players who participated. Return the average age and total player count.",
        "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'China PR 1991'}) WHERE p.dob IS NOT NULL WITH p, tour.year - p.dob.year AS age WITH AVG(age) AS averageAge, COUNT(DISTINCT p) AS totalPlayers RETURN averageAge, totalPlayers",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 485,
        "original_index": 485,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_164",
        "NL Question": "For each squad, compute the average number of goals scored by players in matches and the total number of players in the squad. Return the squad ID, average goals per player, and total player count.",
        "Cypher": "MATCH (s:Squad)<-[:IN_SQUAD]-(p:Person) OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m:Match) WITH s, p, COUNT(sg) AS goalsPerPlayer WITH s, COUNT(DISTINCT p) AS totalPlayers, AVG(goalsPerPlayer) AS avgGoalsPerPlayer RETURN s.id AS squadId, avgGoalsPerPlayer, totalPlayers",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 486,
        "original_index": 486,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_165",
        "NL Question": "For each tournament, find the average number of substitutions made per match and the total number of matches played in that tournament. Return the tournament name, average substitutions per match, and total matches.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[r:PLAYED_IN]-(p:Person) WHERE r.type = 'Subbed On' WITH tour, m, COUNT(DISTINCT p) AS substitutionsPerMatch WITH tour, AVG(substitutionsPerMatch) AS avgSubstitutionsPerMatch, COUNT(DISTINCT m) AS totalMatches RETURN tour.name AS tournamentName, avgSubstitutionsPerMatch, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 487,
        "original_index": 487,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_168",
        "NL Question": "For each tournament, calculate the total number of teams that participated and the average number of players from each team who scored goals in matches within that tournament. Return the tournament name, total teams, and average goal-scoring players per team.",
        "Cypher": "MATCH (tour:Tournament)<-[:PARTICIPATED_IN]-(t:Team) WITH tour, t MATCH (t)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour) WITH tour, t, m OPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m) WHERE (p)-[:REPRESENTS]->(t) WITH tour, t, COLLECT(DISTINCT p) AS scoringPlayers RETURN tour.name AS tournamentName, COUNT(DISTINCT t) AS totalTeams, AVG(SIZE(scoringPlayers)) AS avgGoalScoringPlayersPerTeam",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 488,
        "original_index": 488,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_169",
        "NL Question": "For each team, determine the number of tournaments they participated in and the average number of goals scored per match across all those tournaments. Return the team name, the number of tournaments, and the average goals per match.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament) WITH t, COUNT(DISTINCT tour) AS numTournaments OPTIONAL MATCH (t)-[:PLAYED_IN]->(m:Match) WITH t, numTournaments, COLLECT(m) AS matches UNWIND matches AS match OPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(match) WHERE (p)-[:REPRESENTS]->(t) WITH t, numTournaments, match, COUNT(sg) AS goalsPerMatch RETURN t.name AS teamName, numTournaments, AVG(goalsPerMatch) AS avgGoalsPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 489,
        "original_index": 489,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_170",
        "NL Question": "For each person, find the number of tournaments they played in and calculate the average number of matches they played per tournament. Return the person's name, the number of tournaments, and the average matches per tournament.",
        "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament) WITH p, tour, m WITH p, COUNT(DISTINCT tour) AS numTournaments, COLLECT(m) AS matchesPerTournament RETURN p.name AS personName, numTournaments,  toFloat(SIZE(matchesPerTournament)) / numTournaments AS avgMatchesPerTournament",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 490,
        "original_index": 490,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_171",
        "NL Question": "For each tournament, determine the total number of goals scored and the average number of goals scored by players who represent teams from 'Ecuador'. Return the tournament name, total goals scored, and average goals scored by Ecuador players.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[:PLAYED_IN]-(p:Person)-[:REPRESENTS]->(t:Team {name: 'Ecuador'}) OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m) WITH tour, COUNT(sg) AS ecuadorGoals, m MATCH (m)-[:IN_TOURNAMENT]->(tour) OPTIONAL MATCH (:Person)-[sg_all:SCORED_GOAL]->(m) WITH tour, ecuadorGoals, COUNT(sg_all) AS totalGoals WHERE t.name = 'Ecuador' RETURN tour.name AS tournamentName, totalGoals, AVG(ecuadorGoals) AS avgEcuadorGoals",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "variable t is not defined"
    },
    {
        "id": 491,
        "original_index": 491,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_172",
        "NL Question": "For each squad, compute the total number of players and the average number of goals scored by players in matches where the match date is before '2000-01-01'. Return the squad ID, total player count, and average goals per player.",
        "Cypher": "MATCH (s:Squad)<-[:IN_SQUAD]-(p:Person) OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m:Match) WHERE m.date < date('2000-01-01') WITH s, p, COUNT(sg) AS goalsPerPlayer WITH s, COUNT(DISTINCT p) AS totalPlayers, AVG(goalsPerPlayer) AS avgGoalsPerPlayer RETURN s.id AS squadId, totalPlayers, avgGoalsPerPlayer",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 492,
        "original_index": 492,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_175",
        "NL Question": "For each tournament, calculate the average number of goals scored per match and the total number of matches played. Return the tournament name, year, average goals per match, and total matches.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)\nOPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m)\nWITH tour, m, COUNT(sg) AS goalsPerMatch\nWITH tour, COUNT(m) AS totalMatches, AVG(goalsPerMatch) AS avgGoalsPerMatch\nRETURN tour.name AS tournamentName, tour.year AS tournamentYear, avgGoalsPerMatch, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 493,
        "original_index": 493,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_176",
        "NL Question": "For each team that participated in the 'France 2019' tournament, find the average number of goals scored by players from that team across all matches in the tournament and the total number of players representing the team in the tournament.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'France 2019'})<-[:IN_TOURNAMENT]-(m:Match)\nMATCH (p:Person)-[sg:SCORED_GOAL]->(m)\nWHERE (p)-[:REPRESENTS]->(t)\nWITH t, p, COUNT(sg) AS goalsPerPlayer\nWITH t, AVG(goalsPerPlayer) AS avgGoalsPerPlayer, COUNT(DISTINCT p) AS totalPlayers\nRETURN t.name AS teamName, avgGoalsPerPlayer, totalPlayers",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 494,
        "original_index": 494,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_177",
        "NL Question": "For each person, determine the number of tournaments they played in and the average number of goals they scored per tournament. Return the person's name, the number of tournaments, and the average goals per tournament.",
        "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament)\nOPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m)\nWITH p, t, COUNT(sg) AS goalsPerTournament\nWITH p, COUNT(DISTINCT t) AS numTournaments, AVG(goalsPerTournament) AS avgGoalsPerTournament\nRETURN p.name AS personName, numTournaments, avgGoalsPerTournament",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 495,
        "original_index": 495,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_178",
        "NL Question": "For each team, calculate the total number of matches where their players scored goals and the average number of goals scored by the team's players per match. Return the team's name, total matches with goals, and average goals per match.",
        "Cypher": "MATCH (t:Team)<-[:REPRESENTS]-(p:Person)-[sg:SCORED_GOAL]->(m:Match)\nWITH t, m, COUNT(sg) AS goalsPerMatch\nWITH t, COUNT(m) AS totalMatchesWithGoals, AVG(goalsPerMatch) AS avgGoalsPerMatch\nRETURN t.name AS teamName, totalMatchesWithGoals, avgGoalsPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 496,
        "original_index": 496,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_179",
        "NL Question": "For the 'Sweden 1995' tournament, determine the average age of players who scored at least one goal and the total number of goals scored by these players. Return the average age and the total goals scored.",
        "Cypher": "MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament {name: 'Sweden 1995'})\nWHERE p.dob IS NOT NULL\nWITH p, t, COUNT(sg) AS goalsScored\nWHERE goalsScored > 0\nWITH p, t.year AS tournamentYear, goalsScored\nWITH AVG(tournamentYear - p.dob.year) AS avgAge, SUM(goalsScored) AS totalGoals\nRETURN avgAge, totalGoals",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 497,
        "original_index": 497,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_183",
        "NL Question": "For each team that participated in the 'China 2007' tournament, determine the average number of goals scored by their players in each match. Return the team name and average goals scored per match.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'China 2007'}) MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match) WHERE (t)-[:PLAYED_IN]->(m) WITH t, COUNT(sg) AS totalGoals, COUNT(DISTINCT m) AS totalMatches RETURN t.name AS teamName, CASE WHEN totalMatches > 0 THEN toFloat(totalGoals) / totalMatches ELSE 0 END AS avgGoalsPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 498,
        "original_index": 498,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_184",
        "NL Question": "For each player who played in a match on '1995-06-07', calculate the total number of goals they scored and the average number of minutes they played in those matches. Return the player's name, total goals, and average minutes played.",
        "Cypher": "MATCH (p:Person)-[r:PLAYED_IN]->(m:Match {date: date('1995-06-07')}) OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m) WITH p, r, COUNT(sg) AS totalGoals, COLLECT(toInt(r.minuteOn)) AS minutesPlayedList WITH p, totalGoals, REDUCE(s = 0, i IN minutesPlayedList | s + i) AS totalMinutes, SIZE(minutesPlayedList) AS matchCount RETURN p.name AS playerName, totalGoals, CASE WHEN matchCount > 0 THEN toFloat(totalMinutes) / matchCount ELSE 0 END AS avgMinutesPlayed",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "grammatical error: toInt() function"
    },
    {
        "id": 499,
        "original_index": 499,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_185",
        "NL Question": "For each team, find the average number of players in their squads and the total number of tournaments they have participated in. Return the team name, average squad size, and the total number of tournaments.",
        "Cypher": "MATCH (t:Team)-[:NAMED]->(s:Squad) WITH t, s MATCH (s)<-[:IN_SQUAD]-(p:Person) WITH t, s, COUNT(p) AS squadSize MATCH (t)-[:PARTICIPATED_IN]->(tour:Tournament) WITH t, AVG(squadSize) AS avgSquadSize, COUNT(DISTINCT tour) AS totalTournaments RETURN t.name AS teamName, avgSquadSize, totalTournaments",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 500,
        "original_index": 500,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_186",
        "NL Question": "For each tournament after the year 2000, calculate the average number of teams participating and the average number of goals scored across all matches. Return the tournament name, average team count, and average goals per match.",
        "Cypher": "MATCH (tour:Tournament) WHERE tour.year > 2000 MATCH (t:Team)-[:PARTICIPATED_IN]->(tour) WITH tour, COUNT(t) AS teamCount OPTIONAL MATCH (m:Match)-[:IN_TOURNAMENT]->(tour) OPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m) WITH tour, teamCount, COUNT(sg) AS totalGoals, COUNT(DISTINCT m) AS totalMatches RETURN tour.name AS tournamentName, toFloat(teamCount), CASE WHEN totalMatches > 0 THEN toFloat(totalGoals) / totalMatches ELSE 0 END AS avgGoalsPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 501,
        "original_index": 501,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_189",
        "NL Question": "For each tournament, calculate the total number of teams that participated and the average number of players per team across all squads in that tournament. Return the tournament name, total teams, and average players per team.",
        "Cypher": "MATCH (tour:Tournament)<-[:PARTICIPATED_IN]-(team:Team)-[:NAMED]->(squad:Squad)<-[:IN_SQUAD]-(person:Person) WITH tour, team, squad, COUNT(person) AS playerCount WITH tour, team, AVG(playerCount) AS avgPlayersPerTeam GROUP BY tour.name WITH tour.name AS tournamentName, COUNT(DISTINCT team) AS totalTeams, AVG(avgPlayersPerTeam) AS avgPlayersPerTeam RETURN tournamentName, totalTeams, avgPlayersPerTeam",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "GROUP BY is not valid Cypher syntax â€” that's SQL-style."
    },
    {
        "id": 502,
        "original_index": 502,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_190",
        "NL Question": "For each team that played in the 'USA 2003' tournament, find the average score of their players in all matches they played. Return the team name and the average score.",
        "Cypher": "MATCH (team:Team)-[:PARTICIPATED_IN]->(tournament:Tournament {name: 'USA 2003'}) MATCH (person:Person)-[playedIn:PLAYED_IN]->(match:Match) WHERE (person)-[:REPRESENTS]->(team) WITH team, AVG(toInt(playedIn.score)) AS averageScore RETURN team.name AS teamName, averageScore",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "grammatical error: toInt() function"
    },
    {
        "id": 503,
        "original_index": 503,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_191",
        "NL Question": "For each player who scored goals, calculate the total number of goals they scored and the average number of goals scored per match. Return the player's name, total goals scored, and average goals per match, sorted by average goals per match in descending order.",
        "Cypher": "MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match) WITH p, COUNT(sg) AS totalGoals, COUNT(DISTINCT m) AS totalMatches RETURN p.name AS playerName, totalGoals, CASE WHEN totalMatches = 0 THEN 0 ELSE toFloat(totalGoals)/totalMatches END AS avgGoalsPerMatch ORDER BY avgGoalsPerMatch DESC",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 504,
        "original_index": 504,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_192",
        "NL Question": "For each tournament year, determine the average age of the players who participated in matches during that year. Return the tournament year and the average player age.",
        "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament) WHERE p.dob IS NOT NULL WITH t.year AS tournamentYear, p, t.year - p.dob.year AS playerAge RETURN tournamentYear, AVG(playerAge) AS averagePlayerAge",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 505,
        "original_index": 505,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_193",
        "NL Question": "For each team, find the total number of goals scored and the total number of matches played. Then, calculate the average goals scored per match for each team. Return the team name, total goals, total matches, and average goals per match.",
        "Cypher": "MATCH (t:Team)-[:PLAYED_IN]->(m:Match) OPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m) WHERE (p)-[:REPRESENTS]->(t) WITH t, m, COUNT(sg) AS goalsPerMatch WITH t, SUM(goalsPerMatch) AS totalGoals, COUNT(DISTINCT m) AS totalMatches RETURN t.name AS teamName, totalGoals, totalMatches, CASE WHEN totalMatches = 0 THEN 0 ELSE toFloat(totalGoals) / totalMatches END AS avgGoalsPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 506,
        "original_index": 506,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_197",
        "NL Question": "For each person who played in a match, find the average number of goals they scored per match and the total number of matches they played. Return the person's name, average goals per match, and total matches played, ordering by average goals in descending order.",
        "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match) OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m) WITH p, COUNT(DISTINCT m) AS totalMatches, COUNT(sg) AS totalGoals RETURN p.name AS playerName, CASE WHEN totalMatches = 0 THEN 0 ELSE toFloat(totalGoals) / totalMatches END AS avgGoalsPerMatch, totalMatches ORDER BY avgGoalsPerMatch DESC",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 507,
        "original_index": 507,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_199",
        "NL Question": "For each team, calculate the average number of goals scored by players representing that team and the total number of matches where the team participated. Return the team name, average goals scored by players, and total matches played.",
        "Cypher": "MATCH (t:Team)<-[:REPRESENTS]-(p:Person)-[sg:SCORED_GOAL]->(m:Match) WITH t, p, COUNT(sg) AS goalsScored OPTIONAL MATCH (t)-[:PLAYED_IN]->(m2:Match) WITH t, AVG(goalsScored) AS avgGoals, COUNT(DISTINCT m2) AS totalMatches RETURN t.name AS teamName, avgGoals, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 508,
        "original_index": 508,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_200",
        "NL Question": "For each tournament, find the average number of goals scored per match and the total number of players who scored at least one goal. Return the tournament name, average goals per match, and total number of players with goals.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[sg:SCORED_GOAL]-(p:Person) WITH tour, m, COUNT(sg) AS goalsPerMatch, COLLECT(DISTINCT p) AS playersWithGoals WITH tour, AVG(goalsPerMatch) AS avgGoalsPerMatch, SIZE(playersWithGoals) AS totalPlayersWithGoals RETURN tour.name AS tournamentName, avgGoalsPerMatch, totalPlayersWithGoals",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 509,
        "original_index": 509,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_204",
        "NL Question": "For each tournament, find the average number of goals scored by players in matches of that tournament. Return the tournament name and the average goals scored.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[sg:SCORED_GOAL]-(p:Person) WITH tour, m, COUNT(sg) AS goalsPerMatch RETURN tour.name AS tournamentName, AVG(goalsPerMatch) AS avgGoalsPerMatch;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 510,
        "original_index": 510,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_205",
        "NL Question": "For each player, determine the total number of matches they played and the total number of goals scored. Then calculate the average goals per match. Return the player's name, total matches, total goals, and average goals per match.",
        "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match) WITH p, COUNT(DISTINCT m) AS totalMatches OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m2:Match) WITH p, totalMatches, COUNT(sg) AS totalGoals RETURN p.name AS playerName, totalMatches, totalGoals, CASE WHEN totalMatches = 0 THEN 0 ELSE toFloat(totalGoals)/totalMatches END AS avgGoalsPerMatch;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 511,
        "original_index": 511,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_210",
        "NL Question": "For each tournament, compute the average number of players per team and the total number of teams that participated. Return the tournament name, average players per team, and total teams.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament) WITH tour, t MATCH (p:Person)-[:REPRESENTS]->(t) WITH tour, t, COUNT(p) AS playerCount WITH tour, AVG(playerCount) AS avgPlayersPerTeam, COUNT(DISTINCT t) AS totalTeams RETURN tour.name AS tournamentName, avgPlayersPerTeam, totalTeams",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 512,
        "original_index": 512,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_212",
        "NL Question": "For each tournament, determine the team with the highest average number of goals scored per match. Return the tournament name, the team's name, and its average goals per match.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament) WHERE r.score IS NOT NULL WITH tour, t, COUNT(m) AS matchCount, SUM(r.score) AS totalGoals, toFloat(SUM(r.score))/COUNT(m) AS avgGoalsPerMatch ORDER BY tour.name, avgGoalsPerMatch DESC WITH tour, COLLECT({team: t.name, avgGoals: avgGoalsPerMatch}) AS teamGoals RETURN tour.name AS tournamentName, teamGoals[0].team AS teamName, teamGoals[0].avgGoals AS avgGoals",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 513,
        "original_index": 513,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_213",
        "NL Question": "For each player, calculate the total number of tournaments they participated in and the average number of matches they played per tournament. Return the player's name, total tournaments, and average matches per tournament.",
        "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament) WITH p, tour, COUNT(m) AS matchesPerTournament WITH p, COUNT(DISTINCT tour) AS totalTournaments, COLLECT(matchesPerTournament) AS matchesList RETURN p.name AS playerName, totalTournaments, REDUCE(s = 0, i IN matchesList | s + i) * 1.0 / SIZE(matchesList) AS avgMatchesPerTournament",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 514,
        "original_index": 514,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_214",
        "NL Question": "For each squad, compute the total number of players born before 1990 and the average number of goals scored by those players. Return the squad ID, the count of players born before 1990, and the average goals scored by those players.",
        "Cypher": "MATCH (s:Squad)<-[:IN_SQUAD]-(p:Person) WHERE p.dob.year < 1990 OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(:Match) WITH s, p, COUNT(sg) AS goalsPerPlayer WITH s, COUNT(DISTINCT p) AS totalPlayers, AVG(goalsPerPlayer) AS avgGoalsPerPlayer RETURN s.id AS squadId, totalPlayers, avgGoalsPerPlayer",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 515,
        "original_index": 515,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_217",
        "NL Question": "For the 'France 2019' tournament, calculate the average number of goals scored per match and the total number of matches played. Return the tournament name, average goals per match, and total matches.",
        "Cypher": "MATCH (tour:Tournament {name: 'France 2019'})<-[:IN_TOURNAMENT]-(m:Match)\nOPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m)\nWITH tour, m, COUNT(sg) AS goals\nWITH tour, COUNT(m) AS totalMatches, SUM(goals) AS totalGoals\nRETURN tour.name AS tournamentName, toFloat(totalGoals) / totalMatches AS avgGoalsPerMatch, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 516,
        "original_index": 516,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_218",
        "NL Question": "For each team that participated in the 'Canada 2015' tournament, find the average number of players who scored goals in each of their matches. Return the team's name and the average number of goal-scoring players per match.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'Canada 2015'})\nMATCH (t)-[:PLAYED_IN]->(m:Match)<-[sg:SCORED_GOAL]-(p:Person)\nWITH t, m, COUNT(DISTINCT p) AS goalScorers\nWITH t, AVG(goalScorers) AS avgGoalScorers\nRETURN t.name AS teamName, avgGoalScorers",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 517,
        "original_index": 517,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_219",
        "NL Question": "For each person who played in a match, determine the total number of goals they scored and the average 'score' value from the PLAYED_IN relationships across all matches. Return the person's name, total goals scored, and average score.",
        "Cypher": "MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match)\nWITH p, COUNT(sg) AS totalGoals\nOPTIONAL MATCH (p)-[pi:PLAYED_IN]->(m2:Match)\nWITH p, totalGoals, AVG(toInt(pi.score)) AS avgScore\nRETURN p.name AS playerName, totalGoals, avgScore",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "grammatical error: toInt() function"
    },
    {
        "id": 518,
        "original_index": 518,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_220",
        "NL Question": "For each tournament, calculate the total number of teams that participated and the average number of players per team across all matches played in that tournament. Return the tournament name, total teams, and average players per team.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament)\nWITH tour, COLLECT(DISTINCT t) AS teams\nUNWIND teams AS team\nOPTIONAL MATCH (team)-[:PLAYED_IN]->(m:Match)<-[:PLAYED_IN]-(p:Person)\nWITH tour, teams, team, COUNT(DISTINCT p) AS playersPerTeam\nWITH tour, SIZE(teams) AS totalTeams, AVG(playersPerTeam) AS avgPlayersPerTeam\nRETURN tour.name AS tournamentName, totalTeams, avgPlayersPerTeam",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 519,
        "original_index": 519,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_221",
        "NL Question": "For each team, determine the total number of matches where they scored more than 1 goal and calculate the average minute at which they scored their first goal in those matches. Return the team name, the count of matches with more than 1 goal, and the average minute of their first goal.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match)\nWHERE toInteger(r.score) > 1\nWITH t, m, toInteger(r.score) as score\nOPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m)\nWITH t, m, score, COLLECT(toInteger(sg.minute)) AS goalMinutes\nWHERE size(goalMinutes) > 0\nWITH t, m, score, MIN(goalMinutes[0]) AS firstGoalMinute\nWITH t, COUNT(DISTINCT m) AS matchesWithMoreThanOneGoal, AVG(firstGoalMinute) AS avgFirstGoalMinute\nRETURN t.name AS teamName, matchesWithMoreThanOneGoal, avgFirstGoalMinute",
        "result [0/1]": "0",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": "The query is logically correct, but there no results"
    },
    {
        "id": 520,
        "original_index": 520,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_226",
        "NL Question": "For each player, determine the total number of tournaments they participated in and the average number of matches they played per tournament. Return the player's name, the total number of tournaments, and the average matches per tournament.",
        "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament)\nWITH p, t, COUNT(m) AS matchesPlayed\nWITH p, COUNT(t) AS totalTournaments, COLLECT(matchesPlayed) AS matchesPerTournament\nRETURN p.name AS playerName, totalTournaments, REDUCE(s = 0, x IN matchesPerTournament | s + x) * 1.0 / SIZE(matchesPerTournament) AS avgMatchesPerTournament",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 521,
        "original_index": 521,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_227",
        "NL Question": "For each squad, calculate the total number of players and the average number of matches played by each player in the 'Canada 2015' tournament. Return the squad ID, total players, and average matches played per player.",
        "Cypher": "MATCH (s:Squad)-[:FOR]->(t:Tournament {name: 'Canada 2015'})<-[:IN_TOURNAMENT]-(m:Match)<-[:PLAYED_IN]-(p:Person)-[:IN_SQUAD]->(s)\nWITH s, p, COUNT(m) AS matchesPlayed\nWITH s, COUNT(DISTINCT p) AS totalPlayers, COLLECT(matchesPlayed) AS matchesPerPlayer\nRETURN s.id AS squadId, totalPlayers, REDUCE(acc = 0, m IN matchesPerPlayer | acc + m * 1.0) / totalPlayers AS avgMatchesPerPlayer",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "Your query is almost correct, but it slightly misuses how COUNT(m) behaves in the WITH clause due to how Cypher aggregates. You also donâ€™t need to collect and reduce â€” you can directly compute the average using AVG()."
    },
    {
        "id": 522,
        "original_index": 522,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_228",
        "NL Question": "For each tournament, determine the team with the highest average number of goals scored per match. Return the tournament name, year, the name of the team with the highest average goals, and that team's average goals per match.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[r:PLAYED_IN]-(t:Team)\nWHERE r.score IS NOT NULL\nWITH tour, t, AVG(r.score) AS avgGoals\nORDER BY tour.id, avgGoals DESC\nWITH tour, COLLECT({team: t, avgGoals: avgGoals}) AS teamGoals\nRETURN tour.name AS tournamentName, tour.year AS tournamentYear, teamGoals[0].team.name AS teamName, teamGoals[0].avgGoals AS avgGoals",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 523,
        "original_index": 523,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_232",
        "NL Question": "For each team that played in the 'China 2007' tournament, find the average number of goals scored per match and the total number of matches played. Return the team name, average goals per match, and total matches played.",
        "Cypher": "MATCH (team:Team)-[playedIn:PLAYED_IN]->(match:Match)-[:IN_TOURNAMENT]->(tournament:Tournament {name: 'China 2007'})\nWITH team, match, playedIn\nWHERE playedIn.score IS NOT NULL\nWITH team, COUNT(match) AS totalMatches, SUM(playedIn.score) AS totalGoals\nRETURN team.name AS teamName, toFloat(totalGoals) / totalMatches AS avgGoalsPerMatch, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 524,
        "original_index": 524,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_235",
        "NL Question": "For each year a tournament was held, determine the total number of matches played and the average number of teams participating. Return the tournament year, total matches, and average teams per tournament.",
        "Cypher": "MATCH (tournament:Tournament)<-[:IN_TOURNAMENT]-(match:Match)\nWITH tournament.year AS tournamentYear, tournament, match\nMATCH (team:Team)-[:PARTICIPATED_IN]->(tournament)\nWITH tournamentYear, COUNT(DISTINCT match) AS totalMatches, COUNT(DISTINCT team) AS totalTeams, tournament\nWITH tournamentYear, totalMatches, AVG(totalTeams) AS avgTeamsPerTournament\nRETURN tournamentYear, totalMatches, avgTeamsPerTournament",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 525,
        "original_index": 525,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_238",
        "NL Question": "For each tournament, calculate the average number of goals scored per team and the total number of teams that participated. Return the tournament name, average goals per team, and total team count.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament) WHERE r.score IS NOT NULL WITH tour, t, SUM(r.score) AS teamGoals WITH tour, AVG(teamGoals) AS avgGoalsPerTeam, COUNT(DISTINCT t) AS totalTeams RETURN tour.name AS tournamentName, avgGoalsPerTeam, totalTeams",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 526,
        "original_index": 526,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_240",
        "NL Question": "For each player, find the total number of tournaments they participated in and the average number of goals they scored per tournament. Return the player's name, total tournaments, and average goals per tournament.",
        "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament) OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m) WITH p, tour, COUNT(sg) AS goalsPerTournament WITH p, COUNT(DISTINCT tour) AS totalTournaments, AVG(goalsPerTournament) AS avgGoalsPerTournament RETURN p.name AS playerName, totalTournaments, avgGoalsPerTournament",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 527,
        "original_index": 527,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_241",
        "NL Question": "For each tournament, determine the average age of the players who participated and the total number of players. Return the tournament name, average player age, and total player count.",
        "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament) WHERE p.dob IS NOT NULL WITH tour, p, tour.year - p.dob.year AS playerAge WITH tour, AVG(playerAge) AS avgPlayerAge, COUNT(DISTINCT p) AS totalPlayers RETURN tour.name AS tournamentName, avgPlayerAge, totalPlayers",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 528,
        "original_index": 528,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_242",
        "NL Question": "For each squad, calculate the total number of players and the average number of matches played by players in that squad. Return the squad ID, total players, and average matches played per player.",
        "Cypher": "MATCH (s:Squad)<-[:IN_SQUAD]-(p:Person)-[:PLAYED_IN]->(m:Match) WITH s, p, COUNT(m) AS matchesPlayedPerPlayer WITH s, COUNT(DISTINCT p) AS totalPlayers, AVG(matchesPlayedPerPlayer) AS avgMatchesPerPlayer RETURN s.id AS squadId, totalPlayers, avgMatchesPerPlayer",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 529,
        "original_index": 529,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_245",
        "NL Question": "For each tournament, calculate the total number of goals scored and the average age of the players who scored those goals. Return the tournament name, total goals scored, and average age of goal scorers.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[:SCORED_GOAL]-(p:Person) WHERE p.dob IS NOT NULL WITH tour, p, COUNT(m) AS goalsPerPlayer,p.dob as dob  WITH tour, COLLECT( {dob: dob, goals: goalsPerPlayer}) as playerdetails UNWIND playerdetails as playerdetail with tour, playerdetail.dob as dob, playerdetail.goals as goals with tour, dob, goals return tour.name as tournamentName, sum(goals) as totalGoals, avg(tour.year - dob.year) as averageAgeOfGoalScorers",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 530,
        "original_index": 530,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_246",
        "NL Question": "For each team that participated in the 'Germany 2011' tournament, find the average number of goals scored per match and the total number of matches played. Return the team name, average goals per match, and total matches played.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'Germany 2011'})-[<-[:IN_TOURNAMENT]-(m:Match)<-[r:PLAYED_IN]-(t) WHERE r.score IS NOT NULL WITH t, COUNT(DISTINCT m) AS totalMatches, SUM(r.score) AS totalGoals RETURN t.name AS teamName, CASE WHEN totalMatches = 0 THEN 0 ELSE toFloat(totalGoals) / totalMatches END AS avgGoalsPerMatch, totalMatches",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "There is some issue with the joins."
    },
    {
        "id": 531,
        "original_index": 531,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_247",
        "NL Question": "For each player who played in matches during the 'Sweden 1995' tournament, calculate the total number of minutes they played and the average number of goals they scored per match. Return the player's name, total minutes played, and average goals per match.",
        "Cypher": "MATCH (p:Person)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'Sweden 1995'}) WHERE r.minuteOn IS NOT NULL WITH p, m, r.minuteOn AS minutes, r.score AS score OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m) WITH p, SUM(toInt(minutes)) AS totalMinutes, COUNT(sg) AS totalGoals, COUNT(DISTINCT m) AS totalMatches RETURN p.name AS playerName, totalMinutes, CASE WHEN totalMatches = 0 THEN 0 ELSE toFloat(totalGoals) / totalMatches END AS avgGoalsPerMatch",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "grammatical error: toInt() function"
    },
    {
        "id": 532,
        "original_index": 532,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_248",
        "NL Question": "For each squad in the 'USA 2003' tournament, determine the number of players and calculate the average number of matches played by each player in that squad. Return the squad ID, number of players, and average matches per player.",
        "Cypher": "MATCH (s:Squad)-[:FOR]->(tour:Tournament {name: 'USA 2003'}) MATCH (p:Person)-[:IN_SQUAD]->(s) OPTIONAL MATCH (p)-[:PLAYED_IN]->(m:Match) WITH s, COUNT(DISTINCT p) AS numPlayers, COUNT(DISTINCT m) AS totalMatchesPerPlayer RETURN s.id AS squadId, numPlayers, CASE WHEN numPlayers = 0 THEN 0 ELSE toFloat(totalMatchesPerPlayer) / numPlayers END AS avgMatchesPerPlayer",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 533,
        "original_index": 533,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_249",
        "NL Question": "For each year a tournament was held, determine the average number of teams that participated and the total number of matches played. Return the tournament year, average teams per tournament, and total matches played.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match) WITH tour.year AS tournamentYear, tour, t, m WITH tournamentYear, tour, COUNT(DISTINCT t) AS numTeams, COUNT(DISTINCT m) AS numMatchesPerTournament WITH tournamentYear, AVG(numTeams) AS avgTeamsPerTournament, SUM(numMatchesPerTournament) AS totalMatchesPlayed RETURN tournamentYear, avgTeamsPerTournament, totalMatchesPlayed",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 534,
        "original_index": 534,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_252",
        "NL Question": "For each tournament, calculate the average number of goals scored per match and the total number of matches played. Return the tournament name, year, average goals per match, and total matches played.",
        "Cypher": "MATCH (t:Tournament)<-[:IN_TOURNAMENT]-(m:Match) OPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m) WITH t, m, COUNT(sg) AS goalsPerMatch WITH t, COUNT(m) AS totalMatches, AVG(goalsPerMatch) AS avgGoalsPerMatch RETURN t.name AS tournamentName, t.year AS tournamentYear, avgGoalsPerMatch, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 535,
        "original_index": 535,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_253",
        "NL Question": "For each team that participated in the 'Canada 2015' tournament, find the average number of goals scored by players representing that team across all matches in the tournament. Return the team name and the average goals scored.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'Canada 2015'}) MATCH (p:Person)-[:REPRESENTS]->(t)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour) OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m) WITH t, p, COUNT(sg) AS goalsPerPlayerPerMatch WITH t, AVG(goalsPerPlayerPerMatch) AS avgGoalsPerPlayer RETURN t.name AS teamName, avgGoalsPerPlayer",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 536,
        "original_index": 536,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_254",
        "NL Question": "For each squad in the 'France 2019' tournament, determine the average age of the players in the squad at the time of the tournament. Return the squad ID and the average age.",
        "Cypher": "MATCH (s:Squad)-[:FOR]->(tour:Tournament {name: 'France 2019'}) MATCH (p:Person)-[:IN_SQUAD]->(s) WHERE p.dob IS NOT NULL WITH s, p, tour.year - p.dob.year AS age RETURN s.id AS squadId, AVG(age) AS averageAge",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 537,
        "original_index": 537,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_255",
        "NL Question": "For each player, find the total number of goals they scored and the number of tournaments in which they scored at least one goal. Return the player's name, total goals scored, and the number of tournaments with at least one goal.",
        "Cypher": "MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament) WITH p, COUNT(sg) AS totalGoals, COLLECT(DISTINCT t.id) AS tournamentsWithGoals RETURN p.name AS playerName, totalGoals, SIZE(tournamentsWithGoals) AS numberOfTournamentsWithGoals",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 538,
        "original_index": 538,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_256",
        "NL Question": "For each team, calculate the total number of matches they played in tournaments before the year 2000 and the average score they achieved in those matches. Return the team name, total matches, and average score.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament) WHERE tour.year < 2000 WITH t, m, r, tour WHERE r.score IS NOT NULL WITH t, COUNT(m) AS totalMatches, AVG(r.score) AS averageScore RETURN t.name AS teamName, totalMatches, averageScore",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 539,
        "original_index": 539,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_259",
        "NL Question": "For the tournament 'Sweden 1995', what is the average number of goals scored per match, considering only matches where goals were actually scored?",
        "Cypher": "MATCH (m:Match)-[:IN_TOURNAMENT]->(t:Tournament {name: 'Sweden 1995'}) OPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m) WITH m, COUNT(sg) AS totalGoals WHERE totalGoals > 0 RETURN AVG(toFloat(totalGoals)) AS averageGoalsPerMatch;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 540,
        "original_index": 540,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_260",
        "NL Question": "For each team that participated in the 'Sweden 1995' tournament, calculate the average number of players in their squads. Return the team name and the average squad size.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'Sweden 1995'}) MATCH (t)-[:NAMED]->(s:Squad)<-[:IN_SQUAD]-(p:Person) WITH t, s, COUNT(p) AS squadSize RETURN t.name AS teamName, AVG(squadSize) AS averageSquadSize;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 541,
        "original_index": 541,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_261",
        "NL Question": "What is the average age of players who scored goals in matches during the 'Sweden 1995' tournament, considering their age at the time of the tournament?",
        "Cypher": "MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament {name: 'Sweden 1995'}) WHERE p.dob IS NOT NULL WITH p, t.year - p.dob.year AS age RETURN AVG(age) AS averageAge;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 542,
        "original_index": 542,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_262",
        "NL Question": "For each stage of matches in the 'Sweden 1995' tournament, determine the average number of teams that played in matches of that stage. Return the stage and the average number of teams.",
        "Cypher": "MATCH (m:Match)-[:IN_TOURNAMENT]->(t:Tournament {name: 'Sweden 1995'}) MATCH (team:Team)-[:PLAYED_IN]->(m) WITH m.stage AS stage, COLLECT(DISTINCT team.id) AS teams RETURN stage, AVG(SIZE(teams)) AS averageNumberOfTeams;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 543,
        "original_index": 543,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_263",
        "NL Question": "Considering only matches where the 'score' property is available in the 'PLAYED_IN' relationship, what is the average 'score' value for teams playing in the 'Sweden 1995' tournament?",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'Sweden 1995'}) WHERE r.score IS NOT NULL RETURN AVG(r.score) AS averageScore;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 544,
        "original_index": 544,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_266",
        "NL Question": "For each team, calculate the total number of matches they played and the average number of goals scored in those matches. Return the team's name, the total matches played, and the average goals scored per match.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match) WHERE r.score IS NOT NULL WITH t, COUNT(m) AS totalMatches, SUM(r.score) AS totalGoals RETURN t.name AS teamName, totalMatches, CASE WHEN totalMatches > 0 THEN toFloat(totalGoals) / totalMatches ELSE 0 END AS avgGoalsPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 545,
        "original_index": 545,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_267",
        "NL Question": "For each tournament, find the team that scored the most goals in all matches within that tournament. Return the tournament name, the team's name, and the total goals scored by that team in the tournament.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[r:PLAYED_IN]-(t:Team) WHERE r.score IS NOT NULL WITH tour, t, SUM(r.score) AS totalGoals ORDER BY tour.id, totalGoals DESC WITH tour, COLLECT({team: t, totalGoals: totalGoals}) AS teamGoals RETURN tour.name AS tournamentName, teamGoals[0].team.name AS teamName, teamGoals[0].totalGoals AS totalGoals",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 546,
        "original_index": 546,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_268",
        "NL Question": "For each player, determine the total number of tournaments they participated in and the average number of matches they played per tournament. Return the player's name, the number of tournaments, and the average matches per tournament.",
        "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament) WITH p, t, COUNT(m) AS matchesPerTournament WITH p, COUNT(DISTINCT t) AS totalTournaments, COLLECT(matchesPerTournament) AS matchesList RETURN p.name AS playerName, totalTournaments, CASE WHEN totalTournaments > 0 THEN toFloat(SUM(matchesList)) / totalTournaments ELSE 0 END AS avgMatchesPerTournament",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "Your Cypher query is close, but there's a small bug in the aggregation step. Specifically, you're trying to SUM(matchesList) â€” but SUM() does not accept a list directly in Cypher."
    },
    {
        "id": 547,
        "original_index": 547,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_269",
        "NL Question": "For the 'China PR 1991' tournament, calculate the average age of all players who scored goals in the matches. Return the average age.",
        "Cypher": "MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'China PR 1991'}) WHERE p.dob IS NOT NULL WITH p, tour, p.dob AS birthDate RETURN avg(tour.year - birthDate.year) AS averageAge",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 548,
        "original_index": 548,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_270",
        "NL Question": "For each team that participated in a tournament, find the average number of players in their squads. Return the team name, tournament name, and the average squad size.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament) MATCH (t)-[:NAMED]->(s:Squad)-[:FOR]->(tour) MATCH (p:Person)-[:IN_SQUAD]->(s) WITH t, tour, s, COUNT(p) AS squadSize WITH t, tour, AVG(squadSize) AS avgSquadSize RETURN t.name AS teamName, tour.name AS tournamentName, avgSquadSize",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 549,
        "original_index": 549,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_273",
        "NL Question": "For each team that participated in the 'Germany 2011' tournament, calculate the total number of matches they played and the average score in those matches. Return the team name, total matches, and average score.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'Germany 2011'}) WITH t, m, r WHERE r.score IS NOT NULL WITH t, COUNT(m) AS totalMatches, AVG(r.score) AS averageScore RETURN t.name AS teamName, totalMatches, averageScore",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 550,
        "original_index": 550,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_274",
        "NL Question": "For each person who played in a match, find the total number of matches they played and the average number of goals they scored per match. Return the person's name, total matches played, and average goals per match.",
        "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match) OPTIONAL MATCH (p)-[s:SCORED_GOAL]->(m) WITH p, COUNT(DISTINCT m) AS totalMatches, COUNT(s) AS totalGoals RETURN p.name AS playerName, totalMatches, CASE WHEN totalMatches > 0 THEN toFloat(totalGoals) / totalMatches ELSE 0 END AS avgGoalsPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 551,
        "original_index": 551,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_275",
        "NL Question": "For each tournament, determine the average number of players per squad and the total number of teams that participated. Return the tournament name, average players per squad, and total participating teams.",
        "Cypher": "MATCH (tour:Tournament)<-[:FOR]-(s:Squad)<-[:IN_SQUAD]-(p:Person) WITH tour, s, COUNT(p) AS playerCount WITH tour, AVG(playerCount) AS avgPlayersPerSquad MATCH (team:Team)-[:PARTICIPATED_IN]->(tour) WITH tour, avgPlayersPerSquad, COUNT(DISTINCT team) AS totalTeams RETURN tour.name AS tournamentName, avgPlayersPerSquad, totalTeams",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 552,
        "original_index": 552,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_276",
        "NL Question": "For each team, find the number of matches they played where their score was greater than 0, and calculate the average penalty score across all matches. Return the team's name, the number of matches with a score greater than 0, and the average penalty score.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match) WHERE r.score > 0 WITH t, COUNT(m) AS matchesWithScoreGreaterThanZero OPTIONAL MATCH (t)-[r2:PLAYED_IN]->(m2:Match) WHERE r2.penaltyScore IS NOT NULL WITH t, matchesWithScoreGreaterThanZero, AVG(r2.penaltyScore) AS averagePenaltyScore RETURN t.name AS teamName, matchesWithScoreGreaterThanZero, averagePenaltyScore",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 553,
        "original_index": 553,
        "source_dataset": "wwc",
        "source_chunk": "data_3_3_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_277",
        "NL Question": "For each tournament, calculate the average number of goals scored by players who were 'Subbed On' and the total number of matches played. Return the tournament name, the average goals scored by 'Subbed On' players, and the total matches played.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[r:PLAYED_IN]-(p:Person) WHERE r.type = 'Subbed On' OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m) WITH tour, m, p, COUNT(sg) AS goalsScoredBySubbedOnPlayer WITH tour, m, AVG(goalsScoredBySubbedOnPlayer) AS avgGoalsBySubbedOnPlayersPerMatch WITH tour, COUNT(DISTINCT m) AS totalMatches, AVG(avgGoalsBySubbedOnPlayersPerMatch) AS avgGoalsBySubbedOnPlayers RETURN tour.name AS tournamentName, avgGoalsBySubbedOnPlayers, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 554,
        "original_index": 554,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_0",
        "NL Question": "For each tournament, calculate the average number of players who scored goals and the total number of goals scored. Return the tournament name, average players with goals, and total goals.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[sg:SCORED_GOAL]-(p:Person) WITH tour, p, COUNT(sg) AS goalsPerPlayerPerMatch WITH tour, COUNT(DISTINCT p) AS playersWithGoals, SUM(goalsPerPlayerPerMatch) AS totalGoals RETURN tour.name AS tournamentName, AVG(playersWithGoals) AS avgPlayersWithGoals, totalGoals",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 555,
        "original_index": 555,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_1",
        "NL Question": "For each team that participated in a tournament, find the average number of goals scored per match and the total number of matches played. Return the team name, average goals per match, and total matches played.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match) WITH t, m, r.score AS score WHERE score IS NOT NULL WITH t, COUNT(m) AS totalMatches, SUM(score) AS totalGoals RETURN t.name AS teamName, toFloat(totalGoals) / totalMatches AS avgGoalsPerMatch, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 556,
        "original_index": 556,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_2",
        "NL Question": "For each player who played in a match, calculate the total number of goals they scored and the average number of minutes they played per match. Return the player's name, total goals scored, and average minutes played.",
        "Cypher": "MATCH (p:Person)-[r:PLAYED_IN]->(m:Match) WHERE r.minuteOn IS NOT NULL WITH p, m, toInteger(r.minuteOn) AS minuteOn OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m) WITH p, AVG(minuteOn) AS avgMinutesPlayed, COUNT(sg) AS totalGoals RETURN p.name AS playerName, totalGoals, avgMinutesPlayed",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 557,
        "original_index": 557,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_3",
        "NL Question": "For each squad, determine the total number of players and the average number of matches played by those players. Return the squad ID, total player count, and average matches played per player.",
        "Cypher": "MATCH (s:Squad)<-[:IN_SQUAD]-(p:Person)-[:PLAYED_IN]->(m:Match) WITH s, p, COUNT(m) AS matchesPlayed OPTIONAL MATCH (s)<-[:IN_SQUAD]-(p2:Person) WITH s, AVG(matchesPlayed) AS avgMatchesPlayed, COUNT(DISTINCT p2) AS totalPlayers RETURN s.id AS squadId, totalPlayers, avgMatchesPlayed",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 558,
        "original_index": 558,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_4",
        "NL Question": "For each tournament, find the team that scored the most goals and calculate the average goals scored by all teams in that tournament. Return the tournament name, the name of the top-scoring team, and the average goals scored by all teams.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[r:PLAYED_IN]-(t:Team) WHERE r.score IS NOT NULL WITH tour, t, SUM(r.score) AS totalGoals ORDER BY tour.name, totalGoals DESC WITH tour, COLLECT({team: t.name, goals: totalGoals}) AS teamGoals, AVG(totalGoals) AS avgGoalsPerTeam RETURN tour.name AS tournamentName, teamGoals[0].team AS topScoringTeam, avgGoalsPerTeam",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 559,
        "original_index": 559,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_7",
        "NL Question": "For each team that participated in the 'USA 1999' tournament, calculate the average number of goals scored per match. Return the team name and their average goals per match.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'USA 1999'}) WHERE r.score IS NOT NULL WITH t, m, r.score AS scorePerMatch WITH t, AVG(scorePerMatch) AS avgGoalsPerMatch RETURN t.name AS teamName, avgGoalsPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 560,
        "original_index": 560,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_8",
        "NL Question": "For the 'France 2019' tournament, what is the average number of players per squad? Return the tournament name and the average squad size.",
        "Cypher": "MATCH (tour:Tournament {name: 'France 2019'})<-[:FOR]-(s:Squad)<-[:IN_SQUAD]-(p:Person) WITH tour, s, COUNT(p) AS squadSize WITH tour, AVG(squadSize) AS avgSquadSize RETURN tour.name AS tournamentName, avgSquadSize",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 561,
        "original_index": 561,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_9",
        "NL Question": "For each tournament, find the team that scored the most goals in total. Return the tournament name, team name, and total goals scored by that team.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament) WHERE r.score IS NOT NULL WITH tour, t, SUM(r.score) AS totalGoals ORDER BY tour.name, totalGoals DESC WITH tour, COLLECT({team: t, totalGoals: totalGoals}) AS teamGoals RETURN tour.name AS tournamentName, teamGoals[0].team.name AS teamName, teamGoals[0].totalGoals AS totalGoals",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 562,
        "original_index": 562,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_10",
        "NL Question": "Calculate the average number of goals scored per match for matches played after '1991-11-16'.",
        "Cypher": "MATCH (m:Match) WHERE date(m.date) > date('1991-11-16') OPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m) WITH m, COUNT(sg) AS goalsPerMatch WITH AVG(goalsPerMatch) AS avgGoalsPerMatch RETURN avgGoalsPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 563,
        "original_index": 563,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_11",
        "NL Question": "For each player, compute the total number of tournaments they participated in and the average number of matches they played per tournament. Return the player's name, total tournaments, and average matches per tournament.",
        "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament) WITH p, tour, m WITH p, tour, COUNT(m) AS matchesPerTournament WITH p, COUNT(DISTINCT tour) AS totalTournaments, COLLECT(matchesPerTournament) AS matchesList RETURN p.name AS playerName, totalTournaments, REDUCE(s = 0, i IN matchesList | s + i) * 1.0 / SIZE(matchesList) AS avgMatchesPerTournament",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 564,
        "original_index": 564,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_14",
        "NL Question": "For the tournament 'China PR 1991', what is the average number of players per squad and the total number of players across all squads?",
        "Cypher": "MATCH (t:Tournament {name: 'China PR 1991'})<-[:FOR]-(s:Squad)<-[:IN_SQUAD]-(p:Person) WITH t, s, COUNT(p) AS squadSize WITH t, AVG(squadSize) AS avgSquadSize, SUM(squadSize) AS totalPlayers RETURN t.name AS tournamentName, avgSquadSize, totalPlayers",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 565,
        "original_index": 565,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_15",
        "NL Question": "Calculate the average number of goals scored per match for each team that participated in the 'Germany 2011' tournament, and also find the total number of matches they played.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'Germany 2011'}) WHERE r.score IS NOT NULL WITH t, COUNT(m) AS totalMatches, SUM(r.score) AS totalGoals RETURN t.name AS teamName, totalMatches, CASE WHEN totalMatches > 0 THEN toFloat(totalGoals) / totalMatches ELSE 0 END AS avgGoalsPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 566,
        "original_index": 566,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_16",
        "NL Question": "For each player, determine the total number of tournaments they participated in and the average number of matches they played per tournament.",
        "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament) WITH p, t, COUNT(m) AS matchesPerTournament WITH p, COUNT(t) AS totalTournaments, COLLECT(matchesPerTournament) AS matchesList RETURN p.name AS playerName, totalTournaments, REDUCE(s = 0, x IN matchesList | s + x) * 1.0 / SIZE(matchesList) AS avgMatchesPerTournament",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 567,
        "original_index": 567,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_17",
        "NL Question": "For each team, calculate the total number of goals scored in all matches and the average number of goals scored per match where they played as 'Home'.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match) WHERE r.type = 'Home' WITH t, COUNT(m) AS totalMatches, SUM(r.score) AS totalGoals RETURN t.name AS teamName, totalGoals, CASE WHEN totalMatches > 0 THEN toFloat(totalGoals) / totalMatches ELSE 0 END AS avgGoalsPerMatch",
        "result [0/1]": "0",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": "Query is correct, but the r.type is too resytrictive."
    },
    {
        "id": 568,
        "original_index": 568,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_18",
        "NL Question": "For each tournament after the year 2000, find the average number of goals scored by players who are older than 25 years at the time of the tournament.",
        "Cypher": "MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament) WHERE tour.year > 2000 AND p.dob IS NOT NULL AND tour.year - p.dob.year > 25 WITH tour, p, COUNT(sg) AS goalsPerPlayer WITH tour, AVG(goalsPerPlayer) AS avgGoalsPerPlayer RETURN tour.name AS tournamentName, avgGoalsPerPlayer",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 569,
        "original_index": 569,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_21",
        "NL Question": "For each team that participated in the 'Sweden 1995' tournament, calculate the average score of their players across all matches. Return the team name and the average score.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'Sweden 1995'}) MATCH (p:Person)-[r:PLAYED_IN]->(m:Match) WHERE (p)-[:REPRESENTS]->(t) WITH t, p, AVG(toInt(r.score)) AS avgScorePerPlayer RETURN t.name AS teamName, avg(avgScorePerPlayer) AS avgTeamScore",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "grammatical error: toInt() function"
    },
    {
        "id": 570,
        "original_index": 570,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_22",
        "NL Question": "For each tournament, find the average number of players from each team that participated in that tournament. Return the tournament name and the average number of players per team.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament) WITH t, tour MATCH (p:Person)-[:REPRESENTS]->(t) WITH tour, t, COUNT(p) AS playerCountPerTeam RETURN tour.name AS tournamentName, AVG(playerCountPerTeam) AS avgPlayersPerTeam",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 571,
        "original_index": 571,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_23",
        "NL Question": "For each tournament, calculate the total number of goals scored by players who are part of a squad 'FOR' that tournament, and then compute the average goals scored per player. Return the tournament name and the average goals per player.",
        "Cypher": "MATCH (tour:Tournament)<-[:FOR]-(s:Squad)<-[:IN_SQUAD]-(p:Person)-[sg:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(tour) WITH tour, p, COUNT(sg) AS goalsPerPlayer RETURN tour.name AS tournamentName, AVG(goalsPerPlayer) AS avgGoalsPerPlayer",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 572,
        "original_index": 572,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_24",
        "NL Question": "For each team, determine the total number of matches played and the average 'minuteOn' for players in those matches. Return the team name, total matches, and average 'minuteOn'.",
        "Cypher": "MATCH (t:Team)-[:PLAYED_IN]->(m:Match) WITH t, COUNT(m) AS totalMatches MATCH (p:Person)-[r:PLAYED_IN]->(m) WHERE (p)-[:REPRESENTS]->(t) AND r.minuteOn IS NOT NULL WITH t, totalMatches, AVG(toFloat(r.minuteOn)) AS avgMinuteOn RETURN t.name AS teamName, totalMatches, avgMinuteOn",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 573,
        "original_index": 573,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_29",
        "NL Question": "For each team that participated in the 'Germany 2011' tournament, compute the total number of goals scored and the average number of goals scored per match. Return the team name, total goals, and average goals per match.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'Germany 2011'})-[<-[:IN_TOURNAMENT]-(m:Match)\nOPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m)\nWITH t, m, COUNT(sg) AS goals\nWITH t, COUNT(m) AS totalMatches, SUM(goals) AS totalGoals\nRETURN t.name AS teamName, totalGoals, toFloat(totalGoals) / totalMatches AS avgGoalsPerMatch",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "This line is malformed and mixes directionality incorrectly."
    },
    {
        "id": 574,
        "original_index": 574,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_31",
        "NL Question": "For each squad, determine the number of players and the average number of matches played by each player in the squad. Return the squad ID, player count, and average matches played per player.",
        "Cypher": "MATCH (s:Squad)<-[:IN_SQUAD]-(p:Person)-[:PLAYED_IN]->(m:Match)\nWITH s, p, COUNT(m) AS matchesPlayed\nWITH s, COUNT(DISTINCT p) AS totalPlayers, AVG(matchesPlayed) AS avgMatchesPerPlayer\nRETURN s.id AS squadId, totalPlayers, avgMatchesPerPlayer",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 575,
        "original_index": 575,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_32",
        "NL Question": "For each year, find the average number of goals scored in matches and the total number of matches played. Return the year, the average goals scored, and the total matches played.",
        "Cypher": "MATCH (m:Match)\nOPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m)\nWITH m.date.year AS matchYear, m, COUNT(sg) AS goals\nWITH matchYear, COUNT(m) AS totalMatches, SUM(goals) AS totalGoals\nRETURN matchYear, toFloat(totalGoals) / totalMatches AS avgGoalsPerMatch, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 576,
        "original_index": 576,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_35",
        "NL Question": "For the tournament 'Germany 2011', calculate the average number of goals scored per match and the total number of matches played. Return the tournament name, average goals per match, and total matches.",
        "Cypher": "MATCH (m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'Germany 2011'}) OPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m) WITH tour, m, COUNT(sg) AS matchGoals WITH tour, SUM(matchGoals) AS totalGoals, COUNT(m) AS totalMatches RETURN tour.name AS tournamentName, CASE WHEN totalMatches > 0 THEN toFloat(totalGoals) / totalMatches ELSE 0 END AS avgGoalsPerMatch, totalMatches;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 577,
        "original_index": 577,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_36",
        "NL Question": "For each team that participated in the 'Germany 2011' tournament, find the average number of goals scored by players from that team in all matches. Return the team name and the average goals scored.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'Germany 2011'}) MATCH (p:Person)-[:REPRESENTS]->(t)-[:PLAYED_IN]->(m:Match) OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m) WITH t, p, COUNT(sg) AS goalsPerPlayer WITH t, AVG(goalsPerPlayer) AS avgGoalsPerPlayer RETURN t.name AS teamName, avgGoalsPerPlayer;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 578,
        "original_index": 578,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_38",
        "NL Question": "For each squad, calculate the total number of players in the squad and the average age of the players in the squad as of the year 2011. Return the squad ID, the total number of players, and the average age.",
        "Cypher": "MATCH (s:Squad)<-[:IN_SQUAD]-(p:Person) WHERE p.dob IS NOT NULL WITH s, p, 2011 - p.dob.year AS ageIn2011 WITH s, AVG(ageIn2011) AS avgAge, COUNT(p) AS totalPlayers RETURN s.id AS squadId, totalPlayers, avgAge;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 579,
        "original_index": 579,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_39",
        "NL Question": "For each team, calculate the total number of matches they played and the average penalty score they achieved across all matches. Return the team name, total matches played, and average penalty score.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match) WHERE r.penaltyScore IS NOT NULL WITH t, COUNT(m) AS totalMatches, AVG(toInt(r.penaltyScore)) AS avgPenaltyScore RETURN t.name AS teamName, totalMatches, avgPenaltyScore;",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "grammatical error: toInt() function"
    },
    {
        "id": 580,
        "original_index": 580,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_42",
        "NL Question": "For each tournament, calculate the average number of players who scored goals in matches within that tournament and the total number of matches played. Return the tournament name, average number of goal-scoring players, and total match count.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[:PLAYED_IN]-(p:Person)-[:SCORED_GOAL]->(m)\nWITH tour, m, collect(DISTINCT p) AS playersWhoScored\nWITH tour, count(m) AS totalMatches, size(playersWhoScored) AS numPlayersWhoScored\nWITH tour, totalMatches, numPlayersWhoScored\nRETURN tour.name AS tournamentName, toFloat(sum(numPlayersWhoScored))/count(DISTINCT tour) AS avgGoalScoringPlayers, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 581,
        "original_index": 581,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_43",
        "NL Question": "For each team, determine the total number of matches they played and the average number of goals scored in those matches. Return the team's name, the total matches played, and the average goals scored, only for teams that have played at least one match.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match)\nWHERE r.score IS NOT NULL\nWITH t, COUNT(m) AS totalMatches, SUM(r.score) AS totalGoals\nWHERE totalMatches > 0\nRETURN t.name AS teamName, totalMatches, toFloat(totalGoals) / totalMatches AS avgGoals",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 582,
        "original_index": 582,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_44",
        "NL Question": "For each player born before 1972, find the total number of goals they scored and the number of distinct tournaments they participated in. Return the player's name, total goals, and the count of distinct tournaments.",
        "Cypher": "MATCH (p:Person)-[:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament)\nWHERE p.dob IS NOT NULL AND p.dob.year < 1972\nWITH p, t, COUNT(m) AS goalsPerTournament\nWITH p, collect(DISTINCT t) AS tournaments, sum(goalsPerTournament) AS totalGoals\nRETURN p.name AS playerName, totalGoals, size(tournaments) AS tournamentCount",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 583,
        "original_index": 583,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_45",
        "NL Question": "For each tournament, calculate the average number of players in each squad participating in that tournament and the total number of teams participating. Return the tournament name, average squad size, and total team count.",
        "Cypher": "MATCH (tour:Tournament)<-[:FOR]-(s:Squad)<-[:IN_SQUAD]-(p:Person)\nWITH tour, s, COUNT(p) AS squadSize\nWITH tour, AVG(squadSize) AS avgSquadSize\nMATCH (team:Team)-[:PARTICIPATED_IN]->(tour)\nWITH tour, avgSquadSize, COUNT(DISTINCT team) AS totalTeams\nRETURN tour.name AS tournamentName, avgSquadSize, totalTeams",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 584,
        "original_index": 584,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_46",
        "NL Question": "For each team that participated in the 'Canada 2015' tournament, determine the average number of goals scored by players representing that team. Return the team name and the average goals scored by its players.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'Canada 2015'})<-[:IN_TOURNAMENT]-(m:Match)<-[:PLAYED_IN]-(p:Person)-[sg:SCORED_GOAL]->(m)\nWHERE p-[:REPRESENTS]->t\nWITH t, COUNT(sg) AS totalGoals, COUNT(DISTINCT p) AS numPlayers\nRETURN t.name AS teamName, toFloat(totalGoals) / numPlayers AS avgGoalsPerPlayer",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "This is not valid Cypher syntax â€” you cannot use a pattern match inside a WHERE clause like that."
    },
    {
        "id": 585,
        "original_index": 585,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_49",
        "NL Question": "For each team that participated in the 'Germany 2011' tournament, calculate the total number of matches they played and the average score in those matches. Return the team name, total matches played, and average score.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'Germany 2011'}) WHERE r.score IS NOT NULL WITH t, COUNT(m) AS matchCount, AVG(r.score) AS avgScore RETURN t.name AS teamName, matchCount AS totalMatches, avgScore",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 586,
        "original_index": 586,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_50",
        "NL Question": "For each person who played in a match, determine the total number of goals they scored and calculate the average number of goals scored per match. Return the person's name, total goals scored, total matches played, and average goals per match.",
        "Cypher": "MATCH (p:Person)-[r:SCORED_GOAL]->(m:Match) WITH p, COUNT(m) AS totalGoals, COLLECT(DISTINCT m) AS matches PLAYED_IN (p)-[:PLAYED_IN]->(m2:Match) WITH p, totalGoals, size(matches) AS totalMatches RETURN p.name AS playerName, totalGoals, totalMatches, CASE WHEN totalMatches = 0 THEN 0 ELSE toFloat(totalGoals) / totalMatches END AS avgGoalsPerMatch",
        "result [0/1]": "0",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": "The r.type() is not a valid Cypher syntax. It should be r:PLAYED_IN instead of r.type()."
    },
    {
        "id": 587,
        "original_index": 587,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_51",
        "NL Question": "For each tournament, find the team with the highest average score across all matches they played in that tournament. Return the tournament name, the team name, and the team's average score.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament) WHERE r.score IS NOT NULL WITH tour, t, AVG(r.score) AS avgScore ORDER BY tour.name, avgScore DESC WITH tour, COLLECT({team: t.name, avgScore: avgScore}) AS teamScores RETURN tour.name AS tournamentName, teamScores[0].team AS teamName, teamScores[0].avgScore AS averageScore",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 588,
        "original_index": 588,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_52",
        "NL Question": "For each squad, calculate the total number of players in the squad and the average number of matches each player has played. Return the squad ID, the total number of players, and the average number of matches played per player.",
        "Cypher": "MATCH (s:Squad)<-[:IN_SQUAD]-(p:Person)-[:PLAYED_IN]->(m:Match) WITH s, p, COUNT(m) AS matchesPlayedPerPlayer WITH s, COUNT(DISTINCT p) AS totalPlayers, AVG(matchesPlayedPerPlayer) AS avgMatchesPerPlayer RETURN s.id AS squadId, totalPlayers, avgMatchesPerPlayer",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 589,
        "original_index": 589,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_53",
        "NL Question": "For each tournament year, determine the average number of goals scored per match and the total number of matches played. Return the tournament year, the average goals per match, and the total matches played.",
        "Cypher": "MATCH (m:Match)-[:IN_TOURNAMENT]->(t:Tournament) OPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m) WITH t.year AS tournamentYear, m, COUNT(sg) AS goalsPerMatch WITH tournamentYear, SUM(goalsPerMatch) AS totalGoals, COUNT(m) AS totalMatches RETURN tournamentYear, CASE WHEN totalMatches = 0 THEN 0 ELSE toFloat(totalGoals) / totalMatches END AS avgGoalsPerMatch, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 590,
        "original_index": 590,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_57",
        "NL Question": "For each team, determine the total number of matches played and calculate the average number of goals scored by players from that team in those matches. Return the team name, total matches played, and average goals scored per match.",
        "Cypher": "MATCH (t:Team)-[:PLAYED_IN]->(m:Match)\nOPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m)\nWHERE (p)-[:REPRESENTS]->(t)\nWITH t, m, COUNT(sg) AS goalsPerMatch\nWITH t, COUNT(DISTINCT m) AS totalMatches, SUM(goalsPerMatch) AS totalGoals\nRETURN t.name AS teamName, totalMatches, CASE WHEN totalMatches > 0 THEN toFloat(totalGoals) / totalMatches ELSE 0 END AS avgGoalsPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 591,
        "original_index": 591,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_58",
        "NL Question": "For each player born before 1980, find the number of tournaments they participated in and the average number of goals they scored per tournament. Return the player's name, number of tournaments, and average goals per tournament.",
        "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament)\nWHERE p.dob.year < 1980\nOPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m)\nWITH p, t, COUNT(sg) AS goalsPerTournament\nWITH p, COUNT(DISTINCT t) AS totalTournaments, SUM(goalsPerTournament) AS totalGoals\nRETURN p.name AS playerName, totalTournaments, CASE WHEN totalTournaments > 0 THEN toFloat(totalGoals) / totalTournaments ELSE 0 END AS avgGoalsPerTournament",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 592,
        "original_index": 592,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_59",
        "NL Question": "For each squad participating in the 'USA 1999' tournament, calculate the average age of the players in the squad and the total number of goals scored by the squad's players. Return the squad ID, average player age, and total goals scored.",
        "Cypher": "MATCH (s:Squad)-[:FOR]->(t:Tournament {name: 'USA 1999'})<-[:IN_TOURNAMENT]-(m:Match)<-[sg:SCORED_GOAL]-(p:Person)-[:IN_SQUAD]->(s)\nWHERE p.dob IS NOT NULL\nWITH s, p, m, sg, t.year - p.dob.year AS playerAge\nWITH s, AVG(playerAge) AS avgPlayerAge, COUNT(sg) AS totalGoals\nRETURN s.id AS squadId, avgPlayerAge, totalGoals",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 593,
        "original_index": 593,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_60",
        "NL Question": "For each team that played in a match in the year 2011, calculate the total number of goals scored and the average number of minutes played by the players of that team. Return the team name, total goals scored, and average minutes played.",
        "Cypher": "MATCH (t:Team)-[:PLAYED_IN]->(m:Match)\nWHERE m.date.year = 2011\nOPTIONAL MATCH (p:Person)-[pi:PLAYED_IN]->(m)\nWHERE (p)-[:REPRESENTS]->(t)\nWITH t, m, p, pi.minuteOn as minuteOn\nOPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m)\nWITH t, m, p, minuteOn, COUNT(sg) AS goalsPerMatch\nWITH t, SUM(goalsPerMatch) AS totalGoals, AVG(toInt(minuteOn)) AS avgMinutesPlayed\nRETURN t.name AS teamName, totalGoals, avgMinutesPlayed",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "grammatical error: toInt() function"
    },
    {
        "id": 594,
        "original_index": 594,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_64",
        "NL Question": "For each tournament, determine the average number of players from each squad participating in the tournament. Return the tournament name and the average number of players per squad.",
        "Cypher": "MATCH (tour:Tournament)<-[:FOR]-(s:Squad)<-[:IN_SQUAD]-(p:Person) WITH tour, s, COUNT(p) AS playerCountPerSquad WITH tour, AVG(playerCountPerSquad) AS avgPlayersPerSquad RETURN tour.name AS tournamentName, avgPlayersPerSquad",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 595,
        "original_index": 595,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_65",
        "NL Question": "For each player, calculate the total number of goals they scored and the number of tournaments they played in. Then, calculate the average goals scored per tournament for each player. Return the player's name, the number of tournaments, and the average goals per tournament.",
        "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament) OPTIONAL MATCH (p)-[s:SCORED_GOAL]->(m) WITH p, COUNT(DISTINCT t) AS tournamentCount, COUNT(s) AS totalGoals RETURN p.name AS playerName, tournamentCount, CASE WHEN tournamentCount = 0 THEN 0 ELSE toFloat(totalGoals) / tournamentCount END AS avgGoalsPerTournament",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 596,
        "original_index": 596,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_66",
        "NL Question": "For each team that participated in the 'Germany 2011' tournament, calculate the total number of goals scored by all players representing that team. Return the team name and the total goals scored.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'Germany 2011'}) MATCH (p:Person)-[:REPRESENTS]->(t)-[:PLAYED_IN]->(m:Match) MATCH (p)-[s:SCORED_GOAL]->(m) WITH t, COUNT(s) AS totalGoals RETURN t.name AS teamName, totalGoals",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 597,
        "original_index": 597,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_67",
        "NL Question": "For each tournament, find the average age of the players who scored goals in the matches of that tournament. Return the tournament name and the average age of goal scorers.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[sg:SCORED_GOAL]-(p:Person) WHERE p.dob IS NOT NULL WITH tour, p, tour.year - p.dob.year AS playerAge WITH tour, AVG(playerAge) AS avgAge RETURN tour.name AS tournamentName, avgAge",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 598,
        "original_index": 598,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_70",
        "NL Question": "For each tournament, what is the average number of players who scored goals in matches, and what is the total number of matches played?",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[:SCORED_GOAL]-(p:Person) WITH tour, m, COLLECT(DISTINCT p) AS playersPerMatch, COUNT(DISTINCT m) AS totalMatchesPerTournament WITH tour, AVG(SIZE(playersPerMatch)) AS avgPlayersScoring, totalMatchesPerTournament RETURN tour.name AS TournamentName, avgPlayersScoring, totalMatchesPerTournament",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 599,
        "original_index": 599,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_71",
        "NL Question": "For each team that participated in the 'USA 2003' tournament, calculate the average number of goals scored in matches and the total number of matches they played.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'USA 2003'}) MATCH (t)-[r:PLAYED_IN]->(m:Match) WHERE r.score IS NOT NULL WITH t, COUNT(m) AS totalMatches, AVG(r.score) AS avgGoalsPerMatch RETURN t.name AS TeamName, totalMatches, avgGoalsPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 600,
        "original_index": 600,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_72",
        "NL Question": "For each person, calculate the total number of goals they scored and the average number of minutes they played in each match. Return the person's name, the total goals scored and the average minutes played.",
        "Cypher": "MATCH (p:Person)-[r:PLAYED_IN]->(m:Match) WITH p, m, r.minuteOn AS minuteOn OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m) WITH p, SUM(toInt(sg.minute)) AS totalGoals, AVG(toInt(minuteOn)) AS avgMinutesPlayed RETURN p.name AS PersonName, totalGoals, avgMinutesPlayed",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "grammatical error: toInt() function"
    },
    {
        "id": 601,
        "original_index": 601,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_73",
        "NL Question": "For each tournament, find the average number of teams participating and the total number of squads involved.",
        "Cypher": "MATCH (tour:Tournament)<-[:PARTICIPATED_IN]-(t:Team) WITH tour, COUNT(DISTINCT t) AS teamCount MATCH (tour)<-[:FOR]-(s:Squad) WITH tour, teamCount, COUNT(DISTINCT s) AS squadCount RETURN tour.name AS TournamentName, AVG(teamCount) AS avgTeams, SUM(squadCount) AS totalSquads",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 602,
        "original_index": 602,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_74",
        "NL Question": "For each team, calculate the total number of goals scored in all matches played and the average number of goals scored per match. Display the team name, total goals scored, and average goals per match.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match) WHERE r.score IS NOT NULL WITH t, COUNT(m) AS totalMatches, SUM(r.score) AS totalGoals RETURN t.name AS TeamName, totalGoals, CASE WHEN totalMatches > 0 THEN toFloat(totalGoals) / totalMatches ELSE 0 END AS avgGoalsPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 603,
        "original_index": 603,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_77",
        "NL Question": "For each team that participated in the 'Canada 2015' tournament, calculate the total number of matches they played and the average score in those matches. Return the team name, total matches, and average score.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'Canada 2015'}) WHERE r.score IS NOT NULL WITH t, COUNT(m) AS totalMatches, AVG(r.score) AS averageScore RETURN t.name AS teamName, totalMatches, averageScore",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 604,
        "original_index": 604,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_79",
        "NL Question": "For each player, calculate the total number of matches played in the 'France 2019' tournament and the average 'score' they achieved in those matches. Return the player's name, the total matches played, and the average score.",
        "Cypher": "MATCH (p:Person)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'France 2019'}) WHERE r.score IS NOT NULL WITH p, COUNT(m) AS totalMatches, AVG(r.score) AS averageScore RETURN p.name AS playerName, totalMatches, averageScore",
        "result [0/1]": "0",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": "The query is correct, there is some minor issue with the dataset."
    },
    {
        "id": 605,
        "original_index": 605,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_80",
        "NL Question": "For each team, find the average number of goals scored by players representing that team in all matches. Return the team name and the average goals scored by its players.",
        "Cypher": "MATCH (t:Team)<-[:REPRESENTS]-(p:Person)-[sg:SCORED_GOAL]->(m:Match) WITH t, p, COUNT(sg) AS goalsPerPlayer WITH t, AVG(goalsPerPlayer) AS avgGoalsPerPlayer RETURN t.name AS teamName, avgGoalsPerPlayer",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 606,
        "original_index": 606,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_81",
        "NL Question": "For each tournament, calculate the average number of goals scored per match and the total number of participating teams. Return the tournament's name, average goals per match, and the count of participating teams.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match) OPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m) WITH tour, m, COUNT(sg) AS goalsPerMatch MATCH (t:Team)-[:PARTICIPATED_IN]->(tour) WITH tour, AVG(goalsPerMatch) AS avgGoalsPerMatch, COUNT(DISTINCT t) AS totalTeams RETURN tour.name AS tournamentName, avgGoalsPerMatch, totalTeams",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 607,
        "original_index": 607,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_84",
        "NL Question": "For each team, calculate the total number of matches they played in the 'France 2019' tournament and the average number of goals scored per match. Return the team name, total matches, and average goals per match.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'France 2019'})\nOPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m)\nWHERE t.name IS NOT NULL AND r.score IS NOT NULL\nWITH t, COUNT(DISTINCT m) AS matchCount, SUM(r.score) AS totalGoals\nRETURN t.name AS teamName, matchCount AS totalMatches, CASE WHEN matchCount = 0 THEN 0 ELSE toFloat(totalGoals)/matchCount END AS avgGoalsPerMatch;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 608,
        "original_index": 608,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_85",
        "NL Question": "For the 'USA 1999' tournament, determine the average number of players per squad and the total number of matches played. Return the average players per squad and total matches.",
        "Cypher": "MATCH (tour:Tournament {name: 'USA 1999'})<-[:FOR]-(s:Squad)<-[:IN_SQUAD]-(p:Person)\nWITH tour, s, COUNT(DISTINCT p) AS playerCount\nWITH tour, AVG(playerCount) AS avgPlayersPerSquad\nMATCH (m:Match)-[:IN_TOURNAMENT]->(tour)\nWITH tour, avgPlayersPerSquad, COUNT(DISTINCT m) AS totalMatches\nRETURN avgPlayersPerSquad, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 609,
        "original_index": 609,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_86",
        "NL Question": "For each person who played in a match, find the average 'score' and 'penaltyScore' from the 'PLAYED_IN' relationship. Return the person's name, average score, and average penalty score.",
        "Cypher": "MATCH (p:Person)-[r:PLAYED_IN]->(m:Match)\nWHERE r.score IS NOT NULL AND r.penaltyScore IS NOT NULL\nWITH p, AVG(toInt(r.score)) AS avgScore, AVG(toInt(r.penaltyScore)) AS avgPenaltyScore\nRETURN p.name AS playerName, avgScore, avgPenaltyScore",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "grammatical error: toInt() function"
    },
    {
        "id": 610,
        "original_index": 610,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_87",
        "NL Question": "For each team that participated in a tournament, calculate the total number of players who represent that team and the average number of goals scored by those players. Return the team name, player count, and average goals scored.",
        "Cypher": "MATCH (t:Team)<-[:REPRESENTS]-(p:Person)\nOPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m:Match)\nWITH t, p, COUNT(sg) AS goalsPerPlayer\nWITH t, COUNT(DISTINCT p) AS totalPlayers, AVG(goalsPerPlayer) AS avgGoalsPerPlayer\nRETURN t.name AS teamName, totalPlayers, avgGoalsPerPlayer",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 611,
        "original_index": 611,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_88",
        "NL Question": "For each tournament, find the team with the highest average 'score' in the 'PLAYED_IN' relationships across all matches. Return the tournament name and the name of the team with the highest average score.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[r:PLAYED_IN]-(t:Team)\nWHERE r.score IS NOT NULL\nWITH tour, t, AVG(toInt(r.score)) AS avgScore\nORDER BY tour.id, avgScore DESC\nWITH tour, COLLECT({team: t, avgScore: avgScore}) AS teamScores\nRETURN tour.name AS tournamentName, teamScores[0].team.name AS teamWithHighestAvgScore",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "grammatical error: toInt() function"
    },
    {
        "id": 612,
        "original_index": 612,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_91",
        "NL Question": "For each team that participated in the tournament 'Canada 2015', calculate the average number of goals scored by players of that team across all matches they played in the tournament. Return the team name and the average goals scored.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'Canada 2015'}) MATCH (p:Person)-[:REPRESENTS]->(t)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour) OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m) WITH t, p, COUNT(sg) AS goalsPerPlayerPerMatch WITH t, AVG(goalsPerPlayerPerMatch) AS avgGoalsPerPlayer RETURN t.name AS teamName, avgGoalsPerPlayer",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 613,
        "original_index": 613,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_92",
        "NL Question": "For each person who played in a match, find the total number of goals they scored and the total number of matches they played in. Then, calculate the average goals scored per match for each person. Return the person's name, total matches played, total goals scored, and the average goals per match, ordering by average goals per match in descending order.",
        "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match) WITH p, COUNT(DISTINCT m) AS totalMatches OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m2:Match) WITH p, totalMatches, COUNT(sg) AS totalGoals RETURN p.name AS playerName, totalMatches, totalGoals, CASE WHEN totalMatches = 0 THEN 0 ELSE toFloat(totalGoals)/totalMatches END AS avgGoalsPerMatch ORDER BY avgGoalsPerMatch DESC",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 614,
        "original_index": 614,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_94",
        "NL Question": "For each squad, determine the total number of players and the average number of goals scored by players in matches of the tournament 'Canada 2015'. Return the squad ID, total player count, and average goals per player.",
        "Cypher": "MATCH (s:Squad)-[:FOR]->(tour:Tournament {name: 'Canada 2015'}) MATCH (s)<-[:IN_SQUAD]-(p:Person) OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(tour) WITH s, p, COUNT(sg) AS goalsPerPlayer WITH s, COUNT(DISTINCT p) AS totalPlayers, AVG(goalsPerPlayer) AS avgGoalsPerPlayer RETURN s.id AS squadId, totalPlayers, avgGoalsPerPlayer",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 615,
        "original_index": 615,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_95",
        "NL Question": "For each team, find the total number of matches they played and the average number of goals scored in those matches where the score property is available. Return the team name, total matches played, and the average goals scored per match.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match) WHERE r.score IS NOT NULL WITH t, COUNT(m) AS matchCount, SUM(r.score) AS totalGoals RETURN t.name AS teamName, matchCount AS totalMatches, toFloat(totalGoals)/matchCount AS avgGoalsPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 616,
        "original_index": 616,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_98",
        "NL Question": "For each tournament, what is the average number of players who scored goals in a match and the total number of goals scored across all matches?",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[sg:SCORED_GOAL]-(p:Person) WITH tour, m, COLLECT(DISTINCT p) AS players, COUNT(sg) AS goalsPerMatch WITH tour, AVG(SIZE(players)) AS avgPlayersScoring, SUM(goalsPerMatch) AS totalGoalsScored RETURN tour.name AS tournamentName, avgPlayersScoring, totalGoalsScored",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 617,
        "original_index": 617,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_99",
        "NL Question": "For each team that participated in a tournament, what is the average number of matches played per year and the total number of goals scored across all tournaments?",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament) MATCH (t)-[r:PLAYED_IN]->(m:Match) WITH t, tour, m, r.score AS matchScore WHERE matchScore IS NOT NULL WITH t, tour, COUNT(m) AS matchesPlayed, SUM(matchScore) AS totalGoalsScored RETURN t.name AS teamName, AVG(matchesPlayed) AS avgMatchesPlayed, SUM(totalGoalsScored) AS totalGoals",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 618,
        "original_index": 618,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_100",
        "NL Question": "For each tournament, determine the average age of the players who played in matches and the total number of matches played.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[:PLAYED_IN]-(p:Person) WHERE p.dob IS NOT NULL WITH tour, p, m, tour.year - p.dob.year AS playerAge WITH tour, AVG(playerAge) AS avgPlayerAge, COUNT(DISTINCT m) AS totalMatchesPlayed RETURN tour.name AS tournamentName, avgPlayerAge, totalMatchesPlayed",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 619,
        "original_index": 619,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_101",
        "NL Question": "For each team, calculate the average number of goals scored in matches played in the 'Group Matches' stage and the total number of matches played in that stage.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match) WHERE m.stage = 'Group Matches' WITH t, m, r.score AS matchScore WHERE matchScore IS NOT NULL WITH t, COUNT(m) AS totalMatches, SUM(matchScore) AS totalGoals RETURN t.name AS teamName, AVG(totalGoals) AS avgGoals, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 620,
        "original_index": 620,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_102",
        "NL Question": "For each tournament, what is the average number of players in squads and the total number of teams that participated?",
        "Cypher": "MATCH (tour:Tournament)<-[:FOR]-(s:Squad)<-[:IN_SQUAD]-(p:Person) WITH tour, s, COUNT(DISTINCT p) AS playerCount MATCH (t:Team)-[:PARTICIPATED_IN]->(tour) WITH tour, AVG(playerCount) AS avgPlayersInSquad, COUNT(DISTINCT t) AS totalTeamsParticipated RETURN tour.name AS tournamentName, avgPlayersInSquad, totalTeamsParticipated",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 621,
        "original_index": 621,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_105",
        "NL Question": "For each team that participated in the 'Canada 2015' tournament, calculate the average number of goals scored by their players across all matches they played in. Return the team name and the average goals scored.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'Canada 2015'}) MATCH (p:Person)-[:REPRESENTS]->(t)-[:PLAYED_IN]->(m:Match) OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m) WITH t, p, COUNT(sg) AS goalsPerPlayerPerMatch WITH t, AVG(goalsPerPlayerPerMatch) AS avgGoalsPerPlayer RETURN t.name AS teamName, avgGoalsPerPlayer",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 622,
        "original_index": 622,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_106",
        "NL Question": "For each tournament, determine the team with the highest average 'score' in the PLAYED_IN relationship, considering only matches where the 'score' property is not null. Return the tournament name, the team's name, and the average score.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament) WHERE r.score IS NOT NULL WITH tour, t, AVG(r.score) AS avgScore ORDER BY tour.name, avgScore DESC WITH tour, COLLECT({team: t.name, avgScore: avgScore}) AS teamScores RETURN tour.name AS tournamentName, teamScores[0].team AS teamWithHighestAvgScore, teamScores[0].avgScore AS highestAvgScore",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 623,
        "original_index": 623,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_107",
        "NL Question": "For each player, calculate the total number of tournaments they participated in and the average number of matches they played per tournament. Return the player's name, the total tournaments, and the average matches per tournament.",
        "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament) WITH p, tour, COUNT(m) AS matchesPerTournament WITH p, COUNT(DISTINCT tour) AS totalTournaments, COLLECT(matchesPerTournament) AS matchesList RETURN p.name AS playerName, totalTournaments, REDUCE(s = 0, i IN matchesList | s + i) * 1.0 / SIZE(matchesList) AS avgMatchesPerTournament",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 624,
        "original_index": 624,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_108",
        "NL Question": "For each team, calculate the total number of players who scored goals in matches they played and the average number of goals scored by these players. Return the team's name, the number of goal-scoring players, and the average goals scored by these players.",
        "Cypher": "MATCH (t:Team)-[:PLAYED_IN]->(m:Match)<-[sg:SCORED_GOAL]-(p:Person) WHERE sg.minute IS NOT NULL WITH t, p, COUNT(sg) AS goalsPerPlayerPerMatch WITH t, COUNT(DISTINCT p) AS totalGoalScorers, COLLECT(goalsPerPlayerPerMatch) AS goalsList RETURN t.name AS teamName, totalGoalScorers, REDUCE(s = 0, i IN goalsList | s + i) * 1.0 / SIZE(goalsList) AS avgGoalsPerScorer",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 625,
        "original_index": 625,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_109",
        "NL Question": "For each tournament, find the average age of the players who played in matches during that tournament. Return the tournament name and the average age of the players.",
        "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament) WHERE p.dob IS NOT NULL WITH tour, p, tour.year - p.dob.year AS playerAge WITH tour, AVG(playerAge) AS avgPlayerAge RETURN tour.name AS tournamentName, avgPlayerAge",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 626,
        "original_index": 626,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_113",
        "NL Question": "For each team that participated in the 'France 2019' tournament, determine the total number of goals scored by all players and the average number of goals scored per player. Return the team name, total goals, and average goals per player.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'France 2019'})<-[:IN_TOURNAMENT]-(m:Match)<-[sg:SCORED_GOAL]-(p:Person)\nWITH t, p, COUNT(sg) AS goalsPerPlayer\nWITH t, SUM(goalsPerPlayer) AS totalGoals, COUNT(DISTINCT p) AS totalPlayers\nRETURN t.name AS teamName, totalGoals, CASE WHEN totalPlayers = 0 THEN 0 ELSE toFloat(totalGoals) / totalPlayers END AS avgGoalsPerPlayer",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 627,
        "original_index": 627,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_114",
        "NL Question": "For each person, find the average number of tournaments they played in and the total number of goals they scored. Return the person's name, average tournaments, and total goals.",
        "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament)\nWITH p, t, m\nOPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m)\nWITH p, COUNT(DISTINCT t) AS tournamentsPlayed, COUNT(sg) AS totalGoals\nRETURN p.name AS personName, toFloat(tournamentsPlayed), totalGoals",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 628,
        "original_index": 628,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_115",
        "NL Question": "For each squad, compute the average number of players and the average number of goals scored per match by players in that squad. Return the squad ID, average number of players, and average goals per match.",
        "Cypher": "MATCH (s:Squad)<-[:IN_SQUAD]-(p:Person)\nWITH s, COUNT(DISTINCT p) AS totalPlayers\nOPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m:Match)\nWITH s, totalPlayers, COUNT(sg) AS totalGoals\nRETURN s.id AS squadId, toFloat(totalPlayers), toFloat(totalGoals)",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 629,
        "original_index": 629,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_116",
        "NL Question": "For each tournament, determine the average number of teams participating and the total number of people who scored goals. Return the tournament name, average teams, and total goal scorers.",
        "Cypher": "MATCH (tour:Tournament)<-[:PARTICIPATED_IN]-(t:Team)\nWITH tour, COUNT(DISTINCT t) AS totalTeams\nOPTIONAL MATCH (tour)<-[:IN_TOURNAMENT]-(m:Match)<-[sg:SCORED_GOAL]-(p:Person)\nWITH tour, totalTeams, COUNT(DISTINCT p) AS totalGoalScorers\nRETURN tour.name AS tournamentName, toFloat(totalTeams), totalGoalScorers",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 630,
        "original_index": 630,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_119",
        "NL Question": "For each tournament, calculate the total number of goals scored and the average number of goals scored per team participating in that tournament. Return the tournament name, total goals scored, and average goals per team.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[:SCORED_GOAL]-(p:Person)\nWITH tour, m, COUNT(p) AS goalsPerMatch\nMATCH (team:Team)-[:PARTICIPATED_IN]->(tour)\nWITH tour, team, SUM(goalsPerMatch) AS totalGoals\nWITH tour, SUM(totalGoals) AS totalTournamentGoals, COUNT(team) AS totalTeams\nRETURN tour.name AS tournamentName, totalTournamentGoals, toFloat(totalTournamentGoals) / totalTeams AS avgGoalsPerTeam",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 631,
        "original_index": 631,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_120",
        "NL Question": "For each team, find the average number of players who scored goals in matches they played in and the total number of matches they played. Return the team name, average players who scored, and total matches played.",
        "Cypher": "MATCH (t:Team)-[:PLAYED_IN]->(m:Match)<-[:SCORED_GOAL]-(p:Person)\nWITH t, m, COUNT(DISTINCT p) AS playersScored\nWITH t, AVG(playersScored) AS avgPlayersScored, COUNT(m) AS totalMatches\nRETURN t.name AS teamName, avgPlayersScored, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 632,
        "original_index": 632,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_121",
        "NL Question": "For each tournament, determine the number of teams that participated and the average number of matches played by each team. Return the tournament name, total teams, and average matches per team.",
        "Cypher": "MATCH (tour:Tournament)<-[:PARTICIPATED_IN]-(team:Team)-[:PLAYED_IN]->(match:Match)\nWITH tour, team, COUNT(match) AS matchesPlayed\nWITH tour, COUNT(team) AS totalTeams, AVG(matchesPlayed) AS avgMatchesPerTeam\nRETURN tour.name AS tournamentName, totalTeams, avgMatchesPerTeam",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 633,
        "original_index": 633,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_122",
        "NL Question": "For each player born before 1980, calculate the total number of goals they scored and the average score of the matches they played in. Return the player's name, total goals, and average match score.",
        "Cypher": "MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match)\nWHERE p.dob.year < 1980\nWITH p, COUNT(sg) AS totalGoals, m\nOPTIONAL MATCH (p)-[pi:PLAYED_IN]->(m)\nWITH p, totalGoals, AVG(toInt(pi.score)) AS avgMatchScore\nRETURN p.name AS playerName, totalGoals, avgMatchScore",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "grammatical error: toInt() function"
    },
    {
        "id": 634,
        "original_index": 634,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_123",
        "NL Question": "For each tournament held after the year 2000, determine the average number of players per squad and the total number of matches played. Return the tournament name, average players per squad, and total matches played.",
        "Cypher": "MATCH (tour:Tournament)<-[:FOR]-(s:Squad)<-[:IN_SQUAD]-(p:Person)\nWHERE tour.year > 2000\nWITH tour, s, COUNT(p) AS playersPerSquad\nWITH tour, AVG(playersPerSquad) AS avgPlayersPerSquad\nMATCH (tour)<-[:IN_TOURNAMENT]-(m:Match)\nWITH tour, avgPlayersPerSquad, COUNT(m) AS totalMatches\nRETURN tour.name AS tournamentName, avgPlayersPerSquad, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 635,
        "original_index": 635,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_128",
        "NL Question": "For each person, find the tournaments in which they played, and determine the average number of goals they scored per tournament. Return the person's name, the number of tournaments, and their average goals per tournament.",
        "Cypher": "MATCH (p:Person)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament) WHERE r.score IS NOT NULL WITH p, t, SUM(r.score) AS totalGoalsPerTournament WITH p, COLLECT(t.name) AS tournaments, AVG(totalGoalsPerTournament) AS avgGoalsPerTournament RETURN p.name AS personName, SIZE(tournaments) AS numberOfTournaments, avgGoalsPerTournament;",
        "result [0/1]": "0",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": "The cypher is correct, but result are empty"
    },
    {
        "id": 636,
        "original_index": 636,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_130",
        "NL Question": "For each team that participated in the 'Sweden 1995' tournament, calculate the total number of goals scored and the average number of players who scored those goals. Return the team name, total goals, and average number of scorers.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'Sweden 1995'}) MATCH (t)-[:PLAYED_IN]->(m:Match)<-[sg:SCORED_GOAL]-(p:Person) WITH t, COUNT(sg) AS totalGoals, COLLECT(DISTINCT p) AS scorers RETURN t.name AS teamName, totalGoals, SIZE(scorers) AS numberOfScorers;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 637,
        "original_index": 637,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_133",
        "NL Question": "For each tournament, compute the total number of goals scored and the average number of goals scored per match. Return the tournament name, the total goals scored, the total matches played, and the average goals per match.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[sg:SCORED_GOAL]-(p:Person) WITH tour, m, COUNT(sg) AS goalsPerMatch WITH tour, SUM(goalsPerMatch) AS totalGoals, COUNT(m) AS totalMatches RETURN tour.name AS tournamentName, totalGoals, totalMatches, CASE WHEN totalMatches > 0 THEN toFloat(totalGoals) / totalMatches ELSE 0 END AS avgGoalsPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 638,
        "original_index": 638,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_134",
        "NL Question": "For each team that participated in the 'China 2007' tournament, find the average number of players who scored goals in their matches. Return the team name and the average number of goal-scoring players.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'China 2007'}) MATCH (t)-[:PLAYED_IN]->(m:Match)<-[sg:SCORED_GOAL]-(p:Person) WITH t, m, COLLECT(DISTINCT p) AS goalScorers RETURN t.name AS teamName, size(goalScorers) as numberOfGoalScorers",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 639,
        "original_index": 639,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_136",
        "NL Question": "For each year, find the average number of goals scored in matches played in that year. Return the year and the average number of goals scored.",
        "Cypher": "MATCH (m:Match)<-[sg:SCORED_GOAL]-(p:Person) WITH m.date.year AS matchYear, COUNT(sg) AS totalGoals RETURN matchYear, toFloat(totalGoals) / count(m) AS avgGoalsPerMatch",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "is logically incorrect due to aggregation misuse â€” you are using COUNT(sg) and COUNT(m) in a way that doesn't group correctly per match"
    },
    {
        "id": 640,
        "original_index": 640,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_137",
        "NL Question": "For each team, find the tournament in which they scored the most goals. Return the team name, the tournament name, and the total goals scored by the team in that tournament.",
        "Cypher": "MATCH (t:Team)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament) OPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m) WHERE (p)-[:REPRESENTS]->(t) WITH t, tour, COUNT(sg) AS totalGoals ORDER BY t.id, totalGoals DESC WITH t, COLLECT({tournament: tour, goals: totalGoals}) AS tournamentGoals RETURN t.name AS teamName, tournamentGoals[0].tournament.name AS tournamentName, tournamentGoals[0].goals AS totalGoals",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 641,
        "original_index": 641,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_140",
        "NL Question": "For the 'Sweden 1995' tournament, what is the average number of goals scored by each team in their matches, and what is the total number of matches played by all teams?",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'Sweden 1995'}) WHERE r.score IS NOT NULL WITH tour, t, COUNT(m) AS matchesPlayed, SUM(r.score) AS totalGoalsPerTeam WITH tour, t, matchesPlayed, totalGoalsPerTeam RETURN tour.name AS tournamentName, t.name AS teamName, matchesPlayed, totalGoalsPerTeam, toFloat(totalGoalsPerTeam)/matchesPlayed AS avgGoalsPerMatch, SUM(matchesPlayed) OVER (PARTITION BY tour.name) AS totalMatchesPlayed",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "Your current Cypher query is mostly well-written but contains a SQL-style analytic function (SUM(...) OVER (...)), which is not supported in standard Neo4j Cypher. Neo4j doesn't have window functions like SQL"
    },
    {
        "id": 642,
        "original_index": 642,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_141",
        "NL Question": "For each tournament, determine the average age of players who scored goals, and the total number of players who scored at least one goal.",
        "Cypher": "MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament) WHERE p.dob IS NOT NULL WITH tour, p, p.dob AS playerDob, COUNT(sg) AS goalsScored WHERE goalsScored > 0 WITH tour, playerDob, COUNT(p) AS playerCount, p.name AS playerName RETURN tour.name AS tournamentName, AVG(duration.between(playerDob, date(tour.year+'-01-01')).years) AS averageAge, COUNT(DISTINCT playerName) AS totalPlayersWithGoals",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 643,
        "original_index": 643,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_142",
        "NL Question": "For each team, calculate the average number of players who represent them and the total number of tournaments they participated in.",
        "Cypher": "MATCH (p:Person)-[:REPRESENTS]->(t:Team) WITH t, COUNT(p) AS playersRepresenting MATCH (t)-[:PARTICIPATED_IN]->(tour:Tournament) WITH t, playersRepresenting, COUNT(tour) AS tournamentsParticipated RETURN t.name AS teamName, AVG(playersRepresenting) AS averagePlayers, tournamentsParticipated",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 644,
        "original_index": 644,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_143",
        "NL Question": "For each squad, what is the average age of the coaches and the total number of players in the squad?",
        "Cypher": "MATCH (p:Person)-[:COACH_FOR]->(s:Squad) WHERE p.dob IS NOT NULL WITH s, p, p.dob AS coachDob MATCH (s)<-[:IN_SQUAD]-(player:Person) WITH s, coachDob, COUNT(player) AS totalPlayers RETURN s.id AS squadId, AVG(duration.between(coachDob, date())).years AS averageCoachAge, totalPlayers",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 645,
        "original_index": 645,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_144",
        "NL Question": "For each player who played in a match during the 'China PR 1991' tournament, determine the total number of goals they scored and the average minutes they played in each match.",
        "Cypher": "MATCH (p:Person)-[pi:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament {name: 'China PR 1991'}) OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m) WITH p, m, pi, COUNT(sg) AS totalGoals WHERE pi.minuteOn IS NOT NULL WITH p, m, totalGoals, toInteger(split(pi.minuteOn, \"'\")[0]) AS minutesPlayed RETURN p.name AS playerName, SUM(totalGoals) AS totalGoalsScored, AVG(minutesPlayed) AS averageMinutesPlayed",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 646,
        "original_index": 646,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_148",
        "NL Question": "For each team that participated in a tournament, calculate the total number of goals scored by their players across all matches and the average number of players who scored in each match. Return the team name, total goals scored, and average number of scoring players per match.",
        "Cypher": "MATCH (t:Team)-[:PLAYED_IN]->(m:Match)\nOPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m)\nWITH t, m, COLLECT(DISTINCT p) AS scoringPlayers, COUNT(sg) AS goals\nWITH t, SUM(goals) AS totalGoals, AVG(SIZE(scoringPlayers)) AS avgScoringPlayersPerMatch\nRETURN t.name AS teamName, totalGoals, avgScoringPlayersPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 647,
        "original_index": 647,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_149",
        "NL Question": "For each player who played in a match during 'Canada 2015', determine the total number of goals they scored and the average number of minutes they played. Return the player's name, total goals, and average minutes played, only considering players who scored at least one goal.",
        "Cypher": "MATCH (p:Person)-[pi:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament {name: 'Canada 2015'})\nOPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m)\nWHERE EXISTS {MATCH (p)-[:SCORED_GOAL]->(:Match)}\nWITH p, SUM(toInt(sg.minute)) AS totalMinutesPlayed, COUNT(sg) AS totalGoals\nRETURN p.name AS playerName, totalGoals, toFloat(totalMinutesPlayed)/COUNT(DISTINCT m) AS avgMinutesPlayed",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "grammatical error: toInt() function"
    },
    {
        "id": 648,
        "original_index": 648,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_150",
        "NL Question": "For each tournament, find the team with the highest average score in matches played. Return the tournament name, the team's name, and the team's average score.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[pi:PLAYED_IN]-(t:Team)\nWHERE pi.score IS NOT NULL\nWITH tour, t, AVG(toFloat(pi.score)) AS avgScore\nORDER BY tour.name, avgScore DESC\nWITH tour, COLLECT({team: t.name, avgScore: avgScore}) AS teamScores\nRETURN tour.name AS tournamentName, teamScores[0].team AS winningTeam, teamScores[0].avgScore AS averageScore",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 649,
        "original_index": 649,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_151",
        "NL Question": "For each squad that participated in 'France 2019', determine the average age of the players in the squad at the time of the tournament and the total number of goals scored by players in that squad. Return the squad ID, average player age, and total goals scored.",
        "Cypher": "MATCH (s:Squad)-[:FOR]->(t:Tournament {name: 'France 2019'})<-[:IN_TOURNAMENT]-(m:Match)<-[pi:PLAYED_IN]-(p:Person)-[:IN_SQUAD]->(s)\nOPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m)\nWITH s, p, t, COUNT(sg) AS goals\nWITH s, AVG(t.year - p.dob.year) AS avgAge, SUM(goals) AS totalGoals\nRETURN s.id AS squadId, avgAge, totalGoals",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 650,
        "original_index": 650,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_154",
        "NL Question": "For each team that participated in the 'Germany 2011' tournament, calculate the average number of goals scored in matches they played. Return the team's name and the average goals scored.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'Germany 2011'}) WHERE r.score IS NOT NULL WITH t, AVG(r.score) AS avgGoals RETURN t.name AS teamName, avgGoals",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 651,
        "original_index": 651,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_155",
        "NL Question": "For each tournament, determine the average number of players from each squad that participated. Return the tournament name and the average number of players per squad.",
        "Cypher": "MATCH (s:Squad)-[:FOR]->(t:Tournament) MATCH (p:Person)-[:IN_SQUAD]->(s) WITH t, s, COUNT(p) AS squadSize WITH t, AVG(squadSize) AS avgSquadSize RETURN t.name AS tournamentName, avgSquadSize",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 652,
        "original_index": 652,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_156",
        "NL Question": "For each person, find the total number of matches they played and the average penalty score they achieved across those matches. Return the person's name, total matches played, and average penalty score.",
        "Cypher": "MATCH (p:Person)-[r:PLAYED_IN]->(m:Match) WHERE r.penaltyScore IS NOT NULL WITH p, COUNT(m) AS totalMatches, AVG(toInt(r.penaltyScore)) AS avgPenaltyScore RETURN p.name AS personName, totalMatches, avgPenaltyScore",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "grammatical error: toInt() function"
    },
    {
        "id": 653,
        "original_index": 653,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_157",
        "NL Question": "For each tournament, calculate the total number of goals scored by all players and the average age of the players who scored those goals. Return the tournament name, total goals, and average player age.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[sg:SCORED_GOAL]-(p:Person) WHERE p.dob IS NOT NULL WITH tour, p, sg, m MATCH (p)-[:SCORED_GOAL]->(m) WITH tour, p, COUNT(sg) AS goalsPerPlayer, tour.year - p.dob.year AS playerAge WITH tour, SUM(goalsPerPlayer) AS totalGoals, AVG(playerAge) AS avgPlayerAge RETURN tour.name AS tournamentName, totalGoals, avgPlayerAge",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 654,
        "original_index": 654,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_158",
        "NL Question": "For the 'Canada 2015' tournament, calculate the average number of goals scored per match and the total number of teams that participated. Return the average goals per match and the total team count.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'Canada 2015'}) MATCH (m:Match)-[:IN_TOURNAMENT]->(tour) OPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m) WITH tour, m, COUNT(sg) AS matchGoals, t WITH SUM(matchGoals) AS totalGoals, COUNT(DISTINCT m) AS totalMatches, COUNT(DISTINCT t) AS totalTeams RETURN toFloat(totalGoals) / totalMatches AS avgGoalsPerMatch, totalTeams",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 655,
        "original_index": 655,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_162",
        "NL Question": "For each team, find the average number of players in their squads and the total number of tournaments they have participated in. Return the team name, average squad size, and total tournament count.",
        "Cypher": "MATCH (t:Team)-[:NAMED]->(s:Squad)<-[:IN_SQUAD]-(p:Person) WITH t, s, COUNT(p) AS squadSize MATCH (t)-[:PARTICIPATED_IN]->(tour:Tournament) WITH t, AVG(squadSize) AS avgSquadSize, COUNT(DISTINCT tour) AS totalTournaments RETURN t.name AS teamName, avgSquadSize, totalTournaments",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 656,
        "original_index": 656,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_163",
        "NL Question": "For each player born before 1985, calculate the total number of goals they scored and the average number of matches they played per tournament. Return the player's name, total goals, and average matches per tournament.",
        "Cypher": "MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament) WHERE p.dob.year < 1985 WITH p, tour, COUNT(sg) AS goalsPerMatch, m WITH p, tour, COUNT(DISTINCT m) AS matchesPerTournament, SUM(goalsPerMatch) AS totalGoalsPerTournament WITH p, AVG(matchesPerTournament) AS avgMatchesPerTournament, SUM(totalGoalsPerTournament) AS totalGoals RETURN p.name AS playerName, totalGoals, avgMatchesPerTournament",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 657,
        "original_index": 657,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_164",
        "NL Question": "For each tournament held after the year 2000, determine the average number of goals scored in each match and the total number of participating teams. Return the tournament name, average goals per match, and total team count.",
        "Cypher": "MATCH (tour:Tournament)<-[:PARTICIPATED_IN]-(t:Team)-[:PLAYED_IN]->(m:Match)<-[sg:SCORED_GOAL]-(p:Person) WHERE tour.year > 2000 WITH tour, m, COUNT(sg) AS goalsPerMatch WITH tour, AVG(goalsPerMatch) AS avgGoalsPerMatch, t RETURN tour.name AS tournamentName, avgGoalsPerMatch, COUNT(DISTINCT t) AS totalTeams",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "there's a small issue: t is not available in the final WITH clause because itâ€™s not carried forward correctly from the first MATCH."
    },
    {
        "id": 658,
        "original_index": 658,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_165",
        "NL Question": "For each team, find the average number of goals scored per match in tournaments held before 2010, and the total number of players who represent them. Return the team name, average goals per match, and total player count.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament) WHERE tour.year < 2010 MATCH (t)-[:PLAYED_IN]->(m:Match)<-[sg:SCORED_GOAL]-(p:Person) WITH t, m, COUNT(sg) AS goalsPerMatch, tour MATCH (t)<-[:REPRESENTS]-(player:Person) WITH t, AVG(goalsPerMatch) AS avgGoalsPerMatch, COUNT(DISTINCT player) AS totalPlayers RETURN t.name AS teamName, avgGoalsPerMatch, totalPlayers",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 659,
        "original_index": 659,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_169",
        "NL Question": "For each team, determine the total number of matches played and the average number of goals scored by players from that team per match. Return the team name, total matches, and average goals per match.",
        "Cypher": "MATCH (t:Team)-[:PLAYED_IN]->(m:Match)\nOPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m) WHERE (p)-[:REPRESENTS]->(t)\nWITH t, m, COUNT(sg) AS goals\nWITH t, COUNT(m) AS totalMatches, SUM(goals) AS totalGoals\nRETURN t.name AS teamName, totalMatches, toFloat(SUM(totalGoals)) / totalMatches AS avgGoalsPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 660,
        "original_index": 660,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_170",
        "NL Question": "For each tournament, find the average age of players who participated in matches and the total number of players who scored goals. Return the tournament name, average player age, and total goal scorers.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[:PLAYED_IN]-(p:Person)\nWHERE p.dob IS NOT NULL\nWITH tour, p, m\nOPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m)\nWITH tour, p, COUNT(sg) AS goals, m\nWITH tour, p, goals\nWITH tour, COLLECT(DISTINCT p) AS players, SUM(CASE WHEN goals > 0 THEN 1 ELSE 0 END) AS goalScorers\nUNWIND players AS player\nWITH tour, player, goalScorers\nRETURN tour.name AS tournamentName, avg(tour.year - player.dob.year) AS avgPlayerAge, SUM(goalScorers) AS totalGoalScorers",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 661,
        "original_index": 661,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_171",
        "NL Question": "For each squad, compute the average age of the players and the total number of matches played by those players. Return the squad ID, average player age, and total matches played.",
        "Cypher": "MATCH (s:Squad)<-[:IN_SQUAD]-(p:Person)\nWHERE p.dob IS NOT NULL\nWITH s, p\nOPTIONAL MATCH (p)-[:PLAYED_IN]->(m:Match)\nWITH s, p, COUNT(m) AS matchesPlayed\nRETURN s.id AS squadId, avg(date().year - p.dob.year) AS avgPlayerAge, SUM(matchesPlayed) AS totalMatchesPlayed",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 662,
        "original_index": 662,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_172",
        "NL Question": "For each team that participated in the 'USA 1999' tournament, determine the average number of goals scored per match and the total number of players who scored at least one goal. Return the team name, average goals per match, and total number of goal scorers.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'USA 1999'})\nOPTIONAL MATCH (t)-[:PLAYED_IN]->(m:Match)<-[sg:SCORED_GOAL]-(p:Person)\nWITH t, m, p, COUNT(sg) AS goals\nWITH t, m, COLLECT(DISTINCT p) AS players\nWITH t, m, SIZE(players) AS numPlayers, REDUCE(totalGoals = 0, player IN players | totalGoals + CASE WHEN player IS NOT NULL THEN 1 ELSE 0 END) AS totalGoalScorers\nWITH t, SUM(numPlayers) AS totalPlayers, SUM(totalGoalScorers) AS totalGoalScorers, COLLECT(m) AS matches\nWITH t, totalPlayers, totalGoalScorers, SIZE(matches) AS totalMatches\nRETURN t.name AS teamName, toFloat(totalPlayers) / totalMatches AS avgGoalsPerMatch, totalGoalScorers",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 663,
        "original_index": 663,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_175",
        "NL Question": "For each tournament, calculate the average number of goals scored by players and the total number of matches played. Return the tournament name, average goals scored, and total matches.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[:SCORED_GOAL]-(p:Person) WITH tour, m, COUNT(p) AS goalsPerMatch WITH tour, AVG(goalsPerMatch) AS avgGoals, COUNT(m) AS totalMatches RETURN tour.name AS tournamentName, avgGoals, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 664,
        "original_index": 664,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_176",
        "NL Question": "For each team that participated in the 'USA 2003' tournament, find the average number of players who scored goals in each of their matches. Return the team name and the average number of goal-scoring players.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'USA 2003'}) MATCH (t)-[:PLAYED_IN]->(m:Match)<-[:SCORED_GOAL]-(p:Person) WITH t, m, COUNT(DISTINCT p) AS scoringPlayersPerMatch WITH t, AVG(scoringPlayersPerMatch) AS avgScoringPlayers RETURN t.name AS teamName, avgScoringPlayers",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 665,
        "original_index": 665,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_177",
        "NL Question": "For each person, calculate the total number of goals scored and the average number of goals scored per match. Return the person's name, total goals scored, and average goals per match.",
        "Cypher": "MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match) WITH p, COUNT(sg) AS totalGoals, COUNT(DISTINCT m) AS totalMatches RETURN p.name AS personName, totalGoals, CASE WHEN totalMatches = 0 THEN 0 ELSE toFloat(totalGoals) / totalMatches END AS avgGoalsPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 666,
        "original_index": 666,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_178",
        "NL Question": "For each squad, determine the number of players born before 1990 and the average number of matches played by those players. Return the squad ID, the count of players born before 1990, and the average matches played.",
        "Cypher": "MATCH (s:Squad)<-[:IN_SQUAD]-(p:Person) WHERE p.dob.year < 1990 OPTIONAL MATCH (p)-[:PLAYED_IN]->(m:Match) WITH s, p, COUNT(m) AS matchesPlayed WHERE p.dob.year < 1990 WITH s, COUNT(DISTINCT p) AS playersBornBefore1990, AVG(matchesPlayed) AS avgMatchesPlayed RETURN s.id AS squadId, playersBornBefore1990, avgMatchesPlayed",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 667,
        "original_index": 667,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_179",
        "NL Question": "For each team, calculate the total number of goals scored in matches played during the 'First Stage' and the average number of goals scored per match. Return the team's name, total goals, and average goals per match.",
        "Cypher": "MATCH (t:Team)-[:PLAYED_IN]->(m:Match {stage: 'First Stage'}) OPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m) WITH t, m, COUNT(sg) AS goalsPerMatch WITH t, SUM(goalsPerMatch) AS totalGoals, COUNT(m) AS totalMatches RETURN t.name AS teamName, totalGoals, CASE WHEN totalMatches = 0 THEN 0 ELSE toFloat(totalGoals) / totalMatches END AS avgGoalsPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 668,
        "original_index": 668,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_182",
        "NL Question": "For each team that participated in the 'Germany 2011' tournament, calculate the average number of goals scored by its players across all matches. Return the team name and the average goals scored.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'Germany 2011'}) MATCH (p:Person)-[:REPRESENTS]->(t)-[:PLAYED_IN]->(m:Match) OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m) WITH t, p, COUNT(sg) AS goalsPerPlayerPerMatch WITH t, AVG(goalsPerPlayerPerMatch) AS avgGoalsPerPlayer RETURN t.name AS teamName, avgGoalsPerPlayer",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 669,
        "original_index": 669,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_183",
        "NL Question": "For each tournament, determine the average number of players in squads that participated in that tournament. Return the tournament name and the average squad size.",
        "Cypher": "MATCH (tour:Tournament)<-[:FOR]-(s:Squad)<-[:IN_SQUAD]-(p:Person) WITH tour, s, COUNT(p) AS squadSize WITH tour, AVG(squadSize) AS avgSquadSize RETURN tour.name AS tournamentName, avgSquadSize",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 670,
        "original_index": 670,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_184",
        "NL Question": "For each player, calculate the total number of matches they played in and the average number of goals they scored per match. Return the player's name, the total matches played, and the average goals per match, only for players who have played at least one match.",
        "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match) WITH p, COUNT(DISTINCT m) AS totalMatches OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m2:Match) WITH p, totalMatches, COUNT(sg) AS totalGoals WHERE totalMatches > 0 RETURN p.name AS playerName, totalMatches, CASE WHEN totalMatches = 0 THEN 0 ELSE toFloat(totalGoals)/totalMatches END AS avgGoalsPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 671,
        "original_index": 671,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_185",
        "NL Question": "For the 'Canada 2015' tournament, what is the average number of goals scored in matches played by teams representing countries starting with 'N'? Return the average number of goals.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'Canada 2015'}) WHERE t.name STARTS WITH 'N' MATCH (t)-[:PLAYED_IN]->(m:Match) OPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m) WITH m, COUNT(sg) AS goalsPerMatch WITH AVG(goalsPerMatch) AS avgGoals RETURN avgGoals",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 672,
        "original_index": 672,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_186",
        "NL Question": "For each team, calculate the total number of matches played and, among those matches, the number where the 'score' property in the PLAYED_IN relationship is greater than 0. Return the team name, total matches played, and the count of matches with a 'score' greater than 0.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match) WITH t, COUNT(m) AS totalMatches, SUM(CASE WHEN r.score > 0 THEN 1 ELSE 0 END) AS matchesWithScoreGreaterThanZero RETURN t.name AS teamName, totalMatches, matchesWithScoreGreaterThanZero",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 673,
        "original_index": 673,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_189",
        "NL Question": "For the 'China PR 1991' tournament, what is the average number of goals scored per match, considering only matches where goals were actually recorded?",
        "Cypher": "MATCH (tour:Tournament {name: 'China PR 1991'})<-[:IN_TOURNAMENT]-(m:Match)<-[sg:SCORED_GOAL]-(:Person) WITH tour, m, COUNT(sg) AS goalsPerMatch WHERE goalsPerMatch > 0 WITH tour, AVG(goalsPerMatch) AS avgGoalsPerMatch RETURN tour.name AS tournamentName, avgGoalsPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 674,
        "original_index": 674,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_190",
        "NL Question": "For each team that participated in the 'China PR 1991' tournament, determine the average number of players who scored goals in their matches. Return the team name and the average number of goal-scoring players.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'China PR 1991'}) MATCH (t)-[:PLAYED_IN]->(m:Match)<-[sg:SCORED_GOAL]-(p:Person) WITH t, m, COLLECT(DISTINCT p) AS playersPerMatch WITH t, AVG(SIZE(playersPerMatch)) AS avgGoalScorers RETURN t.name AS teamName, avgGoalScorers",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 675,
        "original_index": 675,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_191",
        "NL Question": "Calculate the average number of goals scored per match for each stage of matches in the 'France 2019' tournament.",
        "Cypher": "MATCH (tour:Tournament {name: 'France 2019'})<-[:IN_TOURNAMENT]-(m:Match)<-[sg:SCORED_GOAL]-(:Person) WITH tour, m.stage AS matchStage, COUNT(sg) AS goalsPerMatch WITH tour, matchStage, AVG(goalsPerMatch) AS avgGoalsPerMatch RETURN tour.name AS tournamentName, matchStage, avgGoalsPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 676,
        "original_index": 676,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_192",
        "NL Question": "For each team, what is the average number of goals scored in matches played in the 'Canada 2015' tournament, and how many players represent each team?",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'Canada 2015'}) OPTIONAL MATCH (t)-[:PLAYED_IN]->(m:Match)<-[sg:SCORED_GOAL]-(:Person) WITH t, COUNT(sg) AS totalGoals, COUNT(DISTINCT m) AS totalMatches OPTIONAL MATCH (p:Person)-[:REPRESENTS]->(t) WITH t, totalGoals, totalMatches, COUNT(DISTINCT p) AS playerCount RETURN t.name AS teamName, CASE WHEN totalMatches > 0 THEN toFloat(totalGoals) / totalMatches ELSE 0 END AS avgGoalsPerMatch, playerCount",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 677,
        "original_index": 677,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_193",
        "NL Question": "For each tournament, calculate the average age of players who scored at least one goal. Return the tournament name and the average age.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[sg:SCORED_GOAL]-(p:Person) WHERE p.dob IS NOT NULL WITH tour, p, m.date AS matchDate, p.dob AS playerDob WITH tour, p, duration.between(date(playerDob), date(matchDate)).years AS playerAge COLLECT (playerAge) AS playerAges WITH tour, AVG(playerAges) AS avgAge RETURN tour.name AS tournamentName, avgAge",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "COLLECT(playerAge) AS playerAges is used, but then AVG(playerAges) is invalid â€” you cannot average a list."
    },
    {
        "id": 678,
        "original_index": 678,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_198",
        "NL Question": "For each person who scored a goal in a match, find the average number of goals they scored per match and the total number of matches they played. Return the person's name, average goals per match, and total matches played.",
        "Cypher": "MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match) WITH p, COUNT(sg) AS totalGoals, COUNT(DISTINCT m) AS totalMatches RETURN p.name AS playerName, toFloat(totalGoals) / totalMatches AS avgGoalsPerMatch, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 679,
        "original_index": 679,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_199",
        "NL Question": "For each team, calculate the total number of players who represent them and the average age of those players. Return the team name, total players, and average age.",
        "Cypher": "MATCH (p:Person)-[:REPRESENTS]->(t:Team) WHERE p.dob IS NOT NULL WITH t, p, duration.between(date(p.dob), date()).years AS age WITH t, COUNT(DISTINCT p) AS totalPlayers, AVG(age) AS avgAge RETURN t.name AS teamName, totalPlayers, avgAge",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 680,
        "original_index": 680,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_200",
        "NL Question": "For each tournament, find the average number of goals scored per match and the total number of squads that participated. Return the tournament name, average goals per match, and total squads.",
        "Cypher": "MATCH (m:Match)-[:IN_TOURNAMENT]->(tour:Tournament) OPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m) WITH tour, m, COUNT(sg) AS goalsPerMatch WITH tour, AVG(goalsPerMatch) AS avgGoalsPerMatch MATCH (s:Squad)-[:FOR]->(tour) WITH tour, avgGoalsPerMatch, COUNT(DISTINCT s) AS totalSquads RETURN tour.name AS tournamentName, avgGoalsPerMatch, totalSquads",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 681,
        "original_index": 681,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_203",
        "NL Question": "For each team that participated in the 'USA 1999' tournament, calculate the total number of matches they played and the average number of goals scored in those matches. Return the team name, total matches played, and average goals per match.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'USA 1999'}) MATCH (t)-[r:PLAYED_IN]->(m:Match) WHERE r.score IS NOT NULL WITH t, COUNT(m) AS matchCount, SUM(r.score) AS totalGoals RETURN t.name AS teamName, matchCount AS totalMatches, toFloat(totalGoals)/matchCount AS avgGoalsPerMatch;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 682,
        "original_index": 682,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_204",
        "NL Question": "For each tournament, determine the average number of players per squad and the total number of goals scored across all matches in the tournament. Return the tournament name, average players per squad, and total goals scored.",
        "Cypher": "MATCH (tour:Tournament)<-[:FOR]-(s:Squad)<-[:IN_SQUAD]-(p:Person) WITH tour, s, COUNT(p) AS playerCount MATCH (m:Match)-[:IN_TOURNAMENT]->(tour) OPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m) WITH tour, AVG(playerCount) AS avgPlayersPerSquad, COUNT(sg) AS totalGoals RETURN tour.name AS tournamentName, avgPlayersPerSquad, totalGoals;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 683,
        "original_index": 683,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_205",
        "NL Question": "For each player, find the total number of tournaments they participated in and the average number of goals they scored per tournament. Return the player's name, the number of tournaments, and the average goals per tournament, ordering by average goals in descending order.",
        "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament) OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m) WITH p, tour, COUNT(sg) AS goalsPerTournament, COLLECT(DISTINCT tour.id) AS tournaments  RETURN p.name AS playerName, SIZE(tournaments) AS numberOfTournaments,  CASE WHEN SIZE(tournaments) = 0 THEN 0 ELSE toFloat(SUM(goalsPerTournament)) / SIZE(tournaments) END AS avgGoalsPerTournament ORDER BY avgGoalsPerTournament DESC;",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "You're using COUNT(sg) for goalsPerTournament, but then trying to SUM(goalsPerTournament) across all tournaments without grouping correctly. You're COLLECTing tour.id but not keeping track of how many tournaments the player was in or aggregating the goals per tournament properly."
    },
    {
        "id": 684,
        "original_index": 684,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_206",
        "NL Question": "For each team, calculate the total number of players who represent them and the average number of matches played by those players. Return the team name, total players, and average matches played per player.",
        "Cypher": "MATCH (t:Team)<-[:REPRESENTS]-(p:Person)-[:PLAYED_IN]->(m:Match) WITH t, p, COUNT(m) AS matchesPlayedPerPlayer WITH t, COUNT(DISTINCT p) AS totalPlayers, AVG(matchesPlayedPerPlayer) AS avgMatchesPlayedPerPlayer RETURN t.name AS teamName, totalPlayers, avgMatchesPlayedPerPlayer;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 685,
        "original_index": 685,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_207",
        "NL Question": "For each tournament after the year 1990, calculate the total number of teams that participated and the average number of goals scored per match. Return the tournament name, year, total teams, and average goals per match.",
        "Cypher": "MATCH (tour:Tournament) WHERE tour.year > 1990 MATCH (t:Team)-[:PARTICIPATED_IN]->(tour) OPTIONAL MATCH (m:Match)-[:IN_TOURNAMENT]->(tour)<-[sg:SCORED_GOAL]-(p:Person) WITH tour, COUNT(DISTINCT t) AS totalTeams, COUNT(sg) AS totalGoals, COUNT(DISTINCT m) AS totalMatches RETURN tour.name AS tournamentName, tour.year AS tournamentYear, totalTeams, CASE WHEN totalMatches > 0 THEN toFloat(totalGoals) / totalMatches ELSE 0 END AS avgGoalsPerMatch;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 686,
        "original_index": 686,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_211",
        "NL Question": "For each team that participated in the 'USA 2003' tournament, find the average number of goals scored by players from that team across all matches in that tournament. Return the team name and the average goals scored.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'USA 2003'}) MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(tour) WHERE (p)-[:REPRESENTS]->(t) WITH t, p, COUNT(sg) AS goalsPerPlayerPerMatch WITH t, AVG(goalsPerPlayerPerMatch) AS avgGoalsPerTeam RETURN t.name AS teamName, avgGoalsPerTeam",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 687,
        "original_index": 687,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_212",
        "NL Question": "For each player born before '1970-01-01', calculate the total number of matches they played in and the average score in those matches. Return the player's name, total matches, and average score.",
        "Cypher": "MATCH (p:Person) WHERE date(p.dob) < date('1970-01-01') MATCH (p)-[r:PLAYED_IN]->(m:Match) WITH p, COUNT(m) AS totalMatches, AVG(toInt(r.score)) AS avgScore RETURN p.name AS playerName, totalMatches, avgScore",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "grammatical error: toInt() function"
    },
    {
        "id": 688,
        "original_index": 688,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_213",
        "NL Question": "For each tournament, determine the team with the highest average number of goals scored per match. Return the tournament name, the team name, and the average goals scored by that team.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[:PLAYED_IN]-(t:Team) WITH tour, t, AVG(toInt(m.id)) AS avgGoalsPerMatch ORDER BY tour.id, avgGoalsPerMatch DESC WITH tour, COLLECT({team: t, avgGoals: avgGoalsPerMatch}) AS teamScores RETURN tour.name AS tournamentName, teamScores[0].team.name AS teamName, teamScores[0].avgGoals AS avgGoals",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "grammatical error: toInt() function"
    },
    {
        "id": 689,
        "original_index": 689,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_214",
        "NL Question": "For each squad, calculate the total number of players in the squad and the average number of matches played by those players. Return the squad ID, total players, and average matches played.",
        "Cypher": "MATCH (s:Squad)<-[:IN_SQUAD]-(p:Person) WITH s, p MATCH (p)-[:PLAYED_IN]->(m:Match) WITH s, COUNT(DISTINCT p) AS totalPlayers, COUNT(DISTINCT m) AS totalMatchesPerPlayer RETURN s.id AS squadId, totalPlayers, toFloat(totalMatchesPerPlayer)/totalPlayers AS avgMatchesPlayed",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 690,
        "original_index": 690,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_218",
        "NL Question": "For each team that participated in the 'France 2019' tournament, find the average number of goals scored by players from that team per match. Return the team name and the average goals per match.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'France 2019'}) \nOPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match)<-[:PLAYED_IN]-(t)\nWITH t, m, COUNT(sg) AS goals\nWITH t, COUNT(DISTINCT m) AS totalMatches, SUM(goals) AS totalGoals\nRETURN t.name AS teamName, CASE WHEN totalMatches > 0 THEN toFloat(SUM(totalGoals)) / totalMatches ELSE 0 END AS avgGoalsPerMatch",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match)<-[:PLAYED_IN]-(t) after t:Team might fail if the player doesn't represent that team. You're SUM(goals) twice â€” goals is already a count per match, so SUM(goals) works, but SUM(totalGoals) is redundant and incorrect."
    },
    {
        "id": 691,
        "original_index": 691,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_219",
        "NL Question": "For each player, determine the total number of tournaments in which they played and the average number of matches they played per tournament. Return the player's name, total tournaments, and average matches per tournament.",
        "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament)\nWITH p, t, COUNT(m) AS matchesPerTournament\nWITH p, COLLECT(DISTINCT t.id) AS tournaments, SUM(matchesPerTournament) AS totalMatches\nRETURN p.name AS playerName, SIZE(tournaments) AS totalTournaments, CASE WHEN SIZE(tournaments) > 0 THEN toFloat(totalMatches) / SIZE(tournaments) ELSE 0 END AS avgMatchesPerTournament",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 692,
        "original_index": 692,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_220",
        "NL Question": "For each team, find the tournament in which their players scored the most goals. Return the team name, the tournament name, and the total goals scored by the team's players in that tournament.",
        "Cypher": "MATCH (t:Team)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament)\nOPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m)\nWITH t, tour, COUNT(sg) AS totalGoals\nORDER BY t.id, totalGoals DESC\nWITH t, COLLECT({tournament: tour, goals: totalGoals}) AS tournamentGoals\nRETURN t.name AS teamName, tournamentGoals[0].tournament.name AS tournamentName, tournamentGoals[0].goals AS totalGoals",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 693,
        "original_index": 693,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_221",
        "NL Question": "For each tournament, calculate the average age of the players who participated in the matches and the total number of players. Return the tournament name, average player age, and total players.",
        "Cypher": "MATCH (t:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[:PLAYED_IN]-(p:Person)\nWHERE p.dob IS NOT NULL\nWITH t, p, t.year - p.dob.year AS playerAge\nWITH t, AVG(playerAge) AS avgAge, COUNT(DISTINCT p) AS totalPlayers\nRETURN t.name AS tournamentName, avgAge, totalPlayers",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 694,
        "original_index": 694,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_224",
        "NL Question": "For each tournament, calculate the total number of goals scored and the average number of goals scored per match. Return the tournament name, total goals scored, and average goals per match.",
        "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[sg:SCORED_GOAL]-(:Person) WITH tour, m, COUNT(sg) AS goalsPerMatch WITH tour, SUM(goalsPerMatch) AS totalGoals, COUNT(m) AS totalMatches RETURN tour.name AS tournamentName, totalGoals, CASE WHEN totalMatches > 0 THEN toFloat(totalGoals) / totalMatches ELSE 0 END AS avgGoalsPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 695,
        "original_index": 695,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_225",
        "NL Question": "For each team, determine the total number of matches they played and the average 'score' in the PLAYED_IN relationship across all matches. Return the team's name, total matches played, and the average score.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match) WITH t, COUNT(m) AS totalMatches, AVG(toInt(r.score)) AS avgScore RETURN t.name AS teamName, totalMatches, avgScore",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "grammatical error: toInt() function"
    },
    {
        "id": 696,
        "original_index": 696,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_226",
        "NL Question": "For each person, find the total number of matches they played and the average 'penaltyScore' in the PLAYED_IN relationship across all matches. Return the person's name, total matches played, and the average penalty score.",
        "Cypher": "MATCH (p:Person)-[r:PLAYED_IN]->(m:Match) WITH p, COUNT(m) AS totalMatches, AVG(toInt(r.penaltyScore)) AS avgPenaltyScore RETURN p.name AS personName, totalMatches, avgPenaltyScore",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "grammatical error: toInt() function"
    },
    {
        "id": 697,
        "original_index": 697,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_227",
        "NL Question": "For each team that participated in a tournament, calculate the total number of players who represent that team and the average number of goals scored by those players across all matches. Return the team name, total players representing the team, and the average goals scored per player.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament)<-[:FOR]-(s:Squad)<-[:IN_SQUAD]-(p:Person) OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(:Match) WITH t,p, COUNT(sg) AS goalsPerPlayer WITH t, COUNT(DISTINCT p) AS totalPlayers, AVG(goalsPerPlayer) AS avgGoalsPerPlayer RETURN t.name AS teamName, totalPlayers, avgGoalsPerPlayer",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 698,
        "original_index": 698,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_228",
        "NL Question": "For each tournament, find the average number of players in squads participating in that tournament, and the total number of teams that participated. Return the tournament name, average squad size, and total teams.",
        "Cypher": "MATCH (tour:Tournament)<-[:FOR]-(s:Squad)<-[:IN_SQUAD]-(p:Person) WITH tour, s, COUNT(p) AS squadSize WITH tour, AVG(squadSize) AS avgSquadSize, COUNT(DISTINCT s) AS totalSquads MATCH (team:Team)-[:PARTICIPATED_IN]->(tour) WITH tour, avgSquadSize, COUNT(DISTINCT team) AS totalTeams RETURN tour.name AS tournamentName, avgSquadSize, totalTeams",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 699,
        "original_index": 699,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_233",
        "NL Question": "For each tournament in 1991, find the average age of players who participated in matches and the total number of matches played. Return the tournament name, average player age, and total matches.",
        "Cypher": "MATCH (tour:Tournament {year: 1991})<-[:IN_TOURNAMENT]-(m:Match)<-[:PLAYED_IN]-(p:Person)\nWHERE p.dob IS NOT NULL\nWITH tour, p, m\nWITH tour, collect(DISTINCT p.dob) as player_dobs, COUNT(DISTINCT m) AS totalMatches\nWITH tour, REDUCE(s = 0, dob IN player_dobs | s + (tour.year - dob.year)) * 1.0 / size(player_dobs) AS avgAge, totalMatches\nRETURN tour.name AS tournamentName, avgAge, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 700,
        "original_index": 700,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_234",
        "NL Question": "For each squad, calculate the average age of players in the squad and the total number of goals scored by players in the squad across all matches. Return the squad ID, average player age, and total goals.",
        "Cypher": "MATCH (s:Squad)<-[:IN_SQUAD]-(p:Person)\nOPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m:Match)\nWHERE p.dob IS NOT NULL\nWITH s, p, sg\nWITH s, collect(DISTINCT p.dob) as player_dobs, COUNT(sg) AS totalGoals\nWITH s, REDUCE(s = 0, dob IN player_dobs | s + (date().year - dob.year)) * 1.0 / size(player_dobs) AS avgAge, totalGoals\nRETURN s.id AS squadId, avgAge, totalGoals",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "divide by zero Exception,  dob.year is not valid if dob is a String â€” it needs to be parsed to a date object."
    },
    {
        "id": 701,
        "original_index": 701,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_235",
        "NL Question": "For each team that participated in the 'China PR 1991' tournament, find the average number of goals scored per match and the total number of players who represented the team in those matches. Return the team name, average goals per match, and total players.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'China PR 1991'}) \nOPTIONAL MATCH (t)<-[:REPRESENTS]-(p:Person)-[sg:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(tour)\nWITH t, COUNT(DISTINCT m) AS totalMatches, SUM(CASE WHEN sg IS NOT NULL THEN 1 ELSE 0 END) AS totalGoals,collect(DISTINCT p) as players\nWITH t,totalMatches,totalGoals,SIZE(players) as totalPlayers\nRETURN t.name AS teamName, CASE WHEN totalMatches > 0 THEN toFloat(totalGoals) / totalMatches ELSE 0 END AS avgGoalsPerMatch, totalPlayers",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 702,
        "original_index": 702,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_238",
        "NL Question": "For the 'Sweden 1995' tournament, what is the average number of goals scored per team and the total number of matches played?",
        "Cypher": "MATCH (tour:Tournament {name: 'Sweden 1995'})<-[:IN_TOURNAMENT]-(m:Match)<-[r:PLAYED_IN]-(t:Team) WHERE r.score IS NOT NULL WITH tour, t, COUNT(m) AS matchesPlayed, SUM(r.score) AS totalGoalsPerTeam WITH tour, AVG(totalGoalsPerTeam) AS avgGoalsPerTeam, COUNT(DISTINCT m) AS totalMatches RETURN tour.name AS tournamentName, avgGoalsPerTeam, totalMatches",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": " you're trying to compute both the average goals per team and the total number of matches, but you're mixing levels of aggregation â€” this can miscount matches or goals when teams appear multiple times (as in most matches)."
    },
    {
        "id": 703,
        "original_index": 703,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_239",
        "NL Question": "For each team that participated in the 'Sweden 1995' tournament, calculate the total number of goals scored and the average number of goals scored per match. Return the team name, total goals, and average goals per match.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'Sweden 1995'}) WHERE r.score IS NOT NULL WITH t, m, r.score AS score OPTIONAL MATCH (t)-[r2:PLAYED_IN]->(m) WITH t, COUNT(m) AS matchCount, SUM(score) AS totalGoals RETURN t.name AS teamName, totalGoals, CASE WHEN matchCount = 0 THEN 0 ELSE toFloat(totalGoals) / matchCount END AS avgGoalsPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 704,
        "original_index": 704,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_240",
        "NL Question": "For each tournament, find the average age of the players who scored goals in matches. Return the tournament name and the average age.",
        "Cypher": "MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament) WHERE p.dob IS NOT NULL WITH tour, p, m.date.year AS matchYear, p.dob AS playerDob WITH tour, p, matchYear - playerDob.year AS playerAge WITH tour, AVG(playerAge) AS avgAge RETURN tour.name AS tournamentName, avgAge",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 705,
        "original_index": 705,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_241",
        "NL Question": "For each team, determine the average number of players who scored goals in each of their matches. Return the team's name and the average number of goal-scoring players per match.",
        "Cypher": "MATCH (t:Team)-[:PLAYED_IN]->(m:Match)<-[sg:SCORED_GOAL]-(p:Person) WITH t, m, COLLECT(DISTINCT p) AS playersPerMatch WITH t, m, SIZE(playersPerMatch) AS numPlayersPerMatch WITH t, AVG(numPlayersPerMatch) AS avgPlayersPerMatch RETURN t.name AS teamName, avgPlayersPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 706,
        "original_index": 706,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_242",
        "NL Question": "For each tournament, calculate the average number of teams that participated and the average number of players who scored goals. Return the tournament name, average teams, and average players.",
        "Cypher": "MATCH (tour:Tournament)<-[:PARTICIPATED_IN]-(t:Team) WITH tour, COUNT(DISTINCT t) AS numTeams OPTIONAL MATCH (tour)<-[:IN_TOURNAMENT]-(m:Match)<-[sg:SCORED_GOAL]-(p:Person) WITH tour, numTeams, COUNT(DISTINCT p) AS numPlayers WITH tour, numTeams, numPlayers RETURN tour.name AS tournamentName, AVG(numTeams), AVG(numPlayers)",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 707,
        "original_index": 707,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_245",
        "NL Question": "For each team that participated in the 'USA 1999' tournament, calculate the average number of goals scored per match. Return the team name and the average goals per match.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'USA 1999'}) MATCH (t)-[r:PLAYED_IN]->(m:Match) WHERE r.score IS NOT NULL WITH t, COUNT(m) AS matchCount, SUM(r.score) AS totalGoals RETURN t.name AS teamName, toFloat(totalGoals)/matchCount AS avgGoalsPerMatch;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 708,
        "original_index": 708,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_246",
        "NL Question": "For each person who played in a match, find the total number of goals they scored and the average number of minutes they played per match. Return the person's name, total goals scored, and average minutes played.",
        "Cypher": "MATCH (p:Person)-[r:PLAYED_IN]->(m:Match) WHERE r.minuteOn IS NOT NULL WITH p, COUNT(m) AS matchCount, SUM(toInt(r.minuteOn)) AS totalMinutesPlayed OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m2:Match) WITH p, matchCount, totalMinutesPlayed, COUNT(sg) AS totalGoalsScored RETURN p.name AS playerName, totalGoalsScored, CASE WHEN matchCount = 0 THEN 0 ELSE toFloat(totalMinutesPlayed) / matchCount END AS avgMinutesPlayed;",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "grammatical error: toInt() function"
    },
    {
        "id": 709,
        "original_index": 709,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_247",
        "NL Question": "For each tournament, determine the team with the highest average score in matches. Return the tournament name and the name of the team with the highest average score.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament) WHERE r.score IS NOT NULL WITH tour, t, AVG(r.score) AS avgScore ORDER BY tour.id, avgScore DESC WITH tour, COLLECT({team: t, avgScore: avgScore}) AS teamScores RETURN tour.name AS tournamentName, teamScores[0].team.name AS teamWithHighestAvgScore;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 710,
        "original_index": 710,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_249",
        "NL Question": "For matches played in the 'USA 1999' tournament, find the average 'score' value for each 'stage' of the tournament. Return the stage and the average score.",
        "Cypher": "MATCH (m:Match)-[:IN_TOURNAMENT]->(t:Tournament {name: 'USA 1999'})-[r:PLAYED_IN]-(team:Team) WHERE r.score IS NOT NULL WITH m.stage AS stage, AVG(r.score) AS avgScore RETURN stage, avgScore",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "Match)-[:IN_TOURNAMENT]->(Tournament)-[r:PLAYED_IN]-(Team), which doesnâ€™t match the graph structure â€” teams play in matches, not in tournaments."
    },
    {
        "id": 711,
        "original_index": 711,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_253",
        "NL Question": "For each team that participated in the 'Sweden 1995' tournament, find the average number of players who scored goals in each match. Return the team name and the average number of goal-scoring players per match.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'Sweden 1995'})\nMATCH (t)-[:PLAYED_IN]->(m:Match)<-[sg:SCORED_GOAL]-(p:Person)\nWITH t, m, COUNT(DISTINCT p) AS goalScorers\nWITH t, AVG(goalScorers) AS avgGoalScorersPerMatch\nRETURN t.name AS teamName, avgGoalScorersPerMatch",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 712,
        "original_index": 712,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_254",
        "NL Question": "For each player born before 1975, calculate the total number of goals they scored and the number of tournaments they played in. Return the player's name, total goals scored, and number of tournaments played.",
        "Cypher": "MATCH (p:Person) WHERE p.dob.year < 1975\nOPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament)\nWITH p, COUNT(sg) AS totalGoals, COLLECT(DISTINCT tour.id) AS tournaments\nRETURN p.name AS playerName, totalGoals, SIZE(tournaments) AS numberOfTournaments",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 713,
        "original_index": 713,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_255",
        "NL Question": "For each stage of the matches, what is the average score in 'PLAYED_IN' relationships and the total number of matches in that stage? Return the stage, average score, and total matches.",
        "Cypher": "MATCH (m:Match)-[r:PLAYED_IN]->(t:Team)\nWHERE r.score IS NOT NULL\nWITH m.stage AS stage, r.score AS score\nWITH stage, AVG(score) AS averageScore, COUNT(*) AS totalMatches\nRETURN stage, averageScore, totalMatches",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "Your Cypher query has the right structure but a logical flaw: it's counting total PLAYED_IN relationships, not total unique matches per stage. Since each match has two PLAYED_IN relationships (one for each team), the COUNT(*) AS totalMatches will double-count matches."
    },
    {
        "id": 714,
        "original_index": 714,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_256",
        "NL Question": "For each tournament, determine the average number of teams participating and the total number of squads involved. Return the tournament name, average number of teams, and total squads.",
        "Cypher": "MATCH (tour:Tournament)<-[:PARTICIPATED_IN]-(t:Team)\nWITH tour, COUNT(DISTINCT t) AS teamCount\nOPTIONAL MATCH (tour)<-[:FOR]-(s:Squad)\nWITH tour, teamCount, COUNT(DISTINCT s) AS squadCount\nRETURN tour.name AS tournamentName, teamCount AS avgTeams, squadCount AS totalSquads",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 715,
        "original_index": 715,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_259",
        "NL Question": "For each team, calculate the total number of matches they played in and the average number of goals scored per match. Return the team name, total matches played, and average goals per match.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match) WHERE r.score IS NOT NULL WITH t, COUNT(m) AS matchCount, SUM(r.score) AS totalGoals RETURN t.name AS teamName, matchCount AS totalMatches, toFloat(totalGoals)/matchCount AS avgGoalsPerMatch;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 716,
        "original_index": 716,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_260",
        "NL Question": "For the tournament 'Germany 2011', find the average number of goals scored by players in each match. Return the average goals per match for the tournament.",
        "Cypher": "MATCH (m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'Germany 2011'}) OPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m) WITH tour, m, COUNT(sg) AS goalsPerMatch RETURN tour.name AS tournamentName, avg(goalsPerMatch) AS avgGoalsPerMatch;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 717,
        "original_index": 717,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_261",
        "NL Question": "For each tournament, calculate the total number of teams that participated and the average number of matches played by each team. Return the tournament name, total team count, and average matches per team.",
        "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament) WITH tour, t MATCH (t)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour) WITH tour, t, COUNT(m) AS matchesPerTeam WITH tour, COUNT(DISTINCT t) AS totalTeams, AVG(matchesPerTeam) AS avgMatchesPerTeam RETURN tour.name AS tournamentName, totalTeams, avgMatchesPerTeam;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 718,
        "original_index": 718,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_262",
        "NL Question": "For each player, determine the total number of matches they played and the total number of goals scored, then calculate the average goals per match. Return the top 5 players with the highest average goals per match along with their names, match counts, and goal averages.",
        "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match) WITH p, COUNT(DISTINCT m) AS totalMatches OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m2:Match) WITH p, totalMatches, COUNT(sg) AS totalGoals RETURN p.name AS playerName, totalMatches, totalGoals, CASE WHEN totalMatches = 0 THEN 0 ELSE toFloat(totalGoals)/totalMatches END AS avgGoalsPerMatch ORDER BY avgGoalsPerMatch DESC LIMIT 5;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 719,
        "original_index": 719,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_263",
        "NL Question": "For the team 'Sweden', calculate the total number of goals scored in all matches they played in the 'Germany 2011' tournament. Return the total goals scored by 'Sweden' in 'Germany 2011'.",
        "Cypher": "MATCH (t:Team {name: 'Sweden'})-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'Germany 2011'}) OPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m) WHERE (p)-[:REPRESENTS]->(t) WITH t, tour, COUNT(sg) AS totalGoals RETURN t.name AS teamName, tour.name AS tournamentName, totalGoals;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 720,
        "original_index": 720,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_266",
        "NL Question": "For each team that participated in the 'Germany 2011' tournament, calculate the average number of goals scored per match and the total number of matches played. Return the team name, average goals per match, and total matches played.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'Germany 2011'}) WHERE r.score IS NOT NULL WITH t, m, r.score AS score OPTIONAL MATCH (t)-[r2:PLAYED_IN]->(m2:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'Germany 2011'}) WITH t, COUNT(DISTINCT m2) AS totalMatches, AVG(toFloat(score)) AS avgGoalsPerMatch RETURN t.name AS teamName, avgGoalsPerMatch, totalMatches",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 721,
        "original_index": 721,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_267",
        "NL Question": "For each person who played in a match during the 'Germany 2011' tournament, compute the total number of goals they scored and the average time (minute) at which they scored each goal. Return the person's name, total goals scored, and average goal scoring minute.",
        "Cypher": "MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'Germany 2011'}) WHERE sg.minute IS NOT NULL WITH p, toInteger(replace(sg.minute, '''', '')) AS goalMinute, m OPTIONAL MATCH (p)-[sg2:SCORED_GOAL]->(m2:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'Germany 2011'}) WITH p, AVG(goalMinute) AS avgGoalMinute, COUNT(DISTINCT m2) AS totalGoals RETURN p.name AS playerName, totalGoals, avgGoalMinute",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "You're matching SCORED_GOAL twice (sg and sg2) but inconsistentlyâ€”this may result in misaligned goal counts and averages.You're calculating avg(goalMinute) before counting all the person's goals, but re-matching again unnecessarily."
    },
    {
        "id": 722,
        "original_index": 722,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_268",
        "NL Question": "For each tournament, find the team with the highest average number of goals scored per match. Return the tournament name, the team name, and the average goals scored by that team.",
        "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament) WHERE r.score IS NOT NULL WITH tour, t, AVG(toFloat(r.score)) AS avgGoalsPerMatch ORDER BY tour.name, avgGoalsPerMatch DESC WITH tour, COLLECT({team: t, avgGoals: avgGoalsPerMatch}) AS teamGoals RETURN tour.name AS tournamentName, teamGoals[0].team.name AS teamName, teamGoals[0].avgGoals AS avgGoals",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 723,
        "original_index": 723,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_269",
        "NL Question": "For each squad, calculate the total number of distinct persons who are both coaches and players in that squad. Return the squad ID and the count of such persons.",
        "Cypher": "MATCH (p:Person)-[:IN_SQUAD]->(s:Squad) WITH s, COLLECT(p) AS players MATCH (c:Person)-[:COACH_FOR]->(s) WITH s, players, COLLECT(c) AS coaches RETURN s.id AS squadId, SIZE(INTERSECTION(players, coaches)) AS bothCount",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "Unknown function Intersection"
    },
    {
        "id": 724,
        "original_index": 724,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_270",
        "NL Question": "For each tournament, determine the average age of players who scored at least one goal. Return the tournament name and the average age of the goal-scoring players.",
        "Cypher": "MATCH (p:Person)-[:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament) WHERE p.dob IS NOT NULL WITH tour, p, tour.year - p.dob.year AS playerAge WITH tour, COLLECT(playerAge) AS playerAges RETURN tour.name AS tournamentName, avg(playerAges) AS averageAgeOfGoalScorers",
        "result [0/1]": "0",
        "logical [0/1]": "0",
        "reason/observation [reason for why the query was not logical or was incorrect]": "Cypher does not support avg() over a collected list directly. You should instead use AVG() on the numeric expression directly while you're scanning the individual rows."
    },
    {
        "id": 725,
        "original_index": 725,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_274",
        "NL Question": "For the tournament 'USA 2003', find the youngest player based on their age at the time of the tournament. Return the player name and age during the tournament.",
        "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'USA 2003'}) WHERE p.dob IS NOT NULL WITH p, tour ORDER BY p.dob DESC LIMIT 1 RETURN p.name as name, tour.year - p.dob.year as age;",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    },
    {
        "id": 726,
        "original_index": 726,
        "source_dataset": "wwc",
        "source_chunk": "data_3_4_2_6",
        "original_file": "Complex_Aggregation.json",
        "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_276",
        "NL Question": "For matches played on '1999-06-30', identify the players who scored goals and return each player's name and the total number of goals they scored in that specific match.",
        "Cypher": "MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match {date: date('1999-06-30')}) WITH p, COUNT(sg) AS totalGoals RETURN p.name AS playerName, totalGoals",
        "result [0/1]": "1",
        "logical [0/1]": "1",
        "reason/observation [reason for why the query was not logical or was incorrect]": ""
    }
]