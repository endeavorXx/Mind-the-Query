[
  {
    "NL Question": "For each continent, calculate the average number of visits performed by persons and the average duration of those visits in seconds. Return the continent name, the average number of visits, and the average visit duration.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(pl:Place) MATCH (pl)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WITH c.name AS continentName, p, count(pl) AS totalVisits, avg(pl.homelocation.latitude) AS avgLatitude WITH continentName, avg(totalVisits) AS avgVisits, avg(avgLatitude) AS avgDuration RETURN continentName, avgVisits, avgDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 29,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_29",
    "pipeline_stage": "FAILED_SCHEMA",
    "failure_reason": "❌ `homelocation.latitude` is not valid in node `Place`.",
    "schema_validation": "❌ `homelocation.latitude` is not valid in node `Place`."
  },
  {
    "NL Question": "For each continent, determine the average number of visits per person and the average duration (in seconds) of those visits. Return the continent name, average visits per person, and average visit duration.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WITH c.name AS continent, p, COUNT(pl) AS totalVisits, AVG(pl.homelocation.latitude) as avg_latitude WHERE pl.homelocation.latitude IS NOT NULL WITH continent, AVG(totalVisits) AS avgVisitsPerPerson, AVG(avg_latitude) AS avgDuration RETURN continent, avgVisitsPerPerson, avgDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 92,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_92",
    "pipeline_stage": "FAILED_SCHEMA",
    "failure_reason": "❌ `homelocation.latitude` is not valid in node `Place`.\n❌ `homelocation.latitude` is not valid in node `Place`.",
    "schema_validation": "❌ `homelocation.latitude` is not valid in node `Place`.\n❌ `homelocation.latitude` is not valid in node `Place`."
  },
  {
    "NL Question": "For each continent, calculate the average number of visits performed by persons before their confirmed time. Return the continent name and the average number of pre-confirmation visits.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE p.confirmedtime IS NOT NULL WITH c.name AS continent, p, pl, p.confirmedtime AS confirmedTime, pl.homelocation.latitude AS starttime WHERE pl.homelocation.latitude IS NOT NULL WITH continent, p, confirmedTime, starttime, COUNT(starttime) AS preConfirmationVisits RETURN continent, AVG(preConfirmationVisits) AS avgPreConfirmationVisits",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 95,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_95",
    "pipeline_stage": "FAILED_SCHEMA",
    "failure_reason": "❌ `homelocation.latitude` is not valid in node `Place`.\n❌ `homelocation.latitude` is not valid in node `Place`.",
    "schema_validation": "❌ `homelocation.latitude` is not valid in node `Place`.\n❌ `homelocation.latitude` is not valid in node `Place`."
  },
  {
    "NL Question": "For each continent, determine the average number of visits performed by persons and the average duration (in seconds) of these visits. Return the continent name, average visit count, and average visit duration.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE p IS NOT NULL AND pl IS NOT NULL WITH c.name AS continentName, p, pl, count(pl) AS visitCount, avg(pl.homelocation.latitude) AS avgLat WITH continentName, avg(visitCount) AS avgVisitCount, avg(avgLat) AS avgLatitudes RETURN continentName, avgVisitCount, avgLatitudes",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 330,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_330",
    "pipeline_stage": "FAILED_SCHEMA",
    "failure_reason": "❌ `homelocation.latitude` is not valid in node `Place`.",
    "schema_validation": "❌ `homelocation.latitude` is not valid in node `Place`."
  }
]