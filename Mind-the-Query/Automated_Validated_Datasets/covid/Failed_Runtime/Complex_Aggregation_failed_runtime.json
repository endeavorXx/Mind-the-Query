[
  {
    "NL Question": "For each type of place, calculate the average visit duration in seconds and the total number of visits. Return the place type, average duration, and total visits, but only for place types where the average duration is greater than 60000 seconds.",
    "Cypher": "MATCH (v:Visit)-[:LOCATED_AT]->(pl:Place) WHERE v.duration.seconds IS NOT NULL WITH pl.type AS placeType, AVG(v.duration.seconds) AS avgDuration, COUNT(v) AS totalVisits WHERE avgDuration > 60000 RETURN placeType, avgDuration, totalVisits;",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 0,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_0",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each continent, calculate the average number of visits per person and the average duration of visits (in seconds), considering only persons with a health status of 'Healthy'. Return the continent name, average visits per person, and average visit duration, but only for continents where the average duration is greater than 70000 seconds.",
    "Cypher": "MATCH (p:Person {healthstatus: 'Healthy'})-[v:VISITS]->(pl:Place) MATCH (pl)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE v.duration.seconds IS NOT NULL WITH c.name AS continent, p, v.duration.seconds AS duration WITH continent, COUNT(v) AS visitCount, AVG(duration) AS avgDurationPerVisit WITH continent, AVG(visitCount) AS avgVisitsPerPerson, avgDurationPerVisit WHERE avgDurationPerVisit > 70000 RETURN continent, avgVisitsPerPerson, avgDurationPerVisit;",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 4,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_4",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `v` not defined (line 1, column 268 (offset: 267))\n\"MATCH (p:Person {healthstatus: 'Healthy'})-[v:VISITS]->(pl:Place) MATCH (pl)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE v.duration.seconds IS NOT NULL WITH c.name AS continent, p, v.duration.seconds AS duration WITH continent, COUNT(v) AS visitCount, AVG(duration) AS avgDurationPerVisit WITH continent, AVG(visitCount) AS avgVisitsPerPerson, avgDurationPerVisit WHERE avgDurationPerVisit > 70000 RETURN continent, avgVisitsPerPerson, avgDurationPerVisit;\"\n                                                                                                                                                                                                                                                                            ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each country, find the average number of visits per person and the average visit duration (in seconds) for visits occurring after '2020-04-15'. Return the country name, average visits per person, and average visit duration.",
    "Cypher": "MATCH (p:Person)-[v:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(c:Country) WHERE date(v.starttime) > date('2020-04-15') WITH c.name AS countryName, p, v.duration.seconds AS visitDuration WITH countryName, p, AVG(visitDuration) AS avgVisitDurationPerPerson MATCH (p:Person)-[v:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(c:Country) WHERE date(v.starttime) > date('2020-04-15') WITH countryName, p WITH countryName, COUNT(p) AS personCount RETURN countryName, AVG(personCount), AVG(avgVisitDurationPerPerson)",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 10,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_10",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `avgVisitDurationPerPerson` not defined (line 1, column 503 (offset: 502))\n\"MATCH (p:Person)-[v:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(c:Country) WHERE date(v.starttime) > date('2020-04-15') WITH c.name AS countryName, p, v.duration.seconds AS visitDuration WITH countryName, p, AVG(visitDuration) AS avgVisitDurationPerPerson MATCH (p:Person)-[v:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(c:Country) WHERE date(v.starttime) > date('2020-04-15') WITH countryName, p WITH countryName, COUNT(p) AS personCount RETURN countryName, AVG(personCount), AVG(avgVisitDurationPerPerson)\"\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each continent, calculate the ratio of the number of visits to 'Restaurant' places made by 'Sick' persons to the total number of visits to 'Restaurant' places. Return the continent name and the calculated ratio.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE pl.type = 'Restaurant' WITH c.name AS continentName, p.healthstatus AS healthStatus, p MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE pl.type = 'Restaurant' WITH continentName, healthStatus, COUNT(p) AS visitCount WITH continentName, collect({healthStatus: healthStatus, count: visitCount}) AS visitsPerHealthStatus WITH continentName, apoc.coll.toMap(visitsPerHealthStatus, 'healthStatus', 'count') AS visitsMap RETURN continentName, toFloat(visitsMap['Sick']) / (visitsMap['Sick'] + visitsMap['Healthy']) AS sickToTotalRatio",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 11,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_11",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'apoc.coll.toMap' (line 1, column 522 (offset: 521))\n\"MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE pl.type = 'Restaurant' WITH c.name AS continentName, p.healthstatus AS healthStatus, p MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE pl.type = 'Restaurant' WITH continentName, healthStatus, COUNT(p) AS visitCount WITH continentName, collect({healthStatus: healthStatus, count: visitCount}) AS visitsPerHealthStatus WITH continentName, apoc.coll.toMap(visitsPerHealthStatus, 'healthStatus', 'count') AS visitsMap RETURN continentName, toFloat(visitsMap['Sick']) / (visitsMap['Sick'] + visitsMap['Healthy']) AS sickToTotalRatio\"\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each region, compute the total number of persons who visited places within that region and the average duration in seconds of those visits. Return the region name, total visitor count, and average visit duration.",
    "Cypher": "MATCH (p:Person)-[v:VISITS]->(pl:Place)-[:PART_OF]->(r:Region) WHERE v.duration.seconds IS NOT NULL WITH r.name AS regionName, p, v.duration.seconds AS visitDuration COLLECT visitDuration WITH regionName, COUNT(DISTINCT p) AS totalVisitors, visitDuration RETURN regionName, totalVisitors, AVG(visitDuration) AS avgDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 24,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_24",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'COLLECT': expected 'FOREACH', ',', 'ORDER BY', 'CALL', 'CREATE', 'LOAD CSV', 'DELETE', 'DETACH', 'FINISH', 'INSERT', 'LIMIT', 'MATCH', 'MERGE', 'NODETACH', 'OFFSET', 'OPTIONAL', 'REMOVE', 'RETURN', 'SET', 'SKIP', 'UNION', 'UNWIND', 'USE', 'WHERE', 'WITH' or <EOF> (line 1, column 167 (offset: 166))\n\"MATCH (p:Person)-[v:VISITS]->(pl:Place)-[:PART_OF]->(r:Region) WHERE v.duration.seconds IS NOT NULL WITH r.name AS regionName, p, v.duration.seconds AS visitDuration COLLECT visitDuration WITH regionName, COUNT(DISTINCT p) AS totalVisitors, visitDuration RETURN regionName, totalVisitors, AVG(visitDuration) AS avgDuration\"\n                                                                                                                                                                       ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each type of place, calculate the average duration (in seconds) of visits that occurred before '2020-04-20 T 00:00:00 UTC', and the total number of visits. Return the place type, average duration, and total visit count.",
    "Cypher": "MATCH (v:Visit)-[:LOCATED_AT]->(pl:Place) WHERE v.starttime < datetime('2020-04-20T00:00:00 UTC') WITH pl.type AS placeType, v.duration.seconds AS visitDuration, COUNT(v) AS totalVisits RETURN placeType, AVG(visitDuration) AS averageDuration, totalVisits",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 42,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_42",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Text cannot be parsed to a DateTime\n\"2020-04-20T00:00:00 UTC\"\n ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each continent, determine the average number of visits performed by persons with 'Healthy' health status, and the average visit duration (in seconds). Return the continent name, average visit count, and average duration.",
    "Cypher": "MATCH (p:Person {healthstatus: 'Healthy'})-[:PERFORMS_VISIT]->(v:Visit) MATCH (v)-[:LOCATED_AT]->(pl:Place)-[:PART_OF]->(r:Region)-[:PART_OF]->(c:Country)-[:PART_OF]->(cont:Continent) WITH cont.name AS continent, v.duration.seconds AS visitDuration, p WITH continent, p, COUNT(v) AS visitCount RETURN continent, AVG(visitCount) AS averageVisitCount, AVG(visitDuration) AS averageDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 43,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_43",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `v` not defined (line 1, column 278 (offset: 277))\n\"MATCH (p:Person {healthstatus: 'Healthy'})-[:PERFORMS_VISIT]->(v:Visit) MATCH (v)-[:LOCATED_AT]->(pl:Place)-[:PART_OF]->(r:Region)-[:PART_OF]->(c:Country)-[:PART_OF]->(cont:Continent) WITH cont.name AS continent, v.duration.seconds AS visitDuration, p WITH continent, p, COUNT(v) AS visitCount RETURN continent, AVG(visitCount) AS averageVisitCount, AVG(visitDuration) AS averageDuration\"\n                                                                                                                                                                                                                                                                                      ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each person with health status 'Healthy', find the average duration (in seconds) of their visits to 'Bar' places. Return the person's name and the average visit duration.",
    "Cypher": "MATCH (p:Person {healthstatus: 'Healthy'})-[:VISITS]->(pl:Place {type: 'Bar'}) WITH p, pl MATCH (p)-[:VISITS]->(pl)-[:LOCATED_AT]->(v:Visit) WHERE v.duration.seconds IS NOT NULL WITH p, v.duration.seconds AS visitDuration RETURN p.name AS personName, AVG(visitDuration) AS averageDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 45,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_45",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each country, calculate the average number of visits per person and the average duration (in seconds) of those visits. Return the country name, average visits per person, and average visit duration.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(r:Region)-[:PART_OF]->(c:Country) WITH c, p, pl MATCH (p)-[:VISITS]->(pl)-[:LOCATED_AT]->(v:Visit) WHERE v.duration.seconds IS NOT NULL WITH c.name AS countryName, p, COUNT(v) AS visitCount, AVG(v.duration.seconds) AS avgDurationPerVisit WITH countryName, AVG(visitCount) AS avgVisitsPerPerson, AVG(avgDurationPerVisit) AS avgDurationPerPerson RETURN countryName, avgVisitsPerPerson, avgDurationPerPerson",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 46,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_46",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each health status, calculate the average number of visits performed by people with that health status, and the average duration (in seconds) of those visits. Return the health status, average number of visits, and average visit duration.",
    "Cypher": "MATCH (p:Person)-[:PERFORMS_VISIT]->(v:Visit) WHERE v.duration.seconds IS NOT NULL WITH p.healthstatus AS healthStatus, p, v.duration.seconds AS visitDuration WITH healthStatus, p, COUNT(v) AS visitCount, visitDuration WITH healthStatus, AVG(visitCount) AS avgVisits, AVG(visitDuration) AS avgDuration RETURN healthStatus, avgVisits, avgDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 58,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_58",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `v` not defined (line 1, column 188 (offset: 187))\n\"MATCH (p:Person)-[:PERFORMS_VISIT]->(v:Visit) WHERE v.duration.seconds IS NOT NULL WITH p.healthstatus AS healthStatus, p, v.duration.seconds AS visitDuration WITH healthStatus, p, COUNT(v) AS visitCount, visitDuration WITH healthStatus, AVG(visitCount) AS avgVisits, AVG(visitDuration) AS avgDuration RETURN healthStatus, avgVisits, avgDuration\"\n                                                                                                                                                                                            ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each continent, what is the average visit duration (in seconds) across all visits, and what is the average number of visits per person originating from that continent?",
    "Cypher": "MATCH (p:Person)-[v:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE v.duration.seconds IS NOT NULL WITH c.name AS continent, p, v.duration.seconds AS visitDuration WITH continent, p, AVG(visitDuration) AS avgDuration, COUNT(v) AS visitCount WITH continent, AVG(visitCount) AS avgVisitsPerPerson, avgDuration RETURN continent, avgDuration, avgVisitsPerPerson",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 60,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_60",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `v` not defined (line 1, column 274 (offset: 273))\n\"MATCH (p:Person)-[v:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE v.duration.seconds IS NOT NULL WITH c.name AS continent, p, v.duration.seconds AS visitDuration WITH continent, p, AVG(visitDuration) AS avgDuration, COUNT(v) AS visitCount WITH continent, AVG(visitCount) AS avgVisitsPerPerson, avgDuration RETURN continent, avgDuration, avgVisitsPerPerson\"\n                                                                                                                                                                                                                                                                                  ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "Calculate the average number of visits per person and the average duration (in seconds) of those visits, grouping by the type of place visited. Return the place type, average visits per person, and average visit duration.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(pl:Place)\nWHERE EXISTS { MATCH (p)-[:VISITS]->(v:Visit) WHERE v.duration.seconds IS NOT NULL }\nWITH pl.type AS placeType, p\nWITH placeType, COUNT(*) AS visitCount, COLLECT(p) AS people\nWITH placeType, AVG(visitCount) AS avgVisitsPerPerson, people\nUNWIND people AS person\nMATCH (person)-[:VISITS]->(v:Visit)\nWHERE v.duration.seconds IS NOT NULL\nWITH placeType, avgVisitsPerPerson, v.duration.seconds AS duration\nRETURN placeType, avgVisitsPerPerson, AVG(duration) AS avgDuration;",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 81,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_81",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each region, calculate the total number of visits and the average duration (in seconds) of visits that started before '2020-04-16 T 00:00:00 UTC'. Return the region name, total visit count, and average duration.",
    "Cypher": "MATCH (v:Visit)-[:LOCATED_AT]->(pl:Place)-[:PART_OF]->(r:Region) WHERE v.starttime < datetime('2020-04-16T00:00:00 UTC') WITH r.name AS regionName, v.duration.seconds AS visitDuration, v RETURN regionName, COUNT(v) AS totalVisits, AVG(visitDuration) AS averageDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 86,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_86",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Text cannot be parsed to a DateTime\n\"2020-04-16T00:00:00 UTC\"\n ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each continent, compute the percentage of visits with duration greater than 10000 seconds. Return the continent name and the percentage of long visits.",
    "Cypher": "MATCH (v:Visit)-[:LOCATED_AT]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WITH c.name AS continentName, CASE WHEN v.duration.seconds > 10000 THEN 1 ELSE 0 END AS isLongVisit WITH continentName, SUM(isLongVisit) AS longVisits, COUNT(v) AS totalVisits RETURN continentName, (toFloat(longVisits) / totalVisits) * 100 AS percentageLongVisits",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 88,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_88",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `v` not defined (line 1, column 272 (offset: 271))\n\"MATCH (v:Visit)-[:LOCATED_AT]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WITH c.name AS continentName, CASE WHEN v.duration.seconds > 10000 THEN 1 ELSE 0 END AS isLongVisit WITH continentName, SUM(isLongVisit) AS longVisits, COUNT(v) AS totalVisits RETURN continentName, (toFloat(longVisits) / totalVisits) * 100 AS percentageLongVisits\"\n                                                                                                                                                                                                                                                                                ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each type of place, calculate the average duration (in seconds) of visits made by persons with 'Sick' health status. Return the place type and the average sick-person visit duration.",
    "Cypher": "MATCH (p:Person {healthstatus: 'Sick'})-[v:VISITS]->(pl:Place) WHERE v.duration.seconds IS NOT NULL WITH pl.type AS placeType, v.duration.seconds AS visitDuration COLLECT visitDuration WITH placeType, avg(visitDuration) AS avgDuration RETURN placeType, avgDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 98,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_98",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'COLLECT': expected 'FOREACH', ',', 'ORDER BY', 'CALL', 'CREATE', 'LOAD CSV', 'DELETE', 'DETACH', 'FINISH', 'INSERT', 'LIMIT', 'MATCH', 'MERGE', 'NODETACH', 'OFFSET', 'OPTIONAL', 'REMOVE', 'RETURN', 'SET', 'SKIP', 'UNION', 'UNWIND', 'USE', 'WHERE', 'WITH' or <EOF> (line 1, column 164 (offset: 163))\n\"MATCH (p:Person {healthstatus: 'Sick'})-[v:VISITS]->(pl:Place) WHERE v.duration.seconds IS NOT NULL WITH pl.type AS placeType, v.duration.seconds AS visitDuration COLLECT visitDuration WITH placeType, avg(visitDuration) AS avgDuration RETURN placeType, avgDuration\"\n                                                                                                                                                                    ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each continent, determine the average number of visits performed by people before their confirmed time. Return the continent name and the average number of pre-confirmed time visits.",
    "Cypher": "MATCH (p:Person)-[:PERFORMS_VISIT]->(v:Visit) MATCH (pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE v.starttime < p.confirmedtime WITH c.name AS continentName, p, v RETURN continentName, count(v) AS preConfirmedVisits WITH continentName, collect(preConfirmedVisits) AS visitsPerContinent RETURN continentName, avg(visitsPerContinent)",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 99,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_99",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Type mismatch: expected Float, Integer or Duration but was List<Integer> (line 1, column 355 (offset: 354))\n\"MATCH (p:Person)-[:PERFORMS_VISIT]->(v:Visit) MATCH (pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE v.starttime < p.confirmedtime WITH c.name AS continentName, p, v RETURN continentName, count(v) AS preConfirmedVisits WITH continentName, collect(preConfirmedVisits) AS visitsPerContinent RETURN continentName, avg(visitsPerContinent)\"\n                                                                                                                                                                                                                                                                                                                                                                   ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each country, compute the average visit duration (in seconds) for visits to 'Mall' type places made by 'Sick' persons. Return the country name and the average duration.",
    "Cypher": "MATCH (p:Person {healthstatus: 'Sick'})-[v:VISITS]->(pl:Place {type: 'Mall'}) MATCH (pl)-[:PART_OF]->(:Region)-[:PART_OF]->(c:Country) WHERE v.duration.seconds IS NOT NULL WITH c.name AS countryName, v.duration.seconds AS visitDuration COLLECT visitDuration WITH countryName, avg(visitDuration) AS avgDuration RETURN countryName, avgDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 101,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_101",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'COLLECT': expected 'FOREACH', ',', 'ORDER BY', 'CALL', 'CREATE', 'LOAD CSV', 'DELETE', 'DETACH', 'FINISH', 'INSERT', 'LIMIT', 'MATCH', 'MERGE', 'NODETACH', 'OFFSET', 'OPTIONAL', 'REMOVE', 'RETURN', 'SET', 'SKIP', 'UNION', 'UNWIND', 'USE', 'WHERE', 'WITH' or <EOF> (line 1, column 237 (offset: 236))\n\"MATCH (p:Person {healthstatus: 'Sick'})-[v:VISITS]->(pl:Place {type: 'Mall'}) MATCH (pl)-[:PART_OF]->(:Region)-[:PART_OF]->(c:Country) WHERE v.duration.seconds IS NOT NULL WITH c.name AS countryName, v.duration.seconds AS visitDuration COLLECT visitDuration WITH countryName, avg(visitDuration) AS avgDuration RETURN countryName, avgDuration\"\n                                                                                                                                                                                                                                             ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each continent, calculate the average number of visits per person and the average number of distinct place types visited by those persons. Return the continent name, average visits per person, and average distinct place types.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(pl:Place) MATCH (pl)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WITH c.name AS continentName, p, pl.type AS placeType, count(pl) AS placeCount WITH continentName, p, collect(placeType) AS placeTypes RETURN continentName, p, size(placeTypes) AS distinctPlaceTypes WITH continentName, avg(distinctPlaceTypes) AS avgDistinctPlaceTypes, count(p) AS personCount RETURN continentName, avg(personCount) AS avgPersonCount, avgDistinctPlaceTypes",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 102,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_102",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: RETURN can only be used at the end of the query. (line 1, column 257 (offset: 256))\n\"MATCH (p:Person)-[:VISITS]->(pl:Place) MATCH (pl)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WITH c.name AS continentName, p, pl.type AS placeType, count(pl) AS placeCount WITH continentName, p, collect(placeType) AS placeTypes RETURN continentName, p, size(placeTypes) AS distinctPlaceTypes WITH continentName, avg(distinctPlaceTypes) AS avgDistinctPlaceTypes, count(p) AS personCount RETURN continentName, avg(personCount) AS avgPersonCount, avgDistinctPlaceTypes\"\n                                                                                                                                                                                                                                                                 ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each type of place, calculate the average visit duration in seconds and the number of persons who visited that place type. Return the place type, average duration, and the number of visitors.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(pl:Place) WHERE pl.type IS NOT NULL WITH pl.type AS placeType, p, AVG(duration.seconds) AS avgDuration RETURN placeType, avgDuration, COUNT(DISTINCT p) AS numberOfVisitors",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 105,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_105",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `duration` not defined (line 1, column 100 (offset: 99))\n\"MATCH (p:Person)-[:VISITS]->(pl:Place) WHERE pl.type IS NOT NULL WITH pl.type AS placeType, p, AVG(duration.seconds) AS avgDuration RETURN placeType, avgDuration, COUNT(DISTINCT p) AS numberOfVisitors\"\n                                                                                                    ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each continent, determine the average duration of visits in seconds made by persons with 'Sick' health status. Return the continent name and the average visit duration.",
    "Cypher": "MATCH (p:Person {healthstatus: 'Sick'})-[:VISITS]->(pl:Place) MATCH (pl)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WITH c.name AS continentName, duration.seconds AS visitDuration RETURN continentName, AVG(visitDuration) AS averageVisitDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 106,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_106",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `duration` not defined (line 1, column 175 (offset: 174))\n\"MATCH (p:Person {healthstatus: 'Sick'})-[:VISITS]->(pl:Place) MATCH (pl)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WITH c.name AS continentName, duration.seconds AS visitDuration RETURN continentName, AVG(visitDuration) AS averageVisitDuration\"\n                                                                                                                                                                               ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each region, calculate the average number of visits performed by each person and the average duration of those visits in seconds. Return the region name, average number of visits, and average visit duration.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(r:Region) WITH r.name AS regionName, p, COUNT(pl) AS numberOfVisits, AVG(duration.seconds) AS avgDurationPerVisit WITH regionName, AVG(numberOfVisits) AS avgVisitsPerPerson, AVG(avgDurationPerVisit) AS avgDuration RETURN regionName, avgVisitsPerPerson, avgDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 107,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_107",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `duration` not defined (line 1, column 126 (offset: 125))\n\"MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(r:Region) WITH r.name AS regionName, p, COUNT(pl) AS numberOfVisits, AVG(duration.seconds) AS avgDurationPerVisit WITH regionName, AVG(numberOfVisits) AS avgVisitsPerPerson, AVG(avgDurationPerVisit) AS avgDuration RETURN regionName, avgVisitsPerPerson, avgDuration\"\n                                                                                                                              ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each country, find the place type with the longest average visit duration in seconds. Return the country name and the corresponding place type.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(c:Country) WITH c.name AS countryName, pl.type AS placeType, AVG(duration.seconds) AS avgDurationPerVisit ORDER BY countryName, avgDurationPerVisit DESC WITH countryName, COLLECT({placeType: placeType, avgDuration: avgDurationPerVisit}) AS placeDurations UNWIND placeDurations[0..0] AS topPlace WITH countryName, topPlace.placeType AS placeType, topPlace.avgDuration AS avgDuration RETURN countryName, placeType, avgDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 108,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_108",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `duration` not defined (line 1, column 140 (offset: 139))\n\"MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(c:Country) WITH c.name AS countryName, pl.type AS placeType, AVG(duration.seconds) AS avgDurationPerVisit ORDER BY countryName, avgDurationPerVisit DESC WITH countryName, COLLECT({placeType: placeType, avgDuration: avgDurationPerVisit}) AS placeDurations UNWIND placeDurations[0..0] AS topPlace WITH countryName, topPlace.placeType AS placeType, topPlace.avgDuration AS avgDuration RETURN countryName, placeType, avgDuration\"\n                                                                                                                                            ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each type of place, determine the average number of visits performed by persons with 'Healthy' status and the average duration of these visits. Return the place type, average visit count, and average visit duration in seconds.",
    "Cypher": "MATCH (p:Person {healthstatus: 'Healthy'})-[v:VISITS]->(pl:Place) WHERE v.duration.seconds IS NOT NULL WITH pl.type AS placeType, p, v.duration.seconds AS visitDuration COLLECT(v) AS visits WITH placeType, COUNT(visits) AS visitCount, AVG(visitDuration) AS avgDuration RETURN placeType, AVG(visitCount) AS avgVisitCount, AVG(avgDuration) AS avgVisitDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 127,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_127",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'COLLECT': expected 'FOREACH', ',', 'ORDER BY', 'CALL', 'CREATE', 'LOAD CSV', 'DELETE', 'DETACH', 'FINISH', 'INSERT', 'LIMIT', 'MATCH', 'MERGE', 'NODETACH', 'OFFSET', 'OPTIONAL', 'REMOVE', 'RETURN', 'SET', 'SKIP', 'UNION', 'UNWIND', 'USE', 'WHERE', 'WITH' or <EOF> (line 1, column 170 (offset: 169))\n\"MATCH (p:Person {healthstatus: 'Healthy'})-[v:VISITS]->(pl:Place) WHERE v.duration.seconds IS NOT NULL WITH pl.type AS placeType, p, v.duration.seconds AS visitDuration COLLECT(v) AS visits WITH placeType, COUNT(visits) AS visitCount, AVG(visitDuration) AS avgDuration RETURN placeType, AVG(visitCount) AS avgVisitCount, AVG(avgDuration) AS avgVisitDuration\"\n                                                                                                                                                                          ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each country, determine the average number of visits per person and the average visit duration in seconds for persons whose confirmed time is before '2020-04-20'. Return the country name, average visits per person, and average visit duration.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(c:Country) WHERE p.confirmedtime < datetime('2020-04-20T00:00:00.000Z') WITH c.name AS countryName, p, COUNT(*) AS visitCount, AVG(duration.seconds) AS avgDuration RETURN countryName, AVG(visitCount) AS avgVisitsPerPerson, AVG(avgDuration) AS overallAvgDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 130,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_130",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `duration` not defined (line 1, column 206 (offset: 205))\n\"MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(c:Country) WHERE p.confirmedtime < datetime('2020-04-20T00:00:00.000Z') WITH c.name AS countryName, p, COUNT(*) AS visitCount, AVG(duration.seconds) AS avgDuration RETURN countryName, AVG(visitCount) AS avgVisitsPerPerson, AVG(avgDuration) AS overallAvgDuration\"\n                                                                                                                                                                                                              ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each continent, determine the average number of visits made by persons, and the average duration (in seconds) of those visits. Return the continent name, average number of visits, and average visit duration.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WITH c.name AS continent, p WITH p, COUNT(pl) AS numVisits, AVG(duration(0)) as defaultDuration  MATCH (p)-[v:VISITS]->(pl2:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c2:Continent) WHERE v.duration.seconds IS NOT NULL WITH continent, numVisits, AVG(v.duration.seconds) AS avgDuration RETURN continent, AVG(numVisits) AS avgVisits, avgDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 134,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_134",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `pl` not defined (line 1, column 153 (offset: 152))\n\"MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WITH c.name AS continent, p WITH p, COUNT(pl) AS numVisits, AVG(duration(0)) as defaultDuration  MATCH (p)-[v:VISITS]->(pl2:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c2:Continent) WHERE v.duration.seconds IS NOT NULL WITH continent, numVisits, AVG(v.duration.seconds) AS avgDuration RETURN continent, AVG(numVisits) AS avgVisits, avgDuration\"\n                                                                                                                                                         ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each continent, determine the average number of visits performed by each person and the average visit duration in seconds. Return the continent's name, the average number of visits per person, and the average visit duration.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(pl:Place) MATCH (pl)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WITH c.name AS continent, p, COUNT(pl) AS visitCount, AVG(v.duration.seconds) AS avgDurationPerVisit RETURN continent, AVG(visitCount) AS avgVisitsPerPerson, AVG(avgDurationPerVisit) AS avgDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 155,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_155",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `v` not defined (line 1, column 180 (offset: 179))\n\"MATCH (p:Person)-[:VISITS]->(pl:Place) MATCH (pl)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WITH c.name AS continent, p, COUNT(pl) AS visitCount, AVG(v.duration.seconds) AS avgDurationPerVisit RETURN continent, AVG(visitCount) AS avgVisitsPerPerson, AVG(avgDurationPerVisit) AS avgDuration\"\n                                                                                                                                                                                    ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each continent, calculate the average number of visits per person with 'Sick' healthstatus and the average duration of those visits. Return the continent name, average visits per sick person, and average visit duration.",
    "Cypher": "MATCH (p:Person {healthstatus: 'Sick'})-[v:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WITH c.name AS continent, p, v.duration.seconds AS visitDuration WITH continent, p, COUNT(v) AS visitCount, AVG(visitDuration) AS avgVisitDurationPerPerson WITH continent, AVG(visitCount) AS avgVisitsPerSickPerson, AVG(avgVisitDurationPerPerson) AS avgVisitDuration RETURN continent, avgVisitsPerSickPerson, avgVisitDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 158,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_158",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `v` not defined (line 1, column 225 (offset: 224))\n\"MATCH (p:Person {healthstatus: 'Sick'})-[v:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WITH c.name AS continent, p, v.duration.seconds AS visitDuration WITH continent, p, COUNT(v) AS visitCount, AVG(visitDuration) AS avgVisitDurationPerPerson WITH continent, AVG(visitCount) AS avgVisitsPerSickPerson, AVG(avgVisitDurationPerPerson) AS avgVisitDuration RETURN continent, avgVisitsPerSickPerson, avgVisitDuration\"\n                                                                                                                                                                                                                                 ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each country, determine the average visit duration in seconds for visits occurring before '2020-05-01 T 00:00:00 UTC'. Return the country name and the average visit duration.",
    "Cypher": "MATCH (p:Person)-[v:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(c:Country) WHERE v.starttime < datetime('2020-05-01T00:00:00UTC') AND v.duration.seconds IS NOT NULL WITH c.name AS countryName, AVG(v.duration.seconds) AS avgDuration RETURN countryName, avgDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 171,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_171",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Text cannot be parsed to a DateTime\n\"2020-05-01T00:00:00UTC\"\n ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each continent, calculate the average number of visits per person and the average duration of visits in seconds, only considering persons confirmed to be 'Sick' before '2020-04-15 T 00:00:00 UTC'. Return the continent name, average visits per person, and average visit duration.",
    "Cypher": "MATCH (p:Person {healthstatus: 'Sick'})-[v:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE p.confirmedtime < datetime('2020-04-15T00:00:00UTC') AND v.duration.seconds IS NOT NULL WITH c.name AS continentName, p, v.duration.seconds AS visitDuration WITH continentName, p, COUNT(visitDuration) AS visitCount, AVG(visitDuration) AS avgVisitDurationPerPerson WITH continentName, AVG(visitCount) AS avgVisitsPerPerson, AVG(avgVisitDurationPerPerson) AS avgDurationPerPerson RETURN continentName, avgVisitsPerPerson, avgDurationPerPerson",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 172,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_172",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Text cannot be parsed to a DateTime\n\"2020-04-15T00:00:00UTC\"\n ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each continent, determine the average number of visits per person and the average visit duration in seconds. Return the continent name, average visits per person, and average duration.",
    "Cypher": "MATCH (p:Person)-[v:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE v.duration.seconds IS NOT NULL WITH c.name AS continentName, p, COUNT(v) AS visitCount WITH continentName, AVG(visitCount) AS avgVisitsPerPerson, AVG(v.duration.seconds) AS avgDuration RETURN continentName, avgVisitsPerPerson, avgDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 190,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_190",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `v` not defined (line 1, column 268 (offset: 267))\n\"MATCH (p:Person)-[v:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE v.duration.seconds IS NOT NULL WITH c.name AS continentName, p, COUNT(v) AS visitCount WITH continentName, AVG(visitCount) AS avgVisitsPerPerson, AVG(v.duration.seconds) AS avgDuration RETURN continentName, avgVisitsPerPerson, avgDuration\"\n                                                                                                                                                                                                                                                                            ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each health status, determine the average visit duration in seconds for visits occurring before and after '2020-04-20 T00:00:00 UTC'. Return the health status, average duration before the date, and average duration after the date.",
    "Cypher": "MATCH (p:Person)-[:PERFORMS_VISIT]->(v:Visit) WHERE v.duration.seconds IS NOT NULL WITH p.healthstatus AS healthStatus, v.starttime AS startTime, v.duration.seconds AS duration, CASE WHEN v.starttime < datetime('2020-04-20T00:00:00 UTC') THEN v.duration.seconds ELSE null END AS beforeDuration, CASE WHEN v.starttime >= datetime('2020-04-20T00:00:00 UTC') THEN v.duration.seconds ELSE null END AS afterDuration WITH healthStatus, AVG(beforeDuration) AS avgBeforeDuration, AVG(afterDuration) AS avgAfterDuration RETURN healthStatus, avgBeforeDuration, avgAfterDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 204,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_204",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Text cannot be parsed to a DateTime\n\"2020-04-20T00:00:00 UTC\"\n ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each continent, calculate the total number of visits and the average duration in seconds of visits made by 'Sick' persons. Return the continent name, total visits by sick persons, and average visit duration for sick persons.",
    "Cypher": "MATCH (p:Person {healthstatus: 'Sick'})-[:VISITS]->(pl:Place) MATCH (pl)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE v.duration.seconds IS NOT NULL WITH c.name AS continent, COUNT(v) AS totalVisitsBySick, AVG(v.duration.seconds) AS avgDurationBySick RETURN continent, totalVisitsBySick, avgDurationBySick",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 205,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_205",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `v` not defined (line 1, column 151 (offset: 150))\n\"MATCH (p:Person {healthstatus: 'Sick'})-[:VISITS]->(pl:Place) MATCH (pl)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE v.duration.seconds IS NOT NULL WITH c.name AS continent, COUNT(v) AS totalVisitsBySick, AVG(v.duration.seconds) AS avgDurationBySick RETURN continent, totalVisitsBySick, avgDurationBySick\"\n                                                                                                                                                       ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each person, calculate the total number of visits they performed and the average duration in seconds of those visits. Then, group these results by the person’s health status and return only those health statuses where the average visit duration is greater than 50000 seconds. Return the health status, average number of visits per person, and average visit duration.",
    "Cypher": "MATCH (p:Person)-[:PERFORMS_VISIT]->(v:Visit) WHERE v.duration.seconds IS NOT NULL WITH p, p.healthstatus AS healthStatus, COUNT(v) AS visitCount, AVG(v.duration.seconds) AS avgDuration WITH healthStatus, AVG(visitCount) AS avgVisitsPerPerson, AVG(avgDuration) AS avgDurationPerPerson WHERE avgDurationPerPerson > 50000 RETURN healthStatus, avgVisitsPerPerson, avgDurationPerPerson",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 207,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_207",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each continent, calculate the average number of 'Sick' persons who visited places of type 'Grocery shop'. Return the continent name and the average count of 'Sick' visitors to 'Grocery shop' places.",
    "Cypher": "MATCH (p:Person {healthstatus: 'Sick'})-[v:VISITS]->(pl:Place {type: 'Grocery shop'})-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WITH c.name AS continent, p RETURN continent, COUNT(DISTINCT p) AS sickVisitorsPerContinent RETURN continent, AVG(sickVisitorsPerContinent)",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 228,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_228",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: RETURN can only be used at the end of the query. (line 1, column 186 (offset: 185))\n\"MATCH (p:Person {healthstatus: 'Sick'})-[v:VISITS]->(pl:Place {type: 'Grocery shop'})-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WITH c.name AS continent, p RETURN continent, COUNT(DISTINCT p) AS sickVisitorsPerContinent RETURN continent, AVG(sickVisitorsPerContinent)\"\n                                                                                                                                                                                          ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each country, compute the average visit duration (in seconds) for visits occurring on weekends versus weekdays. Return the country name, average weekend visit duration, and average weekday visit duration.",
    "Cypher": "MATCH (p:Person)-[:PERFORMS_VISIT]->(v:Visit)-[:LOCATED_AT]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(c:Country) WHERE v.duration.seconds IS NOT NULL WITH c.name AS country, v, v.starttime AS visitStart, v.duration.seconds AS duration WITH country, visitStart, duration, CASE WHEN dayOfWeek(visitStart) IN ['Sat', 'Sun'] THEN duration ELSE null END AS weekendDuration, CASE WHEN dayOfWeek(visitStart) IN ['Mon', 'Tue', 'Wed', 'Thu', 'Fri'] THEN duration ELSE null END AS weekdayDuration WITH country, AVG(weekendDuration) AS avgWeekendDuration, AVG(weekdayDuration) AS avgWeekdayDuration RETURN country, avgWeekendDuration, avgWeekdayDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 234,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_234",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'dayOfWeek' (line 1, column 287 (offset: 286))\n\"MATCH (p:Person)-[:PERFORMS_VISIT]->(v:Visit)-[:LOCATED_AT]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(c:Country) WHERE v.duration.seconds IS NOT NULL WITH c.name AS country, v, v.starttime AS visitStart, v.duration.seconds AS duration WITH country, visitStart, duration, CASE WHEN dayOfWeek(visitStart) IN ['Sat', 'Sun'] THEN duration ELSE null END AS weekendDuration, CASE WHEN dayOfWeek(visitStart) IN ['Mon', 'Tue', 'Wed', 'Thu', 'Fri'] THEN duration ELSE null END AS weekdayDuration WITH country, AVG(weekendDuration) AS avgWeekendDuration, AVG(weekdayDuration) AS avgWeekdayDuration RETURN country, avgWeekendDuration, avgWeekdayDuration\"\n                                                                                                                                                                                                                                                                                               ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each continent, calculate the percentage of visits made by 'Sick' persons to places of type 'Mall'. Return the continent name and the percentage of infected mall visits.",
    "Cypher": "MATCH (p:Person {healthstatus: 'Sick'})-[:PERFORMS_VISIT]->(v:Visit)-[:LOCATED_AT]->(pl:Place {type: 'Mall'})-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WITH c.name AS continent, COUNT(v) AS infectedMallVisits MATCH (v2:Visit)-[:LOCATED_AT]->(pl2:Place {type: 'Mall'})-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c2:Continent) WHERE c.name = c2.name WITH continent, infectedMallVisits, COUNT(v2) AS totalMallVisits RETURN continent, toFloat(infectedMallVisits) / totalMallVisits * 100 AS infectedMallVisitPercentage",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 235,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_235",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `c` not defined (line 1, column 376 (offset: 375))\n\"MATCH (p:Person {healthstatus: 'Sick'})-[:PERFORMS_VISIT]->(v:Visit)-[:LOCATED_AT]->(pl:Place {type: 'Mall'})-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WITH c.name AS continent, COUNT(v) AS infectedMallVisits MATCH (v2:Visit)-[:LOCATED_AT]->(pl2:Place {type: 'Mall'})-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c2:Continent) WHERE c.name = c2.name WITH continent, infectedMallVisits, COUNT(v2) AS totalMallVisits RETURN continent, toFloat(infectedMallVisits) / totalMallVisits * 100 AS infectedMallVisitPercentage\"\n                                                                                                                                                                                                                                                                                                                                                                                        ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each region, determine the percentage of visits made by 'Sick' persons compared to the total number of visits. Return the region name and the percentage of visits by 'Sick' persons.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(r:Region)\nWITH r, COUNT(v) AS totalVisits, SUM(CASE WHEN p.healthstatus = 'Sick' THEN 1 ELSE 0 END) AS sickVisits\nRETURN r.name AS regionName, (toFloat(sickVisits) / totalVisits) * 100 AS sickVisitPercentage",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 239,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_239",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `v` not defined (line 2, column 15 (offset: 76))\n\"WITH r, COUNT(v) AS totalVisits, SUM(CASE WHEN p.healthstatus = 'Sick' THEN 1 ELSE 0 END) AS sickVisits\"\n               ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each country, calculate the average number of visits per person and the average duration of visits in seconds. Return the country name, the average number of visits per person, and the average visit duration.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(c:Country)\nWHERE p.id IS NOT NULL\nWITH c.name AS countryName, p.id AS personId, pl, p\nWITH countryName, personId, COUNT(pl) AS visitCount, AVG(Duration.seconds(p.confirmedtime - datetime())) AS avgDuration\nWITH countryName, AVG(visitCount) AS avgVisitsPerPerson, AVG(avgDuration) AS avgVisitDuration\nRETURN countryName, avgVisitsPerPerson, avgVisitDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 248,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_248",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'Duration.seconds' (line 4, column 58 (offset: 217))\n\"WITH countryName, personId, COUNT(pl) AS visitCount, AVG(Duration.seconds(p.confirmedtime - datetime())) AS avgDuration\"\n                                                          ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each continent, determine the type of place with the longest average visit duration in seconds. Return the continent name, place type, and average visit duration.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent)\nWHERE v.duration.seconds IS NOT NULL\nWITH c.name AS continentName, pl.type AS placeType, AVG(v.duration.seconds) AS avgDuration\nWITH continentName, MAX(avgDuration) AS maxAvgDuration\nMATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent)\nWHERE c.name = continentName AND v.duration.seconds IS NOT NULL\nWITH c.name AS continentName, pl.type AS placeType, AVG(v.duration.seconds) AS avgDuration\nWHERE avgDuration = maxAvgDuration\nRETURN continentName, placeType, avgDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 249,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_249",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `v` not defined (line 2, column 7 (offset: 116))\n\"WHERE v.duration.seconds IS NOT NULL\"\n       ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each continent, calculate the average number of visits performed by persons with 'Sick' healthstatus and the average duration of those visits in seconds. Return the continent name, average number of visits, and average visit duration.",
    "Cypher": "MATCH (p:Person {healthstatus: 'Sick'})-[:PERFORMS_VISIT]->(v:Visit)-[:LOCATED_AT]->(pl:Place)-[:PART_OF]->(r:Region)-[:PART_OF]->(c:Country)-[:PART_OF]->(cont:Continent) WHERE v.duration.seconds IS NOT NULL WITH cont.name AS continentName, p, v COUNT(v) AS visitCount, AVG(v.duration.seconds) AS avgDuration WITH continentName, AVG(visitCount) AS avgVisits, AVG(avgDuration) AS overallAvgDuration RETURN continentName, avgVisits, overallAvgDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 259,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_259",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'COUNT': expected an expression, 'FOREACH', ',', 'AS', 'ORDER BY', 'CALL', 'CREATE', 'LOAD CSV', 'DELETE', 'DETACH', 'FINISH', 'INSERT', 'LIMIT', 'MATCH', 'MERGE', 'NODETACH', 'OFFSET', 'OPTIONAL', 'REMOVE', 'RETURN', 'SET', 'SKIP', 'UNION', 'UNWIND', 'USE', 'WHERE', 'WITH' or <EOF> (line 1, column 247 (offset: 246))\n\"MATCH (p:Person {healthstatus: 'Sick'})-[:PERFORMS_VISIT]->(v:Visit)-[:LOCATED_AT]->(pl:Place)-[:PART_OF]->(r:Region)-[:PART_OF]->(c:Country)-[:PART_OF]->(cont:Continent) WHERE v.duration.seconds IS NOT NULL WITH cont.name AS continentName, p, v COUNT(v) AS visitCount, AVG(v.duration.seconds) AS avgDuration WITH continentName, AVG(visitCount) AS avgVisits, AVG(avgDuration) AS overallAvgDuration RETURN continentName, avgVisits, overallAvgDuration\"\n                                                                                                                                                                                                                                                       ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each region, determine the total number of visits and the average visit duration in seconds, considering only visits made by persons confirmed before '2020-04-20'. Return the region name, total visits, and average duration.",
    "Cypher": "MATCH (p:Person)-[:PERFORMS_VISIT]->(v:Visit)-[:LOCATED_AT]->(pl:Place)-[:PART_OF]->(r:Region) WHERE date(p.confirmedtime) < date('2020-04-20') AND v.duration.seconds IS NOT NULL WITH r.name AS regionName, v COUNT(v) AS totalVisits, AVG(v.duration.seconds) AS avgDuration RETURN regionName, totalVisits, avgDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 260,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_260",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'COUNT': expected an expression, 'FOREACH', ',', 'AS', 'ORDER BY', 'CALL', 'CREATE', 'LOAD CSV', 'DELETE', 'DETACH', 'FINISH', 'INSERT', 'LIMIT', 'MATCH', 'MERGE', 'NODETACH', 'OFFSET', 'OPTIONAL', 'REMOVE', 'RETURN', 'SET', 'SKIP', 'UNION', 'UNWIND', 'USE', 'WHERE', 'WITH' or <EOF> (line 1, column 209 (offset: 208))\n\"MATCH (p:Person)-[:PERFORMS_VISIT]->(v:Visit)-[:LOCATED_AT]->(pl:Place)-[:PART_OF]->(r:Region) WHERE date(p.confirmedtime) < date('2020-04-20') AND v.duration.seconds IS NOT NULL WITH r.name AS regionName, v COUNT(v) AS totalVisits, AVG(v.duration.seconds) AS avgDuration RETURN regionName, totalVisits, avgDuration\"\n                                                                                                                                                                                                                 ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each type of place, calculate the average duration of visits in seconds and the total number of persons who visited those places with a health status of 'Sick'. Return the place type, average duration, and total number of sick visitors.",
    "Cypher": "MATCH (p:Person {healthstatus: 'Sick'})-[:PERFORMS_VISIT]->(v:Visit)-[:LOCATED_AT]->(pl:Place) WHERE v.duration.seconds IS NOT NULL WITH pl.type AS placeType, v, p AVG(v.duration.seconds) AS avgDuration, COUNT(DISTINCT p) AS sickVisitorCount RETURN placeType, avgDuration, sickVisitorCount",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 261,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_261",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'AVG': expected an expression, 'FOREACH', ',', 'AS', 'ORDER BY', 'CALL', 'CREATE', 'LOAD CSV', 'DELETE', 'DETACH', 'FINISH', 'INSERT', 'LIMIT', 'MATCH', 'MERGE', 'NODETACH', 'OFFSET', 'OPTIONAL', 'REMOVE', 'RETURN', 'SET', 'SKIP', 'UNION', 'UNWIND', 'USE', 'WHERE', 'WITH' or <EOF> (line 1, column 165 (offset: 164))\n\"MATCH (p:Person {healthstatus: 'Sick'})-[:PERFORMS_VISIT]->(v:Visit)-[:LOCATED_AT]->(pl:Place) WHERE v.duration.seconds IS NOT NULL WITH pl.type AS placeType, v, p AVG(v.duration.seconds) AS avgDuration, COUNT(DISTINCT p) AS sickVisitorCount RETURN placeType, avgDuration, sickVisitorCount\"\n                                                                                                                                                                     ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each continent, find the average number of visits performed by each person and the average duration of those visits in seconds. Then, return the continent name, the average number of visits per person, and the overall average visit duration.",
    "Cypher": "MATCH (p:Person)-[:PERFORMS_VISIT]->(v:Visit)-[:LOCATED_AT]->(pl:Place)-[:PART_OF]->(r:Region)-[:PART_OF]->(c:Country)-[:PART_OF]->(cont:Continent) WHERE v.duration.seconds IS NOT NULL WITH cont.name AS continentName, p, v COUNT(v) AS visitCount, AVG(v.duration.seconds) AS avgDurationPerVisit WITH continentName, AVG(visitCount) AS avgVisitsPerPerson, AVG(avgDurationPerVisit) AS overallAvgDuration RETURN continentName, avgVisitsPerPerson, overallAvgDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 262,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_262",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'COUNT': expected an expression, 'FOREACH', ',', 'AS', 'ORDER BY', 'CALL', 'CREATE', 'LOAD CSV', 'DELETE', 'DETACH', 'FINISH', 'INSERT', 'LIMIT', 'MATCH', 'MERGE', 'NODETACH', 'OFFSET', 'OPTIONAL', 'REMOVE', 'RETURN', 'SET', 'SKIP', 'UNION', 'UNWIND', 'USE', 'WHERE', 'WITH' or <EOF> (line 1, column 224 (offset: 223))\n\"MATCH (p:Person)-[:PERFORMS_VISIT]->(v:Visit)-[:LOCATED_AT]->(pl:Place)-[:PART_OF]->(r:Region)-[:PART_OF]->(c:Country)-[:PART_OF]->(cont:Continent) WHERE v.duration.seconds IS NOT NULL WITH cont.name AS continentName, p, v COUNT(v) AS visitCount, AVG(v.duration.seconds) AS avgDurationPerVisit WITH continentName, AVG(visitCount) AS avgVisitsPerPerson, AVG(avgDurationPerVisit) AS overallAvgDuration RETURN continentName, avgVisitsPerPerson, overallAvgDuration\"\n                                                                                                                                                                                                                                ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each region, determine the average number of visits performed by each person and the average duration of those visits. Return the region name, average visits per person, and average visit duration in seconds.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(r:Region) WHERE v.duration.seconds IS NOT NULL WITH r.name AS region, p, COUNT(pl) AS numVisits, AVG(v.duration.seconds) as avgDurationPerVisit WITH region, AVG(numVisits) AS avgVisitsPerPerson, AVG(avgDurationPerVisit) AS avgDuration RETURN region, avgVisitsPerPerson, avgDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 275,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_275",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `v` not defined (line 1, column 69 (offset: 68))\n\"MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(r:Region) WHERE v.duration.seconds IS NOT NULL WITH r.name AS region, p, COUNT(pl) AS numVisits, AVG(v.duration.seconds) as avgDurationPerVisit WITH region, AVG(numVisits) AS avgVisitsPerPerson, AVG(avgDurationPerVisit) AS avgDuration RETURN region, avgVisitsPerPerson, avgDuration\"\n                                                                     ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each country, calculate the total number of visits and the average visit duration in seconds, considering only visits made by people whose health status is 'Healthy'. Return the country name, total visits, and average duration.",
    "Cypher": "MATCH (p:Person {healthstatus: 'Healthy'})-[v:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(c:Country) WHERE v.duration.seconds IS NOT NULL WITH c.name AS country, v.duration.seconds as visitDuration RETURN country, COUNT(v) AS totalVisits, AVG(visitDuration) AS avgDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 276,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_276",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `v` not defined (line 1, column 232 (offset: 231))\n\"MATCH (p:Person {healthstatus: 'Healthy'})-[v:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(c:Country) WHERE v.duration.seconds IS NOT NULL WITH c.name AS country, v.duration.seconds as visitDuration RETURN country, COUNT(v) AS totalVisits, AVG(visitDuration) AS avgDuration\"\n                                                                                                                                                                                                                                        ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each continent, determine the average number of visits made to places of type 'Mall' and the average visit duration in seconds. Return the continent name, average visits to Malls, and average duration.",
    "Cypher": "MATCH (p:Person)-[v:VISITS]->(pl:Place {type: 'Mall'})-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE v.duration.seconds IS NOT NULL WITH c.name AS continent, v.duration.seconds as visitDuration, p RETURN continent, COUNT(v) AS totalVisitsToMall, AVG(visitDuration) AS avgDuration WITH continent, totalVisitsToMall, avgDuration RETURN continent, AVG(totalVisitsToMall) AS avgVisitsToMall, AVG(avgDuration) AS avgDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 277,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_277",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `v` not defined (line 1, column 253 (offset: 252))\n\"MATCH (p:Person)-[v:VISITS]->(pl:Place {type: 'Mall'})-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE v.duration.seconds IS NOT NULL WITH c.name AS continent, v.duration.seconds as visitDuration, p RETURN continent, COUNT(v) AS totalVisitsToMall, AVG(visitDuration) AS avgDuration WITH continent, totalVisitsToMall, avgDuration RETURN continent, AVG(totalVisitsToMall) AS avgVisitsToMall, AVG(avgDuration) AS avgDuration\"\n                                                                                                                                                                                                                                                             ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each type of place, calculate the average visit duration (in seconds) for visits that started before '2020-04-16 T 00:00:00 UTC' and ended after '2020-04-29 T 00:00:00 UTC'. Return the place type and the average visit duration.",
    "Cypher": "MATCH (v:Visit)-[:LOCATED_AT]->(pl:Place) WHERE v.starttime < datetime('2020-04-16T00:00:00Z') AND v.endtime > datetime('2020-04-29T00:00:00Z') AND v.duration.seconds IS NOT NULL WITH pl.type AS placeType, v.duration.seconds AS visitDuration RETURN placeType, AVG(visitDuration) AS averageVisitDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 282,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_282",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each country, calculate the average number of visits performed by persons with 'Sick' health status and the average duration (in seconds) of those visits. Return the country name, average visit count, and average visit duration.",
    "Cypher": "MATCH (p:Person {healthstatus: 'Sick'})-[v:PERFORMS_VISIT]->(visit:Visit), (visit)-[:LOCATED_AT]->(pl:Place)-[:PART_OF]->(reg:Region)-[:PART_OF]->(c:Country) WHERE visit.duration.seconds IS NOT NULL WITH c.name AS country, p, visit.duration.seconds AS visitDuration WITH country, p, count(visit) AS visitCount, visitDuration RETURN country, AVG(visitCount) AS averageVisitCount, AVG(visitDuration) AS averageVisitDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 283,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_283",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `visit` not defined (line 1, column 290 (offset: 289))\n\"MATCH (p:Person {healthstatus: 'Sick'})-[v:PERFORMS_VISIT]->(visit:Visit), (visit)-[:LOCATED_AT]->(pl:Place)-[:PART_OF]->(reg:Region)-[:PART_OF]->(c:Country) WHERE visit.duration.seconds IS NOT NULL WITH c.name AS country, p, visit.duration.seconds AS visitDuration WITH country, p, count(visit) AS visitCount, visitDuration RETURN country, AVG(visitCount) AS averageVisitCount, AVG(visitDuration) AS averageVisitDuration\"\n                                                                                                                                                                                                                                                                                                  ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each continent, determine the average number of visits to 'Restaurant' type places and the average duration (in seconds) of those visits, considering only persons confirmed to be sick before '2020-04-27 T 00:00:00 UTC'. Return the continent name, average visit count, and average visit duration.",
    "Cypher": "MATCH (p:Person {healthstatus: 'Sick'})-[v:VISITS]->(pl:Place {type: 'Restaurant'}) MATCH (pl)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE p.confirmedtime < datetime('2020-04-27T00:00:00Z') AND v.duration.seconds IS NOT NULL WITH c.name AS continent, p, v.duration.seconds AS visitDuration WITH continent, p, count(v) AS visitCount, visitDuration RETURN continent, AVG(visitCount) AS averageVisitCount, AVG(visitDuration) AS averageVisitDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 284,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_284",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `v` not defined (line 1, column 349 (offset: 348))\n\"MATCH (p:Person {healthstatus: 'Sick'})-[v:VISITS]->(pl:Place {type: 'Restaurant'}) MATCH (pl)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE p.confirmedtime < datetime('2020-04-27T00:00:00Z') AND v.duration.seconds IS NOT NULL WITH c.name AS continent, p, v.duration.seconds AS visitDuration WITH continent, p, count(v) AS visitCount, visitDuration RETURN continent, AVG(visitCount) AS averageVisitCount, AVG(visitDuration) AS averageVisitDuration\"\n                                                                                                                                                                                                                                                                                                                                                             ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each type of place, calculate the total number of visits and the average duration (in seconds) of those visits that occurred before '2020-04-15 T 00:00:00 UTC'. Return the place type, total visit count, and average duration.",
    "Cypher": "MATCH (v:Visit)-[:LOCATED_AT]->(pl:Place) WHERE v.starttime < datetime('2020-04-15T00:00:00 UTC') WITH pl.type AS placeType, COUNT(v) AS totalVisits, AVG(v.duration.seconds) AS avgDuration RETURN placeType, totalVisits, avgDuration;",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 287,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_287",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Text cannot be parsed to a DateTime\n\"2020-04-15T00:00:00 UTC\"\n ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each region, calculate the ratio of visits made by persons whose confirmed time is after '2020-04-20 T 00:00:00 UTC' to the total number of visits. Return the region name and the visit ratio.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(r:Region) WITH r, p, pl MATCH (p)-[:PERFORMS_VISIT]->(v:Visit) WHERE p.confirmedtime > datetime('2020-04-20T00:00:00 UTC') WITH r, COUNT(v) AS visitsAfterConfirmation, COUNT(*) AS totalVisits RETURN r.name AS regionName, toFloat(visitsAfterConfirmation) / totalVisits AS visitRatio;",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 289,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_289",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Text cannot be parsed to a DateTime\n\"2020-04-20T00:00:00 UTC\"\n ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "Calculate the average duration (in seconds) of visits to 'Bar' places before '2020-04-15 T 00:00:00 UTC' and the average duration of visits after that time. Return the average duration before and after the specified date.",
    "Cypher": "MATCH (v:Visit)-[:LOCATED_AT]->(pl:Place {type: 'Bar'}) WITH v, pl.type AS placeType, v.starttime AS visitStartTime, v.duration.seconds AS visitDuration WITH visitStartTime, visitDuration, placeType RETURN avg(CASE WHEN visitStartTime < datetime('2020-04-15T00:00:00 UTC') THEN visitDuration ELSE null END) AS avgDurationBefore, avg(CASE WHEN visitStartTime >= datetime('2020-04-15T00:00:00 UTC') THEN visitDuration ELSE null END) AS avgDurationAfter;",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 291,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_291",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Text cannot be parsed to a DateTime\n\"2020-04-15T00:00:00 UTC\"\n ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each continent, determine the average number of visits performed by persons and the average duration of these visits. Return the continent name, average number of visits, and average visit duration in seconds.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE p.id IS NOT NULL WITH c.name AS continentName, p, pl WITH continentName, p, COUNT(pl) AS numVisits, AVG(pl.id) AS avgPlaceId WITH continentName, AVG(numVisits) AS avgNumVisits MATCH (p)-[v:VISITS]->(pl2:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c2:Continent) WHERE c2.name = continentName AND v.duration.seconds IS NOT NULL WITH continentName, avgNumVisits, AVG(v.duration.seconds) AS avgDuration RETURN continentName, avgNumVisits, avgDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 295,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_295",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Runtime Error: {code: Neo.ClientError.Statement.TypeError} {message: avg() can only handle numerical values, duration, and null. Got String(\"39\")}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each continent, determine the average visit duration in seconds for visits occurring before '2020-04-24 T 00:00:00 UTC'. Also, calculate the number of distinct persons who made these visits. Return the continent name, average duration, and the distinct person count.",
    "Cypher": "MATCH (p:Person)-[v:VISITS]->(pl:Place)\nMATCH (pl)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent)\nWHERE v.starttime < datetime('2020-04-24T00:00:00UTC') AND v.duration.seconds IS NOT NULL\nWITH c.name AS continent, v.duration.seconds AS duration, p\nWITH continent, AVG(duration) AS avgDuration, COUNT(DISTINCT p) AS distinctPersonCount\nRETURN continent, avgDuration, distinctPersonCount",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 302,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_302",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Text cannot be parsed to a DateTime\n\"2020-04-24T00:00:00UTC\"\n ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each continent, determine the average number of visits per person and the average duration of visits in seconds. Return the continent name, average visits per person, and average visit duration.",
    "Cypher": "MATCH (p:Person)-[v:VISITS]->(pl:Place) MATCH (pl)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE v.duration.seconds IS NOT NULL WITH c.name AS continent, p, v.duration.seconds AS visitDuration WITH continent, p, COUNT(v) AS visitCount, AVG(visitDuration) AS avgDurationPerVisit WITH continent, AVG(visitCount) AS avgVisitsPerPerson, AVG(avgDurationPerVisit) AS avgVisitDuration RETURN continent, avgVisitsPerPerson, avgVisitDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 309,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_309",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `v` not defined (line 1, column 250 (offset: 249))\n\"MATCH (p:Person)-[v:VISITS]->(pl:Place) MATCH (pl)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE v.duration.seconds IS NOT NULL WITH c.name AS continent, p, v.duration.seconds AS visitDuration WITH continent, p, COUNT(v) AS visitCount, AVG(visitDuration) AS avgDurationPerVisit WITH continent, AVG(visitCount) AS avgVisitsPerPerson, AVG(avgDurationPerVisit) AS avgVisitDuration RETURN continent, avgVisitsPerPerson, avgVisitDuration\"\n                                                                                                                                                                                                                                                          ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each health status, calculate the average number of visits and the average visit duration in seconds to places of type 'Bar'. Return the health status, the average number of visits, and the average visit duration.",
    "Cypher": "MATCH (p:Person)-[v:VISITS]->(pl:Place {type: 'Bar'}) WHERE v.duration.seconds IS NOT NULL WITH p.healthstatus AS healthStatus, p, v.duration.seconds AS visitDuration WITH healthStatus, p, COUNT(v) AS visitCount, AVG(visitDuration) AS avgDurationPerVisit WITH healthStatus, AVG(visitCount) AS avgVisits, AVG(avgDurationPerVisit) AS avgVisitDuration RETURN healthStatus, avgVisits, avgVisitDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 310,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_310",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `v` not defined (line 1, column 196 (offset: 195))\n\"MATCH (p:Person)-[v:VISITS]->(pl:Place {type: 'Bar'}) WHERE v.duration.seconds IS NOT NULL WITH p.healthstatus AS healthStatus, p, v.duration.seconds AS visitDuration WITH healthStatus, p, COUNT(v) AS visitCount, AVG(visitDuration) AS avgDurationPerVisit WITH healthStatus, AVG(visitCount) AS avgVisits, AVG(avgDurationPerVisit) AS avgVisitDuration RETURN healthStatus, avgVisits, avgVisitDuration\"\n                                                                                                                                                                                                    ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each continent, calculate the average number of visits per person and the average visit duration in seconds. Return the continent name, average visits per person, and average visit duration.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(pl:Place) MATCH (pl)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE v.duration.seconds IS NOT NULL WITH c.name AS continent, p, COUNT(pl) AS visits, AVG(v.duration.seconds) AS avgDurationPerVisit WITH continent, AVG(visits) AS avgVisitsPerPerson, AVG(avgDurationPerVisit) AS avgDuration RETURN continent, avgVisitsPerPerson, avgDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 322,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_322",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `v` not defined (line 1, column 128 (offset: 127))\n\"MATCH (p:Person)-[:VISITS]->(pl:Place) MATCH (pl)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE v.duration.seconds IS NOT NULL WITH c.name AS continent, p, COUNT(pl) AS visits, AVG(v.duration.seconds) AS avgDurationPerVisit WITH continent, AVG(visits) AS avgVisitsPerPerson, AVG(avgDurationPerVisit) AS avgDuration RETURN continent, avgVisitsPerPerson, avgDuration\"\n                                                                                                                                ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each health status, find the average number of visits to each place type and the average duration of those visits in seconds. Return the health status, place type, average visit count, and average visit duration.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(pl:Place) WHERE v.duration.seconds IS NOT NULL WITH p.healthstatus AS healthStatus, pl.type AS placeType, p, v WITH healthStatus, placeType, COUNT(v) AS visitCount, AVG(v.duration.seconds) AS avgDurationPerVisit WITH healthStatus, placeType, AVG(visitCount) AS avgVisits, AVG(avgDurationPerVisit) AS avgDuration RETURN healthStatus, placeType, avgVisits, avgDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 323,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_323",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `v` not defined (line 1, column 46 (offset: 45))\n\"MATCH (p:Person)-[:VISITS]->(pl:Place) WHERE v.duration.seconds IS NOT NULL WITH p.healthstatus AS healthStatus, pl.type AS placeType, p, v WITH healthStatus, placeType, COUNT(v) AS visitCount, AVG(v.duration.seconds) AS avgDurationPerVisit WITH healthStatus, placeType, AVG(visitCount) AS avgVisits, AVG(avgDurationPerVisit) AS avgDuration RETURN healthStatus, placeType, avgVisits, avgDuration\"\n                                              ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each region, calculate the ratio of visits made by 'Sick' persons to the total number of visits, and also compute the average visit duration in seconds for 'Sick' persons. Return the region name, sick visit ratio, and average sick visit duration.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(pl:Place) MATCH (pl)-[:PART_OF]->(r:Region) WHERE v.duration.seconds IS NOT NULL WITH r.name AS region, p, v, CASE WHEN p.healthstatus = 'Sick' THEN 1 ELSE 0 END AS isSick WITH region, SUM(isSick) AS sickVisits, COUNT(v) AS totalVisits, AVG(CASE WHEN p.healthstatus = 'Sick' THEN v.duration.seconds ELSE null END) AS avgSickDurationPerVisit WITH region, toFloat(sickVisits) / totalVisits AS sickVisitRatio, avgSickDurationPerVisit RETURN region, sickVisitRatio, avgSickDurationPerVisit",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 324,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_324",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `v` not defined (line 1, column 80 (offset: 79))\n\"MATCH (p:Person)-[:VISITS]->(pl:Place) MATCH (pl)-[:PART_OF]->(r:Region) WHERE v.duration.seconds IS NOT NULL WITH r.name AS region, p, v, CASE WHEN p.healthstatus = 'Sick' THEN 1 ELSE 0 END AS isSick WITH region, SUM(isSick) AS sickVisits, COUNT(v) AS totalVisits, AVG(CASE WHEN p.healthstatus = 'Sick' THEN v.duration.seconds ELSE null END) AS avgSickDurationPerVisit WITH region, toFloat(sickVisits) / totalVisits AS sickVisitRatio, avgSickDurationPerVisit RETURN region, sickVisitRatio, avgSickDurationPerVisit\"\n                                                                                ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each region, compute the ratio of visits with durations longer than one hour to the total number of visits. Return the region name and the percentage of long visits.",
    "Cypher": "MATCH (v:Visit)-[:LOCATED_AT]->(pl:Place)-[:PART_OF]->(r:Region) WHERE v.duration.seconds IS NOT NULL WITH r, v, duration.inSeconds(v.duration) AS visitDuration WITH r.name AS regionName, CASE WHEN visitDuration > 3600 THEN 1 ELSE 0 END AS isLongVisit, COUNT(v) AS totalVisits WITH regionName, SUM(isLongVisit) AS longVisits, totalVisits RETURN regionName, toFloat(longVisits) / totalVisits * 100 AS longVisitPercentage",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 338,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_338",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Function call does not provide the required number of arguments: expected 2 got 1.\n\nFunction duration.inSeconds has signature: duration.inSeconds(from :: ANY, to :: ANY) :: DURATION\nmeaning that it expects 2 arguments of type ANY, ANY\nDescription: Computes the `DURATION` between the `from` instant (inclusive) and the `to` instant (exclusive) in seconds. (line 1, column 114 (offset: 113))\n\"MATCH (v:Visit)-[:LOCATED_AT]->(pl:Place)-[:PART_OF]->(r:Region) WHERE v.duration.seconds IS NOT NULL WITH r, v, duration.inSeconds(v.duration) AS visitDuration WITH r.name AS regionName, CASE WHEN visitDuration > 3600 THEN 1 ELSE 0 END AS isLongVisit, COUNT(v) AS totalVisits WITH regionName, SUM(isLongVisit) AS longVisits, totalVisits RETURN regionName, toFloat(longVisits) / totalVisits * 100 AS longVisitPercentage\"\n                                                                                                                  ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each country, compute the average visit duration (in seconds) for visits occurring after '2020-05-01' and the total number of visits. Return the country name, average visit duration, and total visit count.",
    "Cypher": "MATCH (p:Person)-[:PERFORMS_VISIT]->(v:Visit)-[:LOCATED_AT]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(c:Country) WHERE v.starttime > datetime('2020-05-01') WITH c.name AS countryName, v.duration.seconds AS visitDuration WITH countryName, AVG(visitDuration) AS avgDuration, v RETURN countryName, avgDuration, COUNT(v) AS totalVisits",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 353,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_353",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `v` not defined (line 1, column 279 (offset: 278))\n\"MATCH (p:Person)-[:PERFORMS_VISIT]->(v:Visit)-[:LOCATED_AT]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(c:Country) WHERE v.starttime > datetime('2020-05-01') WITH c.name AS countryName, v.duration.seconds AS visitDuration WITH countryName, AVG(visitDuration) AS avgDuration, v RETURN countryName, avgDuration, COUNT(v) AS totalVisits\"\n                                                                                                                                                                                                                                                                                       ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each region, find the average number of visits performed by persons and the average duration in seconds of those visits. Return the region name, average visit count, and average visit duration.",
    "Cypher": "MATCH (p:Person)-[v:VISITS]->(pl:Place)-[:PART_OF]->(r:Region) WHERE v.duration.seconds IS NOT NULL WITH r.name AS regionName, p, v.duration.seconds AS visitDuration WITH regionName, p, COUNT(v) AS visitCount, AVG(visitDuration) AS avgDurationPerVisit WITH regionName, AVG(visitCount) AS avgVisitCount, AVG(avgDurationPerVisit) AS avgVisitDuration RETURN regionName, avgVisitCount, avgVisitDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 380,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_380",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `v` not defined (line 1, column 193 (offset: 192))\n\"MATCH (p:Person)-[v:VISITS]->(pl:Place)-[:PART_OF]->(r:Region) WHERE v.duration.seconds IS NOT NULL WITH r.name AS regionName, p, v.duration.seconds AS visitDuration WITH regionName, p, COUNT(v) AS visitCount, AVG(visitDuration) AS avgDurationPerVisit WITH regionName, AVG(visitCount) AS avgVisitCount, AVG(avgDurationPerVisit) AS avgVisitDuration RETURN regionName, avgVisitCount, avgVisitDuration\"\n                                                                                                                                                                                                 ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each country, calculate the total number of visits and the average duration in seconds of visits that occurred before April 15, 2020. Return the country name, total visit count, and average duration.",
    "Cypher": "MATCH (p:Person)-[v:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(c:Country) WHERE v.starttime < datetime('2020-04-15T00:00:00Z') AND v.duration.seconds IS NOT NULL WITH c.name AS countryName, v.duration.seconds AS visitDuration WITH countryName, COUNT(v) AS totalVisits, AVG(visitDuration) AS avgDuration RETURN countryName, totalVisits, avgDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 381,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_381",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `v` not defined (line 1, column 263 (offset: 262))\n\"MATCH (p:Person)-[v:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(c:Country) WHERE v.starttime < datetime('2020-04-15T00:00:00Z') AND v.duration.seconds IS NOT NULL WITH c.name AS countryName, v.duration.seconds AS visitDuration WITH countryName, COUNT(v) AS totalVisits, AVG(visitDuration) AS avgDuration RETURN countryName, totalVisits, avgDuration\"\n                                                                                                                                                                                                                                                                       ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each region, what is the average visit duration in seconds for 'Sick' persons compared to 'Healthy' persons? Return the region name, health status, and average visit duration.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(r:Region) WHERE v.duration.seconds IS NOT NULL WITH r.name AS regionName, p.healthstatus AS healthStatus, v.duration.seconds AS duration RETURN regionName, healthStatus, AVG(duration)",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 395,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_395",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `v` not defined (line 1, column 69 (offset: 68))\n\"MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(r:Region) WHERE v.duration.seconds IS NOT NULL WITH r.name AS regionName, p.healthstatus AS healthStatus, v.duration.seconds AS duration RETURN regionName, healthStatus, AVG(duration)\"\n                                                                     ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each region, determine the ratio of visits performed by 'Sick' persons to the total number of visits. Return the region name and the calculated ratio.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(r:Region) WITH r, COUNT(v) AS totalVisits, COUNT(CASE WHEN p.healthstatus = 'Sick' THEN v ELSE null END) AS sickVisits RETURN r.name AS regionName, toFloat(sickVisits) / totalVisits AS sickVisitRatio",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 428,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_428",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `v` not defined (line 1, column 77 (offset: 76))\n\"MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(r:Region) WITH r, COUNT(v) AS totalVisits, COUNT(CASE WHEN p.healthstatus = 'Sick' THEN v ELSE null END) AS sickVisits RETURN r.name AS regionName, toFloat(sickVisits) / totalVisits AS sickVisitRatio\"\n                                                                             ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each type of place, calculate the average visit duration (in seconds) and the total number of persons who visited that type of place. Return the place type, average duration, and total person count.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(pl:Place) WHERE v.duration.seconds IS NOT NULL WITH pl.type AS placeType, v.duration.seconds AS visitDuration, p RETURN placeType, AVG(visitDuration) AS averageDuration, COUNT(DISTINCT p) AS totalPersonCount",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 429,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_429",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `v` not defined (line 1, column 46 (offset: 45))\n\"MATCH (p:Person)-[:VISITS]->(pl:Place) WHERE v.duration.seconds IS NOT NULL WITH pl.type AS placeType, v.duration.seconds AS visitDuration, p RETURN placeType, AVG(visitDuration) AS averageDuration, COUNT(DISTINCT p) AS totalPersonCount\"\n                                              ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each continent, compute the average number of visits per person and the average number of distinct place types visited by each person. Return the continent name, average visits per person, and average distinct place types.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(pl:Place) MATCH (pl)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WITH c.name AS continent, p, COUNT(v) AS totalVisits, COUNT(DISTINCT pl.type) AS distinctPlaceTypes WITH continent, AVG(totalVisits) AS avgVisitsPerPerson, AVG(distinctPlaceTypes) AS avgDistinctPlaceTypes RETURN continent, avgVisitsPerPerson, avgDistinctPlaceTypes",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 430,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_430",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `v` not defined (line 1, column 157 (offset: 156))\n\"MATCH (p:Person)-[:VISITS]->(pl:Place) MATCH (pl)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WITH c.name AS continent, p, COUNT(v) AS totalVisits, COUNT(DISTINCT pl.type) AS distinctPlaceTypes WITH continent, AVG(totalVisits) AS avgVisitsPerPerson, AVG(distinctPlaceTypes) AS avgDistinctPlaceTypes RETURN continent, avgVisitsPerPerson, avgDistinctPlaceTypes\"\n                                                                                                                                                             ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each type of place, calculate the average duration (in seconds) of visits that occurred after '2020-05-01 T00:00:00 UTC'. Return the place type and the average duration.",
    "Cypher": "MATCH (v:Visit)-[:LOCATED_AT]->(pl:Place) WHERE v.starttime > datetime('2020-05-01T00:00:00 UTC') AND v.duration.seconds IS NOT NULL WITH pl.type AS placeType, v.duration.seconds AS duration RETURN placeType, AVG(duration) AS averageDurationInSeconds",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 436,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_436",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Text cannot be parsed to a DateTime\n\"2020-05-01T00:00:00 UTC\"\n ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each region, calculate the average number of visits performed by persons with 'Healthy' health status and the average duration of those visits (in seconds). Return the region name, average visit count, and average visit duration.",
    "Cypher": "MATCH (p:Person {healthstatus: 'Healthy'})-[v:VISITS]->(pl:Place)-[:PART_OF]->(r:Region) WHERE v.duration.seconds IS NOT NULL WITH r.name AS region, p, v.duration.seconds AS visitDuration WITH region, p, COUNT(v) AS visitCount, visitDuration RETURN region, AVG(visitCount) AS averageVisitCount, AVG(visitDuration) AS averageVisitDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 443,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_443",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `v` not defined (line 1, column 211 (offset: 210))\n\"MATCH (p:Person {healthstatus: 'Healthy'})-[v:VISITS]->(pl:Place)-[:PART_OF]->(r:Region) WHERE v.duration.seconds IS NOT NULL WITH r.name AS region, p, v.duration.seconds AS visitDuration WITH region, p, COUNT(v) AS visitCount, visitDuration RETURN region, AVG(visitCount) AS averageVisitCount, AVG(visitDuration) AS averageVisitDuration\"\n                                                                                                                                                                                                                   ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each continent, calculate the total number of persons who visited at least one 'Hospital' and the average number of visits made by those persons. Return the continent name, total person count, and average visit count.",
    "Cypher": "MATCH (p:Person)-[v:VISITS]->(pl:Place {type: 'Hospital'})-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WITH c.name AS continent, p WITH continent, COUNT(v) AS visitCount RETURN continent, COUNT(DISTINCT p) AS totalPersons, AVG(visitCount) AS averageVisitCount",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 445,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_445",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `v` not defined (line 1, column 181 (offset: 180))\n\"MATCH (p:Person)-[v:VISITS]->(pl:Place {type: 'Hospital'})-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WITH c.name AS continent, p WITH continent, COUNT(v) AS visitCount RETURN continent, COUNT(DISTINCT p) AS totalPersons, AVG(visitCount) AS averageVisitCount\"\n                                                                                                                                                                                     ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each region, determine the average number of visits performed by people with 'Healthy' status and the average duration (in seconds) of those visits. Return the region name, average visit count, and average visit duration.",
    "Cypher": "MATCH (p:Person {healthstatus: 'Healthy'})-[pv:PERFORMS_VISIT]->(v:Visit)-[:LOCATED_AT]->(pl:Place)-[:PART_OF]->(r:Region) WHERE v.duration.seconds IS NOT NULL WITH r.name AS regionName, v, p COUNT(v) AS visitCount, AVG(v.duration.seconds) AS avgDuration RETURN regionName, AVG(visitCount) AS avgVisitCount, AVG(avgDuration) AS avgVisitDuration;",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 458,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_458",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'COUNT': expected an expression, 'FOREACH', ',', 'AS', 'ORDER BY', 'CALL', 'CREATE', 'LOAD CSV', 'DELETE', 'DETACH', 'FINISH', 'INSERT', 'LIMIT', 'MATCH', 'MERGE', 'NODETACH', 'OFFSET', 'OPTIONAL', 'REMOVE', 'RETURN', 'SET', 'SKIP', 'UNION', 'UNWIND', 'USE', 'WHERE', 'WITH' or <EOF> (line 1, column 193 (offset: 192))\n\"MATCH (p:Person {healthstatus: 'Healthy'})-[pv:PERFORMS_VISIT]->(v:Visit)-[:LOCATED_AT]->(pl:Place)-[:PART_OF]->(r:Region) WHERE v.duration.seconds IS NOT NULL WITH r.name AS regionName, v, p COUNT(v) AS visitCount, AVG(v.duration.seconds) AS avgDuration RETURN regionName, AVG(visitCount) AS avgVisitCount, AVG(avgDuration) AS avgVisitDuration;\"\n                                                                                                                                                                                                 ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each country, calculate the ratio of visits made by persons whose health status is 'Sick' to the total number of visits, and also compute the average visit duration (in seconds) for each group. Return the country name, the visit ratio, and the average visit duration for both groups.",
    "Cypher": "MATCH (p:Person)-[:PERFORMS_VISIT]->(v:Visit)-[:LOCATED_AT]->(pl:Place)-[:PART_OF]->(r:Region)-[:PART_OF]->(c:Country) WHERE v.duration.seconds IS NOT NULL WITH c.name AS countryName, CASE WHEN p.healthstatus = 'Sick' THEN 1 ELSE 0 END AS isSick, v.duration.seconds AS duration WITH countryName, SUM(isSick) AS sickVisits, COUNT(v) AS totalVisits, AVG(CASE WHEN isSick = 1 THEN duration ELSE NULL END) AS avgSickDuration, AVG(CASE WHEN isSick = 0 THEN duration ELSE NULL END) AS avgHealthyDuration RETURN countryName, toFloat(sickVisits) / totalVisits AS sickVisitRatio, avgSickDuration, avgHealthyDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 459,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_459",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `v` not defined (line 1, column 330 (offset: 329))\n\"MATCH (p:Person)-[:PERFORMS_VISIT]->(v:Visit)-[:LOCATED_AT]->(pl:Place)-[:PART_OF]->(r:Region)-[:PART_OF]->(c:Country) WHERE v.duration.seconds IS NOT NULL WITH c.name AS countryName, CASE WHEN p.healthstatus = 'Sick' THEN 1 ELSE 0 END AS isSick, v.duration.seconds AS duration WITH countryName, SUM(isSick) AS sickVisits, COUNT(v) AS totalVisits, AVG(CASE WHEN isSick = 1 THEN duration ELSE NULL END) AS avgSickDuration, AVG(CASE WHEN isSick = 0 THEN duration ELSE NULL END) AS avgHealthyDuration RETURN countryName, toFloat(sickVisits) / totalVisits AS sickVisitRatio, avgSickDuration, avgHealthyDuration\"\n                                                                                                                                                                                                                                                                                                                                          ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each continent, calculate the ratio of visits made to 'Bar' type places by 'Sick' persons to the total number of visits made to 'Bar' type places. Return the continent name and the calculated ratio.",
    "Cypher": "MATCH (p:Person {healthstatus: 'Sick'})-[v:VISITS]->(pl:Place {type: 'Bar'})-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WITH c.name AS continent, COUNT(v) AS sickVisits MATCH (p2:Person)-[v2:VISITS]->(pl2:Place {type: 'Bar'})-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c2:Continent) WHERE c.name = c2.name WITH continent, sickVisits, COUNT(v2) AS totalVisits RETURN continent, toFloat(sickVisits) / totalVisits AS sickVisitRatio",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 466,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_466",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `c` not defined (line 1, column 333 (offset: 332))\n\"MATCH (p:Person {healthstatus: 'Sick'})-[v:VISITS]->(pl:Place {type: 'Bar'})-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WITH c.name AS continent, COUNT(v) AS sickVisits MATCH (p2:Person)-[v2:VISITS]->(pl2:Place {type: 'Bar'})-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c2:Continent) WHERE c.name = c2.name WITH continent, sickVisits, COUNT(v2) AS totalVisits RETURN continent, toFloat(sickVisits) / totalVisits AS sickVisitRatio\"\n                                                                                                                                                                                                                                                                                                                                             ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each continent, calculate the average number of visits per person and the average duration of visits (in seconds). Return the continent name, average visits per person, and average visit duration.",
    "Cypher": "MATCH (p:Person)-[v:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE v.duration.seconds IS NOT NULL WITH c.name AS continent, p, v WITH continent, p, COUNT(v) AS visitCount WITH continent, AVG(visitCount) AS avgVisitsPerPerson, AVG(v.duration.seconds) AS avgDuration RETURN continent, avgVisitsPerPerson, avgDuration ORDER BY continent",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 487,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_487",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `v` not defined (line 1, column 281 (offset: 280))\n\"MATCH (p:Person)-[v:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE v.duration.seconds IS NOT NULL WITH c.name AS continent, p, v WITH continent, p, COUNT(v) AS visitCount WITH continent, AVG(visitCount) AS avgVisitsPerPerson, AVG(v.duration.seconds) AS avgDuration RETURN continent, avgVisitsPerPerson, avgDuration ORDER BY continent\"\n                                                                                                                                                                                                                                                                                         ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each continent, determine the average number of visits performed by persons and the average duration (in seconds) of those visits. Return the continent name, average visit count, and average visit duration.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(v:Visit)-[:LOCATED_AT]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE v.duration.seconds IS NOT NULL WITH c.name AS continent, p, COUNT(v) AS visitCount, AVG(v.duration.seconds) AS avgDurationPerVisit WITH continent, AVG(visitCount) AS avgVisitCount, AVG(avgDurationPerVisit) AS overallAvgDuration RETURN continent, avgVisitCount, overallAvgDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 498,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_498",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each type of place, determine the average number of visits and the average duration (in seconds) of visits that occur after '2020-04-12 T 00:00:00 UTC'. Return the place type, the average number of visits, and the average duration.",
    "Cypher": "MATCH (v:Visit)-[:LOCATED_AT]->(pl:Place) WHERE v.starttime > datetime('2020-04-12T00:00:00 UTC') AND v.duration.seconds IS NOT NULL WITH pl.type AS placeType, v RETURN placeType, COUNT(v) AS visitCount, AVG(v.duration.seconds) AS avgDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 505,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_505",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Text cannot be parsed to a DateTime\n\"2020-04-12T00:00:00 UTC\"\n ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each region, calculate the average number of visits per person and the average duration (in seconds) of those visits, considering only visits to places of type 'Mall'. Return the region name, average visits per person, and average visit duration.",
    "Cypher": "MATCH (p:Person)-[v:VISITS]->(pl:Place)-[:PART_OF]->(r:Region) WHERE pl.type = 'Mall' AND v.duration.seconds IS NOT NULL WITH r.name AS region, p, v.duration.seconds AS duration WITH region, p, AVG(duration) AS avgDurationPerPerson MATCH (p)-[:VISITS]->(pl2:Place)-[:PART_OF]->(r:Region) WHERE pl2.type = 'Mall' WITH region, p RETURN region, COUNT(DISTINCT p) AS numberOfPeople, avgDurationPerPerson",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 506,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_506",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `avgDurationPerPerson` not defined (line 1, column 380 (offset: 379))\n\"MATCH (p:Person)-[v:VISITS]->(pl:Place)-[:PART_OF]->(r:Region) WHERE pl.type = 'Mall' AND v.duration.seconds IS NOT NULL WITH r.name AS region, p, v.duration.seconds AS duration WITH region, p, AVG(duration) AS avgDurationPerPerson MATCH (p)-[:VISITS]->(pl2:Place)-[:PART_OF]->(r:Region) WHERE pl2.type = 'Mall' WITH region, p RETURN region, COUNT(DISTINCT p) AS numberOfPeople, avgDurationPerPerson\"\n                                                                                                                                                                                                                                                                                                                                                                                            ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each continent, calculate the average duration (in seconds) of visits that started before '2020-04-20 T 00:00:00 UTC' and the average duration of visits that started after that date. Return the continent name, average duration before the date, and average duration after the date.",
    "Cypher": "MATCH (v:Visit)-[:LOCATED_AT]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE v.duration.seconds IS NOT NULL WITH c.name AS continent, v, v.starttime AS startTime, v.duration.seconds AS duration WITH continent, duration, CASE WHEN startTime < datetime('2020-04-20T00:00:00 UTC') THEN duration ELSE null END AS beforeDuration, CASE WHEN startTime >= datetime('2020-04-20T00:00:00 UTC') THEN duration ELSE null END AS afterDuration RETURN continent, AVG(beforeDuration) AS avgDurationBefore, AVG(afterDuration) AS avgDurationAfter",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 508,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_508",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Text cannot be parsed to a DateTime\n\"2020-04-20T00:00:00 UTC\"\n ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each type of place, calculate the average visit duration in seconds and the number of persons who visited that type of place. Return the place type, average visit duration, and the number of distinct persons.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(v:Visit)-[:LOCATED_AT]->(pl:Place) WHERE v.duration.seconds IS NOT NULL WITH pl.type AS placeType, AVG(v.duration.seconds) AS avgDuration, COUNT(DISTINCT p) AS numPersons RETURN placeType, avgDuration, numPersons",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 511,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_511",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each continent, determine the average visit duration in seconds for visits performed by persons with 'Sick' health status. Return the continent name and the average duration.",
    "Cypher": "MATCH (p:Person {healthstatus: 'Sick'})-[:VISITS]->(v:Visit)-[:LOCATED_AT]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE v.duration.seconds IS NOT NULL WITH c.name AS continent, v.duration.seconds AS visitDuration RETURN continent, AVG(visitDuration) AS avgDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 512,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_512",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each region, calculate the total number of visits and the average duration in seconds of visits that started after '2020-04-20 T 00:00:00 UTC'. Return the region name, total visit count, and average duration.",
    "Cypher": "MATCH (v:Visit)-[:LOCATED_AT]->(pl:Place)-[:PART_OF]->(r:Region) WHERE v.starttime > datetime('2020-04-20T00:00:00UTC') AND v.duration.seconds IS NOT NULL WITH r.name AS region, v.duration.seconds AS visitDuration, v RETURN region, COUNT(v) AS totalVisits, AVG(visitDuration) AS avgDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 513,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_513",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Text cannot be parsed to a DateTime\n\"2020-04-20T00:00:00UTC\"\n ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each country, calculate the average visit duration in seconds for visits to 'Grocery shop' places made by persons with 'Sick' health status. Return the country name and the average visit duration.",
    "Cypher": "MATCH (p:Person {healthstatus: 'Sick'})-[:VISITS]->(v:Visit)-[:LOCATED_AT]->(pl:Place {type: 'Grocery shop'})-[:PART_OF]->(:Region)-[:PART_OF]->(c:Country) WHERE v.duration.seconds IS NOT NULL WITH c.name AS country, v.duration.seconds AS visitDuration RETURN country, AVG(visitDuration) AS avgDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 515,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_515",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each country, find the average number of visits performed by persons with 'Healthy' status and the average duration of those visits in seconds. Return the country name, average number of visits, and average visit duration.",
    "Cypher": "MATCH (p:Person {healthstatus: 'Healthy'})-[v:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(c:Country) WHERE v.duration.seconds IS NOT NULL WITH c.name AS countryName, p, v.duration.seconds AS visitDuration WITH countryName, p, COUNT(v) AS visitCount, AVG(visitDuration) AS avgDurationPerVisit RETURN countryName, AVG(visitCount) AS avgVisits, AVG(avgDurationPerVisit) AS avgVisitDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 528,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_528",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `v` not defined (line 1, column 244 (offset: 243))\n\"MATCH (p:Person {healthstatus: 'Healthy'})-[v:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(c:Country) WHERE v.duration.seconds IS NOT NULL WITH c.name AS countryName, p, v.duration.seconds AS visitDuration WITH countryName, p, COUNT(v) AS visitCount, AVG(visitDuration) AS avgDurationPerVisit RETURN countryName, AVG(visitCount) AS avgVisits, AVG(avgDurationPerVisit) AS avgVisitDuration\"\n                                                                                                                                                                                                                                                    ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each type of place, calculate the average visit duration (in seconds) and the number of persons who visited that type of place. Return the place type, average visit duration, and the number of distinct persons.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(v:Visit)-[:LOCATED_AT]->(pl:Place) WHERE v.duration.seconds IS NOT NULL WITH pl.type AS placeType, AVG(v.duration.seconds) AS avgDuration, COUNT(DISTINCT p) AS distinctPersons RETURN placeType, avgDuration, distinctPersons",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 532,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_532",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each continent, determine the average number of visits performed by persons with 'Sick' health status and the average duration of those visits (in seconds). Return the continent name, average number of visits, and average visit duration.",
    "Cypher": "MATCH (p:Person {healthstatus: 'Sick'})-[:VISITS]->(v:Visit)-[:LOCATED_AT]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE v.duration.seconds IS NOT NULL WITH c.name AS continentName, p, v WITH continentName, COUNT(v) AS visitCount, AVG(v.duration.seconds) AS avgDurationPerVisit RETURN continentName, AVG(visitCount) AS avgVisits, AVG(avgDurationPerVisit) AS avgDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 533,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_533",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each region, calculate the total number of visits and the average duration (in seconds) of visits that occurred before '2020-04-20'. Return the region name, total visit count, and average duration of visits before that date.",
    "Cypher": "MATCH (v:Visit)-[:LOCATED_AT]->(pl:Place)-[:PART_OF]->(r:Region) WHERE v.starttime < datetime('2020-04-20T00:00:00.000+00:00') AND v.duration.seconds IS NOT NULL WITH r.name AS regionName, v RETURN regionName, COUNT(v) AS totalVisits, AVG(v.duration.seconds) AS avgDuration RETURN regionName, totalVisits, avgDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 534,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_534",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: RETURN can only be used at the end of the query. (line 1, column 192 (offset: 191))\n\"MATCH (v:Visit)-[:LOCATED_AT]->(pl:Place)-[:PART_OF]->(r:Region) WHERE v.starttime < datetime('2020-04-20T00:00:00.000+00:00') AND v.duration.seconds IS NOT NULL WITH r.name AS regionName, v RETURN regionName, COUNT(v) AS totalVisits, AVG(v.duration.seconds) AS avgDuration RETURN regionName, totalVisits, avgDuration\"\n                                                                                                                                                                                                ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each country, determine the average number of visits performed by persons with 'Healthy' and 'Sick' health statuses, respectively. Return the country name, average number of visits for 'Healthy' persons, and average number of visits for 'Sick' persons.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(v:Visit)-[:LOCATED_AT]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(c:Country) WITH c.name AS countryName, p.healthstatus AS healthStatus, p, v WITH countryName, healthStatus, COUNT(v) AS visitCount RETURN countryName, AVG(CASE WHEN healthStatus = 'Healthy' THEN visitCount ELSE null END) AS avgHealthyVisits, AVG(CASE WHEN healthStatus = 'Sick' THEN visitCount ELSE null END) AS avgSickVisits",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 535,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_535",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each continent, calculate the average duration (in seconds) of visits to 'School' type places made by persons whose confirmed time is after '2020-04-22'. Return the continent name and the average visit duration.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(v:Visit)-[:LOCATED_AT]->(pl:Place {type: 'School'})-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE p.confirmedtime > datetime('2020-04-22T00:00:00.000+00:00') AND v.duration.seconds IS NOT NULL WITH c.name AS continentName, v.duration.seconds AS visitDuration RETURN continentName, AVG(visitDuration) AS avgVisitDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 536,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_536",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each type of place, calculate the average visit duration in seconds and the total number of persons who visited that type of place. Return the place type, average duration, and the count of distinct persons.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(pl:Place) WHERE v.duration.seconds IS NOT NULL WITH pl.type AS placeType, p, v.duration.seconds AS durationInSeconds WITH placeType, AVG(durationInSeconds) AS avgDuration, COUNT(DISTINCT p) AS distinctPersons RETURN placeType, avgDuration, distinctPersons",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 553,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_553",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `v` not defined (line 1, column 46 (offset: 45))\n\"MATCH (p:Person)-[:VISITS]->(pl:Place) WHERE v.duration.seconds IS NOT NULL WITH pl.type AS placeType, p, v.duration.seconds AS durationInSeconds WITH placeType, AVG(durationInSeconds) AS avgDuration, COUNT(DISTINCT p) AS distinctPersons RETURN placeType, avgDuration, distinctPersons\"\n                                              ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each region, calculate the percentage of visits made by persons with 'Healthy' health status. Return the region name and the percentage of healthy visits.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(r:Region) WITH r, COUNT(v) AS totalVisits, COUNT(CASE WHEN p.healthstatus = 'Healthy' THEN v ELSE NULL END) AS healthyVisits RETURN r.name AS regionName, toFloat(healthyVisits) / totalVisits * 100 AS healthyVisitPercentage",
    "source_dataset": "covid",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 556,
    "unique_id": "covid_data_3_1_2_6_Complex_Aggregation_556",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `v` not defined (line 1, column 77 (offset: 76))\n\"MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(r:Region) WITH r, COUNT(v) AS totalVisits, COUNT(CASE WHEN p.healthstatus = 'Healthy' THEN v ELSE NULL END) AS healthyVisits RETURN r.name AS regionName, toFloat(healthyVisits) / totalVisits * 100 AS healthyVisitPercentage\"\n                                                                             ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each continent, calculate the average number of visits performed by each person and the average visit duration in seconds. Then, return the continent name, the average number of visits per person, and the average visit duration.",
    "Cypher": "MATCH (p:Person)-[v:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE v.duration.seconds IS NOT NULL WITH c.name AS continentName, p, v.duration.seconds AS visitDuration WITH continentName, p, COUNT(v) AS visitCount, visitDuration WITH continentName, AVG(visitCount) AS avgVisitsPerPerson, AVG(visitDuration) AS avgDuration RETURN continentName, avgVisitsPerPerson, avgDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 4,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_4",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `v` not defined (line 1, column 247 (offset: 246))\n\"MATCH (p:Person)-[v:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE v.duration.seconds IS NOT NULL WITH c.name AS continentName, p, v.duration.seconds AS visitDuration WITH continentName, p, COUNT(v) AS visitCount, visitDuration WITH continentName, AVG(visitCount) AS avgVisitsPerPerson, AVG(visitDuration) AS avgDuration RETURN continentName, avgVisitsPerPerson, avgDuration\"\n                                                                                                                                                                                                                                                       ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each country, calculate the percentage of visits made by persons whose confirmedtime is after '2020-04-20' with a healthstatus of 'Sick'. Return the country name and the percentage of infected visits.",
    "Cypher": "MATCH (p:Person)-[v:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(c:Country) WHERE p.confirmedtime > datetime('2020-04-20T00:00:00Z') WITH c.name AS country, COUNT(v) AS totalVisits MATCH (p2:Person {healthstatus: 'Sick'})-[v2:VISITS]->(pl2:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(c2:Country) WHERE p2.confirmedtime > datetime('2020-04-20T00:00:00Z') AND c.name = c2.name WITH country, totalVisits, COUNT(v2) AS infectedVisits RETURN country, toFloat(infectedVisits) / totalVisits * 100 AS infectedPercentage",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 11,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_11",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `c` not defined (line 1, column 367 (offset: 366))\n\"MATCH (p:Person)-[v:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(c:Country) WHERE p.confirmedtime > datetime('2020-04-20T00:00:00Z') WITH c.name AS country, COUNT(v) AS totalVisits MATCH (p2:Person {healthstatus: 'Sick'})-[v2:VISITS]->(pl2:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(c2:Country) WHERE p2.confirmedtime > datetime('2020-04-20T00:00:00Z') AND c.name = c2.name WITH country, totalVisits, COUNT(v2) AS infectedVisits RETURN country, toFloat(infectedVisits) / totalVisits * 100 AS infectedPercentage\"\n                                                                                                                                                                                                                                                                                                                                                                               ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each region, calculate the average visit duration (in seconds) for visits occurring after '2020-04-16 T 00:00:00 UTC'. Also, find the total number of distinct place types visited in each region. Return the region name, average duration, and distinct place type count.",
    "Cypher": "MATCH (v:Visit)-[:LOCATED_AT]->(pl:Place)-[:PART_OF]->(r:Region)\nWHERE v.starttime > datetime('2020-04-16T00:00:00UTC') AND v.duration.seconds IS NOT NULL\nWITH r.name AS regionName, AVG(v.duration.seconds) AS avgDuration, pl.type AS placeType\nWITH regionName, avgDuration, COUNT(DISTINCT placeType) AS distinctPlaceTypeCount\nRETURN regionName, avgDuration, distinctPlaceTypeCount",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 16,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_16",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Text cannot be parsed to a DateTime\n\"2020-04-16T00:00:00UTC\"\n ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each region, determine the percentage of visits made by persons whose health status is 'Sick', compared to the total number of visits to places within that region. Return the region name and the percentage.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(r:Region) WITH r, COUNT(v) AS totalVisits, SUM(CASE WHEN p.healthstatus = 'Sick' THEN 1 ELSE 0 END) AS sickVisits RETURN r.name AS regionName, toFloat(sickVisits) / totalVisits * 100 AS sickVisitPercentage",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 29,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_29",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `v` not defined (line 1, column 77 (offset: 76))\n\"MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(r:Region) WITH r, COUNT(v) AS totalVisits, SUM(CASE WHEN p.healthstatus = 'Sick' THEN 1 ELSE 0 END) AS sickVisits RETURN r.name AS regionName, toFloat(sickVisits) / totalVisits * 100 AS sickVisitPercentage\"\n                                                                             ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each type of place, determine the total number of visits and the average visit duration (in seconds) for visits occurring after '2020-04-15 T 00:00:00 UTC'. Return the place type, total visit count, and average duration.",
    "Cypher": "MATCH (v:Visit)-[:LOCATED_AT]->(pl:Place) WHERE v.starttime > datetime('2020-04-15T00:00:00 UTC') AND v.duration.seconds IS NOT NULL WITH pl.type AS placeType, v COUNT(v) AS totalVisits, AVG(v.duration.seconds) AS avgDuration RETURN placeType, totalVisits, avgDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 43,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_43",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'COUNT': expected an expression, 'FOREACH', ',', 'AS', 'ORDER BY', 'CALL', 'CREATE', 'LOAD CSV', 'DELETE', 'DETACH', 'FINISH', 'INSERT', 'LIMIT', 'MATCH', 'MERGE', 'NODETACH', 'OFFSET', 'OPTIONAL', 'REMOVE', 'RETURN', 'SET', 'SKIP', 'UNION', 'UNWIND', 'USE', 'WHERE', 'WITH' or <EOF> (line 1, column 163 (offset: 162))\n\"MATCH (v:Visit)-[:LOCATED_AT]->(pl:Place) WHERE v.starttime > datetime('2020-04-15T00:00:00 UTC') AND v.duration.seconds IS NOT NULL WITH pl.type AS placeType, v COUNT(v) AS totalVisits, AVG(v.duration.seconds) AS avgDuration RETURN placeType, totalVisits, avgDuration\"\n                                                                                                                                                                   ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "Calculate the average number of visits per person and the average visit duration in seconds across all persons, grouped by the continent where the places they visited are located. Return the continent name, average visits per person, and average visit duration.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent)\nWITH c.name AS continent, p, pl\nWITH continent, p, COUNT(pl) AS visitCount\nWITH continent, AVG(visitCount) AS avgVisitsPerPerson\nMATCH (per:Person)-[v:VISITS]->(pla:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(con:Continent) WHERE con.name = continent and per = p\nWITH continent, avgVisitsPerPerson, v.duration.seconds AS durationSeconds\nWITH continent, avgVisitsPerPerson, AVG(durationSeconds) AS avgDuration\nRETURN continent, avgVisitsPerPerson, avgDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 50,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_50",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `p` not defined (line 5, column 154 (offset: 392))\n\"MATCH (per:Person)-[v:VISITS]->(pla:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(con:Continent) WHERE con.name = continent and per = p\"\n                                                                                                                                                          ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each type of place, calculate the average visit duration in seconds and the number of persons who visited those places. Return the place type, average visit duration, and the number of unique persons.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(pl:Place) WHERE p IS NOT NULL WITH pl.type AS placeType, p, avg(duration.seconds) AS avgDuration MATCH (p)-[:VISITS]->(pl2:Place) WHERE pl2.type = placeType WITH placeType, avgDuration, COUNT(DISTINCT p) AS uniquePersonCount RETURN placeType, avgDuration, uniquePersonCount",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 56,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_56",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `duration` not defined (line 1, column 94 (offset: 93))\n\"MATCH (p:Person)-[:VISITS]->(pl:Place) WHERE p IS NOT NULL WITH pl.type AS placeType, p, avg(duration.seconds) AS avgDuration MATCH (p)-[:VISITS]->(pl2:Place) WHERE pl2.type = placeType WITH placeType, avgDuration, COUNT(DISTINCT p) AS uniquePersonCount RETURN placeType, avgDuration, uniquePersonCount\"\n                                                                                              ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each continent, find the average duration of visits in seconds and the number of sick persons who performed those visits. Return the continent name, average visit duration, and the count of sick persons.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(pl:Place) MATCH (pl)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE p.healthstatus = 'Sick' WITH c.name AS continentName, p, avg(duration.seconds) AS avgDuration MATCH (p)-[:VISITS]->(pl2:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c2:Continent) WHERE c2.name = continentName WITH continentName, avgDuration, COUNT(DISTINCT p) AS sickPersonCount RETURN continentName, avgDuration, sickPersonCount",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 57,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_57",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `duration` not defined (line 1, column 189 (offset: 188))\n\"MATCH (p:Person)-[:VISITS]->(pl:Place) MATCH (pl)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE p.healthstatus = 'Sick' WITH c.name AS continentName, p, avg(duration.seconds) AS avgDuration MATCH (p)-[:VISITS]->(pl2:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c2:Continent) WHERE c2.name = continentName WITH continentName, avgDuration, COUNT(DISTINCT p) AS sickPersonCount RETURN continentName, avgDuration, sickPersonCount\"\n                                                                                                                                                                                             ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each continent, compute the average number of visits per person and the average duration in seconds of those visits. Return the continent name, average number of visits per person, and average visit duration.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(pl:Place) MATCH (pl)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE v.duration.seconds IS NOT NULL WITH c.name AS continentName, p, COUNT(pl) AS visitCount, AVG(duration.seconds) AS avgDuration WITH continentName, AVG(visitCount) AS avgVisitsPerPerson, AVG(avgDuration) AS avgVisitDuration RETURN continentName, avgVisitsPerPerson, avgVisitDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 59,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_59",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `v` not defined (line 1, column 128 (offset: 127))\n\"MATCH (p:Person)-[:VISITS]->(pl:Place) MATCH (pl)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE v.duration.seconds IS NOT NULL WITH c.name AS continentName, p, COUNT(pl) AS visitCount, AVG(duration.seconds) AS avgDuration WITH continentName, AVG(visitCount) AS avgVisitsPerPerson, AVG(avgDuration) AS avgVisitDuration RETURN continentName, avgVisitsPerPerson, avgVisitDuration\"\n                                                                                                                                ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each country, determine the average number of visits made by persons with 'Sick' health status and the average duration of those visits in seconds. Return the country name, the average number of visits, and the average visit duration.",
    "Cypher": "MATCH (p:Person {healthstatus: 'Sick'})-[:VISITS]->(pl:Place) MATCH (pl)-[:PART_OF]->(:Region)-[:PART_OF]->(c:Country) WHERE duration.seconds IS NOT NULL WITH c.name AS countryName, p, COUNT(pl) AS visitCount, AVG(duration.seconds) AS avgDuration WITH countryName, AVG(visitCount) AS avgVisitsPerPerson, AVG(avgDuration) AS avgVisitDuration RETURN countryName, avgVisitsPerPerson, avgVisitDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 60,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_60",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `duration` not defined (line 1, column 126 (offset: 125))\n\"MATCH (p:Person {healthstatus: 'Sick'})-[:VISITS]->(pl:Place) MATCH (pl)-[:PART_OF]->(:Region)-[:PART_OF]->(c:Country) WHERE duration.seconds IS NOT NULL WITH c.name AS countryName, p, COUNT(pl) AS visitCount, AVG(duration.seconds) AS avgDuration WITH countryName, AVG(visitCount) AS avgVisitsPerPerson, AVG(avgDuration) AS avgVisitDuration RETURN countryName, avgVisitsPerPerson, avgVisitDuration\"\n                                                                                                                              ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each continent, calculate the average number of visits per person and the average visit duration (in seconds). Return the continent name, average visits per person, and average visit duration.",
    "Cypher": "MATCH (p:Person)-[v:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE v.duration.seconds IS NOT NULL WITH c.name AS continent, p, v.duration.seconds AS visitDuration WITH continent, p, COUNT(v) AS visitCount, AVG(visitDuration) AS avgVisitDurationPerVisit WITH continent, AVG(visitCount) AS avgVisitsPerPerson, AVG(avgVisitDurationPerVisit) AS overallAvgVisitDuration RETURN continent, avgVisitsPerPerson, overallAvgVisitDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 67,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_67",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `v` not defined (line 1, column 239 (offset: 238))\n\"MATCH (p:Person)-[v:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE v.duration.seconds IS NOT NULL WITH c.name AS continent, p, v.duration.seconds AS visitDuration WITH continent, p, COUNT(v) AS visitCount, AVG(visitDuration) AS avgVisitDurationPerVisit WITH continent, AVG(visitCount) AS avgVisitsPerPerson, AVG(avgVisitDurationPerVisit) AS overallAvgVisitDuration RETURN continent, avgVisitsPerPerson, overallAvgVisitDuration\"\n                                                                                                                                                                                                                                               ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each continent, find the average duration (in seconds) of visits. Then, for each continent calculate the average duration (in seconds) of visits made by the person who has 'Sick' healthstatus. Return the continent name, average total visit duration and average sick visit duration.",
    "Cypher": "MATCH (p:Person)-[v:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE v.duration.seconds IS NOT NULL WITH c.name AS continent, AVG(v.duration.seconds) AS totalAvgDuration MATCH (sick:Person {healthstatus: 'Sick'})-[vs:VISITS]->(pls:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(cs:Continent) WHERE vs.duration.seconds IS NOT NULL AND c.name = cs.name WITH continent, totalAvgDuration, AVG(vs.duration.seconds) AS sickAvgDuration RETURN continent, totalAvgDuration, sickAvgDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 92,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_92",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `c` not defined (line 1, column 401 (offset: 400))\n\"MATCH (p:Person)-[v:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE v.duration.seconds IS NOT NULL WITH c.name AS continent, AVG(v.duration.seconds) AS totalAvgDuration MATCH (sick:Person {healthstatus: 'Sick'})-[vs:VISITS]->(pls:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(cs:Continent) WHERE vs.duration.seconds IS NOT NULL AND c.name = cs.name WITH continent, totalAvgDuration, AVG(vs.duration.seconds) AS sickAvgDuration RETURN continent, totalAvgDuration, sickAvgDuration\"\n                                                                                                                                                                                                                                                                                                                                                                                                                 ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each country, determine the average number of visits performed by persons with 'Healthy' status and persons with 'Sick' status to places of type 'Park'. Return the country name, average visits for 'Healthy' persons, and average visits for 'Sick' persons.",
    "Cypher": "MATCH (p:Person)-[:PERFORMS_VISIT]->(v:Visit)-[:LOCATED_AT]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(c:Country) WHERE pl.type = 'Park' WITH c.name AS country, p.healthstatus AS healthStatus, v RETURN country, healthStatus, COUNT(v) AS visitCount WITH country, COLLECT({status: healthStatus, count: visitCount}) AS visits RETURN country, visits[0].count AS healthyVisits, visits[1].count AS sickVisits",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 101,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_101",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: RETURN can only be used at the end of the query. (line 1, column 200 (offset: 199))\n\"MATCH (p:Person)-[:PERFORMS_VISIT]->(v:Visit)-[:LOCATED_AT]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(c:Country) WHERE pl.type = 'Park' WITH c.name AS country, p.healthstatus AS healthStatus, v RETURN country, healthStatus, COUNT(v) AS visitCount WITH country, COLLECT({status: healthStatus, count: visitCount}) AS visits RETURN country, visits[0].count AS healthyVisits, visits[1].count AS sickVisits\"\n                                                                                                                                                                                                        ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each region, calculate the total number of persons who have visited places in that region and the average visit duration (in seconds) for visits made by those persons. Return the region name, total person count, and average visit duration.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(r:Region) WHERE EXISTS {MATCH (p)-[:PERFORMS_VISIT]->(v:Visit) WHERE v.duration.seconds IS NOT NULL} WITH r.name AS regionName, p WITH regionName, p, AVG(duration.seconds) AS avgDuration  RETURN regionName, COUNT(DISTINCT p), AVG(avgDuration)",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 107,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_107",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `duration` not defined (line 1, column 207 (offset: 206))\n\"MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(r:Region) WHERE EXISTS {MATCH (p)-[:PERFORMS_VISIT]->(v:Visit) WHERE v.duration.seconds IS NOT NULL} WITH r.name AS regionName, p WITH regionName, p, AVG(duration.seconds) AS avgDuration  RETURN regionName, COUNT(DISTINCT p), AVG(avgDuration)\"\n                                                                                                                                                                                                               ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each continent, calculate the total number of visits and the average duration of visits in seconds that occurred after '2020-04-15'. Return the continent name, total visits, and average duration.",
    "Cypher": "MATCH (p:Person)-[v:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE v.starttime > datetime('2020-04-15T00:00:00Z') AND v.duration.seconds IS NOT NULL WITH c.name AS continentName, v.duration.seconds AS visitDuration RETURN continentName, COUNT(v) AS totalVisits, AVG(visitDuration) AS averageVisitDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 115,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_115",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `v` not defined (line 1, column 294 (offset: 293))\n\"MATCH (p:Person)-[v:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE v.starttime > datetime('2020-04-15T00:00:00Z') AND v.duration.seconds IS NOT NULL WITH c.name AS continentName, v.duration.seconds AS visitDuration RETURN continentName, COUNT(v) AS totalVisits, AVG(visitDuration) AS averageVisitDuration\"\n                                                                                                                                                                                                                                                                                                      ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each health status, calculate the average number of visits performed by people with that health status and the average duration (in seconds) of those visits. Return the health status, average number of visits, and average visit duration.",
    "Cypher": "MATCH (p:Person)-[v:VISITS]->(pl:Place)\nWHERE v.duration.seconds IS NOT NULL\nWITH p.healthstatus AS healthStatus, p, v.duration.seconds AS visitDuration\nWITH healthStatus, p, COUNT(v) AS totalVisits, visitDuration\nWITH healthStatus, AVG(totalVisits) AS avgVisits, AVG(visitDuration) AS avgDuration\nRETURN healthStatus, avgVisits, avgDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 123,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_123",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `v` not defined (line 4, column 29 (offset: 181))\n\"WITH healthStatus, p, COUNT(v) AS totalVisits, visitDuration\"\n                             ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each continent, determine the average visit duration in seconds for visits to places of type 'Theater'. Also, calculate the total number of persons who performed those visits. Return the continent name, average duration, and total persons.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE pl.type = 'Theater' WITH c.name AS continentName, p, pl, p-[v:VISITS]->pl WHERE v.duration.seconds IS NOT NULL WITH continentName, AVG(v.duration.seconds) AS avgDuration, COUNT(DISTINCT p) AS totalPersons RETURN continentName, avgDuration, totalPersons",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 134,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_134",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input '>': expected an expression (line 1, column 187 (offset: 186))\n\"MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE pl.type = 'Theater' WITH c.name AS continentName, p, pl, p-[v:VISITS]->pl WHERE v.duration.seconds IS NOT NULL WITH continentName, AVG(v.duration.seconds) AS avgDuration, COUNT(DISTINCT p) AS totalPersons RETURN continentName, avgDuration, totalPersons\"\n                                                                                                                                                                                           ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each region, compute the average visit duration in seconds for visits performed by persons with 'Sick' health status. Also, calculate the total number of distinct places visited by these persons. Return the region name, average duration, and total places.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(r:Region) WHERE p.healthstatus = 'Sick' WITH r.name AS regionName, p, pl, p-[v:VISITS]->pl WHERE v.duration.seconds IS NOT NULL WITH regionName, AVG(v.duration.seconds) AS avgDuration, COUNT(DISTINCT pl) AS totalPlaces RETURN regionName, avgDuration, totalPlaces",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 136,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_136",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input '>': expected an expression (line 1, column 140 (offset: 139))\n\"MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(r:Region) WHERE p.healthstatus = 'Sick' WITH r.name AS regionName, p, pl, p-[v:VISITS]->pl WHERE v.duration.seconds IS NOT NULL WITH regionName, AVG(v.duration.seconds) AS avgDuration, COUNT(DISTINCT pl) AS totalPlaces RETURN regionName, avgDuration, totalPlaces\"\n                                                                                                                                            ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each type of place, calculate the average visit duration in seconds and the number of persons who visited that type of place. Return the place type, average visit duration, and the number of unique persons.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(pl:Place) WHERE pl.type IS NOT NULL WITH pl.type AS placeType, p, AVG(duration.seconds) AS avgDuration MATCH (p)-[:VISITS]->(pl2:Place) WHERE pl2.type = placeType WITH placeType, avgDuration, COUNT(DISTINCT p) AS uniquePersonCount RETURN placeType, avgDuration, uniquePersonCount",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 140,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_140",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `duration` not defined (line 1, column 100 (offset: 99))\n\"MATCH (p:Person)-[:VISITS]->(pl:Place) WHERE pl.type IS NOT NULL WITH pl.type AS placeType, p, AVG(duration.seconds) AS avgDuration MATCH (p)-[:VISITS]->(pl2:Place) WHERE pl2.type = placeType WITH placeType, avgDuration, COUNT(DISTINCT p) AS uniquePersonCount RETURN placeType, avgDuration, uniquePersonCount\"\n                                                                                                    ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each continent, determine the average number of visits made by persons with 'Sick' health status and the total number of places visited by these persons. Return the continent name, average visits, and total places visited.",
    "Cypher": "MATCH (p:Person {healthstatus: 'Sick'})-[:VISITS]->(pl:Place) MATCH (pl)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WITH c.name AS continent, p, pl COUNT(p) AS personCount WITH continent,personCount,COUNT(DISTINCT pl) AS placeCount RETURN continent, AVG(personCount), placeCount",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 141,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_141",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'COUNT': expected an expression, 'FOREACH', ',', 'AS', 'ORDER BY', 'CALL', 'CREATE', 'LOAD CSV', 'DELETE', 'DETACH', 'FINISH', 'INSERT', 'LIMIT', 'MATCH', 'MERGE', 'NODETACH', 'OFFSET', 'OPTIONAL', 'REMOVE', 'RETURN', 'SET', 'SKIP', 'UNION', 'UNWIND', 'USE', 'WHERE', 'WITH' or <EOF> (line 1, column 177 (offset: 176))\n\"MATCH (p:Person {healthstatus: 'Sick'})-[:VISITS]->(pl:Place) MATCH (pl)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WITH c.name AS continent, p, pl COUNT(p) AS personCount WITH continent,personCount,COUNT(DISTINCT pl) AS placeCount RETURN continent, AVG(personCount), placeCount\"\n                                                                                                                                                                                 ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each country, calculate the average number of visits performed by persons before their confirmed time and the total number of distinct places they visited. Return the country name, average visits, and distinct place count.",
    "Cypher": "MATCH (p:Person)-[v:VISITS]->(pl:Place) MATCH (pl)-[:PART_OF]->(:Region)-[:PART_OF]->(c:Country) WHERE v.starttime < p.confirmedtime WITH c.name AS country, p, pl COUNT(v) AS visitCount WITH country, p, visitCount, COUNT(DISTINCT pl) AS distinctPlaces RETURN country, AVG(visitCount), AVG(distinctPlaces)",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 143,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_143",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'COUNT': expected an expression, 'FOREACH', ',', 'AS', 'ORDER BY', 'CALL', 'CREATE', 'LOAD CSV', 'DELETE', 'DETACH', 'FINISH', 'INSERT', 'LIMIT', 'MATCH', 'MERGE', 'NODETACH', 'OFFSET', 'OPTIONAL', 'REMOVE', 'RETURN', 'SET', 'SKIP', 'UNION', 'UNWIND', 'USE', 'WHERE', 'WITH' or <EOF> (line 1, column 164 (offset: 163))\n\"MATCH (p:Person)-[v:VISITS]->(pl:Place) MATCH (pl)-[:PART_OF]->(:Region)-[:PART_OF]->(c:Country) WHERE v.starttime < p.confirmedtime WITH c.name AS country, p, pl COUNT(v) AS visitCount WITH country, p, visitCount, COUNT(DISTINCT pl) AS distinctPlaces RETURN country, AVG(visitCount), AVG(distinctPlaces)\"\n                                                                                                                                                                    ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each continent, calculate the average visit duration in seconds for visits to 'Theater' type places made by 'Sick' persons, and also count the number of such visits. Return the continent name, average duration, and visit count.",
    "Cypher": "MATCH (p:Person {healthstatus: 'Sick'})-[v:VISITS]->(pl:Place {type: 'Theater'}) MATCH (pl)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WITH c.name AS continent, v.duration.seconds AS duration RETURN continent, AVG(duration), COUNT(v)",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 144,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_144",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `v` not defined (line 1, column 260 (offset: 259))\n\"MATCH (p:Person {healthstatus: 'Sick'})-[v:VISITS]->(pl:Place {type: 'Theater'}) MATCH (pl)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WITH c.name AS continent, v.duration.seconds AS duration RETURN continent, AVG(duration), COUNT(v)\"\n                                                                                                                                                                                                                                                                    ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each continent, determine the average number of visits made by persons with 'Healthy' status and the average duration of these visits in seconds. Return the continent name, average visit count, and average duration.",
    "Cypher": "MATCH (p:Person {healthstatus: 'Healthy'})-[:VISITS]->(v:Visit)-[:LOCATED_AT]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE v.duration.seconds IS NOT NULL WITH c.name AS continent, p, v WITH continent, p, COUNT(v) AS visitCount, AVG(v.duration.seconds) AS avgDurationPerVisit WITH continent, AVG(visitCount) AS avgVisitCount, AVG(avgDurationPerVisit) AS overallAvgDuration RETURN continent, avgVisitCount, overallAvgDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 148,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_148",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each region, compute the total number of visits and the average duration of visits in seconds made by persons before their confirmed time. Return the region name, total visits, and average duration.",
    "Cypher": "MATCH (p:Person)-[:PERFORMS_VISIT]->(v:Visit)-[:LOCATED_AT]->(pl:Place)-[:PART_OF]->(r:Region) WHERE v.duration.seconds IS NOT NULL AND v.starttime < p.confirmedtime WITH r.name AS region, v.duration.seconds AS duration RETURN region, COUNT(v) AS totalVisits, AVG(duration) AS averageDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 150,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_150",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `v` not defined (line 1, column 242 (offset: 241))\n\"MATCH (p:Person)-[:PERFORMS_VISIT]->(v:Visit)-[:LOCATED_AT]->(pl:Place)-[:PART_OF]->(r:Region) WHERE v.duration.seconds IS NOT NULL AND v.starttime < p.confirmedtime WITH r.name AS region, v.duration.seconds AS duration RETURN region, COUNT(v) AS totalVisits, AVG(duration) AS averageDuration\"\n                                                                                                                                                                                                                                                  ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each continent, what is the average visit duration in seconds for each type of place, considering only visits made by people whose health status is 'Healthy'?",
    "Cypher": "MATCH (p:Person {healthstatus: 'Healthy'})-[:VISITS]->(v:Visit)-[:LOCATED_AT]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE v.duration.seconds IS NOT NULL WITH c.name AS continent, pl.type AS placeType, v.duration.seconds AS duration RETURN continent, placeType, AVG(duration) AS averageDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 151,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_151",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each country, calculate the average visit duration (in seconds) for visits occurring before '2020-04-20' and the average visit duration for visits occurring on or after '2020-04-20'. Return the country name, average duration before the date, and average duration on or after the date.",
    "Cypher": "MATCH (v:Visit)-[:LOCATED_AT]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(c:Country) WHERE v.duration.seconds IS NOT NULL WITH c.name AS country, v.starttime AS visitStart, v.duration.seconds AS visitDuration, CASE WHEN date(visitStart) < date('2020-04-20') THEN visitDuration ELSE null END AS beforeDuration, CASE WHEN date(visitStart) >= date('2020-04-20') THEN visitDuration ELSE null END AS afterDuration WITH country, AVG(beforeDuration) AS avgBefore, AVG(afterDuration) AS avgAfter RETURN country, avgBefore, avgAfter",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 165,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_165",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `visitStart` not defined (line 1, column 229 (offset: 228))\n\"MATCH (v:Visit)-[:LOCATED_AT]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(c:Country) WHERE v.duration.seconds IS NOT NULL WITH c.name AS country, v.starttime AS visitStart, v.duration.seconds AS visitDuration, CASE WHEN date(visitStart) < date('2020-04-20') THEN visitDuration ELSE null END AS beforeDuration, CASE WHEN date(visitStart) >= date('2020-04-20') THEN visitDuration ELSE null END AS afterDuration WITH country, AVG(beforeDuration) AS avgBefore, AVG(afterDuration) AS avgAfter RETURN country, avgBefore, avgAfter\"\n                                                                                                                                                                                                                                     ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each type of place, determine the average number of visits performed by persons with 'Healthy' status before '2020-04-20 T 00:00:00 UTC'. Return the place type and the average number of visits.",
    "Cypher": "MATCH (p:Person {healthstatus: 'Healthy'})-[v:VISITS]->(pl:Place) WHERE v.starttime < datetime('2020-04-20T00:00:00 UTC') WITH pl.type AS placeType, COUNT(v) AS visitCount RETURN placeType, AVG(visitCount) AS avgVisits ORDER BY placeType",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 169,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_169",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Text cannot be parsed to a DateTime\n\"2020-04-20T00:00:00 UTC\"\n ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each region, compute the average number of visits made by persons with 'Healthy' status and the average duration (in seconds) of those visits. Return the region name, average number of visits, and average visit duration.",
    "Cypher": "MATCH (p:Person {healthstatus: 'Healthy'})-[v:VISITS]->(pl:Place)-[:PART_OF]->(r:Region) WHERE v.duration.seconds IS NOT NULL WITH r.name AS region, p, v COUNT(v) AS visitCount, AVG(v.duration.seconds) AS avgDuration RETURN region, AVG(visitCount) AS avgVisits, AVG(avgDuration) AS overallAvgDuration ORDER BY region",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 170,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_170",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'COUNT': expected an expression, 'FOREACH', ',', 'AS', 'ORDER BY', 'CALL', 'CREATE', 'LOAD CSV', 'DELETE', 'DETACH', 'FINISH', 'INSERT', 'LIMIT', 'MATCH', 'MERGE', 'NODETACH', 'OFFSET', 'OPTIONAL', 'REMOVE', 'RETURN', 'SET', 'SKIP', 'UNION', 'UNWIND', 'USE', 'WHERE', 'WITH' or <EOF> (line 1, column 155 (offset: 154))\n\"MATCH (p:Person {healthstatus: 'Healthy'})-[v:VISITS]->(pl:Place)-[:PART_OF]->(r:Region) WHERE v.duration.seconds IS NOT NULL WITH r.name AS region, p, v COUNT(v) AS visitCount, AVG(v.duration.seconds) AS avgDuration RETURN region, AVG(visitCount) AS avgVisits, AVG(avgDuration) AS overallAvgDuration ORDER BY region\"\n                                                                                                                                                           ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each country, calculate the ratio of visits to 'School' places to the total number of visits. Return the country name and the visit ratio.",
    "Cypher": "MATCH (p:Person)-[v:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(c:Country) WITH c, pl, v, CASE WHEN pl.type = 'School' THEN 1 ELSE 0 END AS isSchool VISIT MATCH (p:Person)-[v:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(c:Country) WITH c, SUM(CASE WHEN pl.type = 'School' THEN 1 ELSE 0 END) AS schoolVisits, COUNT(v) AS totalVisits RETURN c.name AS countryName, toFloat(schoolVisits) / totalVisits AS schoolVisitRatio ORDER BY countryName",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 171,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_171",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'VISIT': expected 'FOREACH', ',', 'ORDER BY', 'CALL', 'CREATE', 'LOAD CSV', 'DELETE', 'DETACH', 'FINISH', 'INSERT', 'LIMIT', 'MATCH', 'MERGE', 'NODETACH', 'OFFSET', 'OPTIONAL', 'REMOVE', 'RETURN', 'SET', 'SKIP', 'UNION', 'UNWIND', 'USE', 'WHERE', 'WITH' or <EOF> (line 1, column 161 (offset: 160))\n\"MATCH (p:Person)-[v:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(c:Country) WITH c, pl, v, CASE WHEN pl.type = 'School' THEN 1 ELSE 0 END AS isSchool VISIT MATCH (p:Person)-[v:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(c:Country) WITH c, SUM(CASE WHEN pl.type = 'School' THEN 1 ELSE 0 END) AS schoolVisits, COUNT(v) AS totalVisits RETURN c.name AS countryName, toFloat(schoolVisits) / totalVisits AS schoolVisitRatio ORDER BY countryName\"\n                                                                                                                                                                 ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each continent, find the place type with the maximum average visit duration in seconds. Return the continent name, place type, and maximum average duration.",
    "Cypher": "MATCH (p:Person)-[v:VISITS]->(pl:Place)\nMATCH (pl)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(cont:Continent)\nWITH cont.name AS continent, pl.type AS placeType, AVG(v.duration.seconds) AS avgDuration\nWITH continent, placeType, avgDuration, MAX(avgDuration) OVER (PARTITION BY continent) AS maxAvgDuration\nWHERE avgDuration = maxAvgDuration\nRETURN continent, placeType, avgDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 178,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_178",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'OVER': expected an expression, 'FOREACH', ',', 'AS', 'ORDER BY', 'CALL', 'CREATE', 'LOAD CSV', 'DELETE', 'DETACH', 'FINISH', 'INSERT', 'LIMIT', 'MATCH', 'MERGE', 'NODETACH', 'OFFSET', 'OPTIONAL', 'REMOVE', 'RETURN', 'SET', 'SKIP', 'UNION', 'UNWIND', 'USE', 'WHERE', 'WITH' or <EOF> (line 4, column 58 (offset: 272))\n\"WITH continent, placeType, avgDuration, MAX(avgDuration) OVER (PARTITION BY continent) AS maxAvgDuration\"\n                                                          ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each continent, calculate the average number of visits performed by 'Healthy' persons to 'Restaurant' type places. Return the continent name and the average number of visits.",
    "Cypher": "MATCH (p:Person {healthstatus: 'Healthy'})-[v:VISITS]->(pl:Place {type: 'Restaurant'})\nMATCH (pl)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent)\nWITH c.name AS continent, p\nRETURN continent, count(v) AS visitCount",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 186,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_186",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `v` not defined (line 4, column 25 (offset: 221))\n\"RETURN continent, count(v) AS visitCount\"\n                         ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each type of place, calculate the average visit duration in seconds and the number of persons who visited that type of place at least once. Return the place type, average visit duration, and the number of unique visitors.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(pl:Place) WHERE p.id IS NOT NULL WITH pl.type AS placeType, p, AVG(duration.seconds) AS avgDuration MATCH (p)-[:VISITS]->(pl2:Place) WHERE pl2.type = placeType WITH placeType, avgDuration, COUNT(DISTINCT p) AS uniqueVisitors RETURN placeType, avgDuration, uniqueVisitors",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 189,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_189",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `duration` not defined (line 1, column 97 (offset: 96))\n\"MATCH (p:Person)-[:VISITS]->(pl:Place) WHERE p.id IS NOT NULL WITH pl.type AS placeType, p, AVG(duration.seconds) AS avgDuration MATCH (p)-[:VISITS]->(pl2:Place) WHERE pl2.type = placeType WITH placeType, avgDuration, COUNT(DISTINCT p) AS uniqueVisitors RETURN placeType, avgDuration, uniqueVisitors\"\n                                                                                                 ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each continent, determine the average number of visits performed by persons with 'Sick' health status and the average duration of these visits in seconds. Return the continent name, average number of visits, and average visit duration.",
    "Cypher": "MATCH (p:Person {healthstatus: 'Sick'})-[:VISITS]->(pl:Place) MATCH (pl)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WITH c.name AS continent, p, AVG(duration.seconds) AS avgDuration RETURN continent, count(p) AS totalSickVisitors, avgDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 190,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_190",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `duration` not defined (line 1, column 178 (offset: 177))\n\"MATCH (p:Person {healthstatus: 'Sick'})-[:VISITS]->(pl:Place) MATCH (pl)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WITH c.name AS continent, p, AVG(duration.seconds) AS avgDuration RETURN continent, count(p) AS totalSickVisitors, avgDuration\"\n                                                                                                                                                                                  ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each region, calculate the ratio of visits made by persons with 'Sick' health status to the total number of visits, and the average duration of visits in seconds. Return the region name, the ratio of 'Sick' visits to total visits, and the average visit duration.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(r:Region) WITH r.name AS region, p, pl, duration.seconds AS visitDuration WITH region, p, visitDuration, CASE WHEN p.healthstatus = 'Sick' THEN 1 ELSE 0 END AS isSick MATCH (p:Person)-[:VISITS]->(pl2:Place)-[:PART_OF]->(r2:Region) WHERE r2.name = region WITH region, SUM(isSick) AS sickVisits, COUNT(*) AS totalVisits, AVG(visitDuration) AS avgDuration RETURN region, toFloat(sickVisits) / totalVisits AS sickVisitRatio, avgDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 191,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_191",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `duration` not defined (line 1, column 93 (offset: 92))\n\"MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(r:Region) WITH r.name AS region, p, pl, duration.seconds AS visitDuration WITH region, p, visitDuration, CASE WHEN p.healthstatus = 'Sick' THEN 1 ELSE 0 END AS isSick MATCH (p:Person)-[:VISITS]->(pl2:Place)-[:PART_OF]->(r2:Region) WHERE r2.name = region WITH region, SUM(isSick) AS sickVisits, COUNT(*) AS totalVisits, AVG(visitDuration) AS avgDuration RETURN region, toFloat(sickVisits) / totalVisits AS sickVisitRatio, avgDuration\"\n                                                                                             ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each country, find the place type with the longest average visit duration in seconds. Return the country name, place type, and the corresponding average visit duration.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(c:Country) WHERE duration.seconds IS NOT NULL WITH c.name AS country, pl.type AS placeType, AVG(duration.seconds) AS avgDuration WITH country, placeType, avgDuration ORDER BY avgDuration DESC WITH country, COLLECT({placeType: placeType, avgDuration: avgDuration}) AS placeDurations RETURN country, head(placeDurations).placeType AS placeType, head(placeDurations).avgDuration AS avgDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 192,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_192",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `duration` not defined (line 1, column 92 (offset: 91))\n\"MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(c:Country) WHERE duration.seconds IS NOT NULL WITH c.name AS country, pl.type AS placeType, AVG(duration.seconds) AS avgDuration WITH country, placeType, avgDuration ORDER BY avgDuration DESC WITH country, COLLECT({placeType: placeType, avgDuration: avgDuration}) AS placeDurations RETURN country, head(placeDurations).placeType AS placeType, head(placeDurations).avgDuration AS avgDuration\"\n                                                                                            ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "Calculate the average number of visits per person and the average visit duration in seconds across all continents, considering only persons who have visited at least two different types of places. Return the overall average number of visits per person and the overall average visit duration.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(pl:Place) WITH p, count(DISTINCT pl.type) AS distinctPlaceTypes WHERE distinctPlaceTypes >= 2 WITH p MATCH (p)-[:VISITS]->(pl2:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WITH p, duration.seconds AS visitDuration WITH AVG(duration.seconds) AS avgDuration, count(p) AS totalVisits RETURN avgDuration, totalVisits",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 193,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_193",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `duration` not defined (line 1, column 243 (offset: 242))\n\"MATCH (p:Person)-[:VISITS]->(pl:Place) WITH p, count(DISTINCT pl.type) AS distinctPlaceTypes WHERE distinctPlaceTypes >= 2 WITH p MATCH (p)-[:VISITS]->(pl2:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WITH p, duration.seconds AS visitDuration WITH AVG(duration.seconds) AS avgDuration, count(p) AS totalVisits RETURN avgDuration, totalVisits\"\n                                                                                                                                                                                                                                                   ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each continent, calculate the average number of visits per person and the average duration (in seconds) of those visits, considering only visits to 'Hospital' type places. Return the continent name, average visits per person, and average visit duration.",
    "Cypher": "MATCH (p:Person)-[:PERFORMS_VISIT]->(v:Visit)-[:LOCATED_AT]->(pl:Place {type: 'Hospital'})-[:PART_OF]->(r:Region)-[:PART_OF]->(c:Country)-[:PART_OF]->(cont:Continent) WHERE v.duration.seconds IS NOT NULL WITH cont.name AS continentName, p, v.duration.seconds AS visitDuration WITH continentName, p, COUNT(v) AS visitCount, AVG(visitDuration) AS avgVisitDurationPerPerson WITH continentName, AVG(visitCount) AS avgVisitsPerPerson, AVG(avgVisitDurationPerPerson) AS avgDuration RETURN continentName, avgVisitsPerPerson, avgDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 200,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_200",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `v` not defined (line 1, column 306 (offset: 305))\n\"MATCH (p:Person)-[:PERFORMS_VISIT]->(v:Visit)-[:LOCATED_AT]->(pl:Place {type: 'Hospital'})-[:PART_OF]->(r:Region)-[:PART_OF]->(c:Country)-[:PART_OF]->(cont:Continent) WHERE v.duration.seconds IS NOT NULL WITH cont.name AS continentName, p, v.duration.seconds AS visitDuration WITH continentName, p, COUNT(v) AS visitCount, AVG(visitDuration) AS avgVisitDurationPerPerson WITH continentName, AVG(visitCount) AS avgVisitsPerPerson, AVG(avgVisitDurationPerPerson) AS avgDuration RETURN continentName, avgVisitsPerPerson, avgDuration\"\n                                                                                                                                                                                                                                                                                                                  ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each continent, determine the average number of visits performed by people with 'Sick' health status and the average duration of those visits in seconds. Return the continent name, average number of visits, and average visit duration.",
    "Cypher": "MATCH (p:Person {healthstatus: 'Sick'})-[v:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE v.duration.seconds IS NOT NULL WITH c.name AS continent, p, v COUNT(v) AS visitCount, AVG(v.duration.seconds) AS avgDuration WITH continent, AVG(visitCount) AS avgVisits, AVG(avgDuration) AS avgVisitDuration RETURN continent, avgVisits, avgVisitDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 203,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_203",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'COUNT': expected an expression, 'FOREACH', ',', 'AS', 'ORDER BY', 'CALL', 'CREATE', 'LOAD CSV', 'DELETE', 'DETACH', 'FINISH', 'INSERT', 'LIMIT', 'MATCH', 'MERGE', 'NODETACH', 'OFFSET', 'OPTIONAL', 'REMOVE', 'RETURN', 'SET', 'SKIP', 'UNION', 'UNWIND', 'USE', 'WHERE', 'WITH' or <EOF> (line 1, column 203 (offset: 202))\n\"MATCH (p:Person {healthstatus: 'Sick'})-[v:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE v.duration.seconds IS NOT NULL WITH c.name AS continent, p, v COUNT(v) AS visitCount, AVG(v.duration.seconds) AS avgDuration WITH continent, AVG(visitCount) AS avgVisits, AVG(avgDuration) AS avgVisitDuration RETURN continent, avgVisits, avgVisitDuration\"\n                                                                                                                                                                                                           ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each type of place, calculate the average number of visits and the average visit duration in seconds, only considering visits that started before '2020-04-20 T 00:00:00 UTC'. Return the place type, average visit count, and average visit duration.",
    "Cypher": "MATCH (v:Visit)-[:LOCATED_AT]->(pl:Place) WHERE v.starttime < datetime('2020-04-20T00:00:00 UTC') AND v.duration.seconds IS NOT NULL WITH pl.type AS placeType, v COUNT(v) AS visitCount, AVG(v.duration.seconds) AS avgDuration WITH placeType, AVG(visitCount) AS avgVisits, AVG(avgDuration) AS avgVisitDuration RETURN placeType, avgVisits, avgVisitDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 204,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_204",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'COUNT': expected an expression, 'FOREACH', ',', 'AS', 'ORDER BY', 'CALL', 'CREATE', 'LOAD CSV', 'DELETE', 'DETACH', 'FINISH', 'INSERT', 'LIMIT', 'MATCH', 'MERGE', 'NODETACH', 'OFFSET', 'OPTIONAL', 'REMOVE', 'RETURN', 'SET', 'SKIP', 'UNION', 'UNWIND', 'USE', 'WHERE', 'WITH' or <EOF> (line 1, column 163 (offset: 162))\n\"MATCH (v:Visit)-[:LOCATED_AT]->(pl:Place) WHERE v.starttime < datetime('2020-04-20T00:00:00 UTC') AND v.duration.seconds IS NOT NULL WITH pl.type AS placeType, v COUNT(v) AS visitCount, AVG(v.duration.seconds) AS avgDuration WITH placeType, AVG(visitCount) AS avgVisits, AVG(avgDuration) AS avgVisitDuration RETURN placeType, avgVisits, avgVisitDuration\"\n                                                                                                                                                                   ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each region, compute the average number of visits made by persons before their confirmed time, and the average duration of these visits in seconds. Return the region name, average number of pre-confirmation visits, and average visit duration.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(r:Region), (p)-[:PERFORMS_VISIT]->(v:Visit) WHERE v.starttime < p.confirmedtime AND v.duration.seconds IS NOT NULL WITH r.name AS region, p, v COUNT(v) AS preConfirmationVisits, AVG(v.duration.seconds) AS avgDuration WITH region, AVG(preConfirmationVisits) AS avgPreConfirmationVisits, AVG(avgDuration) AS avgVisitDuration RETURN region, avgPreConfirmationVisits, avgVisitDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 205,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_205",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'COUNT': expected an expression, 'FOREACH', ',', 'AS', 'ORDER BY', 'CALL', 'CREATE', 'LOAD CSV', 'DELETE', 'DETACH', 'FINISH', 'INSERT', 'LIMIT', 'MATCH', 'MERGE', 'NODETACH', 'OFFSET', 'OPTIONAL', 'REMOVE', 'RETURN', 'SET', 'SKIP', 'UNION', 'UNWIND', 'USE', 'WHERE', 'WITH' or <EOF> (line 1, column 196 (offset: 195))\n\"MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(r:Region), (p)-[:PERFORMS_VISIT]->(v:Visit) WHERE v.starttime < p.confirmedtime AND v.duration.seconds IS NOT NULL WITH r.name AS region, p, v COUNT(v) AS preConfirmationVisits, AVG(v.duration.seconds) AS avgDuration WITH region, AVG(preConfirmationVisits) AS avgPreConfirmationVisits, AVG(avgDuration) AS avgVisitDuration RETURN region, avgPreConfirmationVisits, avgVisitDuration\"\n                                                                                                                                                                                                    ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "Considering only visits with a duration greater than 1 hour (3600 seconds), for each continent, calculate the average number of visits per person and the average duration of those visits in seconds. Return the continent name, average visits per person, and average visit duration.",
    "Cypher": "MATCH (p:Person)-[v:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE v.duration.seconds > 3600 WITH c.name AS continent, p, v COUNT(v) AS visitCount, AVG(v.duration.seconds) AS avgDuration WITH continent, AVG(visitCount) AS avgVisitsPerPerson, AVG(avgDuration) AS avgVisitDuration RETURN continent, avgVisitsPerPerson, avgVisitDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 207,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_207",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'COUNT': expected an expression, 'FOREACH', ',', 'AS', 'ORDER BY', 'CALL', 'CREATE', 'LOAD CSV', 'DELETE', 'DETACH', 'FINISH', 'INSERT', 'LIMIT', 'MATCH', 'MERGE', 'NODETACH', 'OFFSET', 'OPTIONAL', 'REMOVE', 'RETURN', 'SET', 'SKIP', 'UNION', 'UNWIND', 'USE', 'WHERE', 'WITH' or <EOF> (line 1, column 175 (offset: 174))\n\"MATCH (p:Person)-[v:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE v.duration.seconds > 3600 WITH c.name AS continent, p, v COUNT(v) AS visitCount, AVG(v.duration.seconds) AS avgDuration WITH continent, AVG(visitCount) AS avgVisitsPerPerson, AVG(avgDuration) AS avgVisitDuration RETURN continent, avgVisitsPerPerson, avgVisitDuration\"\n                                                                                                                                                                               ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each type of place, calculate the total number of visits and the average duration of visits that started before '2020-04-26 T 00:00:00 UTC'. Return the place type, total visit count, and average duration in seconds.",
    "Cypher": "MATCH (v:Visit)-[:LOCATED_AT]->(pl:Place)\nWHERE v.starttime < datetime('2020-04-26T00:00:00 UTC')\nWITH pl.type AS placeType, v\nWITH placeType, COUNT(v) AS totalVisits, AVG(v.duration.seconds) AS avgDuration\nRETURN placeType, totalVisits, avgDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 218,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_218",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Text cannot be parsed to a DateTime\n\"2020-04-26T00:00:00 UTC\"\n ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each country, calculate the average visit duration in seconds for visits performed by people who were confirmed to be sick before '2020-04-21 T 00:00:00 UTC'. Return the country name and the average visit duration.",
    "Cypher": "MATCH (p:Person)-[v:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(c:Country)\nWHERE p.confirmedtime < datetime('2020-04-21T00:00:00 UTC') AND p.healthstatus = 'Sick'\nWITH c.name AS country, v\nRETURN country, AVG(v.duration.seconds) AS avgVisitDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 221,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_221",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Text cannot be parsed to a DateTime\n\"2020-04-21T00:00:00 UTC\"\n ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each country, calculate the ratio of 'Sick' persons' visits to the total visits, and then determine the average visit duration in seconds for all visits. Return the country name, visit ratio, and average duration.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(pl:Place) MATCH (pl)-[:PART_OF]->(:Region)-[:PART_OF]->(c:Country) WITH c.name AS country, p, pl MATCH (p)-[:PERFORMS_VISIT]->(v:Visit) WHERE v.duration.seconds IS NOT NULL WITH country, COUNT(v) AS totalVisits, SUM(CASE WHEN p.healthstatus = 'Sick' THEN 1 ELSE 0 END) AS sickVisits RETURN country, toFloat(sickVisits) / totalVisits AS visitRatio, AVG(v.duration.seconds)",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 228,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_228",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `v` not defined (line 1, column 382 (offset: 381))\n\"MATCH (p:Person)-[:VISITS]->(pl:Place) MATCH (pl)-[:PART_OF]->(:Region)-[:PART_OF]->(c:Country) WITH c.name AS country, p, pl MATCH (p)-[:PERFORMS_VISIT]->(v:Visit) WHERE v.duration.seconds IS NOT NULL WITH country, COUNT(v) AS totalVisits, SUM(CASE WHEN p.healthstatus = 'Sick' THEN 1 ELSE 0 END) AS sickVisits RETURN country, toFloat(sickVisits) / totalVisits AS visitRatio, AVG(v.duration.seconds)\"\n                                                                                                                                                                                                                                                                                                                                                                                              ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each type of place, find the average visit duration in seconds and the number of people who visited that place type with a 'Sick' health status. Return the place type, average duration, and the count of sick visitors.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(pl:Place) WHERE p.healthstatus = 'Sick' WITH pl.type AS placeType, p, pl MATCH (p)-[:VISITS]->(pl) WHERE v.duration.seconds IS NOT NULL WITH placeType, AVG(v.duration.seconds) AS avgDuration, COUNT(DISTINCT p) AS sickVisitorCount RETURN placeType, avgDuration, sickVisitorCount",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 238,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_238",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `v` not defined (line 1, column 135 (offset: 134))\n\"MATCH (p:Person)-[:VISITS]->(pl:Place) WHERE p.healthstatus = 'Sick' WITH pl.type AS placeType, p, pl MATCH (p)-[:VISITS]->(pl) WHERE v.duration.seconds IS NOT NULL WITH placeType, AVG(v.duration.seconds) AS avgDuration, COUNT(DISTINCT p) AS sickVisitorCount RETURN placeType, avgDuration, sickVisitorCount\"\n                                                                                                                                       ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each country, compute the ratio of visits occurring before '2020-05-01 T00:00:00 UTC' to the total number of visits. Return the country name and the calculated ratio.",
    "Cypher": "MATCH (v:Visit)-[:LOCATED_AT]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(c:Country) WITH c, v WHERE v.starttime < datetime('2020-05-01T00:00:00 UTC') WITH c, count(v) AS earlyVisits MATCH (v2:Visit)-[:LOCATED_AT]->(pl2:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(c) WITH c.name AS countryName, earlyVisits, count(v2) AS totalVisits RETURN countryName, toFloat(earlyVisits) / totalVisits AS visitRatio",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 262,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_262",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Text cannot be parsed to a DateTime\n\"2020-05-01T00:00:00 UTC\"\n ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each continent, calculate the total number of persons who have visited at least two different types of places and the average visit duration (in seconds) for those persons. Return the continent name, the count of persons, and the average visit duration.",
    "Cypher": "MATCH (p:Person)-[v:VISITS]->(pl:Place)\nMATCH (pl)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent)\nWHERE v.duration.seconds IS NOT NULL\nWITH c.name AS continentName, p, pl.type AS placeType, v.duration.seconds AS visitDuration\nWITH continentName, p, COLLECT(DISTINCT placeType) AS placeTypes, AVG(visitDuration) AS avgDuration\nWHERE SIZE(placeTypes) >= 2\nWITH continentName, avgDuration\nWITH continentName, COUNT(DISTINCT p) AS personCount, AVG(avgDuration) AS overallAvgDuration\nRETURN continentName, personCount, overallAvgDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 270,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_270",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `p` not defined (line 8, column 36 (offset: 445))\n\"WITH continentName, COUNT(DISTINCT p) AS personCount, AVG(avgDuration) AS overallAvgDuration\"\n                                    ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each continent, calculate the average number of visits performed by persons with 'Sick' health status and the average visit duration in seconds. Return the continent name, average number of visits, and average visit duration.",
    "Cypher": "MATCH (p:Person {healthstatus: 'Sick'})-[:PERFORMS_VISIT]->(v:Visit)-[:LOCATED_AT]->(pl:Place)-[:PART_OF]->(r:Region)-[:PART_OF]->(c:Country)-[:PART_OF]->(cont:Continent) WHERE v.duration.seconds IS NOT NULL WITH cont.name AS continent, p, v COUNT(v) AS visitCount, AVG(v.duration.seconds) AS avgDuration WITH continent, AVG(visitCount) AS avgVisits, AVG(avgDuration) AS overallAvgDuration RETURN continent, avgVisits, overallAvgDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 280,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_280",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'COUNT': expected an expression, 'FOREACH', ',', 'AS', 'ORDER BY', 'CALL', 'CREATE', 'LOAD CSV', 'DELETE', 'DETACH', 'FINISH', 'INSERT', 'LIMIT', 'MATCH', 'MERGE', 'NODETACH', 'OFFSET', 'OPTIONAL', 'REMOVE', 'RETURN', 'SET', 'SKIP', 'UNION', 'UNWIND', 'USE', 'WHERE', 'WITH' or <EOF> (line 1, column 243 (offset: 242))\n\"MATCH (p:Person {healthstatus: 'Sick'})-[:PERFORMS_VISIT]->(v:Visit)-[:LOCATED_AT]->(pl:Place)-[:PART_OF]->(r:Region)-[:PART_OF]->(c:Country)-[:PART_OF]->(cont:Continent) WHERE v.duration.seconds IS NOT NULL WITH cont.name AS continent, p, v COUNT(v) AS visitCount, AVG(v.duration.seconds) AS avgDuration WITH continent, AVG(visitCount) AS avgVisits, AVG(avgDuration) AS overallAvgDuration RETURN continent, avgVisits, overallAvgDuration\"\n                                                                                                                                                                                                                                                   ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each continent, determine the average number of visits performed by persons and the average duration of these visits in seconds. Then, calculate the correlation between the number of visits and the average duration for each continent. Return the continent name and the correlation value.",
    "Cypher": "MATCH (p:Person)-[:PERFORMS_VISIT]->(v:Visit)-[:LOCATED_AT]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(cont:Continent) WHERE v.duration.seconds IS NOT NULL WITH cont.name AS continent, p, COUNT(v) AS visitCount, AVG(v.duration.seconds) AS avgDuration WITH continent, collect(visitCount) AS visits, collect(avgDuration) AS durations RETURN continent, stDevP(visits) * stDevP(durations) / (stDevP(visits) * stDevP(durations)) AS correlation",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 283,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_283",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Type mismatch: expected Float but was List<Integer> (line 1, column 385 (offset: 384))\n\"MATCH (p:Person)-[:PERFORMS_VISIT]->(v:Visit)-[:LOCATED_AT]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(cont:Continent) WHERE v.duration.seconds IS NOT NULL WITH cont.name AS continent, p, COUNT(v) AS visitCount, AVG(v.duration.seconds) AS avgDuration WITH continent, collect(visitCount) AS visits, collect(avgDuration) AS durations RETURN continent, stDevP(visits) * stDevP(durations) / (stDevP(visits) * stDevP(durations)) AS correlation\"\n                                                                                                                                                                                                                                                                                                                                                                                                 ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each country, compute the average visit duration in seconds, and the number of people who visited at least one place. Return the country name, the average visit duration and the number of people who visited at least one place.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(c:Country) WITH c.name AS country, p, avg(duration(p,pl).seconds) as avg_duration MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(c:Country) WITH country, avg_duration, count(DISTINCT p) AS people_visited RETURN country, avg_duration, people_visited",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 284,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_284",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Function call does not provide the required number of arguments: expected 1 got 2.\n\nFunction duration has signature: duration(input :: ANY) :: DURATION\nmeaning that it expects 1 argument of type ANY\nDescription: Creates a `DURATION` value. (line 1, column 117 (offset: 116))\n\"MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(c:Country) WITH c.name AS country, p, avg(duration(p,pl).seconds) as avg_duration MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(c:Country) WITH country, avg_duration, count(DISTINCT p) AS people_visited RETURN country, avg_duration, people_visited\"\n                                                                                                                     ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each type of place, calculate the average visit duration in seconds and the number of persons with 'Healthy' status who visited that type of place. Return the place type, average duration, and the count of healthy visitors.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(pl:Place) WHERE p.healthstatus = 'Healthy' WITH pl.type AS placeType, p, duration(p,pl) AS durationInSeconds MATCH (p)-[:VISITS]->(pl2:Place) WHERE pl2.type = placeType WITH placeType, AVG(durationInSeconds) AS avgDuration, COUNT(DISTINCT p) AS healthyVisitorCount RETURN placeType, avgDuration, healthyVisitorCount",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 294,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_294",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Function call does not provide the required number of arguments: expected 1 got 2.\n\nFunction duration has signature: duration(input :: ANY) :: DURATION\nmeaning that it expects 1 argument of type ANY\nDescription: Creates a `DURATION` value. (line 1, column 103 (offset: 102))\n\"MATCH (p:Person)-[:VISITS]->(pl:Place) WHERE p.healthstatus = 'Healthy' WITH pl.type AS placeType, p, duration(p,pl) AS durationInSeconds MATCH (p)-[:VISITS]->(pl2:Place) WHERE pl2.type = placeType WITH placeType, AVG(durationInSeconds) AS avgDuration, COUNT(DISTINCT p) AS healthyVisitorCount RETURN placeType, avgDuration, healthyVisitorCount\"\n                                                                                                       ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each continent, determine the average visit duration in seconds for visits to 'Hospital' type places and the total number of visits originating from 'Sick' persons. Return the continent name, average duration, and total sick visits.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(pl:Place {type: 'Hospital'})-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE p.healthstatus = 'Sick' WITH c.name AS continentName, p, duration(p,pl) AS durationInSeconds MATCH (p)-[:VISITS]->(pl2:Place {type: 'Hospital'})-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c2:Continent) WHERE c2.name = continentName WITH continentName, AVG(durationInSeconds) AS avgDuration, COUNT(DISTINCT p) AS sickVisitorCount RETURN continentName, avgDuration, sickVisitorCount",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 295,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_295",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Function call does not provide the required number of arguments: expected 1 got 2.\n\nFunction duration has signature: duration(input :: ANY) :: DURATION\nmeaning that it expects 1 argument of type ANY\nDescription: Creates a `DURATION` value. (line 1, column 193 (offset: 192))\n\"MATCH (p:Person)-[:VISITS]->(pl:Place {type: 'Hospital'})-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE p.healthstatus = 'Sick' WITH c.name AS continentName, p, duration(p,pl) AS durationInSeconds MATCH (p)-[:VISITS]->(pl2:Place {type: 'Hospital'})-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c2:Continent) WHERE c2.name = continentName WITH continentName, AVG(durationInSeconds) AS avgDuration, COUNT(DISTINCT p) AS sickVisitorCount RETURN continentName, avgDuration, sickVisitorCount\"\n                                                                                                                                                                                                 ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "Calculate the average number of visits per person and the average duration of visits in seconds for all persons who have a 'Sick' health status before their confirmed time.",
    "Cypher": "MATCH (p:Person {healthstatus: 'Sick'})-[v:VISITS]->(pl:Place) WHERE v.starttime < p.confirmedtime WITH p, COUNT(v) AS visitCount, duration(p,pl) AS durationInSeconds RETURN AVG(visitCount) AS avgVisitsPerPerson, AVG(durationInSeconds) AS avgVisitDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 296,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_296",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Function call does not provide the required number of arguments: expected 1 got 2.\n\nFunction duration has signature: duration(input :: ANY) :: DURATION\nmeaning that it expects 1 argument of type ANY\nDescription: Creates a `DURATION` value. (line 1, column 132 (offset: 131))\n\"MATCH (p:Person {healthstatus: 'Sick'})-[v:VISITS]->(pl:Place) WHERE v.starttime < p.confirmedtime WITH p, COUNT(v) AS visitCount, duration(p,pl) AS durationInSeconds RETURN AVG(visitCount) AS avgVisitsPerPerson, AVG(durationInSeconds) AS avgVisitDuration\"\n                                                                                                                                    ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each region, find the average number of visits performed by persons and the average visit duration in seconds, grouping the results by the health status of the persons. Return the region name, health status, average number of visits, and average visit duration.",
    "Cypher": "MATCH (p:Person)-[v:VISITS]->(pl:Place)-[:PART_OF]->(r:Region) WITH r.name AS regionName, p.healthstatus AS healthStatus, p, COUNT(v) AS visitCount, duration(p,pl) AS durationInSeconds WITH regionName, healthStatus, AVG(visitCount) AS avgVisits, AVG(durationInSeconds) AS avgDuration RETURN regionName, healthStatus, avgVisits, avgDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 297,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_297",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Function call does not provide the required number of arguments: expected 1 got 2.\n\nFunction duration has signature: duration(input :: ANY) :: DURATION\nmeaning that it expects 1 argument of type ANY\nDescription: Creates a `DURATION` value. (line 1, column 150 (offset: 149))\n\"MATCH (p:Person)-[v:VISITS]->(pl:Place)-[:PART_OF]->(r:Region) WITH r.name AS regionName, p.healthstatus AS healthStatus, p, COUNT(v) AS visitCount, duration(p,pl) AS durationInSeconds WITH regionName, healthStatus, AVG(visitCount) AS avgVisits, AVG(durationInSeconds) AS avgDuration RETURN regionName, healthStatus, avgVisits, avgDuration\"\n                                                                                                                                                      ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each type of place, find the average visit duration (in seconds) for visits that started before '2020-04-20 T00:00:00 UTC'. Return the place type and the average visit duration.",
    "Cypher": "MATCH (v:Visit)-[:LOCATED_AT]->(pl:Place) WHERE v.starttime < datetime('2020-04-20T00:00:00 UTC') AND v.duration.seconds IS NOT NULL WITH pl.type AS placeType, v.duration.seconds AS visitDuration RETURN placeType, AVG(visitDuration) AS averageDuration;",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 303,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_303",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Text cannot be parsed to a DateTime\n\"2020-04-20T00:00:00 UTC\"\n ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each type of place, calculate the average visit duration in seconds and the number of persons who performed visits to that type of place. Return the place type, average duration, and the number of persons.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(pl:Place) WHERE pl.type IS NOT NULL WITH pl.type AS placeType, p, AVG(duration.seconds) AS avgDuration MATCH (p)-[:VISITS]->(pl2:Place) WHERE pl2.type = placeType WITH placeType, avgDuration, COUNT(DISTINCT p) AS personCount RETURN placeType, avgDuration, personCount",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 308,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_308",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `duration` not defined (line 1, column 100 (offset: 99))\n\"MATCH (p:Person)-[:VISITS]->(pl:Place) WHERE pl.type IS NOT NULL WITH pl.type AS placeType, p, AVG(duration.seconds) AS avgDuration MATCH (p)-[:VISITS]->(pl2:Place) WHERE pl2.type = placeType WITH placeType, avgDuration, COUNT(DISTINCT p) AS personCount RETURN placeType, avgDuration, personCount\"\n                                                                                                    ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each country, calculate the total number of visits and the average visit duration in seconds for visits that occurred before '2020-04-15'. Return the country name, total visits, and average duration.",
    "Cypher": "MATCH (p:Person)-[v:VISITS]->(pl:Place) MATCH (pl)-[:PART_OF]->(:Region)-[:PART_OF]->(c:Country) WHERE date(v.starttime) < date('2020-04-15') WITH c.name AS countryName, v.duration.seconds AS visitDuration RETURN countryName, COUNT(v) AS totalVisits, AVG(visitDuration) AS averageVisitDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 311,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_311",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `v` not defined (line 1, column 233 (offset: 232))\n\"MATCH (p:Person)-[v:VISITS]->(pl:Place) MATCH (pl)-[:PART_OF]->(:Region)-[:PART_OF]->(c:Country) WHERE date(v.starttime) < date('2020-04-15') WITH c.name AS countryName, v.duration.seconds AS visitDuration RETURN countryName, COUNT(v) AS totalVisits, AVG(visitDuration) AS averageVisitDuration\"\n                                                                                                                                                                                                                                         ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each continent, calculate the average number of visits performed by persons and the average duration of those visits in seconds. Return the continent name, average visit count, and average visit duration.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE p IS NOT NULL WITH c.name AS continentName, p, count(pl) AS visitCount, avg(duration(p,pl).seconds) AS avgDuration RETURN continentName, avg(visitCount), avg(avgDuration)",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 317,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_317",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Function call does not provide the required number of arguments: expected 1 got 2.\n\nFunction duration has signature: duration(input :: ANY) :: DURATION\nmeaning that it expects 1 argument of type ANY\nDescription: Creates a `DURATION` value. (line 1, column 193 (offset: 192))\n\"MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE p IS NOT NULL WITH c.name AS continentName, p, count(pl) AS visitCount, avg(duration(p,pl).seconds) AS avgDuration RETURN continentName, avg(visitCount), avg(avgDuration)\"\n                                                                                                                                                                                                 ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each country, compute the percentage of visits made to 'Restaurant' places and the average visit duration in seconds to those places. Return the country name, visit percentage, and average duration.",
    "Cypher": "MATCH (v:Visit)-[:LOCATED_AT]->(pl:Place)-[:PART_OF]->(r:Region)-[:PART_OF]->(c:Country) WHERE pl.type = 'Restaurant' WITH c.name AS countryName, COUNT(v) AS restaurantVisits MATCH (v2:Visit)-[:LOCATED_AT]->(pl2:Place)-[:PART_OF]->(r2:Region)-[:PART_OF]->(c) WITH countryName, restaurantVisits, COUNT(v2) AS totalVisits, AVG(v2.duration.seconds) AS avgDuration WHERE v2.duration.seconds IS NOT NULL RETURN countryName, (toFloat(restaurantVisits) / totalVisits) * 100 AS visitPercentage, avgDuration;",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 318,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_318",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: In a WITH/RETURN with DISTINCT or an aggregation, it is not possible to access variables declared before the WITH/RETURN: v2 (line 1, column 368 (offset: 367))\n\"MATCH (v:Visit)-[:LOCATED_AT]->(pl:Place)-[:PART_OF]->(r:Region)-[:PART_OF]->(c:Country) WHERE pl.type = 'Restaurant' WITH c.name AS countryName, COUNT(v) AS restaurantVisits MATCH (v2:Visit)-[:LOCATED_AT]->(pl2:Place)-[:PART_OF]->(r2:Region)-[:PART_OF]->(c) WITH countryName, restaurantVisits, COUNT(v2) AS totalVisits, AVG(v2.duration.seconds) AS avgDuration WHERE v2.duration.seconds IS NOT NULL RETURN countryName, (toFloat(restaurantVisits) / totalVisits) * 100 AS visitPercentage, avgDuration;\"\n                                                                                                                                                                                                                                                                                                                                                                                ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each type of place, calculate the average visit duration in seconds and the total number of persons who visited that type of place. Return the place type, average duration, and total person count.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(v:Visit)-[:LOCATED_AT]->(pl:Place) WHERE v.duration.seconds IS NOT NULL WITH pl.type AS placeType, AVG(v.duration.seconds) AS avgDuration, COLLECT(DISTINCT p) AS personsPerPlace RETURN placeType, avgDuration, SIZE(personsPerPlace) AS totalPersonCount",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 329,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_329",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each region, calculate the average duration in seconds of visits to 'Restaurant' type places, and the total number of visits to 'Park' type places. Return the region name, average restaurant visit duration, and total park visit count.",
    "Cypher": "MATCH (v:Visit)-[:LOCATED_AT]->(pl:Place)-[:PART_OF]->(r:Region) WHERE pl.type = 'Restaurant' AND v.duration.seconds IS NOT NULL WITH r.name AS regionName, AVG(v.duration.seconds) AS avgRestaurantVisitDuration MATCH (v2:Visit)-[:LOCATED_AT]->(pl2:Place)-[:PART_OF]->(r2:Region) WHERE pl2.type = 'Park' WITH regionName, avgRestaurantVisitDuration, r2, v2 COUNT(v2) AS totalParkVisitCount RETURN regionName, avgRestaurantVisitDuration, totalParkVisitCount",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 331,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_331",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'COUNT': expected an expression, 'FOREACH', ',', 'AS', 'ORDER BY', 'CALL', 'CREATE', 'LOAD CSV', 'DELETE', 'DETACH', 'FINISH', 'INSERT', 'LIMIT', 'MATCH', 'MERGE', 'NODETACH', 'OFFSET', 'OPTIONAL', 'REMOVE', 'RETURN', 'SET', 'SKIP', 'UNION', 'UNWIND', 'USE', 'WHERE', 'WITH' or <EOF> (line 1, column 355 (offset: 354))\n\"MATCH (v:Visit)-[:LOCATED_AT]->(pl:Place)-[:PART_OF]->(r:Region) WHERE pl.type = 'Restaurant' AND v.duration.seconds IS NOT NULL WITH r.name AS regionName, AVG(v.duration.seconds) AS avgRestaurantVisitDuration MATCH (v2:Visit)-[:LOCATED_AT]->(pl2:Place)-[:PART_OF]->(r2:Region) WHERE pl2.type = 'Park' WITH regionName, avgRestaurantVisitDuration, r2, v2 COUNT(v2) AS totalParkVisitCount RETURN regionName, avgRestaurantVisitDuration, totalParkVisitCount\"\n                                                                                                                                                                                                                                                                                                                                                                   ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each continent, compute the average visit duration (in seconds) for visits starting after '2020-04-30 T 00:00:00 UTC'. Return the continent name and the average duration.",
    "Cypher": "MATCH (p:Person)-[v:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE v.duration.seconds IS NOT NULL AND datetime(v.starttime) > datetime('2020-04-30T00:00:00 UTC') WITH c.name AS continentName, v.duration.seconds AS visitDuration RETURN continentName, AVG(visitDuration) AS averageVisitDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 347,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_347",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Text cannot be parsed to a DateTime\n\"2020-04-30T00:00:00 UTC\"\n ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each continent, determine the average visit duration in seconds for visits to places of type 'Hospital', and the total number of healthy persons who have visited places in that continent. Return the continent name, average duration, and number of healthy visitors.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(pl:Place) MATCH (pl)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE pl.type = 'Hospital' WITH c.name AS continent, p, pl MATCH (p:Person)-[:VISITS]->(pl:Place) WHERE pl.type = 'Hospital' AND p.healthstatus = 'Healthy' WITH continent, AVG(p.name) AS avgHealthy, count(DISTINCT p) AS healthyPersons MATCH (v:Visit)-[:LOCATED_AT]->(pl2:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c2:Continent) WHERE pl2.type = 'Hospital' AND c2.name = continent WITH continent, healthyPersons, AVG(v.duration.seconds) AS avgDuration RETURN continent, avgDuration, healthyPersons",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 351,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_351",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Runtime Error: {code: Neo.ClientError.Statement.TypeError} {message: avg() can only handle numerical values, duration, and null. Got String(\"Darnell Mayer\")}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "Calculate the average visit duration in seconds for each health status ('Sick', 'Healthy'), and for each health status, find the number of persons who have visited at least two different places. Return the health status, average duration, and the count of persons with at least two visits.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(pl:Place) WHERE p.healthstatus IN ['Sick', 'Healthy'] WITH p.healthstatus AS healthStatus, p, pl MATCH (p)-[:VISITS]->(pl2:Place) WITH healthStatus, p, COUNT(DISTINCT pl2) AS placeCount WHERE placeCount >= 2 WITH healthStatus, COUNT(DISTINCT p) AS personCount MATCH (p2:Person)-[:VISITS]->(v:Visit) WHERE p2.healthstatus = healthStatus WITH healthStatus, personCount, AVG(v.duration.seconds) AS avgDuration RETURN healthStatus, avgDuration, personCount",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 352,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_352",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each region, determine the average visit duration in seconds for visits occurring before '2020-04-15', and the total number of visits made by persons whose name contains 'Samir'. Return the region name, average duration, and Samir's visit count.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(v:Visit)-[:LOCATED_AT]->(pl:Place)-[:PART_OF]->(r:Region) WHERE v.starttime < datetime('2020-04-15T00:00:00Z') WITH r.name AS region, p, v MATCH (p2:Person)-[:VISITS]->(v2:Visit)-[:LOCATED_AT]->(pl2:Place)-[:PART_OF]->(r2:Region) WHERE p2.name CONTAINS 'Samir' AND r2.name = region WITH region, COUNT(v2) AS samirVisitCount MATCH (p3:Person)-[:VISITS]->(v3:Visit)-[:LOCATED_AT]->(pl3:Place)-[:PART_OF]->(r3:Region) WHERE r3.name = region AND v3.starttime < datetime('2020-04-15T00:00:00Z') WITH region, samirVisitCount, AVG(v3.duration.seconds) AS avgDuration RETURN region, avgDuration, samirVisitCount",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 353,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_353",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each type of place, calculate the total number of visits and the average duration (in seconds) of visits that started before '2020-04-23 T 00:00:00 UTC'.",
    "Cypher": "MATCH (v:Visit)-[:LOCATED_AT]->(pl:Place) WHERE v.starttime < datetime('2020-04-23T00:00:00 UTC') AND v.duration.seconds IS NOT NULL WITH pl.type AS placeType, v.duration.seconds AS visitDuration, v RETURN placeType, COUNT(v) AS totalVisits, AVG(visitDuration) AS averageDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 359,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_359",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Text cannot be parsed to a DateTime\n\"2020-04-23T00:00:00 UTC\"\n ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each continent, what is the average number of visits per person, considering only visits with a duration greater than 10000 seconds?",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE duration.inSeconds(p.id) > 10000 WITH c.name AS continent, p, COUNT(pl) AS visitCount RETURN continent, AVG(visitCount) AS avgVisitsPerPerson",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 361,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_361",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Function call does not provide the required number of arguments: expected 2 got 1.\n\nFunction duration.inSeconds has signature: duration.inSeconds(from :: ANY, to :: ANY) :: DURATION\nmeaning that it expects 2 arguments of type ANY, ANY\nDescription: Computes the `DURATION` between the `from` instant (inclusive) and the `to` instant (exclusive) in seconds. (line 1, column 117 (offset: 116))\n\"MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE duration.inSeconds(p.id) > 10000 WITH c.name AS continent, p, COUNT(pl) AS visitCount RETURN continent, AVG(visitCount) AS avgVisitsPerPerson\"\n                                                                                                                     ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each continent, calculate the average number of visits performed by each person and the average duration of these visits in seconds, considering only visits to 'Park' type places. Return the continent name, average visits per person, and average visit duration.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE pl.type = 'Park' MATCH (p)-[:PERFORMS_VISIT]->(v:Visit) WHERE v.duration.seconds IS NOT NULL WITH c.name AS continentName, p, v.duration.seconds AS visitDuration WITH continentName, p, COUNT(v) AS totalVisits, AVG(visitDuration) AS avgDurationPerVisit WITH continentName, AVG(totalVisits) AS avgVisitsPerPerson, AVG(avgDurationPerVisit) AS avgDuration RETURN continentName, avgVisitsPerPerson, avgDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 389,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_389",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `v` not defined (line 1, column 308 (offset: 307))\n\"MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE pl.type = 'Park' MATCH (p)-[:PERFORMS_VISIT]->(v:Visit) WHERE v.duration.seconds IS NOT NULL WITH c.name AS continentName, p, v.duration.seconds AS visitDuration WITH continentName, p, COUNT(v) AS totalVisits, AVG(visitDuration) AS avgDurationPerVisit WITH continentName, AVG(totalVisits) AS avgVisitsPerPerson, AVG(avgDurationPerVisit) AS avgDuration RETURN continentName, avgVisitsPerPerson, avgDuration\"\n                                                                                                                                                                                                                                                                                                                    ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each type of place, calculate the average visit duration in seconds and the number of persons who visited that place type. Return the place type, average duration, and the number of unique persons.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(pl:Place) WHERE pl.type IS NOT NULL WITH pl.type AS placeType, p, AVG(duration.seconds) AS avgDuration MATCH (p)-[:VISITS]->(pl2:Place) WHERE pl2.type = placeType WITH placeType, avgDuration, COUNT(DISTINCT p) AS uniquePersonCount RETURN placeType, avgDuration, uniquePersonCount",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 392,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_392",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `duration` not defined (line 1, column 100 (offset: 99))\n\"MATCH (p:Person)-[:VISITS]->(pl:Place) WHERE pl.type IS NOT NULL WITH pl.type AS placeType, p, AVG(duration.seconds) AS avgDuration MATCH (p)-[:VISITS]->(pl2:Place) WHERE pl2.type = placeType WITH placeType, avgDuration, COUNT(DISTINCT p) AS uniquePersonCount RETURN placeType, avgDuration, uniquePersonCount\"\n                                                                                                    ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each continent, determine the average visit duration (in seconds) for visits performed by persons with 'Sick' health status. Return the continent name and average visit duration.",
    "Cypher": "MATCH (p:Person {healthstatus: 'Sick'})-[:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WITH c.name AS continentName, duration.seconds AS visitDuration WHERE visitDuration IS NOT NULL RETURN continentName, AVG(visitDuration) AS avgVisitDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 393,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_393",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `duration` not defined (line 1, column 164 (offset: 163))\n\"MATCH (p:Person {healthstatus: 'Sick'})-[:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WITH c.name AS continentName, duration.seconds AS visitDuration WHERE visitDuration IS NOT NULL RETURN continentName, AVG(visitDuration) AS avgVisitDuration\"\n                                                                                                                                                                    ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each region, find the average number of visits performed by each person and the average duration of those visits in seconds. Return the region name, average visits per person, and average visit duration.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(r:Region) WITH r.name AS regionName, p, AVG(duration.seconds) AS avgVisitDuration, COUNT(pl) AS visitCount WITH regionName, AVG(visitCount) AS avgVisitsPerPerson, AVG(avgVisitDuration) AS avgDurationPerPerson RETURN regionName, avgVisitsPerPerson, avgDurationPerPerson",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 394,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_394",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `duration` not defined (line 1, column 97 (offset: 96))\n\"MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(r:Region) WITH r.name AS regionName, p, AVG(duration.seconds) AS avgVisitDuration, COUNT(pl) AS visitCount WITH regionName, AVG(visitCount) AS avgVisitsPerPerson, AVG(avgVisitDuration) AS avgDurationPerPerson RETURN regionName, avgVisitsPerPerson, avgDurationPerPerson\"\n                                                                                                 ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each country, calculate the total number of visits and the average duration (in seconds) of visits that occurred before '2020-05-01'. Return the country name, total visits, and average duration.",
    "Cypher": "MATCH (p:Person)-[v:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(c:Country) WHERE v.starttime < datetime('2020-05-01T00:00:00.000Z') WITH c.name AS countryName, v, duration.seconds AS visitDuration WITH countryName, visitDuration, COUNT(v) AS totalVisits WHERE visitDuration IS NOT NULL RETURN countryName, totalVisits, AVG(visitDuration) AS avgVisitDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 395,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_395",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `duration` not defined (line 1, column 175 (offset: 174))\n\"MATCH (p:Person)-[v:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(c:Country) WHERE v.starttime < datetime('2020-05-01T00:00:00.000Z') WITH c.name AS countryName, v, duration.seconds AS visitDuration WITH countryName, visitDuration, COUNT(v) AS totalVisits WHERE visitDuration IS NOT NULL RETURN countryName, totalVisits, AVG(visitDuration) AS avgVisitDuration\"\n                                                                                                                                                                               ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each region, find the average number of visits performed by persons with 'Healthy' health status and the average duration of those visits in seconds. Return the region name, average visit count, and average visit duration.",
    "Cypher": "MATCH (p:Person {healthstatus: 'Healthy'})-[v:VISITS]->(pl:Place)-[:PART_OF]->(r:Region) WHERE v.duration.seconds IS NOT NULL WITH r.name AS regionName, p, v.duration.seconds AS visitDuration WITH regionName, p, COUNT(v) AS visitCount, AVG(visitDuration) AS avgDurationPerVisit RETURN regionName, AVG(visitCount), AVG(avgDurationPerVisit)",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 402,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_402",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `v` not defined (line 1, column 219 (offset: 218))\n\"MATCH (p:Person {healthstatus: 'Healthy'})-[v:VISITS]->(pl:Place)-[:PART_OF]->(r:Region) WHERE v.duration.seconds IS NOT NULL WITH r.name AS regionName, p, v.duration.seconds AS visitDuration WITH regionName, p, COUNT(v) AS visitCount, AVG(visitDuration) AS avgDurationPerVisit RETURN regionName, AVG(visitCount), AVG(avgDurationPerVisit)\"\n                                                                                                                                                                                                                           ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each continent, calculate the total number of visits and the average duration in seconds of visits made to 'School' places. Return the continent name, total visit count, and average duration.",
    "Cypher": "MATCH (p:Person)-[v:VISITS]->(pl:Place {type: 'School'})-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE v.duration.seconds IS NOT NULL WITH c.name AS continentName, v.duration.seconds AS visitDuration WITH continentName, COUNT(v) AS totalVisitCount, AVG(visitDuration) AS avgDuration RETURN continentName, totalVisitCount, avgDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 403,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_403",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `v` not defined (line 1, column 258 (offset: 257))\n\"MATCH (p:Person)-[v:VISITS]->(pl:Place {type: 'School'})-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE v.duration.seconds IS NOT NULL WITH c.name AS continentName, v.duration.seconds AS visitDuration WITH continentName, COUNT(v) AS totalVisitCount, AVG(visitDuration) AS avgDuration RETURN continentName, totalVisitCount, avgDuration\"\n                                                                                                                                                                                                                                                                  ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each country, determine the average number of visits performed by persons before their confirmed time, grouped by the health status of the persons. Return the country name, health status, and the average number of pre-confirmation visits.",
    "Cypher": "MATCH (p:Person)-[:PERFORMS_VISIT]->(v:Visit) MATCH (p)-[:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(c:Country) WHERE v.starttime < p.confirmedtime WITH c.name AS countryName, p.healthstatus AS healthStatus, p, v COUNT(v) AS preConfirmationVisits WITH countryName, healthStatus, AVG(preConfirmationVisits) AS avgPreConfirmationVisits RETURN countryName, healthStatus, avgPreConfirmationVisits",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 407,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_407",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'COUNT': expected an expression, 'FOREACH', ',', 'AS', 'ORDER BY', 'CALL', 'CREATE', 'LOAD CSV', 'DELETE', 'DETACH', 'FINISH', 'INSERT', 'LIMIT', 'MATCH', 'MERGE', 'NODETACH', 'OFFSET', 'OPTIONAL', 'REMOVE', 'RETURN', 'SET', 'SKIP', 'UNION', 'UNWIND', 'USE', 'WHERE', 'WITH' or <EOF> (line 1, column 226 (offset: 225))\n\"MATCH (p:Person)-[:PERFORMS_VISIT]->(v:Visit) MATCH (p)-[:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(c:Country) WHERE v.starttime < p.confirmedtime WITH c.name AS countryName, p.healthstatus AS healthStatus, p, v COUNT(v) AS preConfirmationVisits WITH countryName, healthStatus, AVG(preConfirmationVisits) AS avgPreConfirmationVisits RETURN countryName, healthStatus, avgPreConfirmationVisits\"\n                                                                                                                                                                                                                                  ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each region, calculate the average visit duration (in seconds) for visits to 'Park' places, and the average number of visits performed by each person. Return the region name, average visit duration to parks, and average visits per person.",
    "Cypher": "MATCH (p:Person)-[v:VISITS]->(pl:Place {type: 'Park'}) MATCH (pl)-[:PART_OF]->(r:Region) WHERE v.duration.seconds IS NOT NULL WITH r.name AS regionName, v.duration.seconds AS parkVisitDuration, p WITH regionName, AVG(parkVisitDuration) AS avgParkVisitDuration, p, COUNT(v) AS visitsPerPerson RETURN regionName, avgParkVisitDuration, AVG(visitsPerPerson) AS avgVisitsPerPerson",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 408,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_408",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `v` not defined (line 1, column 271 (offset: 270))\n\"MATCH (p:Person)-[v:VISITS]->(pl:Place {type: 'Park'}) MATCH (pl)-[:PART_OF]->(r:Region) WHERE v.duration.seconds IS NOT NULL WITH r.name AS regionName, v.duration.seconds AS parkVisitDuration, p WITH regionName, AVG(parkVisitDuration) AS avgParkVisitDuration, p, COUNT(v) AS visitsPerPerson RETURN regionName, avgParkVisitDuration, AVG(visitsPerPerson) AS avgVisitsPerPerson\"\n                                                                                                                                                                                                                                                                               ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each continent, calculate the average number of visits made by persons with 'Healthy' status to each type of place, and then determine the maximum of these average visit counts across all place types. Return the continent name and the maximum average visit count.",
    "Cypher": "MATCH (p:Person)-[v:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE p.healthstatus = 'Healthy' WITH c.name AS continent, pl.type AS placeType, COUNT(v) AS visitCount WITH continent, placeType, AVG(visitCount) AS avgVisitCount GROUP BY continent WITH continent, COLLECT(avgVisitCount) AS visitCounts RETURN continent, MAX(visitCounts) AS maxAvgVisitCount",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 431,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_431",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'GROUP': expected 'FOREACH', ',', 'ORDER BY', 'CALL', 'CREATE', 'LOAD CSV', 'DELETE', 'DETACH', 'FINISH', 'INSERT', 'LIMIT', 'MATCH', 'MERGE', 'NODETACH', 'OFFSET', 'OPTIONAL', 'REMOVE', 'RETURN', 'SET', 'SKIP', 'UNION', 'UNWIND', 'USE', 'WHERE', 'WITH' or <EOF> (line 1, column 276 (offset: 275))\n\"MATCH (p:Person)-[v:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE p.healthstatus = 'Healthy' WITH c.name AS continent, pl.type AS placeType, COUNT(v) AS visitCount WITH continent, placeType, AVG(visitCount) AS avgVisitCount GROUP BY continent WITH continent, COLLECT(avgVisitCount) AS visitCounts RETURN continent, MAX(visitCounts) AS maxAvgVisitCount\"\n                                                                                                                                                                                                                                                                                    ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each region, find the most common health status among persons who visited places in that region. Return the region name and the most frequent health status.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(r:Region) WITH r.name AS regionName, p.healthstatus AS healthStatus, COUNT(*) AS statusCount WITH regionName, healthStatus, statusCount, MAX(statusCount) OVER (PARTITION BY regionName) AS maxCount WHERE statusCount = maxCount RETURN regionName, healthStatus",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 443,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_443",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'OVER': expected an expression, 'FOREACH', ',', 'AS', 'ORDER BY', 'CALL', 'CREATE', 'LOAD CSV', 'DELETE', 'DETACH', 'FINISH', 'INSERT', 'LIMIT', 'MATCH', 'MERGE', 'NODETACH', 'OFFSET', 'OPTIONAL', 'REMOVE', 'RETURN', 'SET', 'SKIP', 'UNION', 'UNWIND', 'USE', 'WHERE', 'WITH' or <EOF> (line 1, column 207 (offset: 206))\n\"MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(r:Region) WITH r.name AS regionName, p.healthstatus AS healthStatus, COUNT(*) AS statusCount WITH regionName, healthStatus, statusCount, MAX(statusCount) OVER (PARTITION BY regionName) AS maxCount WHERE statusCount = maxCount RETURN regionName, healthStatus\"\n                                                                                                                                                                                                               ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each country, calculate the total number of visits and the average duration of visits in seconds, only considering visits that started before '2020-05-01 T00:00:00 UTC'. Return the country name, total visits, and average duration.",
    "Cypher": "MATCH (p:Person)-[v:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(c:Country) WHERE v.starttime < datetime('2020-05-01T00:00:00Z') AND v.duration.seconds IS NOT NULL WITH c.name AS countryName, v RETURN countryName, COUNT(v) AS totalVisits, AVG(v.duration.seconds) AS averageDuration RETURN countryName, totalVisits, averageDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 444,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_444",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: RETURN can only be used at the end of the query. (line 1, column 205 (offset: 204))\n\"MATCH (p:Person)-[v:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(c:Country) WHERE v.starttime < datetime('2020-05-01T00:00:00Z') AND v.duration.seconds IS NOT NULL WITH c.name AS countryName, v RETURN countryName, COUNT(v) AS totalVisits, AVG(v.duration.seconds) AS averageDuration RETURN countryName, totalVisits, averageDuration\"\n                                                                                                                                                                                                             ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each continent, determine the average number of visits per person and the average number of places visited per person. Return the continent name, average visits per person, and average places visited per person.",
    "Cypher": "MATCH (p:Person)-[v:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WITH c.name AS continentName, p, pl WITH continentName, p, COUNT(pl) AS placesVisited, COUNT(v) AS totalVisitsPerPerson WITH continentName, AVG(totalVisitsPerPerson) AS avgVisitsPerPerson, AVG(placesVisited) AS avgPlacesVisitedPerPerson RETURN continentName, avgVisitsPerPerson, avgPlacesVisitedPerPerson",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 445,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_445",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `v` not defined (line 1, column 205 (offset: 204))\n\"MATCH (p:Person)-[v:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WITH c.name AS continentName, p, pl WITH continentName, p, COUNT(pl) AS placesVisited, COUNT(v) AS totalVisitsPerPerson WITH continentName, AVG(totalVisitsPerPerson) AS avgVisitsPerPerson, AVG(placesVisited) AS avgPlacesVisitedPerPerson RETURN continentName, avgVisitsPerPerson, avgPlacesVisitedPerPerson\"\n                                                                                                                                                                                                             ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each country, calculate the average number of visits per person and the average visit duration in seconds, considering only visits to places of type 'Restaurant'. Return the country name, average visits per person, and average visit duration.",
    "Cypher": "MATCH (p:Person)-[v:VISITS]->(pl:Place {type: 'Restaurant'}) MATCH (pl)-[:PART_OF]->(:Region)-[:PART_OF]->(c:Country) WHERE v.duration.seconds IS NOT NULL WITH c.name AS country, p, v.duration.seconds AS duration WITH country, p, COUNT(v) AS visitCount, AVG(duration) AS avgDurationPerVisit WITH country, AVG(visitCount) AS avgVisitsPerPerson, AVG(avgDurationPerVisit) AS overallAvgDuration RETURN country, avgVisitsPerPerson, overallAvgDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 459,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_459",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `v` not defined (line 1, column 237 (offset: 236))\n\"MATCH (p:Person)-[v:VISITS]->(pl:Place {type: 'Restaurant'}) MATCH (pl)-[:PART_OF]->(:Region)-[:PART_OF]->(c:Country) WHERE v.duration.seconds IS NOT NULL WITH c.name AS country, p, v.duration.seconds AS duration WITH country, p, COUNT(v) AS visitCount, AVG(duration) AS avgDurationPerVisit WITH country, AVG(visitCount) AS avgVisitsPerPerson, AVG(avgDurationPerVisit) AS overallAvgDuration RETURN country, avgVisitsPerPerson, overallAvgDuration\"\n                                                                                                                                                                                                                                             ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each continent, find the place type with the highest average visit duration (in seconds). Return the continent name, place type, and the highest average visit duration.",
    "Cypher": "MATCH (p:Person)-[v:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE v.duration.seconds IS NOT NULL WITH c.name AS continentName, pl.type AS placeType, AVG(v.duration.seconds) AS avgDuration WITH continentName, placeType, avgDuration, ROW_NUMBER() OVER (PARTITION BY continentName ORDER BY avgDuration DESC) AS rn WHERE rn = 1 RETURN continentName, placeType, avgDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 480,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_480",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'OVER': expected an expression, 'FOREACH', ',', 'AS', 'ORDER BY', 'CALL', 'CREATE', 'LOAD CSV', 'DELETE', 'DETACH', 'FINISH', 'INSERT', 'LIMIT', 'MATCH', 'MERGE', 'NODETACH', 'OFFSET', 'OPTIONAL', 'REMOVE', 'RETURN', 'SET', 'SKIP', 'UNION', 'UNWIND', 'USE', 'WHERE', 'WITH' or <EOF> (line 1, column 297 (offset: 296))\n\"MATCH (p:Person)-[v:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE v.duration.seconds IS NOT NULL WITH c.name AS continentName, pl.type AS placeType, AVG(v.duration.seconds) AS avgDuration WITH continentName, placeType, avgDuration, ROW_NUMBER() OVER (PARTITION BY continentName ORDER BY avgDuration DESC) AS rn WHERE rn = 1 RETURN continentName, placeType, avgDuration\"\n                                                                                                                                                                                                                                                                                                         ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each continent, calculate the average number of visits made by persons with 'Sick' health status and the average number of visits made by persons with 'Healthy' health status. Return the continent name, average sick visits, and average healthy visits.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WITH c.name AS continent, p.healthstatus AS healthStatus, pl WITH continent, healthStatus, COUNT(pl) AS visitCount WITH continent, healthStatus, AVG(visitCount) AS avgVisitCount GROUP BY continent WITH continent, COLLECT(CASE WHEN healthStatus = 'Sick' THEN avgVisitCount ELSE null END)[0] AS avgSickVisits, COLLECT(CASE WHEN healthStatus = 'Healthy' THEN avgVisitCount ELSE null END)[0] AS avgHealthyVisits RETURN continent, avgSickVisits, avgHealthyVisits",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 493,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_493",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'GROUP': expected 'FOREACH', ',', 'ORDER BY', 'CALL', 'CREATE', 'LOAD CSV', 'DELETE', 'DETACH', 'FINISH', 'INSERT', 'LIMIT', 'MATCH', 'MERGE', 'NODETACH', 'OFFSET', 'OPTIONAL', 'REMOVE', 'RETURN', 'SET', 'SKIP', 'UNION', 'UNWIND', 'USE', 'WHERE', 'WITH' or <EOF> (line 1, column 289 (offset: 288))\n\"MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WITH c.name AS continent, p.healthstatus AS healthStatus, pl WITH continent, healthStatus, COUNT(pl) AS visitCount WITH continent, healthStatus, AVG(visitCount) AS avgVisitCount GROUP BY continent WITH continent, COLLECT(CASE WHEN healthStatus = 'Sick' THEN avgVisitCount ELSE null END)[0] AS avgSickVisits, COLLECT(CASE WHEN healthStatus = 'Healthy' THEN avgVisitCount ELSE null END)[0] AS avgHealthyVisits RETURN continent, avgSickVisits, avgHealthyVisits\"\n                                                                                                                                                                                                                                                                                                 ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each type of place, calculate the average and maximum visit duration (in seconds) for visits occurring after '2020-04-10 T 00:00:00 UTC'. Return the place type, average duration, and maximum duration.",
    "Cypher": "MATCH (v:Visit)-[:LOCATED_AT]->(pl:Place) WHERE v.starttime > datetime('2020-04-10T00:00:00 UTC') AND v.duration.seconds IS NOT NULL WITH pl.type AS placeType, AVG(v.duration.seconds) AS avgDuration, MAX(v.duration.seconds) AS maxDuration RETURN placeType, avgDuration, maxDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 504,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_504",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Text cannot be parsed to a DateTime\n\"2020-04-10T00:00:00 UTC\"\n ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each continent, determine the average duration in seconds of visits made by people with each health status. Return the continent name, health status, and average visit duration.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(pl:Place) MATCH (pl)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE p.healthstatus IS NOT NULL WITH c.name AS continentName, p.healthstatus AS healthStatus, duration.seconds AS visitDuration RETURN continentName, healthStatus, avg(visitDuration) AS avgVisitDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 512,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_512",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `duration` not defined (line 1, column 217 (offset: 216))\n\"MATCH (p:Person)-[:VISITS]->(pl:Place) MATCH (pl)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE p.healthstatus IS NOT NULL WITH c.name AS continentName, p.healthstatus AS healthStatus, duration.seconds AS visitDuration RETURN continentName, healthStatus, avg(visitDuration) AS avgVisitDuration\"\n                                                                                                                                                                                                                         ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each country, determine the average number of visits per person and the average visit duration in seconds. Return the country name, average visits per person, and average visit duration.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(c:Country) WITH c.name AS countryName, p, duration.seconds AS visitDuration WITH countryName, p, count(*) AS numVisits, visitDuration WITH countryName, avg(numVisits) AS avgVisitsPerPerson, avg(visitDuration) AS avgVisitDuration RETURN countryName, avgVisitsPerPerson, avgVisitDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 514,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_514",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `duration` not defined (line 1, column 117 (offset: 116))\n\"MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(c:Country) WITH c.name AS countryName, p, duration.seconds AS visitDuration WITH countryName, p, count(*) AS numVisits, visitDuration WITH countryName, avg(numVisits) AS avgVisitsPerPerson, avg(visitDuration) AS avgVisitDuration RETURN countryName, avgVisitsPerPerson, avgVisitDuration\"\n                                                                                                                     ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each person's health status, calculate the average number of visits performed and the average duration (in seconds) of those visits. Return the health status, average visit count, and average visit duration.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(pl:Place) WITH p.healthstatus AS healthStatus, p, count(pl) AS visitCount, avg(duration.seconds(p,pl)) AS avgDuration RETURN healthStatus, avg(visitCount) AS avgVisits, avg(avgDuration) AS avgVisitDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 518,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_518",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'duration.seconds' (line 1, column 109 (offset: 108))\n\"MATCH (p:Person)-[:VISITS]->(pl:Place) WITH p.healthstatus AS healthStatus, p, count(pl) AS visitCount, avg(duration.seconds(p,pl)) AS avgDuration RETURN healthStatus, avg(visitCount) AS avgVisits, avg(avgDuration) AS avgVisitDuration\"\n                                                                                                             ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each type of place, determine the average visit duration (in seconds) and the number of persons with 'Sick' health status who visited that place type. Return the place type, average visit duration, and number of sick visitors.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(pl:Place) WHERE p.healthstatus = 'Sick' WITH pl.type AS placeType, p, avg(duration.seconds(p,pl)) AS avgDuration MATCH (p:Person)-[:VISITS]->(pl:Place) WHERE pl.type = placeType WITH placeType, avgDuration, COUNT(DISTINCT p) AS sickVisitorCount RETURN placeType, avgDuration, sickVisitorCount",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 519,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_519",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'duration.seconds' (line 1, column 104 (offset: 103))\n\"MATCH (p:Person)-[:VISITS]->(pl:Place) WHERE p.healthstatus = 'Sick' WITH pl.type AS placeType, p, avg(duration.seconds(p,pl)) AS avgDuration MATCH (p:Person)-[:VISITS]->(pl:Place) WHERE pl.type = placeType WITH placeType, avgDuration, COUNT(DISTINCT p) AS sickVisitorCount RETURN placeType, avgDuration, sickVisitorCount\"\n                                                                                                        ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each continent, calculate the average number of visits and the average duration (in seconds) of visits originating from persons with 'Sick' health status. Return the continent name, average visit count, and average visit duration.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE p.healthstatus = 'Sick' WITH c.name AS continent, p, duration.seconds(p,pl) AS visitDuration MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE p.healthstatus = 'Sick' AND c.name = continent WITH continent, visitDuration, COUNT(DISTINCT p) AS visitCount RETURN continent, avg(visitCount) AS avgVisitCount, avg(visitDuration) AS avgVisitDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 520,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_520",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'duration.seconds' (line 1, column 170 (offset: 169))\n\"MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE p.healthstatus = 'Sick' WITH c.name AS continent, p, duration.seconds(p,pl) AS visitDuration MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE p.healthstatus = 'Sick' AND c.name = continent WITH continent, visitDuration, COUNT(DISTINCT p) AS visitCount RETURN continent, avg(visitCount) AS avgVisitCount, avg(visitDuration) AS avgVisitDuration\"\n                                                                                                                                                                          ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each region, determine the average duration (in seconds) of visits for persons whose confirmed time is before '2020-04-20T00:00:00 UTC'. Return the region name and the average visit duration.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(r:Region) WHERE p.confirmedtime < datetime('2020-04-20T00:00:00 UTC') WITH r.name AS regionName, p, duration.seconds(p,pl) AS visitDuration RETURN regionName, avg(visitDuration) AS avgVisitDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 521,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_521",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'duration.seconds' (line 1, column 153 (offset: 152))\n\"MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(r:Region) WHERE p.confirmedtime < datetime('2020-04-20T00:00:00 UTC') WITH r.name AS regionName, p, duration.seconds(p,pl) AS visitDuration RETURN regionName, avg(visitDuration) AS avgVisitDuration\"\n                                                                                                                                                         ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each continent, calculate the total number of visits and the average visit duration (in seconds), considering only visits to places of type 'Hospital'. Return the continent name, total visits to hospitals, and average duration of those visits.",
    "Cypher": "MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE pl.type = 'Hospital' WITH c.name AS continent, p, duration.seconds(p,pl) AS visitDuration MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE pl.type = 'Hospital' AND c.name = continent WITH continent, visitDuration, COUNT(DISTINCT p) AS visitCount RETURN continent, avg(visitCount) AS avgVisitCount, avg(visitDuration) AS avgVisitDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 522,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_522",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'duration.seconds' (line 1, column 167 (offset: 166))\n\"MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE pl.type = 'Hospital' WITH c.name AS continent, p, duration.seconds(p,pl) AS visitDuration MATCH (p:Person)-[:VISITS]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE pl.type = 'Hospital' AND c.name = continent WITH continent, visitDuration, COUNT(DISTINCT p) AS visitCount RETURN continent, avg(visitCount) AS avgVisitCount, avg(visitDuration) AS avgVisitDuration\"\n                                                                                                                                                                       ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "Calculate the average visit duration (in seconds) for visits occurring before and after '2020-04-15 T00:00:00 UTC', grouping the results by the health status of the person performing the visit.",
    "Cypher": "MATCH (p:Person)-[v:VISITS]->(pl:Place) WHERE v.duration.seconds IS NOT NULL WITH p.healthstatus AS healthStatus, v.starttime AS startTime, v.duration.seconds AS visitDuration, date('2020-04-15') AS comparisonDate WITH healthStatus, visitDuration, CASE WHEN startTime < datetime('2020-04-15T00:00:00 UTC') THEN 'Before' ELSE 'After' END AS timePeriod RETURN timePeriod, healthStatus, AVG(visitDuration) AS averageDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 528,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_528",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Text cannot be parsed to a DateTime\n\"2020-04-15T00:00:00 UTC\"\n ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each continent, determine the type of place with the highest average visit duration (in seconds) made by persons with 'Sick' healthstatus.",
    "Cypher": "MATCH (p:Person {healthstatus: 'Sick'})-[v:VISITS]->(pl:Place) MATCH (pl)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(cont:Continent) WHERE v.duration.seconds IS NOT NULL WITH cont.name AS continent, pl.type AS placeType, AVG(v.duration.seconds) AS avgDuration ORDER BY continent, avgDuration DESC WITH continent, COLLECT({placeType: placeType, avgDuration: avgDuration}) AS placeDurations UNWIND placeDurations[0..0] AS topPlace RETURN continent, topPlace.placeType AS placeType, topPlace.avgDuration AS avgDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 529,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_529",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each type of place, calculate the average visit duration (in seconds) for visits occurring after '2020-04-15 T00:00:00 UTC'. Return the place type and the average visit duration.",
    "Cypher": "MATCH (v:Visit)-[:LOCATED_AT]->(pl:Place) WHERE v.starttime > datetime('2020-04-15T00:00:00 UTC') AND v.duration.seconds IS NOT NULL WITH pl.type AS placeType, v.duration.seconds AS visitDuration RETURN placeType, AVG(visitDuration) AS averageVisitDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 534,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_534",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Text cannot be parsed to a DateTime\n\"2020-04-15T00:00:00 UTC\"\n ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each continent, find the type of place with the longest average visit duration (in seconds). Return the continent name, place type, and average visit duration.",
    "Cypher": "MATCH (v:Visit)-[:LOCATED_AT]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE v.duration.seconds IS NOT NULL WITH c.name AS continentName, pl.type AS placeType, AVG(v.duration.seconds) AS averageDuration WITH continentName, placeType, averageDuration, RANK() OVER (PARTITION BY continentName ORDER BY averageDuration DESC) AS rank WHERE rank = 1 RETURN continentName, placeType, averageDuration",
    "source_dataset": "covid",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 536,
    "unique_id": "covid_data_3_2_2_6_Complex_Aggregation_536",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'OVER': expected an expression, 'FOREACH', ',', 'AS', 'ORDER BY', 'CALL', 'CREATE', 'LOAD CSV', 'DELETE', 'DETACH', 'FINISH', 'INSERT', 'LIMIT', 'MATCH', 'MERGE', 'NODETACH', 'OFFSET', 'OPTIONAL', 'REMOVE', 'RETURN', 'SET', 'SKIP', 'UNION', 'UNWIND', 'USE', 'WHERE', 'WITH' or <EOF> (line 1, column 301 (offset: 300))\n\"MATCH (v:Visit)-[:LOCATED_AT]->(pl:Place)-[:PART_OF]->(:Region)-[:PART_OF]->(:Country)-[:PART_OF]->(c:Continent) WHERE v.duration.seconds IS NOT NULL WITH c.name AS continentName, pl.type AS placeType, AVG(v.duration.seconds) AS averageDuration WITH continentName, placeType, averageDuration, RANK() OVER (PARTITION BY continentName ORDER BY averageDuration DESC) AS rank WHERE rank = 1 RETURN continentName, placeType, averageDuration\"\n                                                                                                                                                                                                                                                                                                             ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  }
]