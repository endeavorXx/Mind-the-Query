[
  {
    "NL Question": "For each officer rank, what is the average number of crimes investigated and the average number of objects involved in those crimes?",
    "Cypher": "MATCH (o:Officer)<-[:INVESTIGATED_BY]-(c:Crime) WITH o.rank AS officerRank, c MATCH (c)-[:INVOLVED_IN]->(ob:Object) WITH officerRank, c, count(ob) AS objectCount WITH officerRank, count(c) AS crimeCount, AVG(objectCount) AS avgObjectsPerCrime RETURN officerRank, AVG(crimeCount), avgObjectsPerCrime",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 2,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_2",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "What is the average age of people who are family members of Benjamin Hamilton, grouped by the type of family relationship?",
    "Cypher": "MATCH (p:Person {name: 'Benjamin', surname: 'Hamilton'})-[:FAMILY_REL]->(fam:Person)\nWHERE fam.age IS NOT NULL\nWITH p, fam, toInteger(fam.age) AS age\nRETURN p.name, avg(age)",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 9,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_9",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "What is the average number of crimes each officer investigated, grouped by the officer's rank?",
    "Cypher": "MATCH (o:Officer)-[:INVESTIGATED_BY]->(c:Crime)\nWITH o.rank AS officerRank, COUNT(c) AS crimeCount\nRETURN officerRank, avg(crimeCount) AS averageCrimes",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 10,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_10",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each type of crime, calculate the average number of objects involved and the average number of vehicles involved. Return the crime type, average object count, and average vehicle count.",
    "Cypher": "MATCH (c:Crime)<-[:INVOLVED_IN]-(o:Object)\nWITH c, count(o) AS objectCount\nMATCH (c)<-[:INVOLVED_IN]-(v:Vehicle)\nWITH c, objectCount, count(v) AS vehicleCount\nRETURN c.type, avg(objectCount), avg(vehicleCount)",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 14,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_14",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each officer rank, calculate the average number of crimes investigated and the average call duration of phone calls made to phones associated with people involved in those crimes. Return the officer rank, average crime count, and average call duration.",
    "Cypher": "MATCH (c:Crime)-[:INVESTIGATED_BY]->(o:Officer)\nWITH o, c\nMATCH (p:Person)-[:PARTY_TO]->(c)\nWITH o, p\nMATCH (p)-[:HAS_PHONE]->(ph:Phone)<-[:CALLED]-(pc:PhoneCall)\nWITH o, pc.call_duration AS callDuration\nRETURN o.rank, count(DISTINCT c), avg(toFloat(callDuration))",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 16,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_16",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `c` not defined (line 7, column 31 (offset: 234))\n\"RETURN o.rank, count(DISTINCT c), avg(toFloat(callDuration))\"\n                               ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "What is the average number of crimes investigated by each officer, and what is the average number of objects involved in those crimes?",
    "Cypher": "MATCH (o:Officer)<-[:INVESTIGATED_BY]-(c:Crime)\nWITH o, COUNT(c) AS crimeCount\nMATCH (c)-[:INVOLVED_IN]->(obj:Object)\nWITH o, crimeCount, COUNT(obj) AS objectCount\nRETURN o.name, AVG(crimeCount) AS avgCrimes, AVG(objectCount) AS avgObjects",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 21,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_21",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each area, find the average number of crimes that occurred and the average number of people who have a current address in that area. Return the area code, average crime count, and average person count.",
    "Cypher": "MATCH (l:Location)-[:OCCURRED_AT]->(c:Crime) MATCH (l)-[:LOCATION_IN_AREA]->(a:Area) WITH a.areaCode AS areaCode, COUNT(DISTINCT c) AS crimeCount MATCH (p:Person)-[:CURRENT_ADDRESS]->(l2:Location)-[:LOCATION_IN_AREA]->(a:Area) WHERE a.areaCode = areaCode WITH areaCode, crimeCount, COUNT(DISTINCT p) AS personCount RETURN areaCode, AVG(crimeCount), AVG(personCount)",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 29,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_29",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each person, calculate the total number of phone calls made to and from their phone numbers. Then, find the average number of calls made per person. Return the person's name and the average number of calls.",
    "Cypher": "MATCH (p:Person)-[:HAS_PHONE]->(ph:Phone)<-[:CALLED]-(pc:PhoneCall) WITH p, COUNT(pc) AS callsMade MATCH (p)-[:HAS_PHONE]->(ph2:Phone)<-[:CALLER]-(pc2:PhoneCall) WITH p, callsMade + COUNT(pc2) AS totalCalls RETURN p.name, AVG(totalCalls)",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 30,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_30",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Aggregation column contains implicit grouping expressions. For example, in 'RETURN n.a, n.a + n.b + count(*)' the aggregation expression 'n.a + n.b + count(*)' includes the implicit grouping key 'n.b'. It may be possible to rewrite the query by extracting these grouping/aggregation expressions into a preceding WITH clause. Illegal expression(s): callsMade (line 1, column 171 (offset: 170))\n\"MATCH (p:Person)-[:HAS_PHONE]->(ph:Phone)<-[:CALLED]-(pc:PhoneCall) WITH p, COUNT(pc) AS callsMade MATCH (p)-[:HAS_PHONE]->(ph2:Phone)<-[:CALLER]-(pc2:PhoneCall) WITH p, callsMade + COUNT(pc2) AS totalCalls RETURN p.name, AVG(totalCalls)\"\n                                                                                                                                                                           ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each Person, what is the average number of phone calls made to their phone numbers and the average duration of those calls?",
    "Cypher": "MATCH (p:Person)-[:HAS_PHONE]->(ph:Phone) OPTIONAL MATCH (pc:PhoneCall)-[:CALLED]->(ph) WITH p, count(pc) AS callCount, collect(pc.call_duration) AS durations WITH p, callCount, [duration in durations WHERE duration IS NOT NULL | toInteger(duration)] AS validDurations RETURN p.name, avg(callCount), avg(validDurations)",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 38,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_38",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Type mismatch: expected Float, Integer or Duration but was List<Integer> (line 1, column 305 (offset: 304))\n\"MATCH (p:Person)-[:HAS_PHONE]->(ph:Phone) OPTIONAL MATCH (pc:PhoneCall)-[:CALLED]->(ph) WITH p, count(pc) AS callCount, collect(pc.call_duration) AS durations WITH p, callCount, [duration in durations WHERE duration IS NOT NULL | toInteger(duration)] AS validDurations RETURN p.name, avg(callCount), avg(validDurations)\"\n                                                                                                                                                                                                                                                                                                                 ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each type of crime, what is the average number of people involved in the crime and the average call duration of phone calls made to phones of people involved in the crime?",
    "Cypher": "MATCH (crime:Crime)<-[:PARTY_TO]-(person:Person)-[:HAS_PHONE]->(phone:Phone)<-[:CALLED]-(call:PhoneCall) WITH crime.type AS crimeType, collect(DISTINCT person) AS people, collect(DISTINCT call.call_duration) AS durations WITH crimeType, size(people) AS numPeople, [duration in durations WHERE duration IS NOT NULL | toInteger(duration)] AS validDurations RETURN crimeType, avg(numPeople), avg(validDurations)",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 39,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_39",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Type mismatch: expected Float, Integer or Duration but was List<Integer> (line 1, column 394 (offset: 393))\n\"MATCH (crime:Crime)<-[:PARTY_TO]-(person:Person)-[:HAS_PHONE]->(phone:Phone)<-[:CALLED]-(call:PhoneCall) WITH crime.type AS crimeType, collect(DISTINCT person) AS people, collect(DISTINCT call.call_duration) AS durations WITH crimeType, size(people) AS numPeople, [duration in durations WHERE duration IS NOT NULL | toInteger(duration)] AS validDurations RETURN crimeType, avg(numPeople), avg(validDurations)\"\n                                                                                                                                                                                                                                                                                                                                                                                                          ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each type of crime, find the average number of vehicles involved and the average number of objects involved. Return the crime type, average vehicles, and average objects.",
    "Cypher": "MATCH (v:Vehicle)-[:INVOLVED_IN]->(c:Crime) WITH c, count(v) AS vehicleCount MATCH (o:Object)-[:INVOLVED_IN]->(c) WITH c, vehicleCount, count(o) AS objectCount RETURN c.type AS crimeType, avg(vehicleCount) AS avgVehicles, avg(objectCount) AS avgObjects",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 49,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_49",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each type of crime, what is the average number of officers involved in the investigations and the average number of vehicles involved?",
    "Cypher": "MATCH (c:Crime)<-[:INVESTIGATED_BY]-(o:Officer) WITH c, count(o) AS officerCount MATCH (c)<-[:INVOLVED_IN]-(v:Vehicle) WITH c, officerCount, count(v) AS vehicleCount RETURN c.type AS CrimeType, avg(officerCount) AS AvgOfficers, avg(vehicleCount) AS AvgVehicles",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 56,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_56",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each officer rank, what is the average number of crimes investigated by officers of that rank and the average number of objects involved in those crimes?",
    "Cypher": "MATCH (o:Officer)-[:INVESTIGATED_BY]->(c:Crime) WITH o,c MATCH (c)<-[:INVOLVED_IN]-(ob:Object) WITH o.rank AS OfficerRank, c, count(ob) AS objectCount RETURN OfficerRank, avg(objectCount) AS AvgObjectsPerCrime, count(DISTINCT c) AS AvgCrimesInvestigated",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 59,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_59",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each type of crime, find the average number of objects involved and the average number of vehicles involved. Return the crime type, average object count, and average vehicle count.",
    "Cypher": "MATCH (o:Object)-[:INVOLVED_IN]->(c:Crime) WITH c.type AS crimeType, count(o) AS objectCount MATCH (v:Vehicle)-[:INVOLVED_IN]->(c2:Crime) WHERE c2.type = crimeType WITH crimeType, objectCount, count(v) AS vehicleCount RETURN crimeType, avg(objectCount), avg(vehicleCount)",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 63,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_63",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each officer, determine the total number of crimes investigated and the average call duration of phone calls made to phones belonging to persons involved in those crimes. Return the officer's name, total crimes investigated, and average call duration.",
    "Cypher": "MATCH (o:Officer)-[:INVESTIGATED_BY]->(c:Crime)<-[:PARTY_TO]-(p:Person)-[:HAS_PHONE]->(ph:Phone)<-[:CALLED]-(pc:PhoneCall) WITH o.name AS officerName, c, pc.call_duration AS duration WHERE duration IS NOT NULL RETURN officerName, count(DISTINCT c) AS totalCrimesInvestigated, avg(toFloat(duration)) AS averageCallDuration",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 65,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_65",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each postcode, calculate the total number of crimes that occurred at locations with that postcode and the average age of persons who are party to those crimes. Return the postcode, total crime count, and average age of persons.",
    "Cypher": "MATCH (pc:PostCode)<-[:HAS_POSTCODE]-(l:Location)<-[:OCCURRED_AT]-(c:Crime)<-[:PARTY_TO]-(p:Person) WITH pc.code AS postcode, c, p.age AS age WHERE age IS NOT NULL RETURN postcode, count(DISTINCT c) AS totalCrimeCount, avg(toFloat(age)) AS averagePersonAge",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 66,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_66",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each area code, what is the average number of residents (identified by nhs_no) living at locations within that area, and what is the average number of phone calls made from phones associated with those residents?",
    "Cypher": "MATCH (l:Location)-[:LOCATION_IN_AREA]->(a:Area)<-[:CURRENT_ADDRESS]-(p:Person)-[:HAS_PHONE]->(ph:Phone)<-[:CALLER]-(pc:PhoneCall) WITH a, p, count(pc) AS callCount WITH a, count(p) AS residentCount, avg(callCount) AS avgCallsPerResident RETURN a.areaCode, avg(residentCount) AS avgResidents, avgCallsPerResident",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 85,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_85",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "What is the average age of people involved in crimes of type 'Shoplifting', and what is the average call duration of phone calls made by people involved in those crimes?",
    "Cypher": "MATCH (c:Crime {type: 'Shoplifting'})<-[:PARTY_TO]-(p:Person)-[:HAS_PHONE]->(ph:Phone)<-[:CALLER]-(pc:PhoneCall) WITH p, pc.call_duration AS callDuration WHERE p.age IS NOT NULL RETURN avg(toFloat(p.age)) AS averageAge, avg(toFloat(callDuration)) AS averageCallDuration",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 86,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_86",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Content: Results only contain null or zero values.",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "Results returned successfully.",
    "neo4j_result_passed": 1,
    "content_validation": "Results only contain null or zero values.",
    "content_passed": 0
  },
  {
    "NL Question": "For each type of crime, what is the average number of vehicles and objects involved, and what is the average number of officers investigating these crimes?",
    "Cypher": "MATCH (c:Crime)-[:INVOLVED_IN]-(v:Vehicle) WITH c, count(v) AS vehicleCount MATCH (c)-[:INVOLVED_IN]-(o:Object) WITH c, vehicleCount, count(o) AS objectCount MATCH (c)-[:INVESTIGATED_BY]->(of:Officer) WITH c, vehicleCount, objectCount, count(of) AS officerCount RETURN c.type, avg(vehicleCount) AS avgVehicles, avg(objectCount) AS avgObjects, avg(officerCount) AS avgOfficers",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 87,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_87",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each officer rank, calculate the average number of crimes investigated and the average number of distinct objects involved in those crimes.",
    "Cypher": "MATCH (o:Officer)-[:INVESTIGATED_BY]->(c:Crime) WITH o.rank AS officerRank, c MATCH (c)<-[:INVOLVED_IN]-(ob:Object) WITH officerRank, c, COUNT(DISTINCT ob) AS objectCount WITH officerRank, COUNT(DISTINCT c) AS crimeCount, AVG(objectCount) AS avgObjectCount RETURN officerRank, AVG(crimeCount) AS averageCrimes, AVG(avgObjectCount) AS averageObjects",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 102,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_102",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each type of crime, what is the average number of officers investigating those crimes, and what is the average number of objects involved in those crimes?",
    "Cypher": "MATCH (c:Crime)<-[:INVESTIGATED_BY]-(o:Officer) WITH c.type AS crimeType, COUNT(DISTINCT o) AS officerCount MATCH (c:Crime)<-[:INVOLVED_IN]-(ob:Object) WHERE c.type = crimeType WITH crimeType, officerCount, COUNT(DISTINCT ob) AS objectCount RETURN crimeType, avg(officerCount) AS avgOfficers, avg(objectCount) AS avgObjects",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 105,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_105",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each rank of officer, what is the average number of crimes investigated by officers of that rank, and what is the average number of objects involved in those crimes?",
    "Cypher": "MATCH (o:Officer)-[:INVESTIGATED_BY]->(c:Crime) WITH o.rank AS officerRank, c MATCH (c)<-[:INVOLVED_IN]-(ob:Object) WITH officerRank, COUNT(DISTINCT c) AS crimeCount, COUNT(DISTINCT ob) AS objectCount RETURN officerRank, AVG(crimeCount) AS avgCrimes, AVG(objectCount) AS avgObjects",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 109,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_109",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "What is the average age of people who have a family relationship with 'Louis Hughes' and also have a current address?",
    "Cypher": "MATCH (p1:Person {name: 'Louis', surname: 'Hughes'})-[:FAMILY_REL]-(p2:Person)-[:CURRENT_ADDRESS]->(l:Location) WITH toInteger(p2.age) AS age WHERE p2.age IS NOT NULL RETURN AVG(age) AS averageAgeOfFamilyWithAddress",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 121,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_121",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Content: Results only contain null or zero values.",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "Results returned successfully.",
    "neo4j_result_passed": 1,
    "content_validation": "Results only contain null or zero values.",
    "content_passed": 0
  },
  {
    "NL Question": "What is the average duration of phone calls made from each postcode area, and how many distinct phone numbers were called from each area?",
    "Cypher": "MATCH (pc:PostCode)<-[:HAS_POSTCODE]-(l:Location)<-[:OCCURRED_AT]-(c:Crime)-[:INVOLVED_IN]-(phc:PhoneCall)-[:CALLED]-(ph:Phone) WITH pc.code AS postcode, AVG(toFloat(phc.call_duration)) AS avgDuration, COUNT(DISTINCT ph.phoneNo) AS distinctPhoneNumbers RETURN postcode, avgDuration, distinctPhoneNumbers",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 126,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_126",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each area code, what is the average number of crimes that occurred at locations within that area, and what is the average number of officers investigating those crimes?",
    "Cypher": "MATCH (l:Location)-[:LOCATION_IN_AREA]->(a:Area)<-[:OCCURRED_AT]-(c:Crime)-[:INVESTIGATED_BY]->(o:Officer) WITH a.areaCode AS areaCode, c, o MATCH (l:Location)-[:LOCATION_IN_AREA]->(a:Area) WITH areaCode, COUNT(DISTINCT c) AS crimeCount, COUNT(DISTINCT o) AS officerCount RETURN areaCode, avg(crimeCount) AS averageCrimeCount, avg(officerCount) AS averageOfficerCount",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 134,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_134",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "Calculate the average age of people who are family members of 'Jeffrey Campbell' and have HAS_PHONE relationships, grouped by the first digit of their phone number.",
    "Cypher": "MATCH (p1:Person {name: 'Jeffrey', surname: 'Campbell'})<-[:FAMILY_REL]-(p2:Person)-[:HAS_PHONE]->(ph:Phone) WITH p2, substring(ph.phoneNo, 0, 1) AS firstDigit WHERE p2.age IS NOT NULL RETURN firstDigit, avg(toInteger(p2.age)) AS averageAge",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 135,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_135",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each crime type, what is the average number of objects involved and the average number of vehicles involved?",
    "Cypher": "MATCH (c:Crime)<-[:INVOLVED_IN]-(o:Object) WITH c.type AS crimeType, c, COUNT(o) AS objectCount MATCH (c:Crime)<-[:INVOLVED_IN]-(v:Vehicle) WITH crimeType, objectCount, COUNT(v) AS vehicleCount RETURN crimeType, avg(objectCount) AS averageObjectCount, avg(vehicleCount) AS averageVehicleCount",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 136,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_136",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each type of crime, calculate the average number of officers involved in the investigations and the average call duration of phone calls related to people party to those crimes. Return the crime type, average number of officers, and average call duration.",
    "Cypher": "MATCH (c:Crime)<-[:PARTY_TO]-(p:Person)-[:HAS_PHONE]->(ph:Phone)<-[:CALLED]-(pc:PhoneCall) WITH c, AVG(toInt(pc.call_duration)) AS avgCallDuration MATCH (c)<-[:INVESTIGATED_BY]-(o:Officer) WITH c, avgCallDuration, COUNT(o) AS officerCount RETURN c.type AS crimeType, AVG(officerCount) AS avgOfficerCount, AVG(avgCallDuration) AS overallAvgCallDuration",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 140,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_140",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 1, column 104 (offset: 103))\n\"MATCH (c:Crime)<-[:PARTY_TO]-(p:Person)-[:HAS_PHONE]->(ph:Phone)<-[:CALLED]-(pc:PhoneCall) WITH c, AVG(toInt(pc.call_duration)) AS avgCallDuration MATCH (c)<-[:INVESTIGATED_BY]-(o:Officer) WITH c, avgCallDuration, COUNT(o) AS officerCount RETURN c.type AS crimeType, AVG(officerCount) AS avgOfficerCount, AVG(avgCallDuration) AS overallAvgCallDuration\"\n                                                                                                        ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each area code, find the average number of crimes that occurred at locations within that area, and the average age of persons who have a current address in that area. Return the area code, the average number of crimes, and the average age of persons.",
    "Cypher": "MATCH (l:Location)-[:LOCATION_IN_AREA]->(a:Area)<-[:CURRENT_ADDRESS]-(p:Person) WITH a, AVG(toInt(p.age)) AS avgPersonAge MATCH (cr:Crime)-[:OCCURRED_AT]->(l2:Location)-[:LOCATION_IN_AREA]->(a) WITH a, avgPersonAge, COUNT(cr) AS crimeCount RETURN a.areaCode AS areaCode, AVG(crimeCount) AS avgCrimeCount, AVG(avgPersonAge) AS overallAvgPersonAge",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 141,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_141",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 1, column 93 (offset: 92))\n\"MATCH (l:Location)-[:LOCATION_IN_AREA]->(a:Area)<-[:CURRENT_ADDRESS]-(p:Person) WITH a, AVG(toInt(p.age)) AS avgPersonAge MATCH (cr:Crime)-[:OCCURRED_AT]->(l2:Location)-[:LOCATION_IN_AREA]->(a) WITH a, avgPersonAge, COUNT(cr) AS crimeCount RETURN a.areaCode AS areaCode, AVG(crimeCount) AS avgCrimeCount, AVG(avgPersonAge) AS overallAvgPersonAge\"\n                                                                                             ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each officer rank, determine the average number of crimes investigated by officers of that rank and the average number of phone calls made to phone numbers associated with people party to those crimes. Return the officer rank, average number of crimes investigated, and average number of calls.",
    "Cypher": "MATCH (o:Officer)-[:INVESTIGATED_BY]->(c:Crime) WITH o, COUNT(c) AS crimeCount MATCH (p:Person)-[:PARTY_TO]->(c)<-[:INVESTIGATED_BY]-(o) -[:INVESTIGATED_BY]->(c2:Crime)<-[:PARTY_TO]-(p)-[:HAS_PHONE]->(ph:Phone)<-[:CALLED]-(pc:PhoneCall) WITH o.rank AS officerRank, AVG(crimeCount) AS avgCrimesInvestigated, COUNT(pc) AS callCount RETURN officerRank, AVG(avgCrimesInvestigated), AVG(callCount)",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 142,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_142",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each postcode area, calculate the average number of people who currently live there and the average number of crimes that involve vehicles with a model containing 'Silverado'. Return the postcode area, the average number of people, and the average number of 'Silverado' related crimes.",
    "Cypher": "MATCH (p:Person)-[:CURRENT_ADDRESS]->(l:Location)-[:HAS_POSTCODE]->(pc:PostCode) WITH pc, COUNT(p) AS personCount MATCH (cr:Crime)<-[:INVOLVED_IN]-(v:Vehicle) WHERE v.model CONTAINS 'Silverado' MATCH (cr)-[:OCCURRED_AT]->(l:Location)-[:HAS_POSTCODE]->(pc) WITH pc.code AS postcode, AVG(personCount) AS avgPeople, COUNT(cr) AS silveradoCrimeCount RETURN postcode, AVG(avgPeople), AVG(silveradoCrimeCount)",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 143,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_143",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each area code, compute the average age of people living in that area and the average duration of phone calls made by phones associated with those people. Return the area code, the average age, and the average call duration.",
    "Cypher": "MATCH (p:Person)-[:CURRENT_ADDRESS]->(l:Location)-[:LOCATION_IN_AREA]->(a:Area) WITH a, AVG(toInt(p.age)) AS avgPersonAge MATCH (p)-[:HAS_PHONE]->(ph:Phone)<-[:CALLED]-(pc:PhoneCall) MATCH (p)-[:CURRENT_ADDRESS]->(l:Location)-[:LOCATION_IN_AREA]->(a) WITH a.areaCode AS areaCode, AVG(avgPersonAge) AS avgAge, AVG(toInt(pc.call_duration)) AS avgCallDuration RETURN areaCode, AVG(avgAge), AVG(avgCallDuration)",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 144,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_144",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 1, column 93 (offset: 92))\n\"MATCH (p:Person)-[:CURRENT_ADDRESS]->(l:Location)-[:LOCATION_IN_AREA]->(a:Area) WITH a, AVG(toInt(p.age)) AS avgPersonAge MATCH (p)-[:HAS_PHONE]->(ph:Phone)<-[:CALLED]-(pc:PhoneCall) MATCH (p)-[:CURRENT_ADDRESS]->(l:Location)-[:LOCATION_IN_AREA]->(a) WITH a.areaCode AS areaCode, AVG(avgPersonAge) AS avgAge, AVG(toInt(pc.call_duration)) AS avgCallDuration RETURN areaCode, AVG(avgAge), AVG(avgCallDuration)\"\n                                                                                             ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each officer rank, what is the average number of crimes investigated and the average number of people who are party to those crimes?",
    "Cypher": "MATCH (c:Crime)-[:INVESTIGATED_BY]->(o:Officer) WITH o.rank AS officerRank, count(c) AS crimeCount MATCH (p:Person)-[:PARTY_TO]->(c2:Crime) WHERE c2-[:INVESTIGATED_BY]->(:Officer {rank: officerRank}) WITH officerRank, crimeCount, count(DISTINCT p) AS personCount RETURN officerRank, avg(crimeCount) AS avgCrimes, avg(personCount) AS avgPeople",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 156,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_156",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input ':': expected an expression (line 1, column 151 (offset: 150))\n\"MATCH (c:Crime)-[:INVESTIGATED_BY]->(o:Officer) WITH o.rank AS officerRank, count(c) AS crimeCount MATCH (p:Person)-[:PARTY_TO]->(c2:Crime) WHERE c2-[:INVESTIGATED_BY]->(:Officer {rank: officerRank}) WITH officerRank, crimeCount, count(DISTINCT p) AS personCount RETURN officerRank, avg(crimeCount) AS avgCrimes, avg(personCount) AS avgPeople\"\n                                                                                                                                                       ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each year a vehicle was manufactured, what is the average number of crimes the vehicles of that year were involved in, and what is the average number of objects involved in those same crimes?",
    "Cypher": "MATCH (v:Vehicle)-[:INVOLVED_IN]->(c:Crime) WITH v.year AS vehicleYear, c, count(v) AS vehicle_count MATCH (c)<-[:INVOLVED_IN]-(o:Object) WITH vehicleYear, c, vehicle_count, count(o) AS objectCount WITH vehicleYear, vehicle_count, avg(objectCount) AS avgObjectCount RETURN vehicleYear, avg(vehicle_count) AS avgCrimes, avgObjectCount",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 158,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_158",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each officer rank, determine the average number of crimes investigated and the average number of people involved in those crimes. Return the officer's rank, the average number of crimes investigated, and the average number of people involved.",
    "Cypher": "MATCH (o:Officer)-[:INVESTIGATED_BY]->(c:Crime) WITH o.rank AS officerRank, c MATCH (p:Person)-[:PARTY_TO]->(c) WITH officerRank, COUNT(DISTINCT c) AS crimeCount, COUNT(DISTINCT p) AS peopleCount RETURN officerRank, avg(crimeCount), avg(peopleCount)",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 165,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_165",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each area code, find the total number of locations and the average number of people who have their current address within those locations. Return the area code, total locations, and average people per location.",
    "Cypher": "MATCH (l:Location)-[:LOCATION_IN_AREA]->(a:Area) WITH a.areaCode AS areaCode, l MATCH (p:Person)-[:CURRENT_ADDRESS]->(l) WHERE l-[:LOCATION_IN_AREA]->(a:Area) WITH areaCode, l, COUNT(p) AS peoplePerLocation WITH areaCode, COUNT(l) AS totalLocations, AVG(peoplePerLocation) AS avgPeoplePerLocation RETURN areaCode, totalLocations, avgPeoplePerLocation",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 176,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_176",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input ':': expected an expression (line 1, column 131 (offset: 130))\n\"MATCH (l:Location)-[:LOCATION_IN_AREA]->(a:Area) WITH a.areaCode AS areaCode, l MATCH (p:Person)-[:CURRENT_ADDRESS]->(l) WHERE l-[:LOCATION_IN_AREA]->(a:Area) WITH areaCode, l, COUNT(p) AS peoplePerLocation WITH areaCode, COUNT(l) AS totalLocations, AVG(peoplePerLocation) AS avgPeoplePerLocation RETURN areaCode, totalLocations, avgPeoplePerLocation\"\n                                                                                                                                   ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each area, what is the average number of crimes that occurred, and what is the average number of officers investigating crimes in that area?",
    "Cypher": "MATCH (l:Location)-[:LOCATION_IN_AREA]->(a:Area)<-[:OCCURRED_AT]-(c:Crime) WITH a, c MATCH (c)-[:INVESTIGATED_BY]->(o:Officer) WITH a, COUNT(DISTINCT c) AS crimeCount, COUNT(DISTINCT o) AS officerCount RETURN a.areaCode AS areaCode, AVG(crimeCount) AS averageCrimes, AVG(officerCount) AS averageOfficers",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 183,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_183",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "What is the average call duration for each type of crime, considering only phone calls made before the crime date?",
    "Cypher": "MATCH (c:Crime)<-[:PARTY_TO]-(p:Person)-[:HAS_PHONE]->(ph:Phone)<-[:CALLED]-(pc:PhoneCall) WHERE date(pc.call_date) < date(c.date) WITH c.type AS crimeType, toInteger(pc.call_duration) AS duration RETURN crimeType, AVG(duration) AS averageCallDuration",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 184,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_184",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Text cannot be parsed to a Date\n\"28/08/2017\"\n ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each officer, what is the average number of crimes investigated, and what is the average number of vehicles involved in those crimes?",
    "Cypher": "MATCH (o:Officer)<-[:INVESTIGATED_BY]-(c:Crime) WITH o, c MATCH (c)-[:INVOLVED_IN]->(v:Vehicle) WITH o, COUNT(DISTINCT c) AS crimeCount, COUNT(DISTINCT v) AS vehicleCount RETURN o.name AS officerName, AVG(crimeCount) AS averageCrimes, AVG(vehicleCount) AS averageVehicles",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 186,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_186",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each type of crime, what is the average number of officers involved in the investigations and the average duration of phone calls related to those crimes?",
    "Cypher": "MATCH (c:Crime)<-[:INVOLVED_IN]-(o:Object)<-[:CALLED]-(pc:PhoneCall)\nWITH c.type AS crimeType, COUNT(DISTINCT pc) AS callCount, COUNT(DISTINCT o) AS officerCount, AVG(toFloat(pc.call_duration)) AS avgCallDuration\nRETURN crimeType, AVG(officerCount) AS avgOfficers, AVG(avgCallDuration) AS avgCallDuration",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 189,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_189",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each officer, determine the average number of vehicles and objects involved in the crimes they investigated, considering only crimes that occurred in areas with a postcode starting with 'M'.",
    "Cypher": "MATCH (o:Officer)<-[:INVESTIGATED_BY]-(c:Crime)-[:OCCURRED_AT]->(l:Location)-[:HAS_POSTCODE]->(pc:PostCode)\nWHERE pc.code STARTS WITH 'M'\nWITH o, c\nMATCH (c)<-[:INVOLVED_IN]-(v:Vehicle)\nWITH o, c, COUNT(DISTINCT v) AS vehicleCount\nMATCH (c)<-[:INVOLVED_IN]-(ob:Object)\nWITH o, c, vehicleCount, COUNT(DISTINCT ob) AS objectCount\nRETURN o.name, AVG(vehicleCount) AS avgVehicles, AVG(objectCount) AS avgObjects",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 193,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_193",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each crime type, what is the average number of objects involved, and what is the most frequent last outcome?",
    "Cypher": "MATCH (o:Object)-[:INVOLVED_IN]->(c:Crime) WITH c.type AS crimeType, c.last_outcome AS lastOutcome, COUNT(o) AS objectCount WITH crimeType, COLLECT(lastOutcome) AS outcomes, AVG(objectCount) AS avgObjects WITH crimeType, avgObjects, REDUCE (key = '', maxCount = 0, outcome in outcomes | CASE WHEN size([x IN outcomes WHERE x = outcome]) > maxCount THEN outcome ELSE key END) AS mostFrequentOutcome RETURN crimeType, avgObjects, mostFrequentOutcome",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 199,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_199",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input '|': expected an expression, ')' or ',' (line 1, column 286 (offset: 285))\n\"MATCH (o:Object)-[:INVOLVED_IN]->(c:Crime) WITH c.type AS crimeType, c.last_outcome AS lastOutcome, COUNT(o) AS objectCount WITH crimeType, COLLECT(lastOutcome) AS outcomes, AVG(objectCount) AS avgObjects WITH crimeType, avgObjects, REDUCE (key = '', maxCount = 0, outcome in outcomes | CASE WHEN size([x IN outcomes WHERE x = outcome]) > maxCount THEN outcome ELSE key END) AS mostFrequentOutcome RETURN crimeType, avgObjects, mostFrequentOutcome\"\n                                                                                                                                                                                                                                                                                              ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each type of crime, find the average number of officers involved in the investigations and the average call duration related to those crimes.",
    "Cypher": "MATCH (c:Crime)<-[:INVESTIGATED_BY]-(o:Officer)\nWITH c.type AS crimeType, c, count(o) AS officerCount\nMATCH (pc:PhoneCall)-[:CALLED]-(p:Phone)<-[:HAS_PHONE]-(per:Person)-[:PARTY_TO]->(c)\nWITH crimeType, officerCount, AVG(toInt(pc.call_duration)) AS avgCallDuration\nRETURN crimeType, AVG(officerCount) AS avgOfficers, avgCallDuration",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 203,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_203",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 4, column 35 (offset: 221))\n\"WITH crimeType, officerCount, AVG(toInt(pc.call_duration)) AS avgCallDuration\"\n                                   ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each officer rank, find the average number of crimes investigated and the average number of distinct objects involved in those crimes.",
    "Cypher": "MATCH (o:Officer)-[:INVESTIGATED_BY]->(c:Crime)\nWITH o.rank AS officerRank, o, c\nMATCH (obj:Object)-[:INVOLVED_IN]->(c)\nWITH officerRank, o, count(DISTINCT obj) AS objectCount, c\nRETURN officerRank, AVG(objectCount) AS avgObjects, count(DISTINCT c) AS crimeCount",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 206,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_206",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "Calculate the average number of phone calls originating from phones associated with people involved in each type of crime, and determine the average call duration for those calls.",
    "Cypher": "MATCH (c:Crime)<-[:PARTY_TO]-(p:Person)-[:HAS_PHONE]->(ph:Phone)<-[:CALLER]-(pc:PhoneCall)\nWITH c.type AS crimeType, p, ph, count(pc) AS callCount, pc.call_duration AS duration\nRETURN crimeType, AVG(toInt(duration)) AS avgDuration, AVG(callCount) AS avgCalls",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 207,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_207",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 3, column 23 (offset: 199))\n\"RETURN crimeType, AVG(toInt(duration)) AS avgDuration, AVG(callCount) AS avgCalls\"\n                       ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "What is the average age of people who are family of other people, grouped by the relationship type?",
    "Cypher": "MATCH (p1:Person)-[r:FAMILY_REL]->(p2:Person) WITH p1, r.rel_type AS relType, toInteger(p1.age) AS age WHERE p1.age IS NOT NULL RETURN relType, AVG(age) AS averageAge",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 212,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_212",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each area, determine the average number of crimes occurring at locations within that area and the average age of persons currently residing at those locations. Return the area code, average crime count, and average age.",
    "Cypher": "MATCH (a:Area)<-[:LOCATION_IN_AREA]-(l:Location)<-[:OCCURRED_AT]-(c:Crime) WITH a, l, count(c) AS crimeCount MATCH (l)<-[:CURRENT_ADDRESS]-(p:Person) WITH a, crimeCount, p.age AS personAge WHERE p.age IS NOT NULL WITH a.areaCode AS areaCode, AVG(toFloat(crimeCount)) AS avgCrimes, AVG(toFloat(personAge)) AS avgAge RETURN areaCode, avgCrimes, avgAge",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 218,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_218",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each officer, calculate the total number of crimes they investigated and the average number of objects involved in those crimes. Return the officer's name, total crimes investigated, and average objects involved.",
    "Cypher": "MATCH (o:Officer)<-[:INVESTIGATED_BY]-(c:Crime)-[:INVOLVED_IN]->(obj:Object) WITH o, c, count(obj) AS objectCount WITH o, count(c) AS totalCrimes, AVG(toFloat(objectCount)) AS avgObjectsInvolved RETURN o.name AS officerName, totalCrimes, avgObjectsInvolved",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 219,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_219",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each vehicle make, calculate the total number of crimes the vehicles were involved in and the average age of persons involved in those crimes. Return the vehicle make, total crime count, and average person age.",
    "Cypher": "MATCH (v:Vehicle)-[:INVOLVED_IN]->(c:Crime)<-[:PARTY_TO]-(p:Person) WITH v, c, p.age AS personAge WHERE p.age IS NOT NULL WITH v.make AS vehicleMake, count(c) AS totalCrimes, AVG(toFloat(personAge)) AS avgPersonAge RETURN vehicleMake, totalCrimes, avgPersonAge",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 221,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_221",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "Calculate the average age of people involved in each type of crime, and then determine the crime type with the highest average age of involved individuals.",
    "Cypher": "MATCH (p:Person)-[:PARTY_TO]->(c:Crime) WITH c.type AS crimeType, toInteger(p.age) AS age WHERE age IS NOT NULL WITH crimeType, AVG(age) AS avgAge ORDER BY avgAge DESC LIMIT 1 RETURN crimeType, avgAge",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 234,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_234",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each area, compute the average number of phone calls made to phones associated with people who have a current address in that area. Return the area code and the average number of phone calls.",
    "Cypher": "MATCH (p:Person)-[:CURRENT_ADDRESS]->(l:Location)-[:LOCATION_IN_AREA]->(a:Area) WITH p MATCH (p)-[:HAS_PHONE]->(ph:Phone)<-[:CALLED]-(pc:PhoneCall) WITH a, count(pc) AS callCount RETURN a.areaCode AS areaCode, avg(callCount) AS avgCallCount",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 235,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_235",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `a` not defined (line 1, column 154 (offset: 153))\n\"MATCH (p:Person)-[:CURRENT_ADDRESS]->(l:Location)-[:LOCATION_IN_AREA]->(a:Area) WITH p MATCH (p)-[:HAS_PHONE]->(ph:Phone)<-[:CALLED]-(pc:PhoneCall) WITH a, count(pc) AS callCount RETURN a.areaCode AS areaCode, avg(callCount) AS avgCallCount\"\n                                                                                                                                                          ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "What is the average number of crimes each officer investigated, and what is the average number of objects involved in those crimes?",
    "Cypher": "MATCH (o:Officer)-[:INVESTIGATED_BY]->(c:Crime)\nWITH o, COUNT(c) AS crimesInvestigated\nMATCH (c:Crime)<-[:INVOLVED_IN]-(ob:Object)\nWITH o, crimesInvestigated, COUNT(ob) AS objectsInvolved\nRETURN o.name, AVG(crimesInvestigated) AS avgCrimesInvestigated, AVG(objectsInvolved) AS avgObjectsInvolved",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 238,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_238",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each area code, what is the average number of locations and the average number of crimes that occurred in those locations?",
    "Cypher": "MATCH (l:Location)-[:LOCATION_IN_AREA]->(a:Area)\nWITH a, COUNT(l) AS locationCount\nMATCH (l)-[:OCCURRED_AT]->(c:Crime)\nWITH a, locationCount, COUNT(c) AS crimeCount\nRETURN a.areaCode, AVG(locationCount) AS avgLocations, AVG(crimeCount) AS avgCrimes",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 239,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_239",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each officer, what is the average number of people they know who have a 'Violence and sexual offences' crime associated with them?",
    "Cypher": "MATCH (o:Officer)-[:INVESTIGATED_BY]->(c:Crime)<-[:PARTY_TO]-(p2:Person)-[:KNOWS]-(p:Person)\nWHERE c.type = 'Violence and sexual offences'\nWITH o, COUNT(DISTINCT p) AS knownPeopleWithCrime\nRETURN o.name, o.surname, AVG(knownPeopleWithCrime) AS avgKnownPeopleWithCrime",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 242,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_242",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "What is the average number of crimes investigated by officers with the rank 'Sergeant', and what is the average number of objects involved in those crimes?",
    "Cypher": "MATCH (c:Crime)-[:INVESTIGATED_BY]->(o:Officer {rank: 'Sergeant'}) WITH c, o MATCH (o)<-[:INVESTIGATED_BY]-(crime:Crime)<-[:INVOLVED_IN]-(obj:Object) WITH o, COUNT(DISTINCT crime) AS crimesInvestigated, COUNT(DISTINCT obj) AS objectsInvolved RETURN AVG(crimesInvestigated) AS avgCrimesInvestigated, AVG(objectsInvolved) AS avgObjectsInvolved",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 245,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_245",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Content: Results only contain null or zero values.",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "Results returned successfully.",
    "neo4j_result_passed": 1,
    "content_validation": "Results only contain null or zero values.",
    "content_passed": 0
  },
  {
    "NL Question": "For each crime type, what is the average number of officers investigating crimes of that type, and what is the average number of people who are party to those crimes?",
    "Cypher": "MATCH (c:Crime)<-[:PARTY_TO]-(p:Person) WITH c.type AS crimeType, c MATCH (c)-[:INVESTIGATED_BY]->(o:Officer) WITH crimeType, COUNT(DISTINCT o) AS officerCount, COUNT(DISTINCT p) AS peopleCount RETURN crimeType, AVG(officerCount) AS avgOfficers, AVG(peopleCount) AS avgPeople",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 248,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_248",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `p` not defined (line 1, column 177 (offset: 176))\n\"MATCH (c:Crime)<-[:PARTY_TO]-(p:Person) WITH c.type AS crimeType, c MATCH (c)-[:INVESTIGATED_BY]->(o:Officer) WITH crimeType, COUNT(DISTINCT o) AS officerCount, COUNT(DISTINCT p) AS peopleCount RETURN crimeType, AVG(officerCount) AS avgOfficers, AVG(peopleCount) AS avgPeople\"\n                                                                                                                                                                                 ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "What is the average call duration for each call type made to phones connected to people named 'Scott Taylor'?",
    "Cypher": "MATCH (p:Person {name: 'Scott', surname: 'Taylor'})-[:HAS_PHONE]->(ph:Phone)<-[:CALLED]-(pc:PhoneCall) WITH pc.call_type AS callType, toInteger(pc.call_duration) AS duration WHERE duration IS NOT NULL RETURN callType, AVG(duration) AS averageDuration",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 259,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_259",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "What is the average number of crimes each officer with rank 'Sergeant' has investigated, and what is the longest time between the dates of those crimes?",
    "Cypher": "MATCH (o:Officer {rank: 'Sergeant'})-[r:INVESTIGATED_BY]->(c:Crime) WITH o, collect(c.date) AS crimeDates, count(c) AS crimeCount WITH o, crimeDates, crimeCount ORDER BY crimeDates WITH o, crimeDates, crimeCount, crimeDates[size(crimeDates)-1] AS maxDate, crimeDates[0] AS minDate RETURN o.name, o.surname, crimeCount, duration.between(date(minDate), date(maxDate)).days AS dateDifference",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 266,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_266",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "What is the average call duration for each call type, and what is the total number of calls made on '17/08/2017'?",
    "Cypher": "MATCH (pc:PhoneCall) WITH pc.call_type AS callType, toInteger(pc.call_duration) AS duration, pc.call_date AS callDate WITH callType, avg(duration) AS avgDuration, collect(callDate) AS allDates WITH callType, avgDuration, size(filter(date IN allDates WHERE date = '17/08/2017')) AS totalCallsOnDate RETURN callType, avgDuration, totalCallsOnDate",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 268,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_268",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'WHERE': expected an expression, ')' or ',' (line 1, column 251 (offset: 250))\n\"MATCH (pc:PhoneCall) WITH pc.call_type AS callType, toInteger(pc.call_duration) AS duration, pc.call_date AS callDate WITH callType, avg(duration) AS avgDuration, collect(callDate) AS allDates WITH callType, avgDuration, size(filter(date IN allDates WHERE date = '17/08/2017')) AS totalCallsOnDate RETURN callType, avgDuration, totalCallsOnDate\"\n                                                                                                                                                                                                                                                           ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "What is the average age of people who know at least two other people, and what is the average number of phones those people have?",
    "Cypher": "MATCH (p:Person)-[:KNOWS]->(other:Person) WITH p, count(other) AS knownPeople WHERE knownPeople >= 2 WITH p MATCH (p)-[:HAS_PHONE]->(ph:Phone) WITH p, count(ph) AS phoneCount, p.age AS personAge WHERE personAge IS NOT NULL WITH avg(toInteger(personAge)) AS avgAge, avg(phoneCount) AS avgPhones RETURN avgAge, avgPhones",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 270,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_270",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Content: Results only contain null or zero values.",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "Results returned successfully.",
    "neo4j_result_passed": 1,
    "content_validation": "Results only contain null or zero values.",
    "content_passed": 0
  },
  {
    "NL Question": "For each type of crime, what is the average number of officers involved in the investigations and the average number of objects involved?",
    "Cypher": "MATCH (c:Crime)<-[:INVESTIGATED_BY]-(o:Officer) WITH c.type AS crimeType, COUNT(o) AS officerCount MATCH (c2:Crime)<-[:INVOLVED_IN]-(ob:Object) WHERE c2.type = crimeType WITH crimeType, officerCount, COUNT(ob) AS objectCount RETURN crimeType, avg(officerCount) AS avgOfficers, avg(objectCount) AS avgObjects",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 273,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_273",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each person, find the total duration of phone calls made and received, and calculate the average call duration across all their calls.",
    "Cypher": "MATCH (p:Person)-[:HAS_PHONE]->(ph:Phone)<-[:CALLER]-(pc:PhoneCall) WITH p, pc.call_duration AS duration UNION ALL MATCH (p:Person)-[:HAS_PHONE]->(ph:Phone)<-[:CALLED]-(pc:PhoneCall) WITH p, pc.call_duration AS duration WITH p, COLLECT(duration) AS durations UNWIND durations AS dur WITH p, toInteger(dur) AS intDur WHERE intDur IS NOT NULL WITH p, AVG(intDur) AS avgDuration RETURN p.name, avgDuration",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 275,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_275",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Query cannot conclude with WITH (must be a RETURN clause, a FINISH clause, an update clause, a unit subquery call, or a procedure call with no YIELD). (line 1, column 69 (offset: 68))\n\"MATCH (p:Person)-[:HAS_PHONE]->(ph:Phone)<-[:CALLER]-(pc:PhoneCall) WITH p, pc.call_duration AS duration UNION ALL MATCH (p:Person)-[:HAS_PHONE]->(ph:Phone)<-[:CALLED]-(pc:PhoneCall) WITH p, pc.call_duration AS duration WITH p, COLLECT(duration) AS durations UNWIND durations AS dur WITH p, toInteger(dur) AS intDur WHERE intDur IS NOT NULL WITH p, AVG(intDur) AS avgDuration RETURN p.name, avgDuration\"\n                                                                     ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each officer, determine the number of crimes they investigated and the average number of objects involved in those crimes.",
    "Cypher": "MATCH (o:Officer)<-[:INVESTIGATED_BY]-(c:Crime) WITH o, c MATCH (ob:Object)-[:INVOLVED_IN]->(c) WITH o, COUNT(ob) AS objectCount RETURN o.name, COUNT(c) AS crimeCount, avg(objectCount) AS avgObjectsPerCrime",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 276,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_276",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `c` not defined (line 1, column 151 (offset: 150))\n\"MATCH (o:Officer)<-[:INVESTIGATED_BY]-(c:Crime) WITH o, c MATCH (ob:Object)-[:INVOLVED_IN]->(c) WITH o, COUNT(ob) AS objectCount RETURN o.name, COUNT(c) AS crimeCount, avg(objectCount) AS avgObjectsPerCrime\"\n                                                                                                                                                       ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each person, calculate the total number of phone calls made and received through their phones, and then calculate the average call duration for each person.",
    "Cypher": "MATCH (p:Person)-[:HAS_PHONE]->(ph:Phone)\nWITH p, ph\nOPTIONAL MATCH (pc1:PhoneCall)-[:CALLER]->(ph)\nWITH p, ph, COUNT(pc1) AS callsMade\nOPTIONAL MATCH (pc2:PhoneCall)-[:CALLED]->(ph)\nWITH p, ph, callsMade, COUNT(pc2) AS callsReceived\nWITH p, callsMade + callsReceived AS totalCalls, COLLECT(pc1.call_duration + pc2.call_duration) AS durations -- Ensure durations are collected correctly\nUNWIND durations AS duration -- Unwind the list of durations\nWITH p,totalCalls, duration\nRETURN p.name, SUM(toInteger(duration))/totalCalls AS averageDuration",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 282,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_282",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input '-': expected 'FOREACH', ',', 'ORDER BY', 'CALL', 'CREATE', 'LOAD CSV', 'DELETE', 'DETACH', 'FINISH', 'INSERT', 'LIMIT', 'MATCH', 'MERGE', 'NODETACH', 'OFFSET', 'OPTIONAL', 'REMOVE', 'RETURN', 'SET', 'SKIP', 'UNION', 'UNWIND', 'USE', 'WHERE', 'WITH' or <EOF> (line 7, column 110 (offset: 343))\n\"WITH p, callsMade + callsReceived AS totalCalls, COLLECT(pc1.call_duration + pc2.call_duration) AS durations -- Ensure durations are collected correctly\"\n                                                                                                              ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each type of crime, find the average number of officers involved in investigations and the average duration of phone calls made to phones connected to persons involved in that crime type.",
    "Cypher": "MATCH (c:Crime)<-[:INVESTIGATED_BY]-(o:Officer)\nWITH c.type AS crimeType, COUNT(DISTINCT o) AS officerCount, c\nMATCH (p:Person)-[:PARTY_TO]->(c)<-[:INVESTIGATED_BY]-(o:Officer)-[:INVESTIGATED_BY]->(c)\nMATCH (p)-[:HAS_PHONE]->(ph:Phone)<-[:CALLED]-(pc:PhoneCall)\nWITH crimeType, officerCount, AVG(toInt(pc.call_duration)) AS avgCallDuration\nRETURN crimeType, AVG(officerCount) AS avgOfficers, avgCallDuration",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 287,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_287",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 5, column 35 (offset: 296))\n\"WITH crimeType, officerCount, AVG(toInt(pc.call_duration)) AS avgCallDuration\"\n                                   ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each area code, calculate the total number of crimes that occurred and the average age of persons living at locations within that area.",
    "Cypher": "MATCH (l:Location)-[:LOCATION_IN_AREA]->(a:Area)<-[:HAS_POSTCODE]-(pc:PostCode)\nWITH a.areaCode AS areaCode, l\nMATCH (p:Person)-[:CURRENT_ADDRESS]->(l)\nWITH areaCode, AVG(toInt(p.age)) AS avgAge, l\nMATCH (cr:Crime)-[:OCCURRED_AT]->(l)\nWITH areaCode, avgAge, COUNT(cr) AS crimeCount\nRETURN areaCode, crimeCount, avgAge",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 288,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_288",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 4, column 20 (offset: 171))\n\"WITH areaCode, AVG(toInt(p.age)) AS avgAge, l\"\n                    ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each officer rank, determine the total number of crimes investigated and the average number of phone calls associated with each crime investigated by officers of that rank.",
    "Cypher": "MATCH (o:Officer)-[:INVESTIGATED_BY]->(c:Crime)\nWITH o.rank AS officerRank, c, COUNT(DISTINCT c) AS crimeCount\nMATCH (p:Person)-[:PARTY_TO]->(c)\nMATCH (p)-[:HAS_PHONE]->(ph:Phone)<-[:CALLED]-(pc:PhoneCall)\nWITH officerRank, crimeCount, COUNT(DISTINCT pc) AS callCount\nRETURN officerRank, crimeCount, AVG(callCount) AS avgCallsPerCrime",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 289,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_289",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "Calculate the average age of people involved in crimes of type 'Violence and sexual offences', and the average call duration of phone calls made by those people.",
    "Cypher": "MATCH (p:Person)-[:PARTY_TO]->(c:Crime {type: 'Violence and sexual offences'})\nWITH p, c\nMATCH (p)-[:HAS_PHONE]->(ph:Phone)<-[:CALLED]-(pc:PhoneCall)\nWITH AVG(toInt(p.age)) AS avgAge, AVG(toInt(pc.call_duration)) AS avgCallDuration\nRETURN avgAge, avgCallDuration",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 290,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_290",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 4, column 10 (offset: 159))\n\"WITH AVG(toInt(p.age)) AS avgAge, AVG(toInt(pc.call_duration)) AS avgCallDuration\"\n          ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each officer rank, what is the average number of crimes investigated where the crime type is 'Burglary', and what is the average age of people involved in those burglaries?",
    "Cypher": "MATCH (c:Crime {type: 'Burglary'})-[:INVESTIGATED_BY]->(o:Officer) WITH o.rank AS officerRank, c MATCH (p:Person)-[:PARTY_TO]->(c) WHERE p.age IS NOT NULL WITH officerRank, COUNT(c) AS crimeCount, toInteger(p.age) AS personAge RETURN officerRank, AVG(crimeCount) AS avgCrimes, AVG(personAge) AS avgPersonAge",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 298,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_298",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each type of crime, find the average number of officers involved in the investigations and the average duration of phone calls made in relation to those crimes. Return the crime type, average number of officers, and average call duration.",
    "Cypher": "MATCH (c:Crime)<-[:INVESTIGATED_BY]-(o:Officer)\nWITH c.type AS crimeType, c, COUNT(o) AS officerCount\nMATCH (pc:PhoneCall)-[:CALLED]->(ph:Phone)<-[:HAS_PHONE]-(p:Person)-[:PARTY_TO]->(c)\nWITH crimeType, AVG(toFloat(pc.call_duration)) AS avgCallDuration, officerCount\nRETURN crimeType, AVG(officerCount) AS avgOfficerCount, avgCallDuration",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 301,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_301",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each make of vehicle involved in crimes, determine the total number of crimes and the average number of objects involved in those crimes. Return the vehicle make, the total crime count, and the average object count.",
    "Cypher": "MATCH (v:Vehicle)-[:INVOLVED_IN]->(c:Crime)<-[:INVOLVED_IN]-(o:Object)\nWITH v.make AS vehicleMake, c, o\nWITH vehicleMake, c, COUNT(o) AS objectCount\nWITH vehicleMake, COUNT(DISTINCT c) AS totalCrimes, AVG(objectCount) AS avgObjectCount\nRETURN vehicleMake, totalCrimes, avgObjectCount",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 303,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_303",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each officer rank, find the average number of crimes investigated and the average number of people known by those involved in those crimes. Return the officer rank, average crimes investigated, and average number of people known.",
    "Cypher": "MATCH (o:Officer)-[:INVESTIGATED_BY]->(c:Crime)<-[:PARTY_TO]-(p:Person)-[:KNOWS]->(p2:Person)\nWITH o.rank AS officerRank, c, p\nWITH officerRank, c, COUNT(p) AS peopleCount\nWITH officerRank, COUNT(DISTINCT c) AS totalCrimes, AVG(peopleCount) AS avgPeopleCount\nRETURN officerRank, AVG(totalCrimes) AS avgCrimesInvestigated, avgPeopleCount",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 304,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_304",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each postcode area, determine the total number of people living there and the average number of phone calls made by people in that area. Return the postcode, total number of residents, and average call count.",
    "Cypher": "MATCH (p:Person)-[:CURRENT_ADDRESS]->(l:Location)-[:HAS_POSTCODE]->(pc:PostCode)<-[:POSTCODE_IN_AREA]-(a:Area)\nWITH p, pc\nMATCH (p)-[:HAS_PHONE]->(ph:Phone)<-[:CALLER]-(c:PhoneCall)\nWITH pc.code AS postcode, p, COUNT(c) AS callCount\nWITH postcode, COUNT(DISTINCT p) AS totalResidents, AVG(callCount) AS avgCallCount\nRETURN postcode, totalResidents, avgCallCount",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 305,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_305",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each Crime 'type', calculate the average number of Objects 'INVOLVED_IN' that type of crime, and also determine the total number of Vehicles 'INVOLVED_IN' each crime type.",
    "Cypher": "MATCH (c:Crime)<-[:INVOLVED_IN]-(o:Object) WITH c.type AS crimeType, c, count(o) AS objectCount MATCH (c)<-[:INVOLVED_IN]-(v:Vehicle) WITH crimeType, c, objectCount, count(v) AS vehicleCount WITH crimeType, avg(objectCount) AS avgObjects, sum(vehicleCount) AS totalVehicles RETURN crimeType, avgObjects, totalVehicles",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 312,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_312",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each area code, what is the average number of crimes that occurred at locations within that area, and what is the total number of people who have a current address in that area?",
    "Cypher": "MATCH (l:Location)-[:LOCATION_IN_AREA]->(a:Area) WITH a,l MATCH (c:Crime)-[:OCCURRED_AT]->(l) WITH a, COUNT(DISTINCT c) AS crimeCount MATCH (p:Person)-[:CURRENT_ADDRESS]->(l) WHERE l-[:LOCATION_IN_AREA]->(a) WITH a, crimeCount, COUNT(DISTINCT p) AS personCount RETURN a.areaCode, AVG(crimeCount), personCount",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 316,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_316",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input ':': expected an expression (line 1, column 185 (offset: 184))\n\"MATCH (l:Location)-[:LOCATION_IN_AREA]->(a:Area) WITH a,l MATCH (c:Crime)-[:OCCURRED_AT]->(l) WITH a, COUNT(DISTINCT c) AS crimeCount MATCH (p:Person)-[:CURRENT_ADDRESS]->(l) WHERE l-[:LOCATION_IN_AREA]->(a) WITH a, crimeCount, COUNT(DISTINCT p) AS personCount RETURN a.areaCode, AVG(crimeCount), personCount\"\n                                                                                                                                                                                         ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each type of crime, what is the average number of objects involved, and what is the total number of vehicles involved?",
    "Cypher": "MATCH (o:Object)-[:INVOLVED_IN]->(c:Crime) WITH c.type AS crimeType, c, COUNT(o) AS objectCount MATCH (v:Vehicle)-[:INVOLVED_IN]->(c) WITH crimeType, objectCount, COUNT(v) AS vehicleCount RETURN crimeType, AVG(objectCount), SUM(vehicleCount)",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 317,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_317",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "What is the average number of phone calls made from each postcode area, and what is the average call duration for calls originating from each postcode area?",
    "Cypher": "MATCH (pc:PostCode)<-[:HAS_POSTCODE]-(l:Location)<-[:OCCURRED_AT]-(c:Crime)<-[:INVOLVED_IN]-(phc:PhoneCall) WITH pc.code AS postcode, COUNT(phc) AS numCalls, AVG(toInt(phc.call_duration)) AS avgDuration RETURN postcode, AVG(numCalls) AS avgCalls, AVG(avgDuration) AS overallAvgDuration",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 323,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_323",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 1, column 163 (offset: 162))\n\"MATCH (pc:PostCode)<-[:HAS_POSTCODE]-(l:Location)<-[:OCCURRED_AT]-(c:Crime)<-[:INVOLVED_IN]-(phc:PhoneCall) WITH pc.code AS postcode, COUNT(phc) AS numCalls, AVG(toInt(phc.call_duration)) AS avgDuration RETURN postcode, AVG(numCalls) AS avgCalls, AVG(avgDuration) AS overallAvgDuration\"\n                                                                                                                                                                   ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each person, what is the total number of crimes they are party to, and what is the average age of the people they know?",
    "Cypher": "MATCH (p1:Person)-[:PARTY_TO]->(c:Crime) WITH p1, COUNT(c) AS crimeCount MATCH (p1)-[:KNOWS]->(p2:Person) WITH p1, crimeCount, p2.age AS knownAge WHERE p2.age IS NOT NULL RETURN p1.name, crimeCount, AVG(toFloat(knownAge)) AS avgKnownAge",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 324,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_324",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each officer rank, what is the average number of crimes investigated by officers of that rank, and what is the average number of phone calls associated with those crimes?",
    "Cypher": "MATCH (o:Officer)-[:INVESTIGATED_BY]->(c:Crime) WITH o.rank AS officerRank, c MATCH (c)<-[:CALLED]-(phc:PhoneCall) WITH officerRank, c, COUNT(phc) AS numCalls RETURN officerRank, AVG(numCalls) AS avgCalls, COUNT(DISTINCT c) AS totalCrimes",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 326,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_326",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each person, calculate the total number of crimes they are party to, and the average age of the officers who investigated those crimes.",
    "Cypher": "MATCH (p:Person)-[:PARTY_TO]->(c:Crime)-[:INVESTIGATED_BY]->(o:Officer) WITH p, COUNT(c) AS crimeCount, o MATCH o, toInteger(p.age) AS personAge WITH o, AVG(personAge) AS avgPersonAge MATCH (c:Crime)-[:INVESTIGATED_BY]->(o:Officer) WITH o, crimeCount, avgPersonAge, toInteger(o.badge_no) AS officerBadgeNo WITH o, crimeCount, avgPersonAge, officerBadgeNo RETURN o.name, AVG(crimeCount), avgPersonAge",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 331,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_331",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input ',': expected a graph pattern (line 1, column 114 (offset: 113))\n\"MATCH (p:Person)-[:PARTY_TO]->(c:Crime)-[:INVESTIGATED_BY]->(o:Officer) WITH p, COUNT(c) AS crimeCount, o MATCH o, toInteger(p.age) AS personAge WITH o, AVG(personAge) AS avgPersonAge MATCH (c:Crime)-[:INVESTIGATED_BY]->(o:Officer) WITH o, crimeCount, avgPersonAge, toInteger(o.badge_no) AS officerBadgeNo WITH o, crimeCount, avgPersonAge, officerBadgeNo RETURN o.name, AVG(crimeCount), avgPersonAge\"\n                                                                                                                  ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each vehicle make, what is the average number of crimes they are involved in, and what is the average age of people who are party to those crimes?",
    "Cypher": "MATCH (v:Vehicle)-[:INVOLVED_IN]->(c:Crime)<-[:PARTY_TO]-(p:Person) WITH v.make AS vehicleMake, COUNT(DISTINCT c) AS crimeCount, p MATCH p WITH vehicleMake, AVG(crimeCount) AS avgCrimeCount, toInteger(p.age) AS personAge RETURN vehicleMake, avgCrimeCount, AVG(personAge)",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 333,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_333",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'WITH': expected a graph pattern (line 1, column 140 (offset: 139))\n\"MATCH (v:Vehicle)-[:INVOLVED_IN]->(c:Crime)<-[:PARTY_TO]-(p:Person) WITH v.make AS vehicleMake, COUNT(DISTINCT c) AS crimeCount, p MATCH p WITH vehicleMake, AVG(crimeCount) AS avgCrimeCount, toInteger(p.age) AS personAge RETURN vehicleMake, avgCrimeCount, AVG(personAge)\"\n                                                                                                                                            ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "What is the average age of people who have a family relationship with someone else in the database, grouped by the type of family relationship?",
    "Cypher": "MATCH (p1:Person)-[r:FAMILY_REL]->(p2:Person) WITH r.rel_type AS relationshipType, toInteger(p1.age) AS age WHERE age IS NOT NULL RETURN relationshipType, avg(age) AS averageAge",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 352,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_352",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "What is the average number of calls made to each phone number and the average call duration for those calls?",
    "Cypher": "MATCH (p:Phone)<-[:CALLED]-(c:PhoneCall) WITH p, count(c) AS callCount, avg(toInt(c.call_duration)) AS avgDuration RETURN p.phoneNo AS PhoneNumber, avg(callCount) AS AverageCallCount, avg(avgDuration) AS AverageCallDuration",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 357,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_357",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 1, column 77 (offset: 76))\n\"MATCH (p:Phone)<-[:CALLED]-(c:PhoneCall) WITH p, count(c) AS callCount, avg(toInt(c.call_duration)) AS avgDuration RETURN p.phoneNo AS PhoneNumber, avg(callCount) AS AverageCallCount, avg(avgDuration) AS AverageCallDuration\"\n                                                                             ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each type of crime, what is the average number of officers involved in investigations and the average number of objects involved?",
    "Cypher": "MATCH (cr:Crime)<-[:INVESTIGATED_BY]-(o:Officer) WITH cr, count(o) AS officerCount MATCH (cr)<-[:INVOLVED_IN]-(ob:Object) WITH cr, officerCount, count(ob) AS objectCount RETURN cr.type AS CrimeType, avg(officerCount) AS AverageOfficerCount, avg(objectCount) AS AverageObjectCount",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 358,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_358",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "What is the average number of crimes occurring at locations within each area, and what is the average number of people having current addresses in those areas?",
    "Cypher": "MATCH (l:Location)-[:LOCATION_IN_AREA]->(a:Area)<-[:CURRENT_ADDRESS]-(p:Person) WITH a, count(DISTINCT p) AS personCount MATCH (l)<-[:OCCURRED_AT]-(c:Crime) WITH a, personCount, count(DISTINCT c) AS crimeCount RETURN a.areaCode AS AreaCode, avg(crimeCount) AS AverageCrimeCount, avg(personCount) AS AveragePersonCount",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 359,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_359",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each officer rank, determine the average number of crimes investigated and the average number of vehicles involved in those crimes.",
    "Cypher": "MATCH (o:Officer)-[:INVESTIGATED_BY]->(c:Crime) WITH o, count(c) AS crimeCount MATCH (c)<-[:INVOLVED_IN]-(v:Vehicle) WITH o, crimeCount, count(v) AS vehicleCount RETURN o.rank AS OfficerRank, avg(crimeCount) AS AverageCrimeCount, avg(vehicleCount) AS AverageVehicleCount",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 360,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_360",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "Calculate the average number of phone calls originating from each area, and the average call duration for those calls, grouped by the area code.",
    "Cypher": "MATCH (pc:PhoneCall)-[:CALLER]->(p:Phone)<-[:HAS_PHONE]-(per:Person)-[:CURRENT_ADDRESS]->(l:Location)-[:LOCATION_IN_AREA]->(a:Area) WITH a, pc, toInt(pc.call_duration) AS callDuration MATCH (pc)-[:CALLER]->(p) WITH a, count(pc) AS callCount, avg(callDuration) AS avgDuration RETURN a.areaCode AS AreaCode, avg(callCount) AS AverageCallCount, avg(avgDuration) AS AverageCallDuration",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 361,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_361",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 1, column 145 (offset: 144))\n\"MATCH (pc:PhoneCall)-[:CALLER]->(p:Phone)<-[:HAS_PHONE]-(per:Person)-[:CURRENT_ADDRESS]->(l:Location)-[:LOCATION_IN_AREA]->(a:Area) WITH a, pc, toInt(pc.call_duration) AS callDuration MATCH (pc)-[:CALLER]->(p) WITH a, count(pc) AS callCount, avg(callDuration) AS avgDuration RETURN a.areaCode AS AreaCode, avg(callCount) AS AverageCallCount, avg(avgDuration) AS AverageCallDuration\"\n                                                                                                                                                 ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each person, determine the total duration of phone calls made to and from their phone numbers, then calculate the average total call duration across all people.",
    "Cypher": "MATCH (p:Person)-[:HAS_PHONE]->(ph:Phone)<-[:CALLER]-(pc:PhoneCall) WITH p, pc.call_duration AS duration UNION ALL MATCH (p:Person)-[:HAS_PHONE]->(ph:Phone)<-[:CALLED]-(pc:PhoneCall) WITH p, pc.call_duration AS duration WITH p, COLLECT(duration) AS durations WITH p, REDUCE(totalDuration = 0, dur IN durations | totalDuration + toInteger(dur)) AS totalCallDuration RETURN AVG(totalCallDuration)",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 373,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_373",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Query cannot conclude with WITH (must be a RETURN clause, a FINISH clause, an update clause, a unit subquery call, or a procedure call with no YIELD). (line 1, column 69 (offset: 68))\n\"MATCH (p:Person)-[:HAS_PHONE]->(ph:Phone)<-[:CALLER]-(pc:PhoneCall) WITH p, pc.call_duration AS duration UNION ALL MATCH (p:Person)-[:HAS_PHONE]->(ph:Phone)<-[:CALLED]-(pc:PhoneCall) WITH p, pc.call_duration AS duration WITH p, COLLECT(duration) AS durations WITH p, REDUCE(totalDuration = 0, dur IN durations | totalDuration + toInteger(dur)) AS totalCallDuration RETURN AVG(totalCallDuration)\"\n                                                                     ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each officer, find the average number of crimes they investigated and the average number of objects involved in those crimes, and then calculate the average of these averages across all officers.",
    "Cypher": "MATCH (o:Officer)-[:INVESTIGATED_BY]->(c:Crime) WITH o, c MATCH (c)-[:INVOLVED_IN]->(obj:Object) WITH o, COUNT(c) AS crimeCount, COUNT(obj) AS objectCount WITH o, crimeCount, objectCount RETURN AVG(crimeCount), AVG(objectCount)",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 374,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_374",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Content: Results only contain null or zero values.",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "Results returned successfully.",
    "neo4j_result_passed": 1,
    "content_validation": "Results only contain null or zero values.",
    "content_passed": 0
  },
  {
    "NL Question": "For each officer, determine the total number of crimes they investigated, and the average number of vehicles involved in those crimes.",
    "Cypher": "MATCH (o:Officer)-[:INVESTIGATED_BY]->(c:Crime) WITH o, c MATCH (v:Vehicle)-[:INVOLVED_IN]->(c) WITH o, c, collect(v) AS vehicles WITH o, collect(c) AS crimes, vehicles RETURN o.name, size(crimes) AS totalCrimes, avg(size(vehicles)) AS avgVehiclesPerCrime",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 382,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_382",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each officer rank, calculate the total number of crimes investigated and the average number of objects involved in those crimes. Return the officer rank, total crime count, and average object count.",
    "Cypher": "MATCH (o:Officer)-[:INVESTIGATED_BY]->(c:Crime)\nWITH o.rank AS officerRank, c\nMATCH (ob:Object)-[:INVOLVED_IN]->(c)\nWITH officerRank, c, COUNT(ob) AS objectCount\nRETURN officerRank, COUNT(DISTINCT c) AS totalCrimes, AVG(objectCount) AS averageObjectCount",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 395,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_395",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "What is the average number of crimes investigated by each officer, and what is the average number of locations where those crimes occurred?",
    "Cypher": "MATCH (o:Officer)-[:INVESTIGATED_BY]->(c:Crime) WITH o, COUNT(c) AS crimeCount MATCH (c:Crime)-[:OCCURRED_AT]->(l:Location) WITH o, crimeCount, COUNT(DISTINCT l) AS locationCount RETURN o.name, AVG(crimeCount) AS avgCrimes, AVG(locationCount) AS avgLocations",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 399,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_399",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each type of crime, what is the average number of involved objects and vehicles, and what is the average duration of phone calls made in relation to those crimes?",
    "Cypher": "MATCH (c:Crime)<-[:INVOLVED_IN]-(o:Object) WITH c, COUNT(o) AS objectCount MATCH (c)<-[:INVOLVED_IN]-(v:Vehicle) WITH c, objectCount, COUNT(v) AS vehicleCount MATCH (c)<-[:PARTY_TO]-(p:Person)-[:HAS_PHONE]->(ph:Phone)<-[:CALLED]-(pc:PhoneCall) WITH c, objectCount, vehicleCount, AVG(toFloat(pc.call_duration)) AS avgCallDuration RETURN c.type, AVG(objectCount) AS avgObjects, AVG(vehicleCount) AS avgVehicles, AVG(avgCallDuration) AS avgCallDuration",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 400,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_400",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "What is the average number of family members known by people living at locations with a specific postcode, and what is the average age of those family members?",
    "Cypher": "MATCH (l:Location {postcode: 'M43 7RE'})<-[:CURRENT_ADDRESS]-(p:Person)-[:FAMILY_REL]->(f:Person) WITH p, COUNT(f) AS familyCount, AVG(toFloat(f.age)) AS avgFamilyAge RETURN p.name, AVG(familyCount) AS avgFamilyMembers, AVG(avgFamilyAge) AS avgFamilyAge",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 401,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_401",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "What is the average call duration for each type of crime, considering only phone calls made within 7 days of the crime date?",
    "Cypher": "MATCH (c:Crime)<-[:PARTY_TO]-(p:Person)-[:HAS_PHONE]->(ph:Phone)<-[:CALLED]-(pc:PhoneCall) WHERE date(c.date) - date(pc.call_date) <= duration({days: 7}) WITH c.type AS crimeType, pc.call_duration AS callDuration RETURN crimeType, AVG(toInteger(callDuration)) AS averageCallDuration",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 409,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_409",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Type mismatch: expected Duration but was Date (line 1, column 113 (offset: 112))\n\"MATCH (c:Crime)<-[:PARTY_TO]-(p:Person)-[:HAS_PHONE]->(ph:Phone)<-[:CALLED]-(pc:PhoneCall) WHERE date(c.date) - date(pc.call_date) <= duration({days: 7}) WITH c.type AS crimeType, pc.call_duration AS callDuration RETURN crimeType, AVG(toInteger(callDuration)) AS averageCallDuration\"\n                                                                                                                 ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each officer rank, what is the average number of crimes investigated, and what is the average number of objects involved in those crimes?",
    "Cypher": "MATCH (o:Officer)-[:INVESTIGATED_BY]->(c:Crime) WITH o.rank AS officerRank, c MATCH (obj:Object)-[:INVOLVED_IN]->(c) WITH officerRank, c, COUNT(obj) AS objectCount WITH officerRank, COUNT(c) AS crimeCount, AVG(objectCount) AS avgObjectCount RETURN officerRank, AVG(crimeCount) AS averageCrimes, avgObjectCount",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 410,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_410",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each type of crime, what is the average number of objects involved and the average call duration of phone calls made in the area where the crime occurred?",
    "Cypher": "MATCH (c:Crime)<-[:INVOLVED_IN]-(o:Object), (c)-[:OCCURRED_AT]->(l:Location)<-[:HAS_POSTCODE]-(p:PostCode)<-[:POSTCODE_IN_AREA]-(a:Area)<-[:LOCATION_IN_AREA]-(loc:Location)<-[:CURRENT_ADDRESS]-(per:Person)-[:HAS_PHONE]->(ph:Phone)<-[:CALLED]-(pc:PhoneCall) WITH c.type AS crimeType, COUNT(o) AS objectCount, toFloat(pc.call_duration) AS call_duration, l.address as crime_address RETURN crimeType, AVG(objectCount) AS avgObjects, AVG(call_duration) AS avgCallDuration",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 414,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_414",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "What is the average number of crimes investigated by officers with the rank 'Police Constable', and what is the average number of crimes investigated by officers with a rank other than 'Police Constable'?",
    "Cypher": "MATCH (c:Crime)-[:INVESTIGATED_BY]->(o:Officer) WITH o.rank AS OfficerRank, COUNT(c) AS CrimeCount WITH OfficerRank, CrimeCount, CASE WHEN OfficerRank = 'Police Constable' THEN CrimeCount ELSE 0 END AS PC_Crimes, CASE WHEN OfficerRank <> 'Police Constable' THEN CrimeCount ELSE 0 END AS Other_Crimes WITH SUM(PC_Crimes) AS Total_PC_Crimes, SUM(Other_Crimes) AS Total_Other_Crimes, COUNT(DISTINCT CASE WHEN OfficerRank = 'Police Constable' THEN o.badge_no ELSE NULL END) AS PC_Count, COUNT(DISTINCT CASE WHEN OfficerRank <> 'Police Constable' THEN o.badge_no ELSE NULL END) AS Other_Count RETURN Total_PC_Crimes/PC_Count AS Avg_PC_Crimes, Total_Other_Crimes/Other_Count AS Avg_Other_Crimes",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 427,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_427",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `o` not defined (line 1, column 445 (offset: 444))\n\"MATCH (c:Crime)-[:INVESTIGATED_BY]->(o:Officer) WITH o.rank AS OfficerRank, COUNT(c) AS CrimeCount WITH OfficerRank, CrimeCount, CASE WHEN OfficerRank = 'Police Constable' THEN CrimeCount ELSE 0 END AS PC_Crimes, CASE WHEN OfficerRank <> 'Police Constable' THEN CrimeCount ELSE 0 END AS Other_Crimes WITH SUM(PC_Crimes) AS Total_PC_Crimes, SUM(Other_Crimes) AS Total_Other_Crimes, COUNT(DISTINCT CASE WHEN OfficerRank = 'Police Constable' THEN o.badge_no ELSE NULL END) AS PC_Count, COUNT(DISTINCT CASE WHEN OfficerRank <> 'Police Constable' THEN o.badge_no ELSE NULL END) AS Other_Count RETURN Total_PC_Crimes/PC_Count AS Avg_PC_Crimes, Total_Other_Crimes/Other_Count AS Avg_Other_Crimes\"\n                                                                                                                                                                                                                                                                                                                                                                                                                                                             ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each crime type, what is the average number of objects and vehicles involved?",
    "Cypher": "MATCH (c:Crime)<-[:INVOLVED_IN]-(o:Object) WITH c.type AS CrimeType, c, COUNT(o) AS ObjectCount MATCH (c)<-[:INVOLVED_IN]-(v:Vehicle) WITH CrimeType, ObjectCount, COUNT(v) AS VehicleCount RETURN CrimeType, avg(ObjectCount) AS AvgObjectCount, avg(VehicleCount) AS AvgVehicleCount",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 430,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_430",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each person, calculate the total number of phone calls made and received, and then determine the average call duration across all their calls. Return the person's name, total call count, and average call duration.",
    "Cypher": "MATCH (p:Person)-[:HAS_PHONE]->(ph:Phone)<-[:CALLER]-(pc:PhoneCall) WITH p, pc.call_duration AS duration UNION ALL MATCH (p:Person)-[:HAS_PHONE]->(ph:Phone)<-[:CALLED]-(pc:PhoneCall) WITH p, pc.call_duration AS duration WITH p, collect(duration) AS durations UNWIND durations AS dur WITH p.name AS personName, toInteger(dur) AS callDuration WHERE callDuration IS NOT NULL WITH personName, count(*) AS totalCalls, avg(callDuration) AS avgDuration RETURN personName, totalCalls, avgDuration",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 436,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_436",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Query cannot conclude with WITH (must be a RETURN clause, a FINISH clause, an update clause, a unit subquery call, or a procedure call with no YIELD). (line 1, column 69 (offset: 68))\n\"MATCH (p:Person)-[:HAS_PHONE]->(ph:Phone)<-[:CALLER]-(pc:PhoneCall) WITH p, pc.call_duration AS duration UNION ALL MATCH (p:Person)-[:HAS_PHONE]->(ph:Phone)<-[:CALLED]-(pc:PhoneCall) WITH p, pc.call_duration AS duration WITH p, collect(duration) AS durations UNWIND durations AS dur WITH p.name AS personName, toInteger(dur) AS callDuration WHERE callDuration IS NOT NULL WITH personName, count(*) AS totalCalls, avg(callDuration) AS avgDuration RETURN personName, totalCalls, avgDuration\"\n                                                                     ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each make of vehicle involved in crimes, calculate the total number of crimes and the average number of objects involved in those crimes. Return the vehicle make, total crime count, and average objects per crime.",
    "Cypher": "MATCH (v:Vehicle)-[:INVOLVED_IN]->(c:Crime) WITH v.make AS vehicleMake, c MATCH (o:Object)-[:INVOLVED_IN]->(c) WITH vehicleMake, c, count(o) AS objectCount WITH vehicleMake, c, objectCount WITH vehicleMake, count(c) AS totalCrimes, avg(objectCount) AS avgObjectsPerCrime RETURN vehicleMake, totalCrimes, avgObjectsPerCrime",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 437,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_437",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each officer rank, determine the total number of crimes investigated and the average duration of phone calls made to phones associated with persons involved in those crimes. Return the officer rank, total crime count, and average call duration.",
    "Cypher": "MATCH (o:Officer)-[:INVESTIGATED_BY]->(c:Crime)<-[:PARTY_TO]-(p:Person)-[:HAS_PHONE]->(ph:Phone)<-[:CALLER]-(pc:PhoneCall) WITH o.rank AS officerRank, c, pc.call_duration AS duration WITH officerRank, c, duration, toInteger(duration) AS callDuration WHERE callDuration IS NOT NULL WITH officerRank, c, callDuration WITH officerRank, count(c) AS totalCrimes, avg(callDuration) AS avgCallDuration RETURN officerRank, totalCrimes, avgCallDuration",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 438,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_438",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each person, calculate the total number of crimes they are a party to and the average age of all other persons they know. Return the person's name, total crimes, and average age of known persons.",
    "Cypher": "MATCH (p1:Person)-[:PARTY_TO]->(c:Crime) WITH p1, COUNT(c) AS totalCrimes MATCH (p1)-[:KNOWS]->(p2:Person) WITH p1.name AS personName, totalCrimes, p2.age AS knownPersonAge WHERE toInteger(knownPersonAge) IS NOT NULL WITH personName, totalCrimes, AVG(toInteger(knownPersonAge)) AS avgAgeOfKnownPersons RETURN personName, totalCrimes, avgAgeOfKnownPersons",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 451,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_451",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each postcode, determine the total number of people who currently live at locations with that postcode and the average number of phone numbers associated with those people. Return the postcode, total people, and average phone numbers per person.",
    "Cypher": "MATCH (l:Location)-[:HAS_POSTCODE]->(pc:PostCode)<-[:CURRENT_ADDRESS]-(p:Person)-[:HAS_PHONE]->(ph:Phone) WITH pc.code AS postcode, p, ph MATCH (l:Location)-[:HAS_POSTCODE]->(pc:PostCode)<-[:CURRENT_ADDRESS]-(p:Person) WHERE pc.code = postcode WITH postcode, COUNT(DISTINCT p) AS totalPeople, COUNT(DISTINCT ph) AS totalPhoneNumbers RETURN postcode, totalPeople, toFloat(totalPhoneNumbers)/totalPeople AS avgPhoneNumbersPerPerson",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 452,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_452",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each type of crime, find the average number of officers involved in the investigation and the total number of vehicles involved. Return the crime type, average officers, and total vehicles.",
    "Cypher": "MATCH (c:Crime)<-[:INVESTIGATED_BY]-(o:Officer) WITH c, COUNT(DISTINCT o) AS officerCount MATCH (c)<-[:INVOLVED_IN]-(v:Vehicle) WITH c, AVG(officerCount) AS avgOfficers, COUNT(DISTINCT v) AS vehicleCount RETURN c.type, avgOfficers, vehicleCount",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 457,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_457",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each officer with the rank 'Police Constable', find the average number of phone calls made to phones associated with persons they have investigated for crimes. Return the officer's name and the average number of calls.",
    "Cypher": "MATCH (o:Officer {rank: 'Police Constable'})-[:INVESTIGATED_BY]->(c:Crime)<-[:PARTY_TO]-(p:Person)-[:HAS_PHONE]->(ph:Phone)<-[:CALLED]-(pc:PhoneCall) WITH o, ph, COUNT(pc) AS callCount RETURN o.name, AVG(callCount)",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 459,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_459",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each officer rank, find the average number of crimes investigated and the average number of people known by the people involved in those crimes.",
    "Cypher": "MATCH (o:Officer)-[:INVESTIGATED_BY]->(c:Crime)<-[:PARTY_TO]-(p:Person)-[:KNOWS]->(k:Person)\nWITH o.rank AS officerRank, c, count(DISTINCT k) AS knownPeopleCount\nWITH officerRank, count(DISTINCT c) AS crimeCount, avg(knownPeopleCount) AS avgKnownPeople\nRETURN officerRank, avg(crimeCount) AS avgCrimesInvestigated, avgKnownPeople",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 464,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_464",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each crime type, what is the average number of objects involved and the average number of vehicles involved in crimes that occurred at locations within the 'SK' area codes?",
    "Cypher": "MATCH (c:Crime)-[:OCCURRED_AT]->(l:Location)-[:LOCATION_IN_AREA]->(a:Area)\nWHERE a.areaCode STARTS WITH 'SK'\nWITH c, a\nMATCH (c)<-[:INVOLVED_IN]-(o:Object)\nWITH c.type AS crimeType, c, count(o) AS objectCount\nMATCH (c)<-[:INVOLVED_IN]-(v:Vehicle)\nWITH crimeType, avg(objectCount) AS avgObjectCount, count(v) AS vehicleCount\nRETURN crimeType, avgObjectCount, avg(vehicleCount) AS avgVehicleCount",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 466,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_466",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each area code, what is the average number of crimes reported, and what is the average number of people who have a current address in that area?",
    "Cypher": "MATCH (l:Location)-[:LOCATION_IN_AREA]->(a:Area)\nWITH a, l\nMATCH (p:Person)-[:CURRENT_ADDRESS]->(l)\nWITH a, count(DISTINCT p) AS personCount\nMATCH (c:Crime)-[:OCCURRED_AT]->(l)\nWHERE l-[:LOCATION_IN_AREA]->a\nWITH a, personCount, count(DISTINCT c) AS crimeCount\nRETURN a.areaCode, avg(crimeCount) AS averageCrimes, avg(personCount) AS averagePeople",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 477,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_477",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input ':': expected an expression (line 6, column 10 (offset: 186))\n\"WHERE l-[:LOCATION_IN_AREA]->a\"\n          ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each person, what is the total call duration of calls made to their phone, and what is the average call duration of those calls?",
    "Cypher": "MATCH (p:Person)-[:HAS_PHONE]->(ph:Phone)<-[:CALLED]-(pc:PhoneCall)\nWITH p, pc\nRETURN p.name, sum(toInt(pc.call_duration)) AS totalCallDuration, avg(toInt(pc.call_duration)) AS averageCallDuration",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 478,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_478",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 3, column 20 (offset: 98))\n\"RETURN p.name, sum(toInt(pc.call_duration)) AS totalCallDuration, avg(toInt(pc.call_duration)) AS averageCallDuration\"\n                    ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each type of crime, what is the average number of officers involved in the investigations and the average duration of phone calls made related to these crimes?",
    "Cypher": "MATCH (c:Crime)<-[:INVESTIGATED_BY]-(o:Officer)\nWITH c.type AS crimeType, c, count(o) AS numOfficers\nMATCH (phc:PhoneCall)-[:CALLED]->(ph:Phone)<-[:HAS_PHONE]-(p:Person)-[:PARTY_TO]->(c)\nWITH crimeType, avg(numOfficers) AS avgOfficers, avg(toFloat(phc.call_duration)) AS avgCallDuration\nRETURN crimeType, avgOfficers, avgCallDuration",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 483,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_483",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each area, what is the average number of crimes that occurred and the average number of people who have a current address in that area?",
    "Cypher": "MATCH (l:Location)-[:LOCATION_IN_AREA]->(a:Area)<-[:OCCURRED_AT]-(c:Crime)\nWITH a.areaCode AS areaCode, a, count(c) AS crimeCount\nMATCH (p:Person)-[:CURRENT_ADDRESS]->(l2:Location)-[:LOCATION_IN_AREA]->(a)\nWITH areaCode, avg(crimeCount) AS avgCrimeCount, count(DISTINCT p) AS personCount\nRETURN areaCode, avgCrimeCount, avg(personCount)",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 485,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_485",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each officer, calculate the average number of crimes they investigated where the outcome was 'Under investigation', and also determine the average number of objects involved in those crimes.",
    "Cypher": "MATCH (o:Officer)-[:INVESTIGATED_BY]->(c:Crime {last_outcome: 'Under investigation'})<-[:INVOLVED_IN]-(ob:Object)\nWITH o, c, count(ob) AS objectCount\nWITH o, count(c) AS crimeCount, avg(objectCount) AS avgObjectCount\nRETURN o.name, avg(crimeCount), avgObjectCount",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 487,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_487",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each type of object involved in crimes, calculate the total number of crimes and the average number of vehicles also involved in those crimes.",
    "Cypher": "MATCH (o:Object)-[:INVOLVED_IN]->(c:Crime)<-[:INVOLVED_IN]-(v:Vehicle) WITH o.type AS objectType, COUNT(DISTINCT c) AS numCrimes, COUNT(DISTINCT v) AS numVehicles WITH objectType, numCrimes, AVG(numVehicles) AS avgVehicles RETURN objectType, numCrimes, avgVehicles",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 493,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_493",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each officer rank, determine the total number of crimes they have investigated and the average number of people known by individuals involved in those crimes.",
    "Cypher": "MATCH (o:Officer)<-[:INVESTIGATED_BY]-(c:Crime)-[:PARTY_TO]->(p1:Person)-[:KNOWS]->(p2:Person) WITH o.rank AS officerRank, COUNT(DISTINCT c) AS numCrimes, COUNT(DISTINCT p2) AS numKnownPeople WITH officerRank, numCrimes, AVG(numKnownPeople) AS avgKnownPeople RETURN officerRank, numCrimes, avgKnownPeople",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 494,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_494",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "What is the average call duration for phone calls made to each phone number, and what is the total number of calls made to those numbers?",
    "Cypher": "MATCH (pc:PhoneCall)-[:CALLED]->(ph:Phone) WITH ph, pc.call_duration AS duration WHERE duration IS NOT NULL RETURN ph.phoneNo, AVG(toFloat(duration)), COUNT(pc)",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 499,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_499",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `pc` not defined (line 1, column 158 (offset: 157))\n\"MATCH (pc:PhoneCall)-[:CALLED]->(ph:Phone) WITH ph, pc.call_duration AS duration WHERE duration IS NOT NULL RETURN ph.phoneNo, AVG(toFloat(duration)), COUNT(pc)\"\n                                                                                                                                                              ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each type of crime, what is the average age of people involved in that crime, and what is the total number of objects involved?",
    "Cypher": "MATCH (p:Person)-[:PARTY_TO]->(c:Crime) WITH c, p MATCH (o:Object)-[:INVOLVED_IN]->(c) WITH c, p, count(o) AS objectCount WHERE p.age IS NOT NULL RETURN c.type, AVG(toFloat(p.age)), SUM(objectCount)",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 500,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_500",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each officer rank, calculate the average number of crimes investigated and the total number of distinct locations where those crimes occurred.",
    "Cypher": "MATCH (o:Officer)-[:INVESTIGATED_BY]->(c:Crime) WITH o.rank AS officerRank, c MATCH (c)-[:OCCURRED_AT]->(l:Location) WITH officerRank, COUNT(DISTINCT c) AS crimeCount, COUNT(DISTINCT l) AS locationCount RETURN officerRank, AVG(crimeCount) AS avgCrimeCount, SUM(locationCount) AS totalLocationCount",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 507,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_507",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each person, what is the total number of distinct phone numbers they 'HAS_PHONE' and 'KNOWS_PHONE', and what is the average age of the people they 'KNOWS'?",
    "Cypher": "MATCH (p:Person)-[:HAS_PHONE]->(ph:Phone) WITH p, COLLECT(DISTINCT ph.phoneNo) AS hasPhones MATCH (p)-[:KNOWS_PHONE]->(p2:Person) WITH p, hasPhones, COLLECT(DISTINCT p2) AS knownPeople MATCH (p)-[:KNOWS]->(p3:Person) WITH p, hasPhones, knownPeople, COLLECT(DISTINCT p3) AS knowsPeopleUnfiltered WITH p, hasPhones, knownPeople + knowsPeopleUnfiltered AS allKnownPeople WITH p, SIZE(hasPhones) AS numPhones, [person IN allKnownPeople WHERE person.age IS NOT NULL | toInteger(person.age)] AS validAges RETURN p.name, p.surname, numPhones, REDUCE(s = 0, age IN validAges | s + age) * 1.0 / SIZE(validAges) AS averageAge",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 513,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_513",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Runtime Error: {code: Neo.ClientError.Statement.ArithmeticError} {message: / by zero}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each officer rank, what is the average number of crimes investigated by officers of that rank, and what is the average number of people who are party to those crimes?",
    "Cypher": "MATCH (o:Officer)-[:INVESTIGATED_BY]->(c:Crime) WITH o, c MATCH (p:Person)-[:PARTY_TO]->(c) WITH o, c, count(p) AS people_count WITH o.rank AS officerRank, count(DISTINCT c) AS crimeCount, avg(people_count) AS avgPeoplePerCrime RETURN officerRank, AVG(crimeCount), avgPeoplePerCrime",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 515,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_515",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each crime type, calculate the average number of objects involved and the average number of vehicles involved.",
    "Cypher": "MATCH (o:Object)-[:INVOLVED_IN]->(c:Crime) WITH c, COUNT(o) AS objectCount MATCH (v:Vehicle)-[:INVOLVED_IN]->(c) WITH c, objectCount, COUNT(v) AS vehicleCount RETURN c.type, AVG(objectCount) AS averageObjects, AVG(vehicleCount) AS averageVehicles",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 521,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_521",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each area code, what is the average number of residents' phones that have made calls, and what is the average call duration?",
    "Cypher": "MATCH (l:Location)-[:LOCATION_IN_AREA]->(a:Area) WITH l, a MATCH (p:Person)-[:CURRENT_ADDRESS]->(l) WITH p, a MATCH (p)-[:HAS_PHONE]->(ph:Phone) WITH ph, a MATCH (ph)-[:CALLER]-(pc:PhoneCall) WITH a, COUNT(DISTINCT ph) AS phoneCount, AVG(toInt(pc.call_duration)) AS avgDuration RETURN a.areaCode, AVG(phoneCount) AS avgPhonesPerArea, AVG(avgDuration) AS averageCallDuration;",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 526,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_526",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 1, column 239 (offset: 238))\n\"MATCH (l:Location)-[:LOCATION_IN_AREA]->(a:Area) WITH l, a MATCH (p:Person)-[:CURRENT_ADDRESS]->(l) WITH p, a MATCH (p)-[:HAS_PHONE]->(ph:Phone) WITH ph, a MATCH (ph)-[:CALLER]-(pc:PhoneCall) WITH a, COUNT(DISTINCT ph) AS phoneCount, AVG(toInt(pc.call_duration)) AS avgDuration RETURN a.areaCode, AVG(phoneCount) AS avgPhonesPerArea, AVG(avgDuration) AS averageCallDuration;\"\n                                                                                                                                                                                                                                               ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "What is the average number of phone calls made to phones associated with people who know someone who has been party to a crime, and what is the average duration of those calls?",
    "Cypher": "MATCH (p1:Person)-[:KNOWS]->(p2:Person)-[:PARTY_TO]->(c:Crime) WITH p1 MATCH (p1)-[:HAS_PHONE]->(ph:Phone) WITH ph MATCH (pc:PhoneCall)-[:CALLED]->(ph) WITH COUNT(DISTINCT pc) AS callCount, toInt(pc.call_duration) AS callDuration RETURN AVG(callCount) AS avgCallsToKnownCriminals, AVG(callDuration) AS avgCallDuration;",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 529,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_529",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 1, column 191 (offset: 190))\n\"MATCH (p1:Person)-[:KNOWS]->(p2:Person)-[:PARTY_TO]->(c:Crime) WITH p1 MATCH (p1)-[:HAS_PHONE]->(ph:Phone) WITH ph MATCH (pc:PhoneCall)-[:CALLED]->(ph) WITH COUNT(DISTINCT pc) AS callCount, toInt(pc.call_duration) AS callDuration RETURN AVG(callCount) AS avgCallsToKnownCriminals, AVG(callDuration) AS avgCallDuration;\"\n                                                                                                                                                                                               ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each type of crime, what is the average number of officers involved in the investigations and the average duration of phone calls made in relation to those crimes?",
    "Cypher": "MATCH (c:Crime)<-[:INVESTIGATED_BY]-(o:Officer)\nWITH c, COUNT(o) AS officerCount\nOPTIONAL MATCH (c)<-[:INVOLVED_IN]-(obj:Object)<-[:CALLED]-(pc:PhoneCall)\nWITH c, officerCount, AVG(toFloat(pc.call_duration)) AS avgCallDuration\nRETURN c.type AS CrimeType, AVG(officerCount) AS AvgOfficers, avgCallDuration",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 532,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_532",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each officer, what is the average number of crimes investigated and the average age of persons involved in those crimes?",
    "Cypher": "MATCH (o:Officer)-[:INVESTIGATED_BY]->(c:Crime)<-[:PARTY_TO]-(p:Person)\nWITH o, c, p\nWITH o, c, AVG(toFloat(p.age)) AS avgPersonAge\nWITH o, COUNT(DISTINCT c) AS crimeCount, AVG(avgPersonAge) AS avgCrimeAge\nRETURN o.name + ' ' + o.surname AS OfficerName, AVG(crimeCount) AS AverageCrimesInvestigated, avgCrimeAge AS AverageAgeOfInvolvedPersons",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 535,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_535",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each area, calculate the total number of people living in locations within that area, and then determine the average age of those people.",
    "Cypher": "MATCH (l:Location)-[:LOCATION_IN_AREA]->(a:Area)<-[:CURRENT_ADDRESS]-(p:Person) WITH a, p.age AS age WHERE age IS NOT NULL RETURN a.areaCode, AVG(toFloat(age)) AS averageAge",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 543,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_543",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each officer rank, find the average number of crimes investigated and the average number of phone calls made to phones associated with people involved in those crimes. Return the officer rank, average crimes investigated, and average phone calls.",
    "Cypher": "MATCH (o:Officer)-[:INVESTIGATED_BY]->(c:Crime) WITH o.rank AS officerRank, c MATCH (c)<-[:PARTY_TO]-(p:Person)-[:HAS_PHONE]->(ph:Phone)<-[:CALLED]-(pc:PhoneCall) WITH officerRank, COUNT(DISTINCT c) AS crimeCount, COUNT(DISTINCT pc) AS callCount RETURN officerRank, AVG(crimeCount) AS avgCrimesInvestigated, AVG(callCount) AS avgPhoneCalls",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 547,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_547",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each area, determine the average number of crimes that occurred and the average age of persons with current addresses in that area. Return the area code, average crime count, and average person age.",
    "Cypher": "MATCH (a:Area)<-[:LOCATION_IN_AREA]-(l:Location)<-[:OCCURRED_AT]-(c:Crime) WITH a.areaCode AS areaCode, a, COUNT(DISTINCT c) AS crimeCount MATCH (p:Person)-[:CURRENT_ADDRESS]->(l) WITH areaCode, AVG(toInt(p.age)) AS avgPersonAge, AVG(crimeCount) AS avgCrimeCount RETURN areaCode, avgCrimeCount, avgPersonAge",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 548,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_548",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 1, column 200 (offset: 199))\n\"MATCH (a:Area)<-[:LOCATION_IN_AREA]-(l:Location)<-[:OCCURRED_AT]-(c:Crime) WITH a.areaCode AS areaCode, a, COUNT(DISTINCT c) AS crimeCount MATCH (p:Person)-[:CURRENT_ADDRESS]->(l) WITH areaCode, AVG(toInt(p.age)) AS avgPersonAge, AVG(crimeCount) AS avgCrimeCount RETURN areaCode, avgCrimeCount, avgPersonAge\"\n                                                                                                                                                                                                        ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each vehicle make, calculate the total number of crimes the vehicles were involved in and the average age of persons who are party to those crimes. Return the vehicle make, total crime count, and average person age.",
    "Cypher": "MATCH (v:Vehicle)-[:INVOLVED_IN]->(c:Crime) WITH v.make AS vehicleMake, c MATCH (c)<-[:PARTY_TO]-(p:Person) WITH vehicleMake, COUNT(DISTINCT c) AS crimeCount, toInt(p.age) AS personAge RETURN vehicleMake, crimeCount, AVG(personAge)",
    "source_dataset": "pole",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 550,
    "unique_id": "pole_data_3_1_2_6_Complex_Aggregation_550",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 1, column 160 (offset: 159))\n\"MATCH (v:Vehicle)-[:INVOLVED_IN]->(c:Crime) WITH v.make AS vehicleMake, c MATCH (c)<-[:PARTY_TO]-(p:Person) WITH vehicleMake, COUNT(DISTINCT c) AS crimeCount, toInt(p.age) AS personAge RETURN vehicleMake, crimeCount, AVG(personAge)\"\n                                                                                                                                                                ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "What is the average call duration for calls made on each day of the week?",
    "Cypher": "MATCH (pc:PhoneCall) WITH pc, date(pc.call_date) AS callDate WITH pc, dayOfWeek(callDate) AS dayOfWeek WITH dayOfWeek, toInteger(pc.call_duration) AS duration WHERE duration IS NOT NULL RETURN dayOfWeek, AVG(duration) AS averageDuration",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 9,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_9",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'dayOfWeek' (line 1, column 71 (offset: 70))\n\"MATCH (pc:PhoneCall) WITH pc, date(pc.call_date) AS callDate WITH pc, dayOfWeek(callDate) AS dayOfWeek WITH dayOfWeek, toInteger(pc.call_duration) AS duration WHERE duration IS NOT NULL RETURN dayOfWeek, AVG(duration) AS averageDuration\"\n                                                                       ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each area, calculate the total number of people living in locations within that area and the average number of phones associated with those people.",
    "Cypher": "MATCH (l:Location)-[:LOCATION_IN_AREA]->(a:Area)<-[:CURRENT_ADDRESS]-(p:Person)\nWITH a, COUNT(DISTINCT p) AS personCount, p\nMATCH (p)-[:HAS_PHONE]->(ph:Phone)\nWITH a, personCount, COUNT(DISTINCT ph) AS phoneCount\nRETURN a.areaCode, personCount, AVG(phoneCount) AS avgPhonesPerPerson",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 15,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_15",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each officer, calculate the total number of crimes they investigated and the average number of objects involved in those crimes.",
    "Cypher": "MATCH (o:Officer)-[:INVESTIGATED_BY]->(c:Crime)\nWITH o, COUNT(DISTINCT c) AS crimeCount, c\nMATCH (obj:Object)-[:INVOLVED_IN]->(c)\nWITH o, crimeCount, COUNT(DISTINCT obj) AS objectCount\nRETURN o.name, crimeCount, AVG(objectCount) AS avgObjectsPerCrime",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 18,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_18",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each type of crime, calculate the average number of officers involved in the investigations and the average number of objects involved. Return the crime type, average number of officers, and average number of objects.",
    "Cypher": "MATCH (c:Crime)<-[:INVESTIGATED_BY]-(o:Officer)\nWITH c.type AS crimeType, COUNT(DISTINCT o) AS officerCount, c\nMATCH (c)<-[:INVOLVED_IN]-(obj:Object)\nWITH crimeType, officerCount, COUNT(DISTINCT obj) AS objectCount\nRETURN crimeType, avg(officerCount) AS avgOfficers, avg(objectCount) AS avgObjects",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 21,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_21",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each officer rank, what is the average number of crimes investigated, and what is the average number of distinct locations where those crimes occurred?",
    "Cypher": "MATCH (o:Officer)-[:INVESTIGATED_BY]->(c:Crime)-[:OCCURRED_AT]->(l:Location) WITH o.rank AS officerRank, COUNT(DISTINCT c) AS crimeCount, COUNT(DISTINCT l) AS locationCount RETURN officerRank, AVG(toFloat(crimeCount)) AS averageCrimes, AVG(toFloat(locationCount)) AS averageLocations",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 46,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_46",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each type of crime, calculate the average number of officers involved in the investigations and the average number of objects involved. Return the crime type, average officers, and average objects.",
    "Cypher": "MATCH (c:Crime)<-[:INVESTIGATED_BY]-(o:Officer) WITH c.type AS crimeType, COUNT(DISTINCT o) AS officerCount MATCH (c:Crime)<-[:INVOLVED_IN]-(ob:Object) WITH crimeType, officerCount, COUNT(DISTINCT ob) AS objectCount RETURN crimeType, avg(officerCount), avg(objectCount)",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 49,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_49",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each officer rank, find the average number of crimes investigated by officers of that rank and the average number of vehicles involved in those crimes. Return the officer rank, average crime count, and average vehicle count.",
    "Cypher": "MATCH (o:Officer)-[:INVESTIGATED_BY]->(c:Crime) WITH o.rank AS officerRank, c MATCH (v:Vehicle)-[:INVOLVED_IN]->(c) WITH officerRank, c, COUNT(v) AS vehicleCount WITH officerRank, COUNT(DISTINCT c) AS crimeCount, avg(vehicleCount) AS avgVehicleCount RETURN officerRank, avg(crimeCount), avgVehicleCount",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 53,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_53",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each officer rank, find the average number of crimes investigated and the average number of vehicles involved in those crimes.",
    "Cypher": "MATCH (o:Officer)-[:INVESTIGATED_BY]->(c:Crime) WITH o.rank AS officerRank, c MATCH (c)-[:INVOLVED_IN]->(v:Vehicle) WITH officerRank, c, COUNT(v) AS vehicleCount WITH officerRank, COUNT(c) AS crimeCount, AVG(vehicleCount) AS avgVehicleCount RETURN officerRank, AVG(crimeCount) AS avgCrimeCount, avgVehicleCount",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 58,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_58",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each area, determine the total number of crimes that occurred and the average age of persons involved in those crimes. Return the area code, total crime count, and average age.",
    "Cypher": "MATCH (a:Area)<-[:LOCATION_IN_AREA]-(l:Location)<-[:OCCURRED_AT]-(c:Crime)\nWITH a, count(c) AS crimeCount\nMATCH (c)<-[:PARTY_TO]-(p:Person)\nWHERE p.age IS NOT NULL\nWITH a, crimeCount, toInteger(p.age) AS personAge\nRETURN a.areaCode, crimeCount, avg(personAge)",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 65,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_65",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each vehicle make, determine the total number of crimes the vehicles of that make were involved in and the average number of objects related to those crimes. Return the vehicle make, total crime count, and average object count.",
    "Cypher": "MATCH (v:Vehicle)-[:INVOLVED_IN]->(c:Crime)\nWITH v.make AS vehicleMake, c\nWITH vehicleMake, count(c) AS crimeCount, c\nMATCH (c)<-[:INVOLVED_IN]-(o:Object)\nWITH vehicleMake, crimeCount, count(o) AS objectCount\nRETURN vehicleMake, crimeCount, avg(objectCount)",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 67,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_67",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "Calculate the average number of crimes investigated by officers with each rank and the average number of objects involved in those crimes.",
    "Cypher": "MATCH (o:Officer)-[:INVESTIGATED_BY]->(c:Crime)\nWITH o.rank AS officerRank, c\nMATCH (c)-[:INVOLVED_IN]->(ob:Object)\nWITH officerRank, c, COUNT(ob) AS numObjects\nRETURN officerRank, AVG(numObjects) AS avgObjects",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 73,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_73",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each area code, what is the average number of phone calls made to phones within that area, and what is the total duration of these calls?",
    "Cypher": "MATCH (pc:PostCode)-[:POSTCODE_IN_AREA]->(a:Area)<-[:HAS_POSTCODE]-(l:Location)<-[:CURRENT_ADDRESS]-(p:Person)-[:HAS_PHONE]->(ph:Phone)<-[:CALLED]-(pc2:PhoneCall) WITH a.areaCode AS areaCode, COUNT(pc2) AS callCount, SUM(toInteger(pc2.call_duration)) AS totalDuration RETURN areaCode, AVG(callCount) AS averageCalls, SUM(totalDuration) AS totalCallDuration",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 85,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_85",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each person, find the total number of phone calls they are involved in (either as caller or callee) and the average call duration. Return the person's name, total calls, and average call duration.",
    "Cypher": "MATCH (p:Person)-[:HAS_PHONE]->(ph:Phone)<-[:CALLER]-(pc:PhoneCall) WITH p, pc.call_duration AS callDuration UNION ALL MATCH (p:Person)-[:HAS_PHONE]->(ph:Phone)<-[:CALLED]-(pc:PhoneCall) WITH p, pc.call_duration AS callDuration WITH p, COLLECT(callDuration) AS allCallDurations WITH p.name AS personName, SIZE(allCallDurations) AS totalCalls, REDUCE(s = 0, dur IN allCallDurations | s + toInteger(dur)) * 1.0 / SIZE(allCallDurations) AS avgCallDuration RETURN personName, totalCalls, avgCallDuration",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 100,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_100",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Query cannot conclude with WITH (must be a RETURN clause, a FINISH clause, an update clause, a unit subquery call, or a procedure call with no YIELD). (line 1, column 69 (offset: 68))\n\"MATCH (p:Person)-[:HAS_PHONE]->(ph:Phone)<-[:CALLER]-(pc:PhoneCall) WITH p, pc.call_duration AS callDuration UNION ALL MATCH (p:Person)-[:HAS_PHONE]->(ph:Phone)<-[:CALLED]-(pc:PhoneCall) WITH p, pc.call_duration AS callDuration WITH p, COLLECT(callDuration) AS allCallDurations WITH p.name AS personName, SIZE(allCallDurations) AS totalCalls, REDUCE(s = 0, dur IN allCallDurations | s + toInteger(dur)) * 1.0 / SIZE(allCallDurations) AS avgCallDuration RETURN personName, totalCalls, avgCallDuration\"\n                                                                     ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each area code, what is the average number of locations within that area, and what is the average number of phone calls made to phones associated with those locations?",
    "Cypher": "MATCH (a:Area)<-[:LOCATION_IN_AREA]-(l:Location)-[:HAS_PHONE]-(p:Phone)<-[:CALLED]-(pc:PhoneCall) WITH a, l, p, count(pc) AS callCount MATCH (a)<-[:LOCATION_IN_AREA]-(loc:Location) WITH a, loc, avg(callCount) AS avgCallCount, count(loc) AS locationCount RETURN a.areaCode, avg(locationCount) AS avgLocationsPerArea, avgCallCount",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 106,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_106",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "What is the average age of people who have a family relationship with other people, grouped by the type of family relationship?",
    "Cypher": "MATCH (p1:Person)-[r:FAMILY_REL]->(p2:Person) WITH r.rel_type AS relationshipType, toInteger(p1.age) AS age WHERE p1.age IS NOT NULL WITH relationshipType, AVG(age) AS averageAge RETURN relationshipType, averageAge",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 121,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_121",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each make of vehicle involved in crimes, what is the average number of crimes and the average number of objects involved in those crimes?",
    "Cypher": "MATCH (v:Vehicle)-[:INVOLVED_IN]->(c:Crime) WITH v.make AS vehicleMake, c MATCH (c)-[:INVOLVED_IN]-(o:Object) WITH vehicleMake, c, COUNT(o) AS objectCountPerCrime WITH vehicleMake, COUNT(c) AS crimeCount, AVG(objectCountPerCrime) AS avgObjectsPerCrime RETURN vehicleMake, crimeCount, avgObjectsPerCrime",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 122,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_122",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each area code, what is the average number of crimes that occurred at locations within that area, and what is the average call duration of phone calls made to phones associated with people living in those locations?",
    "Cypher": "MATCH (c:Crime)-[:OCCURRED_AT]->(l:Location)-[:LOCATION_IN_AREA]->(a:Area) WITH a, COUNT(c) AS crimeCount MATCH (p:Person)-[:CURRENT_ADDRESS]->(l)-[:LOCATION_IN_AREA]->(a) -[:HAS_PHONE]->(ph:Phone)<-[:CALLED]-(pc:PhoneCall) WITH a, crimeCount, toInteger(pc.call_duration) AS duration WHERE pc.call_duration IS NOT NULL WITH a, crimeCount, AVG(duration) AS avgDuration RETURN a.areaCode, crimeCount, avgDuration",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 123,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_123",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each type of crime, calculate the average number of officers investigating the crime and the average number of objects involved in the crime. Return the crime type, average number of investigating officers, and average number of involved objects.",
    "Cypher": "MATCH (c:Crime)<-[:INVESTIGATED_BY]-(o:Officer) WITH c, count(o) AS officerCount MATCH (c)<-[:INVOLVED_IN]-(obj:Object) WITH c, officerCount, count(obj) AS objectCount RETURN c.type AS crimeType, avg(officerCount) AS avgOfficers, avg(objectCount) AS avgObjects",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 126,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_126",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each area code, determine the average number of locations within that area and the average number of phone calls made to phones within those locations. Return the area code, the average number of locations, and the average number of phone calls.",
    "Cypher": "MATCH (l:Location)-[:LOCATION_IN_AREA]->(a:Area) WITH a, count(l) AS locationCount MATCH (l)-[:HAS_POSTCODE]->(p:PostCode)<-[:CALLED]-(pc:PhoneCall) WITH a, locationCount, count(pc) AS callCount RETURN a.areaCode AS areaCode, avg(locationCount) AS avgLocations, avg(callCount) AS avgCalls",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 127,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_127",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each officer, calculate the total number of crimes investigated and the average age of people involved in those crimes. Return the officer's name, total crimes investigated, and average age of involved people.",
    "Cypher": "MATCH (o:Officer)<-[:INVESTIGATED_BY]-(c:Crime)-[:PARTY_TO]->(p:Person) WITH o, c, p.age AS age WHERE age IS NOT NULL WITH o, count(c) AS crimeCount, avg(toFloat(age)) AS avgAge RETURN o.name AS officerName, crimeCount, avgAge",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 129,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_129",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each officer rank, calculate the average number of crimes investigated by officers of that rank and the average call duration of phone calls made to phones associated with persons involved in those crimes.",
    "Cypher": "MATCH (o:Officer)-[:INVESTIGATED_BY]->(c:Crime) WITH o.rank AS officerRank, c MATCH (p:Person)-[:PARTY_TO]->(c) WITH officerRank, p MATCH (p)-[:HAS_PHONE]->(ph:Phone) WITH officerRank, ph MATCH (ph)<-[:CALLED]-(pc:PhoneCall) WITH officerRank, c, toInteger(pc.call_duration) AS callDuration RETURN officerRank, count(DISTINCT c) AS crimeCount, avg(callDuration) AS avgCallDuration",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 136,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_136",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `c` not defined (line 1, column 244 (offset: 243))\n\"MATCH (o:Officer)-[:INVESTIGATED_BY]->(c:Crime) WITH o.rank AS officerRank, c MATCH (p:Person)-[:PARTY_TO]->(c) WITH officerRank, p MATCH (p)-[:HAS_PHONE]->(ph:Phone) WITH officerRank, ph MATCH (ph)<-[:CALLED]-(pc:PhoneCall) WITH officerRank, c, toInteger(pc.call_duration) AS callDuration RETURN officerRank, count(DISTINCT c) AS crimeCount, avg(callDuration) AS avgCallDuration\"\n                                                                                                                                                                                                                                                    ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each type of crime, calculate the average number of objects involved and the average call duration of phone calls related to phones used in these crimes. Return the crime type, the average number of objects, and the average call duration.",
    "Cypher": "MATCH (c:Crime)<-[:INVOLVED_IN]-(o:Object)\nWITH c, avg(toFloat(size(collect(o)))) AS avgObjects, c.type AS crimeType\nMATCH (c)<-[:PARTY_TO]-(p:Person)-[:HAS_PHONE]->(ph:Phone)<-[:CALLED]-(pc:PhoneCall)\nWITH crimeType, avgObjects, avg(toFloat(pc.call_duration)) AS avgCallDuration\nRETURN crimeType, avgObjects, avgCallDuration",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 140,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_140",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Can't use aggregate functions inside of aggregate functions. (line 2, column 26 (offset: 68))\n\"WITH c, avg(toFloat(size(collect(o)))) AS avgObjects, c.type AS crimeType\"\n                          ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "Calculate the average number of phone calls made from each postcode area and the average call duration for each area.",
    "Cypher": "MATCH (pc:PostCode)<-[:HAS_POSTCODE]-(l:Location)<-[:CALLED]-(p:PhoneCall)\nWITH pc.code AS postcode, p\nWITH postcode, COUNT(p) AS numCalls, AVG(toInt(p.call_duration)) AS avgDuration\nRETURN postcode, AVG(numCalls) AS avgCalls, AVG(avgDuration) AS avgCallDuration",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 148,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_148",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 3, column 42 (offset: 144))\n\"WITH postcode, COUNT(p) AS numCalls, AVG(toInt(p.call_duration)) AS avgDuration\"\n                                          ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each person, determine the total number of distinct phone numbers they know through other people and the average age of those people they know by phone.",
    "Cypher": "MATCH (p1:Person)-[:KNOWS_PHONE]->(p2:Person)-[:HAS_PHONE]->(ph:Phone) WITH p1, p2, collect(DISTINCT ph.phoneNo) AS knownPhones WHERE p2.age IS NOT NULL WITH p1, size(knownPhones) AS phoneCount, toInteger(p2.age) AS ageSum RETURN p1.name, p1.surname, phoneCount, AVG(ageSum) AS avgAge",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 156,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_156",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "Calculate the average number of phone calls made to each phone number, grouped by the type of call, and then find the maximum of these average call counts across all call types.",
    "Cypher": "MATCH (pc:PhoneCall)-[:CALLED]->(ph:Phone) WITH ph.phoneNo AS phoneNumber, pc.call_type AS callType, COUNT(*) AS callCount GROUP BY phoneNumber, callType WITH callType, AVG(callCount) AS avgCallCount RETURN MAX(avgCallCount)",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 157,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_157",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'GROUP': expected 'FOREACH', ',', 'ORDER BY', 'CALL', 'CREATE', 'LOAD CSV', 'DELETE', 'DETACH', 'FINISH', 'INSERT', 'LIMIT', 'MATCH', 'MERGE', 'NODETACH', 'OFFSET', 'OPTIONAL', 'REMOVE', 'RETURN', 'SET', 'SKIP', 'UNION', 'UNWIND', 'USE', 'WHERE', 'WITH' or <EOF> (line 1, column 124 (offset: 123))\n\"MATCH (pc:PhoneCall)-[:CALLED]->(ph:Phone) WITH ph.phoneNo AS phoneNumber, pc.call_type AS callType, COUNT(*) AS callCount GROUP BY phoneNumber, callType WITH callType, AVG(callCount) AS avgCallCount RETURN MAX(avgCallCount)\"\n                                                                                                                            ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each officer rank, what is the average number of crimes investigated and the average number of suspects who are persons known to each other?",
    "Cypher": "MATCH (o:Officer)-[:INVESTIGATED_BY]->(c:Crime) WITH o, COUNT(c) AS crimeCount MATCH (c)<-[:PARTY_TO]-(p1:Person)-[:KNOWS]->(p2:Person)-[:PARTY_TO]->(c) WITH o, crimeCount, COUNT(DISTINCT p1) AS suspectCount RETURN o.rank, avg(crimeCount), avg(suspectCount)",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 162,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_162",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each area code, calculate the total number of locations and the average number of phone calls made to phones within those locations.",
    "Cypher": "MATCH (l:Location)-[:LOCATION_IN_AREA]->(a:Area) WITH a, COUNT(l) AS locationCount MATCH (l)-[:HAS_POSTCODE]->(pc:PostCode)<-[:POSTCODE_IN_AREA]-(a) WITH a, locationCount MATCH (pc)<-[:HAS_POSTCODE]-(loc:Location)<-[:CURRENT_ADDRESS]-(p:Person)-[:HAS_PHONE]->(ph:Phone)<-[:CALLED]-(pc2:PhoneCall) WITH a, locationCount, COUNT(DISTINCT pc2) AS callCount RETURN a.areaCode, locationCount, avg(callCount)",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 163,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_163",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each type of crime, find the average number of objects involved and the average call duration of phone calls made regarding that crime type. Return the crime type, average number of objects, and average call duration.",
    "Cypher": "MATCH (c:Crime)<-[:INVOLVED_IN]-(o:Object) WITH c, count(o) AS objectCount MATCH (c)<-[:PARTY_TO]-(p:Person)-[:HAS_PHONE]->(ph:Phone)<-[:CALLED|CALLER]-(pc:PhoneCall) WITH c, objectCount, avg(toInt(pc.call_duration)) AS avgCallDuration RETURN c.type, avg(objectCount), avgCallDuration",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 168,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_168",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 1, column 193 (offset: 192))\n\"MATCH (c:Crime)<-[:INVOLVED_IN]-(o:Object) WITH c, count(o) AS objectCount MATCH (c)<-[:PARTY_TO]-(p:Person)-[:HAS_PHONE]->(ph:Phone)<-[:CALLED|CALLER]-(pc:PhoneCall) WITH c, objectCount, avg(toInt(pc.call_duration)) AS avgCallDuration RETURN c.type, avg(objectCount), avgCallDuration\"\n                                                                                                                                                                                                 ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each area code, determine the average number of crimes that occurred within locations in that area, as well as the average age of people involved in those crimes. Return the area code, average crime count, and average age.",
    "Cypher": "MATCH (a:Area)<-[:LOCATION_IN_AREA]-(l:Location)<-[:OCCURRED_AT]-(c:Crime)<-[:PARTY_TO]-(p:Person) WITH a, c, p WHERE p.age IS NOT NULL WITH a.areaCode AS areaCode, count(DISTINCT c) AS crimeCount, avg(toInt(p.age)) AS avgAge RETURN areaCode, avg(crimeCount), avgAge",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 169,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_169",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 1, column 203 (offset: 202))\n\"MATCH (a:Area)<-[:LOCATION_IN_AREA]-(l:Location)<-[:OCCURRED_AT]-(c:Crime)<-[:PARTY_TO]-(p:Person) WITH a, c, p WHERE p.age IS NOT NULL WITH a.areaCode AS areaCode, count(DISTINCT c) AS crimeCount, avg(toInt(p.age)) AS avgAge RETURN areaCode, avg(crimeCount), avgAge\"\n                                                                                                                                                                                                           ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each officer rank, calculate the total number of crimes investigated by officers of that rank and the average number of objects involved in those crimes. Return the officer rank, total crime count, and average object count.",
    "Cypher": "MATCH (o:Officer)-[:INVESTIGATED_BY]->(c:Crime)<-[:INVOLVED_IN]-(ob:Object) WITH o, c, count(ob) AS objectCount RETURN o.rank, count(DISTINCT c), avg(objectCount)",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 170,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_170",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each person, determine the number of crimes they are party to and the average duration of phone calls made to or from phones they are associated with. Return the person's name, crime count, and average call duration.",
    "Cypher": "MATCH (p:Person)-[:PARTY_TO]->(c:Crime) WITH p, count(c) AS crimeCount MATCH (p)-[:HAS_PHONE]->(ph:Phone)<-[:CALLED|CALLER]-(pc:PhoneCall) WITH p, crimeCount, pc WHERE pc.call_duration IS NOT NULL RETURN p.name, crimeCount, avg(toInt(pc.call_duration))",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 171,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_171",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 1, column 229 (offset: 228))\n\"MATCH (p:Person)-[:PARTY_TO]->(c:Crime) WITH p, count(c) AS crimeCount MATCH (p)-[:HAS_PHONE]->(ph:Phone)<-[:CALLED|CALLER]-(pc:PhoneCall) WITH p, crimeCount, pc WHERE pc.call_duration IS NOT NULL RETURN p.name, crimeCount, avg(toInt(pc.call_duration))\"\n                                                                                                                                                                                                                                     ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each type of crime, what is the average number of officers investigating crimes of that type, and what is the average number of objects involved in those crimes?",
    "Cypher": "MATCH (c:Crime)-[:INVESTIGATED_BY]->(o:Officer) WITH c.type AS crimeType, COUNT(DISTINCT o) AS numOfficers MATCH (c2:Crime)-[:INVOLVED_IN]->(ob:Object) WHERE c2.type = crimeType WITH crimeType, numOfficers, COUNT(DISTINCT ob) AS numObjects RETURN crimeType, AVG(numOfficers) AS avgOfficers, AVG(numObjects) AS avgObjects",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 175,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_175",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each area code, what is the average number of crimes occurring at locations within that area, and what is the average number of objects involved in those crimes?",
    "Cypher": "MATCH (c:Crime)-[:OCCURRED_AT]->(l:Location)-[:LOCATION_IN_AREA]->(a:Area) WITH a.areaCode AS areaCode, COUNT(DISTINCT c) AS numCrimes MATCH (c2:Crime)-[:OCCURRED_AT]->(l2:Location)-[:LOCATION_IN_AREA]->(a2:Area) MATCH (c2)-[:INVOLVED_IN]->(o:Object) WHERE a2.areaCode = areaCode WITH areaCode, numCrimes, COUNT(DISTINCT o) AS numObjects RETURN areaCode, AVG(toFloat(numCrimes)) AS avgCrimes, AVG(toFloat(numObjects)) AS avgObjects",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 177,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_177",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "What is the average number of phone calls made from each postcode area, and what is the average call duration for each of those areas?",
    "Cypher": "MATCH (pc:PostCode)<-[:HAS_POSTCODE]-(l:Location)<-[:CALLED]-(phc:PhoneCall) WITH pc, COUNT(phc) AS callCount, AVG(toFloat(phc.call_duration)) AS avgDuration RETURN pc.code AS postcode, callCount, avgDuration",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 182,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_182",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each crime type, what is the average number of vehicles involved and the average number of objects involved?",
    "Cypher": "MATCH (c:Crime)-[:INVOLVED_IN]-(v:Vehicle) WITH c, COUNT(v) AS vehicleCount MATCH (c)-[:INVOLVED_IN]-(o:Object) WITH c, vehicleCount, COUNT(o) AS objectCount WITH c.type AS crimeType, AVG(vehicleCount) AS avgVehicles, AVG(objectCount) AS avgObjects RETURN crimeType, avgVehicles, avgObjects",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 185,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_185",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each officer rank, determine the total number of officers and the average number of crimes they have investigated.",
    "Cypher": "MATCH (o:Officer)-[:INVESTIGATED_BY]->(c:Crime) WITH o.rank AS officerRank, o, COUNT(DISTINCT c) AS numCrimes WITH officerRank, COUNT(DISTINCT o) AS officerCount, AVG(numCrimes) AS avgCrimes RETURN officerRank, officerCount, avgCrimes",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 192,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_192",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "Calculate the average number of phone calls originating from each phone number, and the total number of people who have been called by those phone numbers.",
    "Cypher": "MATCH (pc:PhoneCall)-[:CALLER]->(ph:Phone)\nWITH ph, COUNT(pc) AS callCount\nMATCH (p:Person)-[:HAS_PHONE]->(ph)\nWITH ph, callCount\nMATCH (pc2:PhoneCall)-[:CALLED]->(ph)\nWITH ph, callCount\nMATCH (p2:Person)-[:HAS_PHONE]->(ph)\nWITH ph, callCount\nRETURN avg(callCount) AS avgCallCount, count(DISTINCT p2) AS totalPeopleCalled",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 207,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_207",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `p2` not defined (line 9, column 55 (offset: 297))\n\"RETURN avg(callCount) AS avgCallCount, count(DISTINCT p2) AS totalPeopleCalled\"\n                                                       ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "What is the average number of calls made to each phone number, and what is the average call duration for each phone number?",
    "Cypher": "MATCH (p:Phone)<-[c:CALLED]-(pc:PhoneCall) WITH p, count(pc) AS callCount, avg(toInt(pc.call_duration)) AS avgDuration RETURN p.phoneNo, callCount, avgDuration",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 224,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_224",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 1, column 80 (offset: 79))\n\"MATCH (p:Phone)<-[c:CALLED]-(pc:PhoneCall) WITH p, count(pc) AS callCount, avg(toInt(pc.call_duration)) AS avgDuration RETURN p.phoneNo, callCount, avgDuration\"\n                                                                                ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each person, find the total number of distinct crimes they are party to and the average call duration of phone calls made to phones associated with them.",
    "Cypher": "MATCH (p:Person)-[:PARTY_TO]->(c:Crime) WITH p, count(DISTINCT c) AS crimeCount MATCH (p)-[:HAS_PHONE]->(ph:Phone)<-[:CALLED]-(pc:PhoneCall) RETURN p.name, crimeCount, avg(toInt(pc.call_duration))",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 233,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_233",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 1, column 173 (offset: 172))\n\"MATCH (p:Person)-[:PARTY_TO]->(c:Crime) WITH p, count(DISTINCT c) AS crimeCount MATCH (p)-[:HAS_PHONE]->(ph:Phone)<-[:CALLED]-(pc:PhoneCall) RETURN p.name, crimeCount, avg(toInt(pc.call_duration))\"\n                                                                                                                                                                             ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each crime type, determine the average number of objects involved in crimes of that type and the total number of vehicles involved in those crimes.",
    "Cypher": "MATCH (cr:Crime)<-[:INVOLVED_IN]-(o:Object) WITH cr.type AS crimeType, COUNT(DISTINCT o) AS numObjects MATCH (cr2:Crime)<-[:INVOLVED_IN]-(v:Vehicle) WHERE cr2.type = crimeType WITH crimeType, AVG(numObjects) AS avgObjects, COUNT(DISTINCT v) AS totalVehicles RETURN crimeType, avgObjects, totalVehicles",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 242,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_242",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each officer rank, calculate the total number of crimes investigated by officers of that rank and the average number of vehicles involved in those crimes. Return the officer rank, total crime count, and average vehicle count.",
    "Cypher": "MATCH (o:Officer)-[:INVESTIGATED_BY]->(c:Crime)\nWITH o, c\nOPTIONAL MATCH (v:Vehicle)-[:INVOLVED_IN]->(c)\nWITH o.rank AS officerRank, count(DISTINCT c) AS crimeCount, count(DISTINCT v) AS vehicleCount\nRETURN officerRank, crimeCount, toFloat(vehicleCount)/crimeCount AS avgVehicleCount",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 248,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_248",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "What is the average number of phone calls made from each postcode area, and what is the average call duration for those calls, grouped by postcode area?",
    "Cypher": "MATCH (pc:PostCode)<-[:HAS_POSTCODE]-(l:Location)<-[:OCCURRED_AT]-(c:Crime)<-[:INVOLVED_IN]-(phc:PhoneCall)-[:CALLER]-(ph:Phone) WITH pc.code AS postcode, COUNT(DISTINCT phc) AS numCalls, AVG(toFloat(phc.call_duration)) AS avgDuration RETURN postcode, AVG(numCalls) AS avgCalls, AVG(avgDuration) AS avgCallDuration",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 260,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_260",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "What is the average number of crimes each officer investigates, and what is the average number of objects involved in those crimes, grouped by the officer's rank?",
    "Cypher": "MATCH (o:Officer)-[:INVESTIGATED_BY]->(c:Crime) WITH o.rank AS officerRank, o, c MATCH (c)-[:INVOLVED_IN]->(ob:Object) WITH officerRank, o, COUNT(DISTINCT ob) AS numObjects, c RETURN officerRank, AVG(numObjects) AS avgObjects, COUNT(DISTINCT c) AS numCrimes ORDER BY officerRank",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 262,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_262",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each area code, what is the average age of people living in locations within that area, and how many crimes occurred at those locations?",
    "Cypher": "MATCH (p:Person)-[:CURRENT_ADDRESS]->(l:Location)-[:LOCATION_IN_AREA]->(a:Area) OPTIONAL MATCH (c:Crime)-[:OCCURRED_AT]->(l) WITH a.areaCode AS areaCode, toInteger(p.age) AS age, COUNT(c) AS crimeCount WHERE p.age IS NOT NULL WITH areaCode, AVG(age) AS avgAge, SUM(crimeCount) AS totalCrimes RETURN areaCode, avgAge, totalCrimes",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 267,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_267",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: In a WITH/RETURN with DISTINCT or an aggregation, it is not possible to access variables declared before the WITH/RETURN: p (line 1, column 209 (offset: 208))\n\"MATCH (p:Person)-[:CURRENT_ADDRESS]->(l:Location)-[:LOCATION_IN_AREA]->(a:Area) OPTIONAL MATCH (c:Crime)-[:OCCURRED_AT]->(l) WITH a.areaCode AS areaCode, toInteger(p.age) AS age, COUNT(c) AS crimeCount WHERE p.age IS NOT NULL WITH areaCode, AVG(age) AS avgAge, SUM(crimeCount) AS totalCrimes RETURN areaCode, avgAge, totalCrimes\"\n                                                                                                                                                                                                                 ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each postcode, calculate the total number of crimes that occurred at locations with that postcode and the average call duration of phone calls made to phones associated with people living at those locations.",
    "Cypher": "MATCH (c:Crime)-[:OCCURRED_AT]->(l:Location)-[:HAS_POSTCODE]->(pc:PostCode) WITH pc, COUNT(c) AS crimeCount OPTIONAL MATCH (p:Person)-[:CURRENT_ADDRESS]->(l:Location)-[:HAS_POSTCODE]->(pc) -[:HAS_PHONE]->(ph:Phone)<-[:CALLED|CALLER]-(call:PhoneCall) WITH pc, crimeCount, toInteger(call.call_duration) AS duration WHERE call.call_duration IS NOT NULL WITH pc, crimeCount, AVG(duration) AS avgCallDuration RETURN pc.code, crimeCount, avgCallDuration",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 269,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_269",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each officer rank, calculate the average number of crimes investigated and the average number of vehicles involved in those crimes. Return the officer rank, average crime count, and average vehicle count.",
    "Cypher": "MATCH (o:Officer)-[:INVESTIGATED_BY]->(c:Crime)\nWITH o.rank AS officerRank, c\nOPTIONAL MATCH (v:Vehicle)-[:INVOLVED_IN]->(c)\nWITH officerRank, COUNT(DISTINCT c) AS crimeCount, COUNT(DISTINCT v) AS vehicleCount\nRETURN officerRank, avg(crimeCount) AS avgCrimeCount, avg(vehicleCount) AS avgVehicleCount",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 284,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_284",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each crime type, what is the average number of officers involved in the investigations where the crime occurred at locations with postcode BL1 4LG?",
    "Cypher": "MATCH (pc:PostCode {code: 'BL1 4LG'})<-[:HAS_POSTCODE]-(l:Location)<-[:OCCURRED_AT]-(c:Crime)-[:INVESTIGATED_BY]->(o:Officer) WITH c.type AS crimeType, COUNT(o) AS officerCount RETURN crimeType, avg(officerCount) AS averageOfficers",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 288,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_288",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "What is the average age of people who know other people who have 'CALL' type phone calls with duration longer than 60 seconds?",
    "Cypher": "MATCH (p1:Person)-[:KNOWS]->(p2:Person)-[:HAS_PHONE]->(ph:Phone)<-[:CALLED]-(pc:PhoneCall) WHERE pc.call_type = 'CALL' AND toInteger(pc.call_duration) > 60 WITH p1, p2 WHERE p1.age IS NOT NULL RETURN avg(toInteger(p1.age)) AS averageAge",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 289,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_289",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Content: Results only contain null or zero values.",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "Results returned successfully.",
    "neo4j_result_passed": 1,
    "content_validation": "Results only contain null or zero values.",
    "content_passed": 0
  },
  {
    "NL Question": "For each postcode, calculate the total number of people living at locations with that postcode and the average age of those people. Return the postcode, total people count, and average age.",
    "Cypher": "MATCH (p:Person)-[:CURRENT_ADDRESS]->(l:Location)-[:HAS_POSTCODE]->(pc:PostCode) WHERE p.age IS NOT NULL WITH pc.code AS postcode, p, l WITH postcode, COUNT(DISTINCT p) AS peopleCount, COLLECT(toFloat(p.age)) AS ages RETURN postcode, peopleCount, AVG(ages) AS avgAge",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 298,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_298",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Type mismatch: expected Float, Integer or Duration but was List<Float> (line 1, column 252 (offset: 251))\n\"MATCH (p:Person)-[:CURRENT_ADDRESS]->(l:Location)-[:HAS_POSTCODE]->(pc:PostCode) WHERE p.age IS NOT NULL WITH pc.code AS postcode, p, l WITH postcode, COUNT(DISTINCT p) AS peopleCount, COLLECT(toFloat(p.age)) AS ages RETURN postcode, peopleCount, AVG(ages) AS avgAge\"\n                                                                                                                                                                                                                                                            ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each area code, what is the average age of people living in locations within that area, and what is the total number of crimes reported in those locations?",
    "Cypher": "MATCH (p:Person)-[:CURRENT_ADDRESS]->(l:Location)-[:LOCATION_IN_AREA]->(a:Area) WITH a, p, l MATCH (cr:Crime)-[:OCCURRED_AT]->(l) WITH a, toInteger(p.age) AS personAge, COUNT(cr) AS crimeCount WHERE p.age IS NOT NULL RETURN a.areaCode AS areaCode, AVG(personAge) AS averageAge, SUM(crimeCount) AS totalCrimes",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 302,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_302",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: In a WITH/RETURN with DISTINCT or an aggregation, it is not possible to access variables declared before the WITH/RETURN: p (line 1, column 200 (offset: 199))\n\"MATCH (p:Person)-[:CURRENT_ADDRESS]->(l:Location)-[:LOCATION_IN_AREA]->(a:Area) WITH a, p, l MATCH (cr:Crime)-[:OCCURRED_AT]->(l) WITH a, toInteger(p.age) AS personAge, COUNT(cr) AS crimeCount WHERE p.age IS NOT NULL RETURN a.areaCode AS areaCode, AVG(personAge) AS averageAge, SUM(crimeCount) AS totalCrimes\"\n                                                                                                                                                                                                        ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each type of crime, what is the average number of objects involved and the average age of people party to that crime?",
    "Cypher": "MATCH (c:Crime)<-[:INVOLVED_IN]-(o:Object) WITH c.type AS crimeType, COUNT(o) AS objectCount MATCH (p:Person)-[:PARTY_TO]->(cr:Crime) WHERE cr.type = crimeType WITH crimeType, objectCount, p.age AS personAge WHERE p.age IS NOT NULL RETURN crimeType, AVG(toInteger(objectCount)) AS averageObjects, AVG(toInteger(personAge)) AS averagePersonAge",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 304,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_304",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each postcode, determine the total number of crimes occurring at locations with that postcode and the average age of people who have their current address at locations with that postcode.",
    "Cypher": "MATCH (pc:PostCode)<-[:HAS_POSTCODE]-(l:Location)<-[:OCCURRED_AT]-(c:Crime) WITH pc.code AS postcode, l, collect(c) AS crimes MATCH (p:Person)-[:CURRENT_ADDRESS]->(l) WHERE p.age IS NOT NULL WITH postcode, crimes, collect(toFloat(p.age)) AS ages RETURN postcode, size(crimes) AS totalCrimes, avg(ages) AS averageAge",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 311,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_311",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Type mismatch: expected Float, Integer or Duration but was List<Float> (line 1, column 297 (offset: 296))\n\"MATCH (pc:PostCode)<-[:HAS_POSTCODE]-(l:Location)<-[:OCCURRED_AT]-(c:Crime) WITH pc.code AS postcode, l, collect(c) AS crimes MATCH (p:Person)-[:CURRENT_ADDRESS]->(l) WHERE p.age IS NOT NULL WITH postcode, crimes, collect(toFloat(p.age)) AS ages RETURN postcode, size(crimes) AS totalCrimes, avg(ages) AS averageAge\"\n                                                                                                                                                                                                                                                                                                         ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each officer rank, find the total number of crimes investigated by officers of that rank, and the average number of distinct locations where those crimes occurred.",
    "Cypher": "MATCH (o:Officer)-[:INVESTIGATED_BY]->(c:Crime) WITH o.rank AS officerRank, c MATCH (c)-[:OCCURRED_AT]->(l:Location) WITH officerRank, c, collect(DISTINCT l) AS locationsPerCrime WITH officerRank, size(locationsPerCrime) AS numLocations, c RETURN officerRank, count(DISTINCT c) AS totalCrimes, avg(numLocations) AS avgDistinctLocations",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 312,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_312",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each person, calculate the total number of phone calls made and received, and then find the average call duration across all calls. Return the person's name, total calls, and average call duration.",
    "Cypher": "MATCH (p:Person)-[:HAS_PHONE]->(ph:Phone)<-[:CALLER]-(pc:PhoneCall) WITH p, pc.call_duration AS duration UNION ALL MATCH (p:Person)-[:HAS_PHONE]->(ph:Phone)<-[:CALLED]-(pc:PhoneCall) WITH p, pc.call_duration AS duration WITH p, COLLECT(duration) AS durations UNWIND durations AS call_duration WITH p, toInteger(call_duration) AS int_duration WHERE int_duration IS NOT NULL WITH p, AVG(int_duration) AS avgDuration RETURN p.name, count(p), avgDuration",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 317,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_317",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Query cannot conclude with WITH (must be a RETURN clause, a FINISH clause, an update clause, a unit subquery call, or a procedure call with no YIELD). (line 1, column 69 (offset: 68))\n\"MATCH (p:Person)-[:HAS_PHONE]->(ph:Phone)<-[:CALLER]-(pc:PhoneCall) WITH p, pc.call_duration AS duration UNION ALL MATCH (p:Person)-[:HAS_PHONE]->(ph:Phone)<-[:CALLED]-(pc:PhoneCall) WITH p, pc.call_duration AS duration WITH p, COLLECT(duration) AS durations UNWIND durations AS call_duration WITH p, toInteger(call_duration) AS int_duration WHERE int_duration IS NOT NULL WITH p, AVG(int_duration) AS avgDuration RETURN p.name, count(p), avgDuration\"\n                                                                     ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each type of crime, calculate the average number of objects involved and the average call duration of phone calls related to phones used in those crimes. Return the crime type, average object count, and average call duration.",
    "Cypher": "MATCH (c:Crime)<-[:INVOLVED_IN]-(o:Object) WITH c, count(o) AS objectCount MATCH (c)<-[:PARTY_TO]-(p:Person)-[:HAS_PHONE]->(ph:Phone)<-[:CALLED]-(pc:PhoneCall) WITH c, objectCount, avg(toInt(pc.call_duration)) AS avgCallDuration RETURN c.type, avg(objectCount), avgCallDuration",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 322,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_322",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 1, column 186 (offset: 185))\n\"MATCH (c:Crime)<-[:INVOLVED_IN]-(o:Object) WITH c, count(o) AS objectCount MATCH (c)<-[:PARTY_TO]-(p:Person)-[:HAS_PHONE]->(ph:Phone)<-[:CALLED]-(pc:PhoneCall) WITH c, objectCount, avg(toInt(pc.call_duration)) AS avgCallDuration RETURN c.type, avg(objectCount), avgCallDuration\"\n                                                                                                                                                                                          ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each person, determine the number of distinct areas where crimes they are party to occurred, and the average call duration of phone calls made to their phones. Return the person's name, the count of distinct crime areas, and the average call duration.",
    "Cypher": "MATCH (p:Person)-[:PARTY_TO]->(c:Crime)-[:OCCURRED_AT]->(l:Location)-[:LOCATION_IN_AREA]->(a:Area) WITH p, count(DISTINCT a) AS distinctAreaCount MATCH (p)-[:HAS_PHONE]->(ph:Phone)<-[:CALLED]-(pc:PhoneCall) WITH p, distinctAreaCount, avg(toInt(pc.call_duration)) AS avgCallDuration RETURN p.name, distinctAreaCount, avgCallDuration",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 324,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_324",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 1, column 239 (offset: 238))\n\"MATCH (p:Person)-[:PARTY_TO]->(c:Crime)-[:OCCURRED_AT]->(l:Location)-[:LOCATION_IN_AREA]->(a:Area) WITH p, count(DISTINCT a) AS distinctAreaCount MATCH (p)-[:HAS_PHONE]->(ph:Phone)<-[:CALLED]-(pc:PhoneCall) WITH p, distinctAreaCount, avg(toInt(pc.call_duration)) AS avgCallDuration RETURN p.name, distinctAreaCount, avgCallDuration\"\n                                                                                                                                                                                                                                               ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each postcode, determine the total number of people residing there and the average duration of phone calls made by phones associated with those people. Return the postcode, total person count, and average call duration.",
    "Cypher": "MATCH (pc:PostCode)<-[:HAS_POSTCODE]-(l:Location)<-[:CURRENT_ADDRESS]-(p:Person) WITH pc, count(p) AS personCount MATCH (p)-[:HAS_PHONE]->(ph:Phone)<-[:CALLED]-(pc2:PhoneCall) WITH pc, personCount, avg(toInt(pc2.call_duration)) AS avgCallDuration RETURN pc.code, personCount, avgCallDuration",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 326,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_326",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 1, column 203 (offset: 202))\n\"MATCH (pc:PostCode)<-[:HAS_POSTCODE]-(l:Location)<-[:CURRENT_ADDRESS]-(p:Person) WITH pc, count(p) AS personCount MATCH (p)-[:HAS_PHONE]->(ph:Phone)<-[:CALLED]-(pc2:PhoneCall) WITH pc, personCount, avg(toInt(pc2.call_duration)) AS avgCallDuration RETURN pc.code, personCount, avgCallDuration\"\n                                                                                                                                                                                                           ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each officer rank, what is the average number of crimes investigated and the average number of objects involved in those crimes? Return the officer rank, average crime count, and average object count.",
    "Cypher": "MATCH (o:Officer)-[:INVESTIGATED_BY]->(c:Crime) WITH o.rank AS officerRank, c MATCH (ob:Object)-[:INVOLVED_IN]->(c) WITH officerRank, c, count(DISTINCT ob) AS objectCount RETURN officerRank, avg(objectCount)",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 332,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_332",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each officer rank, what is the average number of crimes investigated and what is the average number of distinct locations where these crimes occurred?",
    "Cypher": "MATCH (o:Officer)-[:INVESTIGATED_BY]->(c:Crime)-[:OCCURRED_AT]->(l:Location) WITH o.rank AS officerRank, c, l WITH officerRank, c, count(DISTINCT l) AS distinctLocations RETURN officerRank, avg(distinctLocations) AS avgLocations, count(DISTINCT c) AS crimeCount",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 340,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_340",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "What is the average age of persons involved in crimes of each type, and what is the average number of phones known by those persons?",
    "Cypher": "MATCH (p:Person)-[:PARTY_TO]->(cr:Crime) MATCH (p)-[:KNOWS_PHONE]->(other:Person) WITH cr.type AS crimeType, p, COUNT(DISTINCT other) AS knownPhones, AVG(toInt(p.age)) AS averageAgePerCrime RETURN crimeType, AVG(averageAgePerCrime) AS overallAverageAge, AVG(knownPhones) AS averageKnownPhones",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 345,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_345",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 1, column 155 (offset: 154))\n\"MATCH (p:Person)-[:PARTY_TO]->(cr:Crime) MATCH (p)-[:KNOWS_PHONE]->(other:Person) WITH cr.type AS crimeType, p, COUNT(DISTINCT other) AS knownPhones, AVG(toInt(p.age)) AS averageAgePerCrime RETURN crimeType, AVG(averageAgePerCrime) AS overallAverageAge, AVG(knownPhones) AS averageKnownPhones\"\n                                                                                                                                                           ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "What is the average number of calls made to each phone number, and what is the average call duration for those calls?",
    "Cypher": "MATCH (pc:PhoneCall)-[:CALLED]->(p:Phone) WITH p, COUNT(pc) AS callCount, AVG(toInt(pc.call_duration)) AS avgDuration RETURN p.phoneNo, callCount, avgDuration",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 357,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_357",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 1, column 79 (offset: 78))\n\"MATCH (pc:PhoneCall)-[:CALLED]->(p:Phone) WITH p, COUNT(pc) AS callCount, AVG(toInt(pc.call_duration)) AS avgDuration RETURN p.phoneNo, callCount, avgDuration\"\n                                                                               ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "What is the average number of phone calls made by each person, and what is the average duration of those calls, considering only calls made on '24/08/2017'?",
    "Cypher": "MATCH (p:Person)-[:HAS_PHONE]->(ph:Phone)<-[:CALLER]-(pc:PhoneCall) WHERE pc.call_date = '24/08/2017' WITH p, pc COUNT(pc) AS callCount, AVG(toInt(pc.call_duration)) AS avgDuration RETURN p.name, p.surname, callCount, avgDuration",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 359,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_359",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'COUNT': expected an expression, 'FOREACH', ',', 'AS', 'ORDER BY', 'CALL', 'CREATE', 'LOAD CSV', 'DELETE', 'DETACH', 'FINISH', 'INSERT', 'LIMIT', 'MATCH', 'MERGE', 'NODETACH', 'OFFSET', 'OPTIONAL', 'REMOVE', 'RETURN', 'SET', 'SKIP', 'UNION', 'UNWIND', 'USE', 'WHERE', 'WITH' or <EOF> (line 1, column 114 (offset: 113))\n\"MATCH (p:Person)-[:HAS_PHONE]->(ph:Phone)<-[:CALLER]-(pc:PhoneCall) WHERE pc.call_date = '24/08/2017' WITH p, pc COUNT(pc) AS callCount, AVG(toInt(pc.call_duration)) AS avgDuration RETURN p.name, p.surname, callCount, avgDuration\"\n                                                                                                                  ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "What is the average age of people who know each other, grouped by the relationship type between them?",
    "Cypher": "MATCH (p1:Person)-[r:KNOWS]->(p2:Person) WHERE p1.age IS NOT NULL AND p2.age IS NOT NULL WITH r, toInteger(p1.age) AS age1, toInteger(p2.age) AS age2 RETURN type(r), AVG((age1 + age2) / 2.0) AS averageAge",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 361,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_361",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each officer rank, find the average number of crimes investigated by officers of that rank, and the average number of objects involved in those investigations.",
    "Cypher": "MATCH (o:Officer)-[:INVESTIGATED_BY]->(c:Crime)\nWITH o.rank AS officerRank, c, COUNT(c) AS numCrimes\nMATCH (c)<-[:INVOLVED_IN]-(ob:Object)\nWITH officerRank, AVG(numCrimes) AS avgCrimes, COUNT(ob) AS numObjects\nRETURN officerRank, avgCrimes, AVG(numObjects) AS avgObjects",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 374,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_374",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each type of crime, what is the average number of objects involved and the average number of officers investigating?",
    "Cypher": "MATCH (o:Object)-[:INVOLVED_IN]->(c:Crime) WITH c.type AS crimeType, COUNT(o) AS objectCount MATCH (crime:Crime {type: crimeType})<-[:INVESTIGATED_BY]-(officer:Officer) WITH crimeType, objectCount, COUNT(officer) AS officerCount RETURN crimeType, avg(objectCount) AS avgObjects, avg(officerCount) AS avgOfficers",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 378,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_378",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each year, determine the average number of crimes reported and the average number of vehicles involved in those crimes.",
    "Cypher": "MATCH (c:Crime)<-[:INVOLVED_IN]-(v:Vehicle)\nWITH c.date AS crimeDate, c, v\nWITH crimeDate,substring(crimeDate, 7, 4) AS crimeYear, COUNT(DISTINCT v) AS vehicleCount\nWITH crimeYear, COUNT(DISTINCT c) AS crimeCount, AVG(vehicleCount) AS avgVehicles\nRETURN crimeYear, AVG(crimeCount) AS avgCrimes, avgVehicles;",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 395,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_395",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `c` not defined (line 4, column 32 (offset: 196))\n\"WITH crimeYear, COUNT(DISTINCT c) AS crimeCount, AVG(vehicleCount) AS avgVehicles\"\n                                ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each officer rank, calculate the total number of crimes investigated and the average number of objects involved in those investigated crimes.",
    "Cypher": "MATCH (o:Officer)-[:INVESTIGATED_BY]->(c:Crime)<-[:INVOLVED_IN]-(ob:Object)\nWITH o.rank AS officerRank, c, ob\nWITH officerRank, COUNT(DISTINCT c) AS crimeCount, COUNT(DISTINCT ob) AS objectCount\nRETURN officerRank, SUM(crimeCount) AS totalCrimes, AVG(objectCount) AS avgObjects;",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 396,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_396",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "What is the average call duration for phone calls originating from each area code, and what is the average number of distinct phone numbers called from that area?",
    "Cypher": "MATCH (pc:PhoneCall)-[:CALLER]->(ph:Phone)<-[:HAS_PHONE]-(p:Person)-[:CURRENT_ADDRESS]->(l:Location)-[:LOCATION_IN_AREA]->(a:Area) WITH a, pc, ph MATCH (pc)-[:CALLED]->(calledPhone:Phone) WITH a, AVG(toInt(pc.call_duration)) AS avgDuration, COUNT(DISTINCT calledPhone.phoneNo) AS distinctNumbersCalled RETURN a.areaCode, avgDuration, AVG(distinctNumbersCalled) AS avgDistinctNumbers",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 401,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_401",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 1, column 201 (offset: 200))\n\"MATCH (pc:PhoneCall)-[:CALLER]->(ph:Phone)<-[:HAS_PHONE]-(p:Person)-[:CURRENT_ADDRESS]->(l:Location)-[:LOCATION_IN_AREA]->(a:Area) WITH a, pc, ph MATCH (pc)-[:CALLED]->(calledPhone:Phone) WITH a, AVG(toInt(pc.call_duration)) AS avgDuration, COUNT(DISTINCT calledPhone.phoneNo) AS distinctNumbersCalled RETURN a.areaCode, avgDuration, AVG(distinctNumbersCalled) AS avgDistinctNumbers\"\n                                                                                                                                                                                                         ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each crime type, what is the average number of objects involved and the average call duration of phone calls made to phones associated with people involved in that crime?",
    "Cypher": "MATCH (c:Crime)<-[:INVOLVED_IN]-(o:Object) WITH c, COUNT(o) AS objectCount MATCH (c)<-[:PARTY_TO]-(p:Person)-[:HAS_PHONE]->(ph:Phone)<-[:CALLED]-(pc:PhoneCall) WITH c, objectCount, pc.call_duration AS callDuration, COUNT(DISTINCT ph) as distinctPhoneNumbers MATCH (c)<-[:PARTY_TO]-(p2:Person)-[:HAS_PHONE]->(ph2:Phone)-[:CALLER]-(pc2:PhoneCall) WITH c, objectCount, toInt(callDuration) as callDuration, COUNT(DISTINCT ph2) as distinctPhoneNumbers2 RETURN c.type, AVG(objectCount) AS avgObjects, AVG(callDuration) AS avgCallDuration",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 402,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_402",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 1, column 367 (offset: 366))\n\"MATCH (c:Crime)<-[:INVOLVED_IN]-(o:Object) WITH c, COUNT(o) AS objectCount MATCH (c)<-[:PARTY_TO]-(p:Person)-[:HAS_PHONE]->(ph:Phone)<-[:CALLED]-(pc:PhoneCall) WITH c, objectCount, pc.call_duration AS callDuration, COUNT(DISTINCT ph) as distinctPhoneNumbers MATCH (c)<-[:PARTY_TO]-(p2:Person)-[:HAS_PHONE]->(ph2:Phone)-[:CALLER]-(pc2:PhoneCall) WITH c, objectCount, toInt(callDuration) as callDuration, COUNT(DISTINCT ph2) as distinctPhoneNumbers2 RETURN c.type, AVG(objectCount) AS avgObjects, AVG(callDuration) AS avgCallDuration\"\n                                                                                                                                                                                                                                                                                                                                                                               ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "What is the average age of people who have family relationships with each other, and what is the average number of phone calls made by these people?",
    "Cypher": "MATCH (p1:Person)-[:FAMILY_REL]->(p2:Person) WITH p1, p2, toInt(p1.age) AS age1, toInt(p2.age) AS age2 MATCH (p1)-[:HAS_PHONE]->(ph1:Phone)<-[:CALLER]-(pc1:PhoneCall) WITH p1, p2, age1, age2, COUNT(pc1) AS callCount1 MATCH (p2)-[:HAS_PHONE]->(ph2:Phone)<-[:CALLER]-(pc2:PhoneCall) WITH AVG(age1 + age2)/2 AS avgAge, callCount1, COUNT(pc2) AS callCount2 RETURN avgAge, AVG(callCount1 + callCount2)/2 AS avgCallCount",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 403,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_403",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 1, column 59 (offset: 58))\n\"MATCH (p1:Person)-[:FAMILY_REL]->(p2:Person) WITH p1, p2, toInt(p1.age) AS age1, toInt(p2.age) AS age2 MATCH (p1)-[:HAS_PHONE]->(ph1:Phone)<-[:CALLER]-(pc1:PhoneCall) WITH p1, p2, age1, age2, COUNT(pc1) AS callCount1 MATCH (p2)-[:HAS_PHONE]->(ph2:Phone)<-[:CALLER]-(pc2:PhoneCall) WITH AVG(age1 + age2)/2 AS avgAge, callCount1, COUNT(pc2) AS callCount2 RETURN avgAge, AVG(callCount1 + callCount2)/2 AS avgCallCount\"\n                                                           ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each type of crime, calculate the average number of objects involved and the total number of officers investigating crimes of that type. Return the crime type, average object count, and total officer count.",
    "Cypher": "MATCH (c:Crime)<-[:INVOLVED_IN]-(o:Object) WITH c, count(o) AS objectCount MATCH (c)<-[:INVESTIGATED_BY]-(of:Officer) WITH c, objectCount, count(of) AS officerCount RETURN c.type AS crimeType, avg(objectCount) AS averageObjectCount, sum(officerCount) AS totalOfficerCount",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 406,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_406",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each area, find the total number of crimes that occurred in locations within that area and the average number of officers investigating those crimes. Return the area code, total crime count, and average officer count.",
    "Cypher": "MATCH (a:Area)<-[:LOCATION_IN_AREA]-(l:Location)<-[:OCCURRED_AT]-(c:Crime) WITH a, c MATCH (c)<-[:INVESTIGATED_BY]-(o:Officer) WITH a, c, count(o) AS officerCount RETURN a.areaCode AS areaCode, count(DISTINCT c) AS totalCrimeCount, avg(officerCount) AS averageOfficerCount",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 408,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_408",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each vehicle make, determine the total number of crimes the vehicles of that make were involved in, and calculate the average number of objects involved in those crimes. Return the vehicle make, total crime count, and average object count.",
    "Cypher": "MATCH (v:Vehicle)-[:INVOLVED_IN]->(c:Crime) WITH v.make AS vehicleMake, c MATCH (c)<-[:INVOLVED_IN]-(o:Object) WITH vehicleMake, c, count(o) AS objectCount RETURN vehicleMake, count(DISTINCT c) AS totalCrimeCount, avg(objectCount) AS averageObjectCount",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 409,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_409",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each postcode, calculate the total number of people who live at locations with that postcode and the average age of those people. Return the postcode, total person count, and average age.",
    "Cypher": "MATCH (p:Person)-[:CURRENT_ADDRESS]->(l:Location)-[:HAS_POSTCODE]->(pc:PostCode) WITH pc.code AS postcode, p.age AS age RETURN postcode, count(p) AS totalPersonCount, avg(toFloat(age)) AS averageAge",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 410,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_410",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `p` not defined (line 1, column 144 (offset: 143))\n\"MATCH (p:Person)-[:CURRENT_ADDRESS]->(l:Location)-[:HAS_POSTCODE]->(pc:PostCode) WITH pc.code AS postcode, p.age AS age RETURN postcode, count(p) AS totalPersonCount, avg(toFloat(age)) AS averageAge\"\n                                                                                                                                                ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "Calculate the average number of phone calls made from each postcode area, and also the average call duration for each of those areas.",
    "Cypher": "MATCH (pc:PhoneCall)-[:CALLED]->(p:Phone)<-[:HAS_PHONE]-(person:Person)-[:CURRENT_ADDRESS]->(l:Location)-[:HAS_POSTCODE]->(post:PostCode) WITH post, pc MATCH (pc)-[:CALLER]->(p:Phone)<-[:HAS_PHONE]-(person:Person)-[:CURRENT_ADDRESS]->(l:Location)-[:HAS_POSTCODE]->(post:PostCode) WITH post, pc.call_duration AS duration MATCH (post)-[:POSTCODE_IN_AREA]->(a:Area) WITH a, post, duration RETURN a.areaCode, avg(toFloat(duration)) AS avg_duration, count(post) AS total_postcode",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 421,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_421",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each officer rank, what is the total number of crimes investigated and the average number of objects involved in those crimes?",
    "Cypher": "MATCH (o:Officer)-[:INVESTIGATED_BY]->(c:Crime)<-[:INVOLVED_IN]-(ob:Object) WITH o.rank AS officerRank, c, ob MATCH (o:Officer)-[:INVESTIGATED_BY]->(c:Crime)<-[:INVOLVED_IN]-(ob:Object) WITH officerRank, count(c) AS crimeCount, count(ob) AS objectCount RETURN officerRank, crimeCount, avg(objectCount)",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 422,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_422",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each crime type, calculate the total number of crimes and the average number of phone calls associated with people party to those crimes.",
    "Cypher": "MATCH (c:Crime)<-[:PARTY_TO]-(p:Person)-[:HAS_PHONE]->(ph:Phone)<-[:CALLED]-(pc:PhoneCall) WITH c.type AS crimeType, c, p, ph, pc MATCH (c:Crime)<-[:PARTY_TO]-(p:Person)-[:HAS_PHONE]->(ph:Phone)<-[:CALLER]-(pc:PhoneCall) WITH crimeType, count(c) AS crimeCount, count(pc) AS callCount RETURN crimeType, crimeCount, avg(callCount)",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 424,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_424",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "What is the average number of phone calls made from each postcode area, and what is the average call duration for each area?",
    "Cypher": "MATCH (pc:PostCode)<-[:HAS_POSTCODE]-(l:Location)<-[:CALLED]-(c:PhoneCall) WITH pc, COUNT(c) AS callCount, AVG(toFloat(c.call_duration)) AS avgDuration RETURN pc.code AS Postcode, AVG(callCount) AS AvgCallCount, AVG(avgDuration) AS AvgCallDuration",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 427,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_427",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each type of crime, what is the average number of officers investigating and the average number of objects involved?",
    "Cypher": "MATCH (c:Crime)<-[:INVESTIGATED_BY]-(o:Officer) WITH c.type AS crimeType, COUNT(o) AS officerCount MATCH (obj:Object)-[:INVOLVED_IN]->(c:Crime) WHERE c.type = crimeType WITH crimeType, officerCount, COUNT(obj) AS objectCount RETURN crimeType, AVG(officerCount) AS AvgOfficers, AVG(objectCount) AS AvgObjects",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 428,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_428",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "What is the average number of crimes a vehicle is involved in, and what is the average number of objects involved in those same crimes?",
    "Cypher": "MATCH (v:Vehicle)-[:INVOLVED_IN]->(c:Crime) WITH v, COUNT(c) AS crimeCount MATCH (obj:Object)-[:INVOLVED_IN]->(c:Crime)<-[:INVOLVED_IN]-(v:Vehicle) WITH crimeCount, COUNT(obj) AS objectCount RETURN AVG(crimeCount) AS AvgCrimesPerVehicle, AVG(objectCount) AS AvgObjectsPerCrime",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 430,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_430",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Content: Results only contain null or zero values.",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "Results returned successfully.",
    "neo4j_result_passed": 1,
    "content_validation": "Results only contain null or zero values.",
    "content_passed": 0
  },
  {
    "NL Question": "For each officer rank, what is the average number of crimes investigated, and what is the average number of people who are party to those crimes?",
    "Cypher": "MATCH (o:Officer)-[:INVESTIGATED_BY]->(c:Crime) WITH o.rank AS officerRank, c MATCH (p:Person)-[:PARTY_TO]->(c:Crime)<-[:INVESTIGATED_BY]-(o:Officer) WHERE o.rank = officerRank WITH officerRank, COUNT(DISTINCT c) AS crimeCount, COUNT(DISTINCT p) AS peopleCount RETURN officerRank, AVG(crimeCount) AS AvgCrimesInvestigated, AVG(peopleCount) AS AvgPeopleInvolved",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 431,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_431",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each area code, what is the total number of people who live in locations within that area, and what is the average age of those people?",
    "Cypher": "MATCH (p:Person)-[:CURRENT_ADDRESS]->(l:Location)-[:LOCATION_IN_AREA]->(a:Area) WITH a.areaCode AS area_code, p.age AS age WHERE p.age IS NOT NULL RETURN area_code, count(p) AS total_people, avg(toFloat(age)) AS average_age",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 436,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_436",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `p` not defined (line 1, column 172 (offset: 171))\n\"MATCH (p:Person)-[:CURRENT_ADDRESS]->(l:Location)-[:LOCATION_IN_AREA]->(a:Area) WITH a.areaCode AS area_code, p.age AS age WHERE p.age IS NOT NULL RETURN area_code, count(p) AS total_people, avg(toFloat(age)) AS average_age\"\n                                                                                                                                                                            ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each postcode, what is the average call duration of phone calls made to phones associated with people living in that postcode?",
    "Cypher": "MATCH (p:Person)-[:CURRENT_ADDRESS]->(l:Location)-[:HAS_POSTCODE]->(pc:PostCode)<-[:CALLED]-(phc:PhoneCall)-[:CALLER]->(ph:Phone) WITH pc.code AS postcode, phc.call_duration AS call_duration WHERE phc.call_duration IS NOT NULL RETURN postcode, avg(toFloat(call_duration)) AS average_call_duration",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 437,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_437",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each officer rank, what is the average number of crimes investigated by officers of that rank, and what is the average number of objects involved in those crimes investigated by officers of that rank?",
    "Cypher": "MATCH (o:Officer)-[:INVESTIGATED_BY]->(c:Crime) WITH o.rank AS officer_rank, c MATCH (c)<-[:INVOLVED_IN]-(ob:Object) WITH officer_rank, COUNT(DISTINCT c) AS num_crimes, COUNT(DISTINCT ob) AS num_objects RETURN officer_rank, avg(toFloat(num_crimes)) AS average_crimes, avg(toFloat(num_objects)) AS average_objects",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 438,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_438",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each crime type, calculate the average number of objects involved in crimes of that type, and also find the average call duration of phone calls made to phones associated with persons involved in those crimes. Return the crime type, the average number of objects involved, and the average call duration.",
    "Cypher": "MATCH (c:Crime)<-[:INVOLVED_IN]-(o:Object) MATCH (c)-[:PARTY_TO]-(p:Person)-[:HAS_PHONE]-(ph:Phone)<-[:CALLED]-(pc:PhoneCall) WITH c.type AS crimeType, c, o, pc WITH crimeType, COUNT(DISTINCT o) AS objectsInvolved, SUM(toInt(pc.call_duration)) AS totalCallDuration WITH crimeType, AVG(objectsInvolved) AS avgObjectsInvolved, AVG(totalCallDuration) AS avgCallDuration RETURN crimeType, avgObjectsInvolved, avgCallDuration",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 443,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_443",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 1, column 220 (offset: 219))\n\"MATCH (c:Crime)<-[:INVOLVED_IN]-(o:Object) MATCH (c)-[:PARTY_TO]-(p:Person)-[:HAS_PHONE]-(ph:Phone)<-[:CALLED]-(pc:PhoneCall) WITH c.type AS crimeType, c, o, pc WITH crimeType, COUNT(DISTINCT o) AS objectsInvolved, SUM(toInt(pc.call_duration)) AS totalCallDuration WITH crimeType, AVG(objectsInvolved) AS avgObjectsInvolved, AVG(totalCallDuration) AS avgCallDuration RETURN crimeType, avgObjectsInvolved, avgCallDuration\"\n                                                                                                                                                                                                                            ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each postcode area, determine the average age of persons residing at locations within that postcode area, and also calculate the average number of crimes reported at those locations. Return the postcode, the average age of residents, and the average number of crimes per location.",
    "Cypher": "MATCH (pc:PostCode)<-[:HAS_POSTCODE]-(l:Location)<-[:CURRENT_ADDRESS]-(p:Person) OPTIONAL MATCH (l)<-[:OCCURRED_AT]-(c:Crime) WITH pc.code AS postcode, l, p, c WITH postcode, l, AVG(toInt(p.age)) AS avgAge, COUNT(DISTINCT c) AS crimeCount WITH postcode, AVG(avgAge) AS overallAvgAge, AVG(crimeCount) AS avgCrimesPerLocation RETURN postcode, overallAvgAge, avgCrimesPerLocation",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 444,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_444",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 1, column 183 (offset: 182))\n\"MATCH (pc:PostCode)<-[:HAS_POSTCODE]-(l:Location)<-[:CURRENT_ADDRESS]-(p:Person) OPTIONAL MATCH (l)<-[:OCCURRED_AT]-(c:Crime) WITH pc.code AS postcode, l, p, c WITH postcode, l, AVG(toInt(p.age)) AS avgAge, COUNT(DISTINCT c) AS crimeCount WITH postcode, AVG(avgAge) AS overallAvgAge, AVG(crimeCount) AS avgCrimesPerLocation RETURN postcode, overallAvgAge, avgCrimesPerLocation\"\n                                                                                                                                                                                       ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each vehicle make, calculate the average number of crimes the vehicles of that make have been involved in, and also determine the average call duration of phone calls made by persons involved in those crimes. Return the vehicle make, the average number of involved crimes, and the average call duration.",
    "Cypher": "MATCH (v:Vehicle)-[:INVOLVED_IN]->(c:Crime)<-[:PARTY_TO]-(p:Person)-[:HAS_PHONE]-(ph:Phone)<-[:CALLER]-(pc:PhoneCall) WITH v.make AS vehicleMake, c, p, pc WITH vehicleMake, COUNT(DISTINCT c) AS crimesInvolved, SUM(toInt(pc.call_duration)) AS totalCallDuration WITH vehicleMake, AVG(crimesInvolved) AS avgCrimesInvolved, AVG(totalCallDuration) AS avgCallDuration RETURN vehicleMake, avgCrimesInvolved, avgCallDuration",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 445,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_445",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 1, column 215 (offset: 214))\n\"MATCH (v:Vehicle)-[:INVOLVED_IN]->(c:Crime)<-[:PARTY_TO]-(p:Person)-[:HAS_PHONE]-(ph:Phone)<-[:CALLER]-(pc:PhoneCall) WITH v.make AS vehicleMake, c, p, pc WITH vehicleMake, COUNT(DISTINCT c) AS crimesInvolved, SUM(toInt(pc.call_duration)) AS totalCallDuration WITH vehicleMake, AVG(crimesInvolved) AS avgCrimesInvolved, AVG(totalCallDuration) AS avgCallDuration RETURN vehicleMake, avgCrimesInvolved, avgCallDuration\"\n                                                                                                                                                                                                                       ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "What is the average number of calls made to each phone number, and what is the average duration of those calls?",
    "Cypher": "MATCH (pc:PhoneCall)-[:CALLED]->(p:Phone) WITH p, COUNT(pc) AS callCount, AVG(toInt(pc.call_duration)) AS avgDuration RETURN p.phoneNo, callCount, avgDuration",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 448,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_448",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 1, column 79 (offset: 78))\n\"MATCH (pc:PhoneCall)-[:CALLED]->(p:Phone) WITH p, COUNT(pc) AS callCount, AVG(toInt(pc.call_duration)) AS avgDuration RETURN p.phoneNo, callCount, avgDuration\"\n                                                                               ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "What is the average number of phone calls originating from each area code, and what is the average call duration for those calls?",
    "Cypher": "MATCH (pc:PhoneCall)-[:CALLER]->(p:Phone)<-[:HAS_PHONE]-(person:Person)-[:CURRENT_ADDRESS]->(l:Location)-[:LOCATION_IN_AREA]->(a:Area) WITH a, pc, toInt(pc.call_duration) AS call_duration RETURN a.areaCode, COUNT(pc), AVG(call_duration)",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 450,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_450",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 1, column 148 (offset: 147))\n\"MATCH (pc:PhoneCall)-[:CALLER]->(p:Phone)<-[:HAS_PHONE]-(person:Person)-[:CURRENT_ADDRESS]->(l:Location)-[:LOCATION_IN_AREA]->(a:Area) WITH a, pc, toInt(pc.call_duration) AS call_duration RETURN a.areaCode, COUNT(pc), AVG(call_duration)\"\n                                                                                                                                                    ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each person, what is the total number of crimes they are party to, and what is the average number of objects involved in those crimes?",
    "Cypher": "MATCH (p:Person)-[:PARTY_TO]->(c:Crime) WITH p, c MATCH (o:Object)-[:INVOLVED_IN]->(c) WITH p, COUNT(o) AS objectCount RETURN p.name, p.surname, COUNT(c) AS crimeCount, AVG(objectCount)",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 451,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_451",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `c` not defined (line 1, column 152 (offset: 151))\n\"MATCH (p:Person)-[:PARTY_TO]->(c:Crime) WITH p, c MATCH (o:Object)-[:INVOLVED_IN]->(c) WITH p, COUNT(o) AS objectCount RETURN p.name, p.surname, COUNT(c) AS crimeCount, AVG(objectCount)\"\n                                                                                                                                                        ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each postcode, what is the average number of crimes that occurred at locations within that postcode, and what is the average number of vehicles involved in those crimes?",
    "Cypher": "MATCH (pc:PostCode)<-[:HAS_POSTCODE]-(l:Location)<-[:OCCURRED_AT]-(c:Crime) WITH pc, c MATCH (v:Vehicle)-[:INVOLVED_IN]->(c) WITH pc, COUNT(v) AS vehicleCount RETURN pc.code, COUNT(c) AS crimeCount, AVG(vehicleCount)",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 452,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_452",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `c` not defined (line 1, column 182 (offset: 181))\n\"MATCH (pc:PostCode)<-[:HAS_POSTCODE]-(l:Location)<-[:OCCURRED_AT]-(c:Crime) WITH pc, c MATCH (v:Vehicle)-[:INVOLVED_IN]->(c) WITH pc, COUNT(v) AS vehicleCount RETURN pc.code, COUNT(c) AS crimeCount, AVG(vehicleCount)\"\n                                                                                                                                                                                      ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "What is the average age of people who know other people who have HAS_PHONE relationship with a phone having phone number '2-(716)295-6678'?",
    "Cypher": "MATCH (p1:Person)-[:KNOWS]->(p2:Person)-[:HAS_PHONE]->(phone:Phone {phoneNo: '2-(716)295-6678'}) WHERE p1.age IS NOT NULL WITH toInteger(p1.age) AS age COLLECT age RETURN avg(age)",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 455,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_455",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'COLLECT': expected 'FOREACH', ',', 'ORDER BY', 'CALL', 'CREATE', 'LOAD CSV', 'DELETE', 'DETACH', 'FINISH', 'INSERT', 'LIMIT', 'MATCH', 'MERGE', 'NODETACH', 'OFFSET', 'OPTIONAL', 'REMOVE', 'RETURN', 'SET', 'SKIP', 'UNION', 'UNWIND', 'USE', 'WHERE', 'WITH' or <EOF> (line 1, column 153 (offset: 152))\n\"MATCH (p1:Person)-[:KNOWS]->(p2:Person)-[:HAS_PHONE]->(phone:Phone {phoneNo: '2-(716)295-6678'}) WHERE p1.age IS NOT NULL WITH toInteger(p1.age) AS age COLLECT age RETURN avg(age)\"\n                                                                                                                                                         ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "What is the average call duration for phone calls made to phones that are associated with people who are family members of people named 'Michael Martin'?",
    "Cypher": "MATCH (p1:Person {name: 'Michael', surname: 'Martin'})-[:FAMILY_REL]->(p2:Person)-[:HAS_PHONE]->(phone:Phone)<-[:CALLED]-(call:PhoneCall) WHERE call.call_duration IS NOT NULL WITH toInteger(call.call_duration) AS duration COLLECT duration RETURN avg(duration)",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 457,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_457",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'COLLECT': expected 'FOREACH', ',', 'ORDER BY', 'CALL', 'CREATE', 'LOAD CSV', 'DELETE', 'DETACH', 'FINISH', 'INSERT', 'LIMIT', 'MATCH', 'MERGE', 'NODETACH', 'OFFSET', 'OPTIONAL', 'REMOVE', 'RETURN', 'SET', 'SKIP', 'UNION', 'UNWIND', 'USE', 'WHERE', 'WITH' or <EOF> (line 1, column 223 (offset: 222))\n\"MATCH (p1:Person {name: 'Michael', surname: 'Martin'})-[:FAMILY_REL]->(p2:Person)-[:HAS_PHONE]->(phone:Phone)<-[:CALLED]-(call:PhoneCall) WHERE call.call_duration IS NOT NULL WITH toInteger(call.call_duration) AS duration COLLECT duration RETURN avg(duration)\"\n                                                                                                                                                                                                                               ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each postcode area, what is the average number of people who CURRENT_ADDRESS in that area and have HAS_PHONE relationship with phones that received phone calls of type 'SMS'?",
    "Cypher": "MATCH (p:Person)-[:CURRENT_ADDRESS]->(l:Location)-[:HAS_POSTCODE]->(pc:PostCode) MATCH (p)-[:HAS_PHONE]->(ph:Phone)<-[:CALLED]-(pc2:PhoneCall {call_type: 'SMS'}) WITH pc.code AS postcode, p RETURN postcode, count(p) AS peopleCount ORDER BY postcode RETURN postcode, avg(peopleCount)",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 459,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_459",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: RETURN can only be used at the end of the query. (line 1, column 191 (offset: 190))\n\"MATCH (p:Person)-[:CURRENT_ADDRESS]->(l:Location)-[:HAS_POSTCODE]->(pc:PostCode) MATCH (p)-[:HAS_PHONE]->(ph:Phone)<-[:CALLED]-(pc2:PhoneCall {call_type: 'SMS'}) WITH pc.code AS postcode, p RETURN postcode, count(p) AS peopleCount ORDER BY postcode RETURN postcode, avg(peopleCount)\"\n                                                                                                                                                                                               ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each type of crime, find the average number of objects involved and the total number of investigations led by officers with the rank 'Sergeant'. Return the crime type, average number of objects, and total investigations.",
    "Cypher": "MATCH (c:Crime)<-[r:INVOLVED_IN]-(o:Object)\nWITH c, count(o) AS objectCount\nMATCH (c)<-[:INVESTIGATED_BY]-(officer:Officer) WHERE officer.rank = 'Sergeant'\nWITH c, objectCount, count(officer) AS sergeantInvestigations\nRETURN c.type AS CrimeType, avg(objectCount) AS AverageObjectsInvolved, sum(sergeantInvestigations) AS TotalSergeantInvestigations",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 469,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_469",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each officer rank, find the average number of crimes investigated and the total number of vehicles involved in those crimes. Return the officer rank, average crimes investigated, and total vehicles involved.",
    "Cypher": "MATCH (o:Officer)-[:INVESTIGATED_BY]->(c:Crime)<-[:INVOLVED_IN]-(v:Vehicle)\nWITH o.rank AS OfficerRank, c, v\nWITH OfficerRank, count(DISTINCT c) AS CrimesInvestigated, count(DISTINCT v) AS VehiclesInvolved\nRETURN OfficerRank, avg(CrimesInvestigated) AS AverageCrimesInvestigated, sum(VehiclesInvolved) AS TotalVehiclesInvolved",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 472,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_472",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each postcode, what is the average number of crimes reported and the average number of phone calls made from phones associated with people living at that postcode?",
    "Cypher": "MATCH (l:Location)-[:HAS_POSTCODE]->(pc:PostCode)<-[:CURRENT_ADDRESS]-(p:Person)-[:HAS_PHONE]->(ph:Phone)<-[:CALLED]-(pcall:PhoneCall) WITH pc, COUNT(DISTINCT pcall) AS callCount MATCH (cr:Crime)-[:OCCURRED_AT]->(l) WHERE l-[:HAS_POSTCODE]->(pc) WITH pc, callCount, COUNT(DISTINCT cr) AS crimeCount RETURN pc.code, AVG(callCount), AVG(crimeCount)",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 480,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_480",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input ':': expected an expression (line 1, column 226 (offset: 225))\n\"MATCH (l:Location)-[:HAS_POSTCODE]->(pc:PostCode)<-[:CURRENT_ADDRESS]-(p:Person)-[:HAS_PHONE]->(ph:Phone)<-[:CALLED]-(pcall:PhoneCall) WITH pc, COUNT(DISTINCT pcall) AS callCount MATCH (cr:Crime)-[:OCCURRED_AT]->(l) WHERE l-[:HAS_POSTCODE]->(pc) WITH pc, callCount, COUNT(DISTINCT cr) AS crimeCount RETURN pc.code, AVG(callCount), AVG(crimeCount)\"\n                                                                                                                                                                                                                                  ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each area code, what is the average number of crimes occurring and the average age of people living at locations within that area?",
    "Cypher": "MATCH (l:Location)-[:LOCATION_IN_AREA]->(a:Area) WITH a.areaCode AS areaCode, l MATCH (p:Person)-[:CURRENT_ADDRESS]->(l) WITH areaCode, AVG(toInt(p.age)) AS avgAge, l MATCH (c:Crime)-[:OCCURRED_AT]->(l) WITH areaCode, avgAge, COUNT(DISTINCT c) AS crimeCount RETURN areaCode, AVG(crimeCount) AS avgCrimeCount, avgAge",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 484,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_484",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 1, column 141 (offset: 140))\n\"MATCH (l:Location)-[:LOCATION_IN_AREA]->(a:Area) WITH a.areaCode AS areaCode, l MATCH (p:Person)-[:CURRENT_ADDRESS]->(l) WITH areaCode, AVG(toInt(p.age)) AS avgAge, l MATCH (c:Crime)-[:OCCURRED_AT]->(l) WITH areaCode, avgAge, COUNT(DISTINCT c) AS crimeCount RETURN areaCode, AVG(crimeCount) AS avgCrimeCount, avgAge\"\n                                                                                                                                             ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each officer rank, what is the average number of crimes they investigated and the total number of people involved in those crimes?",
    "Cypher": "MATCH (o:Officer)-[:INVESTIGATED_BY]->(c:Crime) WITH o.rank AS officerRank, c MATCH (p:Person)-[:PARTY_TO]->(c) WITH officerRank, COUNT(DISTINCT p) AS peopleCount, c WITH officerRank, AVG(peopleCount) AS avgPeopleCount, COUNT(DISTINCT c) AS crimeCount RETURN officerRank, crimeCount, avgPeopleCount",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 486,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_486",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "Considering crimes investigated by officers, what is the average number of objects involved in each crime, and what is the average number of vehicles involved in each crime, grouped by the officer's rank?",
    "Cypher": "MATCH (o:Officer)-[:INVESTIGATED_BY]->(c:Crime)\nWITH o.rank AS officerRank, c\nOPTIONAL MATCH (c)<-[:INVOLVED_IN]-(obj:Object)\nWITH officerRank, c, COUNT(obj) AS numObjects\nOPTIONAL MATCH (c)<-[:INVOLVED_IN]-(v:Vehicle)\nWITH officerRank, AVG(numObjects) AS avgObjects, COUNT(v) AS numVehicles\nRETURN officerRank, avgObjects, AVG(numVehicles) AS avgVehicles",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 501,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_501",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "What is the average age of people who are involved in crimes, grouped by the type of crime?",
    "Cypher": "MATCH (p:Person)-[:PARTY_TO]->(c:Crime) WHERE p.age IS NOT NULL WITH c.type AS crimeType, toInteger(p.age) AS personAge RETURN crimeType, AVG(personAge)",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 506,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_506",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each type of crime, what is the average number of officers investigating crimes of that type and what is the average number of objects involved in those crimes?",
    "Cypher": "MATCH (c:Crime)-[:INVESTIGATED_BY]->(o:Officer) WITH c.type AS crimeType, COUNT(DISTINCT o) AS officerCount MATCH (c2:Crime)-[:INVOLVED_IN]<- (ob:Object) WHERE c2.type = crimeType WITH crimeType, AVG(officerCount) AS avgOfficers, COUNT(DISTINCT ob) AS objectCount RETURN crimeType, avgOfficers, AVG(objectCount)",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 514,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_514",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input '<': expected '-' (line 1, column 140 (offset: 139))\n\"MATCH (c:Crime)-[:INVESTIGATED_BY]->(o:Officer) WITH c.type AS crimeType, COUNT(DISTINCT o) AS officerCount MATCH (c2:Crime)-[:INVOLVED_IN]<- (ob:Object) WHERE c2.type = crimeType WITH crimeType, AVG(officerCount) AS avgOfficers, COUNT(DISTINCT ob) AS objectCount RETURN crimeType, avgOfficers, AVG(objectCount)\"\n                                                                                                                                            ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each area, what is the average number of crimes that occurred at locations within that area, and what is the average number of vehicles involved in those crimes?",
    "Cypher": "MATCH (c:Crime)-[:OCCURRED_AT]->(l:Location)-[:LOCATION_IN_AREA]->(a:Area) WITH a.areaCode AS areaCode, COUNT(c) AS crimeCount MATCH (c2:Crime)-[:INVOLVED_IN]->(v:Vehicle) -[:OCCURRED_AT]->(l:Location)-[:LOCATION_IN_AREA]->(a:Area) WHERE a.areaCode = areaCode WITH areaCode, AVG(crimeCount) AS avgCrimes, COUNT(DISTINCT v) AS vehicleCount RETURN areaCode, avgCrimes, AVG(vehicleCount)",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 515,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_515",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each type of crime, calculate the average number of objects involved and the average number of vehicles involved. Return the crime type, average objects, and average vehicles.",
    "Cypher": "MATCH (c:Crime)<-[:INVOLVED_IN]-(o:Object) WITH c, count(o) AS objectCount MATCH (c)<-[:INVOLVED_IN]-(v:Vehicle) WITH c, objectCount, count(v) AS vehicleCount RETURN c.type, avg(objectCount), avg(vehicleCount)",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 518,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_518",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each person, find the total number of phone calls made to their phone numbers and the average call duration. Return the person's name, total calls, and average call duration.",
    "Cypher": "MATCH (p:Person)-[:HAS_PHONE]->(ph:Phone)<-[:CALLED]-(pc:PhoneCall) WITH p, count(pc) AS totalCalls, collect(toFloat(pc.call_duration)) AS durations RETURN p.name, totalCalls, avg(durations[i] IN durations WHERE durations[i] IS NOT NULL | durations[i])",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 519,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_519",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'WHERE': expected an expression, ')' or ',' (line 1, column 207 (offset: 206))\n\"MATCH (p:Person)-[:HAS_PHONE]->(ph:Phone)<-[:CALLED]-(pc:PhoneCall) WITH p, count(pc) AS totalCalls, collect(toFloat(pc.call_duration)) AS durations RETURN p.name, totalCalls, avg(durations[i] IN durations WHERE durations[i] IS NOT NULL | durations[i])\"\n                                                                                                                                                                                                               ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each person, calculate the number of crimes they are party to and the average call duration of phone calls made to phones associated with them. Return the person's name, crime count, and average call duration.",
    "Cypher": "MATCH (p:Person)-[:PARTY_TO]->(c:Crime) WITH p, count(c) AS crimeCount MATCH (p)-[:HAS_PHONE]->(ph:Phone)<-[:CALLED]-(pc:PhoneCall) WITH p, crimeCount, collect(toFloat(pc.call_duration)) AS durations RETURN p.name, crimeCount, avg(durations[i] IN durations WHERE durations[i] IS NOT NULL | durations[i])",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 521,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_521",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'WHERE': expected an expression, ')' or ',' (line 1, column 258 (offset: 257))\n\"MATCH (p:Person)-[:PARTY_TO]->(c:Crime) WITH p, count(c) AS crimeCount MATCH (p)-[:HAS_PHONE]->(ph:Phone)<-[:CALLED]-(pc:PhoneCall) WITH p, crimeCount, collect(toFloat(pc.call_duration)) AS durations RETURN p.name, crimeCount, avg(durations[i] IN durations WHERE durations[i] IS NOT NULL | durations[i])\"\n                                                                                                                                                                                                                                                                  ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each postcode, determine the total number of crimes that occurred at locations with that postcode and the average age of people who are party to those crimes. Return the postcode, total crimes, and average age.",
    "Cypher": "MATCH (pc:PostCode)<-[:HAS_POSTCODE]-(l:Location)<-[:OCCURRED_AT]-(cr:Crime) WITH pc, cr MATCH (cr)<-[:PARTY_TO]-(p:Person) WITH pc, cr, p.age as age WHERE age IS NOT NULL WITH pc, count(DISTINCT cr) AS totalCrimes, collect(toFloat(age)) AS ages RETURN pc.code, totalCrimes, avg(ages[i] IN ages WHERE ages[i] IS NOT NULL | ages[i])",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 522,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_522",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'WHERE': expected an expression, ')' or ',' (line 1, column 296 (offset: 295))\n\"MATCH (pc:PostCode)<-[:HAS_POSTCODE]-(l:Location)<-[:OCCURRED_AT]-(cr:Crime) WITH pc, cr MATCH (cr)<-[:PARTY_TO]-(p:Person) WITH pc, cr, p.age as age WHERE age IS NOT NULL WITH pc, count(DISTINCT cr) AS totalCrimes, collect(toFloat(age)) AS ages RETURN pc.code, totalCrimes, avg(ages[i] IN ages WHERE ages[i] IS NOT NULL | ages[i])\"\n                                                                                                                                                                                                                                                                                                        ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each person, calculate the total number of distinct phone numbers they KNOWS_PHONE and HAS_PHONE, along with the average call duration of calls made to phones they KNOWS_PHONE.",
    "Cypher": "MATCH (p:Person)-[:KNOWS_PHONE]->(phone:Phone)<-[:CALLED]-(call:PhoneCall)\nWITH p, phone, AVG(toInteger(call.call_duration)) AS avgDuration\nMATCH (p)-[:HAS_PHONE]->(phone2:Phone)\nWITH p, COLLECT(DISTINCT phone.phoneNo) + COLLECT(DISTINCT phone2.phoneNo) AS allPhoneNumbers, avgDuration\nRETURN p.name, SIZE(allPhoneNumbers) AS totalPhoneNumbers, avgDuration",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 534,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_534",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each officer rank, determine the average number of crimes investigated by officers of that rank and the total number of distinct locations where those crimes occurred.",
    "Cypher": "MATCH (o:Officer)-[:INVESTIGATED_BY]->(c:Crime)-[:OCCURRED_AT]->(l:Location)\nWITH o.rank AS officerRank, o, c, l\nWITH officerRank, COUNT(DISTINCT c) AS crimeCount, COLLECT(DISTINCT l) AS locations\nRETURN officerRank, AVG(crimeCount) AS avgCrimes, SIZE(locations) AS totalLocations",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 535,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_535",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each year, calculate the total number of vehicle crimes and the average number of objects involved in all crimes that year.",
    "Cypher": "MATCH (c:Crime)<-[:INVOLVED_IN]-(o:Object)\nWITH c, o\nWHERE c.type = 'Vehicle crime'\nWITH substring(c.date, length(c.date) - 3, 4) AS crimeYear, COUNT(DISTINCT c) AS vehicleCrimeCount, COUNT(DISTINCT o) AS objectCount\nRETURN crimeYear, vehicleCrimeCount, AVG(objectCount) AS avgObjects",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 536,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_536",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Type mismatch: expected Path but was Boolean, Float, Integer, Number, Point, String, Duration, Date, Time, LocalTime, LocalDateTime, DateTime, List<Boolean>, List<Float>, List<Integer>, List<Number>, List<Point>, List<String>, List<Duration>, List<Date>, List<Time>, List<LocalTime>, List<LocalDateTime> or List<DateTime> (line 4, column 31 (offset: 114))\n\"WITH substring(c.date, length(c.date) - 3, 4) AS crimeYear, COUNT(DISTINCT c) AS vehicleCrimeCount, COUNT(DISTINCT o) AS objectCount\"\n                               ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each officer, what is the average duration of phone calls related to crimes they investigated?",
    "Cypher": "MATCH (o:Officer)-[:INVESTIGATED_BY]->(c:Crime) MATCH (c)-[:OCCURRED_AT]->(l:Location) MATCH (phc:PhoneCall)-[:CALLED]->(ph:Phone) WITH o, c, phc.call_duration AS callDuration WHERE toInteger(phc.call_duration) IS NOT NULL WITH o.name AS officerName, AVG(toInteger(callDuration)) AS averageCallDuration RETURN officerName, averageCallDuration",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 543,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_543",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each postcode area, calculate the total number of persons currently residing there and the average age of those persons.",
    "Cypher": "MATCH (p:Person)-[:CURRENT_ADDRESS]->(l:Location)-[:HAS_POSTCODE]->(pc:PostCode) WITH pc.code AS postcode, p.age AS personAge, COUNT(p) AS personCount RETURN postcode, sum(toInt(personCount)) AS totalPersons, avg(toInt(personAge)) AS averageAge",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 554,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_554",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 1, column 173 (offset: 172))\n\"MATCH (p:Person)-[:CURRENT_ADDRESS]->(l:Location)-[:HAS_POSTCODE]->(pc:PostCode) WITH pc.code AS postcode, p.age AS personAge, COUNT(p) AS personCount RETURN postcode, sum(toInt(personCount)) AS totalPersons, avg(toInt(personAge)) AS averageAge\"\n                                                                                                                                                                             ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "Calculate the average call duration for each phone, and then find the average of these average call durations across all phones.",
    "Cypher": "MATCH (pc:PhoneCall)-[:CALLED]->(p:Phone) WITH p.phoneNo AS phoneNo, avg(toInt(pc.call_duration)) AS avgDurationPerPhone WITH avg(avgDurationPerPhone) AS overallAvgDuration RETURN overallAvgDuration",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 555,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_555",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 1, column 74 (offset: 73))\n\"MATCH (pc:PhoneCall)-[:CALLED]->(p:Phone) WITH p.phoneNo AS phoneNo, avg(toInt(pc.call_duration)) AS avgDurationPerPhone WITH avg(avgDurationPerPhone) AS overallAvgDuration RETURN overallAvgDuration\"\n                                                                          ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each area code, determine the total number of people living in locations within that area and the average number of phone calls made from phones to people living in that area.",
    "Cypher": "MATCH (p:Person)-[:CURRENT_ADDRESS]->(l:Location)-[:LOCATION_IN_AREA]->(a:Area) WITH a.areaCode AS areaCode, p MATCH (pc:PhoneCall)-[:CALLED]->(ph:Phone)<-[:HAS_PHONE]-(p) WHERE p-[:CURRENT_ADDRESS]->(l:Location)-[:LOCATION_IN_AREA]->(a:Area) WITH areaCode, COUNT(DISTINCT p) AS peopleCount, COUNT(pc) AS callCount RETURN areaCode, peopleCount, toFloat(callCount) / peopleCount AS avgCallsPerPerson",
    "source_dataset": "pole",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 557,
    "unique_id": "pole_data_3_2_2_6_Complex_Aggregation_557",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input ':': expected an expression (line 1, column 182 (offset: 181))\n\"MATCH (p:Person)-[:CURRENT_ADDRESS]->(l:Location)-[:LOCATION_IN_AREA]->(a:Area) WITH a.areaCode AS areaCode, p MATCH (pc:PhoneCall)-[:CALLED]->(ph:Phone)<-[:HAS_PHONE]-(p) WHERE p-[:CURRENT_ADDRESS]->(l:Location)-[:LOCATION_IN_AREA]->(a:Area) WITH areaCode, COUNT(DISTINCT p) AS peopleCount, COUNT(pc) AS callCount RETURN areaCode, peopleCount, toFloat(callCount) / peopleCount AS avgCallsPerPerson\"\n                                                                                                                                                                                      ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  }
]