[
  {
    "NL Question": "For each book, find the average PageRank of persons who appeared in it and died in it. Return the book name and the average PageRank.",
    "Cypher": "MATCH (p:Person)-[:APPEARED_IN]->(b:Book) WITH b, collect(p) AS appearingPersons MATCH (deadPerson:Person)-[:DIED_IN]->(b) WHERE deadPerson IN appearingPersons WITH b, collect(deadPerson.pageRank) AS pageRanks WHERE size(pageRanks) > 0 RETURN b.name AS Book, avg(element) AS AveragePageRank",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 14,
    "unique_id": "gdsc_data_3_1_2_6_Complex_Aggregation_14",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `element` not defined (line 1, column 264 (offset: 263))\n\"MATCH (p:Person)-[:APPEARED_IN]->(b:Book) WITH b, collect(p) AS appearingPersons MATCH (deadPerson:Person)-[:DIED_IN]->(b) WHERE deadPerson IN appearingPersons WITH b, collect(deadPerson.pageRank) AS pageRanks WHERE size(pageRanks) > 0 RETURN b.name AS Book, avg(element) AS AveragePageRank\"\n                                                                                                                                                                                                                                                                        ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each culture, calculate the average age of persons who are members of that culture and have the status 'Noble'. Return the culture name and the average age.",
    "Cypher": "MATCH (p:Person)-[:MEMBER_OF_CULTURE]->(c:Culture) MATCH (p)-[:HAS_STATUS]->(s:Status {name: 'Noble'}) WITH c, collect(p.age) AS ages WHERE size(ages) > 0 RETURN c.name AS Culture, avg(element) AS AverageAge",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 15,
    "unique_id": "gdsc_data_3_1_2_6_Complex_Aggregation_15",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `element` not defined (line 1, column 186 (offset: 185))\n\"MATCH (p:Person)-[:MEMBER_OF_CULTURE]->(c:Culture) MATCH (p)-[:HAS_STATUS]->(s:Status {name: 'Noble'}) WITH c, collect(p.age) AS ages WHERE size(ages) > 0 RETURN c.name AS Culture, avg(element) AS AverageAge\"\n                                                                                                                                                                                          ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each house, find the average PageRank of kings who belong to that house. Return the house name and the average PageRank.",
    "Cypher": "MATCH (k:King)-[:BELONGS_TO]->(h:House) WITH h, collect(k.pageRank) AS pageRanks WHERE size(pageRanks) > 0 RETURN h.name AS House, avg(element) AS AveragePageRank",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 16,
    "unique_id": "gdsc_data_3_1_2_6_Complex_Aggregation_16",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `element` not defined (line 1, column 136 (offset: 135))\n\"MATCH (k:King)-[:BELONGS_TO]->(h:House) WITH h, collect(k.pageRank) AS pageRanks WHERE size(pageRanks) > 0 RETURN h.name AS House, avg(element) AS AveragePageRank\"\n                                                                                                                                        ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each region, determine the average attacker size of battles that occurred in locations within that region. Return the region name and the average attacker size.",
    "Cypher": "MATCH (b:Battle)-[:IS_IN]->(l:Location)-[:IS_IN]->(r:Region) WITH r, collect(b.attacker_size) AS attackerSizes WHERE size(attackerSizes) > 0 RETURN r.name AS Region, avg(element) AS AverageAttackerSize",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 17,
    "unique_id": "gdsc_data_3_1_2_6_Complex_Aggregation_17",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `element` not defined (line 1, column 171 (offset: 170))\n\"MATCH (b:Battle)-[:IS_IN]->(l:Location)-[:IS_IN]->(r:Region) WITH r, collect(b.attacker_size) AS attackerSizes WHERE size(attackerSizes) > 0 RETURN r.name AS Region, avg(element) AS AverageAttackerSize\"\n                                                                                                                                                                           ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each book, calculate the average age of persons who both appeared in the book and died in the book, and whose house is 'Buckler'. Return the book name and average age.",
    "Cypher": "MATCH (p:Person)-[:APPEARED_IN]->(b:Book) WITH b, collect(p) AS appearingPersons MATCH (deadPerson:Person)-[:DIED_IN]->(b) WHERE deadPerson IN appearingPersons MATCH (deadPerson)-[:BELONGS_TO]->(h:House {name: 'Buckler'}) WITH b, collect(deadPerson.age) AS ages WHERE size(ages) > 0 RETURN b.name AS Book, avg(element) AS AverageAge",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 18,
    "unique_id": "gdsc_data_3_1_2_6_Complex_Aggregation_18",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `element` not defined (line 1, column 311 (offset: 310))\n\"MATCH (p:Person)-[:APPEARED_IN]->(b:Book) WITH b, collect(p) AS appearingPersons MATCH (deadPerson:Person)-[:DIED_IN]->(b) WHERE deadPerson IN appearingPersons MATCH (deadPerson)-[:BELONGS_TO]->(h:House {name: 'Buckler'}) WITH b, collect(deadPerson.age) AS ages WHERE size(ages) > 0 RETURN b.name AS Book, avg(element) AS AverageAge\"\n                                                                                                                                                                                                                                                                                                                       ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "What is the average pageRank of people who are related to Stannis Baratheon and belong to House Erenford?",
    "Cypher": "MATCH (p:Person)-[:RELATED_TO]->(k:King {name: 'Stannis Baratheon'}) MATCH (p)-[:BELONGS_TO]->(h:House {name: 'Erenford'}) RETURN avg(p.pageRank) AS AveragePageRank",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 39,
    "unique_id": "gdsc_data_3_1_2_6_Complex_Aggregation_39",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Content: Results only contain null or zero values.",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "Results returned successfully.",
    "neo4j_result_passed": 1,
    "content_validation": "Results only contain null or zero values.",
    "content_passed": 0
  },
  {
    "NL Question": "For each house, calculate the average pageRank of persons belonging to that house who died in 'Dance with dragons', and also the total number of such persons. Return the house name, the average pageRank, and the count of persons.",
    "Cypher": "MATCH (p:Person)-[:BELONGS_TO]->(h:House) WHERE (p)-[:DIED_IN]->(b:Book {name: 'Dance with dragons'}) WITH h, p.pageRank AS personPageRank,p.name AS personName  RETURN h.name AS House, avg(personPageRank) AS AveragePageRank, count(personName) AS PersonCount",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 77,
    "unique_id": "gdsc_data_3_1_2_6_Complex_Aggregation_77",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: PatternExpressions are not allowed to introduce new variables: 'b'. (line 1, column 66 (offset: 65))\n\"MATCH (p:Person)-[:BELONGS_TO]->(h:House) WHERE (p)-[:DIED_IN]->(b:Book {name: 'Dance with dragons'}) WITH h, p.pageRank AS personPageRank,p.name AS personName  RETURN h.name AS House, avg(personPageRank) AS AveragePageRank, count(personName) AS PersonCount\"\n                                                                  ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each region, find the average pageRank of people who reside in that region, and also count the total number of battles fought within that region. Return the region's name, the average pageRank of its people, and the number of battles fought there.",
    "Cypher": "MATCH (l:Location)-[:IS_IN]->(r:Region)<-[:BELONGS_TO]-(p:Person)\nWITH r, AVG(p.pageRank) AS avgPageRank\nMATCH (l:Location)-[:IS_IN]->(r:Region)<-[:IS_IN]-(b:Battle)\nWITH r, avgPageRank, COUNT(b) AS battleCount\nRETURN r.name AS Region, avgPageRank, battleCount",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 102,
    "unique_id": "gdsc_data_3_1_2_6_Complex_Aggregation_102",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each book, compute the average age of persons who appeared in it and also died in it. Additionally, count the number of battles that occurred in the same year as the book's sequence number. Return the book name, average age, and battle count.",
    "Cypher": "MATCH (p:Person)-[:APPEARED_IN]->(b:Book), (p)-[:DIED_IN]->(b) WITH b, AVG(p.age) AS avgAge MATCH (bt:Battle) WHERE bt.year = b.sequence WITH b, avgAge, COUNT(bt) AS battleCount RETURN b.name, avgAge, battleCount",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 116,
    "unique_id": "gdsc_data_3_1_2_6_Complex_Aggregation_116",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "Calculate the average age of persons who belong to each culture, and determine the number of battles in which houses of that culture participated as either attackers or defenders.",
    "Cypher": "MATCH (p:Person)-[:MEMBER_OF_CULTURE]->(c:Culture) WITH c, AVG(p.age) AS avgAge MATCH (h:House)-[:ATTACKER|:DEFENDER]->(bat:Battle) WHERE (p)-[:BELONGS_TO]->(h) WITH c, avgAge, COUNT(DISTINCT bat) AS battleCount RETURN c.name AS Culture, avgAge, battleCount",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 134,
    "unique_id": "gdsc_data_3_1_2_6_Complex_Aggregation_134",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: PatternExpressions are not allowed to introduce new variables: 'p'. (line 1, column 140 (offset: 139))\n\"MATCH (p:Person)-[:MEMBER_OF_CULTURE]->(c:Culture) WITH c, AVG(p.age) AS avgAge MATCH (h:House)-[:ATTACKER|:DEFENDER]->(bat:Battle) WHERE (p)-[:BELONGS_TO]->(h) WITH c, avgAge, COUNT(DISTINCT bat) AS battleCount RETURN c.name AS Culture, avgAge, battleCount\"\n                                                                                                                                            ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each house, what is the average age of its members who appeared in 'Game of thrones', and how many members appeared in that book?",
    "Cypher": "MATCH (p:Person)-[:BELONGS_TO]->(h:House)-[:APPEARED_IN]->(b:Book {name: 'Game of thrones'}) WITH h.name AS houseName, AVG(p.age) AS avgAge, COUNT(p) AS totalMembers RETURN houseName, avgAge, totalMembers",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 164,
    "unique_id": "gdsc_data_3_1_2_6_Complex_Aggregation_164",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each region, find the average pageRank of persons who live there and the total number of battles that occurred there. Return the region name, average pageRank, and total battle count.",
    "Cypher": "MATCH (p:Person)-[:APPEARED_IN]->(b:Book) WITH b, AVG(p.pageRank) AS avgPageRank MATCH (b)-[:DIED_IN]->(p2:Person) WITH b, avgPageRank, AVG(p2.age) AS avgAge RETURN b.name, avgPageRank, avgAge",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 178,
    "unique_id": "gdsc_data_3_1_2_6_Complex_Aggregation_178",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each book, find the average pageRank of persons who appeared in it and also find the number of battles that happened in the same year as the book was published. Return the book name, average pageRank of persons, and the count of battles.",
    "Cypher": "MATCH (p:Person)-[:APPEARED_IN]->(b:Book) WITH b, AVG(p.pageRank) AS avgPageRank MATCH (battle:Battle) WHERE battle.year = b.sequence WITH b.name AS bookName, avgPageRank, COUNT(battle) AS battleCount RETURN bookName, avgPageRank, battleCount",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 182,
    "unique_id": "gdsc_data_3_1_2_6_Complex_Aggregation_182",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each region, calculate the average attacker_size of battles that took place there and the number of distinct houses that participated as defenders in those battles. Return the region name, average attacker size, and the count of defender houses.",
    "Cypher": "MATCH (b:Battle)-[:IS_IN]->(l:Location)-[:IS_IN]->(r:Region) WITH r, AVG(b.attacker_size) AS avgAttackerSize MATCH (h:House)-[:DEFENDER]->(b) WHERE (b)-[:IS_IN]->(l:Location)-[:IS_IN]->(r:Region) WITH r.name AS regionName, avgAttackerSize, h RETURN regionName, avgAttackerSize, COUNT(DISTINCT h) AS defenderHousesCount",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 185,
    "unique_id": "gdsc_data_3_1_2_6_Complex_Aggregation_185",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: PatternExpressions are not allowed to introduce new variables: 'l'. (line 1, column 164 (offset: 163))\n\"MATCH (b:Battle)-[:IS_IN]->(l:Location)-[:IS_IN]->(r:Region) WITH r, AVG(b.attacker_size) AS avgAttackerSize MATCH (h:House)-[:DEFENDER]->(b) WHERE (b)-[:IS_IN]->(l:Location)-[:IS_IN]->(r:Region) WITH r.name AS regionName, avgAttackerSize, h RETURN regionName, avgAttackerSize, COUNT(DISTINCT h) AS defenderHousesCount\"\n                                                                                                                                                                    ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "Calculate the average pageRank of all Persons, Kings, Knights, and Dead. Also, compute the total number of Persons, Kings, Knights and Dead.",
    "Cypher": "MATCH (n) WHERE n:Person OR n:King OR n:Knight OR n:Dead WITH labels(n)[0] AS label, n.pageRank AS pageRank RETURN label, AVG(pageRank), COUNT(n)",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 198,
    "unique_id": "gdsc_data_3_1_2_6_Complex_Aggregation_198",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `n` not defined (line 1, column 144 (offset: 143))\n\"MATCH (n) WHERE n:Person OR n:King OR n:Knight OR n:Dead WITH labels(n)[0] AS label, n.pageRank AS pageRank RETURN label, AVG(pageRank), COUNT(n)\"\n                                                                                                                                                ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each region, what is the average pageRank of persons who are located in that region and what is the total number of distinct cultures these persons belong to?",
    "Cypher": "MATCH (l:Location)-[:IS_IN]->(r:Region)<-[:IS_IN]-(b:Battle) WITH r, AVG(b.attacker_size) AS avgAttackerSize MATCH (p:Person)-[:MEMBER_OF_CULTURE]->(c:Culture) WITH r, avgAttackerSize, COUNT(DISTINCT c) AS cultureCount RETURN r.name, avgAttackerSize, cultureCount",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 241,
    "unique_id": "gdsc_data_3_1_2_6_Complex_Aggregation_241",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "What is the average attacker_size and defender_size for battles that took place in 'The Reach'?",
    "Cypher": "MATCH (b:Battle)-[:IS_IN]->(l:Location)-[:IS_IN]->(r:Region {name: 'The Reach'}) WITH b.attacker_size AS attacker_size, b.defender_size AS defender_size WHERE attacker_size IS NOT NULL AND defender_size IS NOT NULL RETURN AVG(attacker_size) AS averageAttackerSize, AVG(defender_size) AS averageDefenderSize",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 254,
    "unique_id": "gdsc_data_3_1_2_6_Complex_Aggregation_254",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Content: Results only contain null or zero values.",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "Results returned successfully.",
    "neo4j_result_passed": 1,
    "content_validation": "Results only contain null or zero values.",
    "content_passed": 0
  },
  {
    "NL Question": "For each house, calculate the average pageRank of its members and the number of members who died in a book.",
    "Cypher": "MATCH (p:Person)-[:BELONGS_TO]->(h:House) OPTIONAL MATCH (p)-[:DIED_IN]->(b:Book) WITH h, AVG(p.pageRank) AS avgPageRank, CASE WHEN b IS NOT NULL THEN COUNT(DISTINCT p) ELSE 0 END AS diedInBookCount RETURN h.name, avgPageRank, SUM(diedInBookCount)",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 270,
    "unique_id": "gdsc_data_3_1_2_6_Complex_Aggregation_270",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Aggregation column contains implicit grouping expressions. For example, in 'RETURN n.a, n.a + n.b + count(*)' the aggregation expression 'n.a + n.b + count(*)' includes the implicit grouping key 'n.b'. It may be possible to rewrite the query by extracting these grouping/aggregation expressions into a preceding WITH clause. Illegal expression(s): b (line 1, column 133 (offset: 132))\n\"MATCH (p:Person)-[:BELONGS_TO]->(h:House) OPTIONAL MATCH (p)-[:DIED_IN]->(b:Book) WITH h, AVG(p.pageRank) AS avgPageRank, CASE WHEN b IS NOT NULL THEN COUNT(DISTINCT p) ELSE 0 END AS diedInBookCount RETURN h.name, avgPageRank, SUM(diedInBookCount)\"\n                                                                                                                                     ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each house, find the average pageRank of its members who died in a battle and also count the number of members who died in battles. Return the house name, average pageRank of members who died in battles, and the total count of members who died in battles.",
    "Cypher": "MATCH (p:Person)-[:BELONGS_TO]->(h:House) MATCH (p)-[:DIED_IN]->(b:Book) WHERE (b:Battle) WITH h, AVG(p.pageRank) AS avgPageRank, p WITH h.name AS houseName, avgPageRank, COUNT(p) AS memberCount RETURN houseName, avgPageRank, memberCount",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 283,
    "unique_id": "gdsc_data_3_1_2_6_Complex_Aggregation_283",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each Region, find the average PageRank of Persons located within it and the average PageRank of Dead characters located within it. Show the Region name, average Person PageRank, and average Dead PageRank.",
    "Cypher": "MATCH (l:Location)-[:IS_IN]->(r:Region)<-[:IS_IN]-(p:Person) WITH r, AVG(p.pageRank) AS avgPersonPageRank MATCH (l:Location)-[:IS_IN]->(r:Region)<-[:IS_IN]-(d:Dead) WITH r, avgPersonPageRank, AVG(d.pageRank) AS avgDeadPageRank RETURN r.name AS Region, avgPersonPageRank, avgDeadPageRank",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 311,
    "unique_id": "gdsc_data_3_1_2_6_Complex_Aggregation_311",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each house, determine the average age of members and the count of members who have the status 'Noble'. Return the house name, average age, and count of 'Noble' members.",
    "Cypher": "MATCH (p:Person)-[:BELONGS_TO]->(h:House) WITH h, AVG(p.age) AS avgAge MATCH (n:Person)-[:BELONGS_TO]->(h)-[:HAS_STATUS]->(s:Status) WHERE s.name = 'Noble' WITH h, avgAge, COUNT(n) AS nobleCount RETURN h.name AS House, avgAge, nobleCount",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 323,
    "unique_id": "gdsc_data_3_1_2_6_Complex_Aggregation_323",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each culture, find the average pageRank of its members and the total number of members who died in a book named 'Storm of swords'. Return the culture name, average pageRank, and total deaths in that specific book.",
    "Cypher": "MATCH (p:Person)-[:MEMBER_OF_CULTURE]->(c:Culture) WITH c, AVG(p.pageRank) AS avgPageRank MATCH (d:Dead)-[:MEMBER_OF_CULTURE]->(c)-[:DIED_IN]->(b:Book) WHERE b.name = 'Storm of swords' WITH c, avgPageRank, COUNT(d) AS totalDeaths RETURN c.name AS Culture, avgPageRank, totalDeaths",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 324,
    "unique_id": "gdsc_data_3_1_2_6_Complex_Aggregation_324",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each region, determine the average age of persons located in that region and the total number of battles that took place there with a major death. Return the region name, average age, and total battles with major deaths.",
    "Cypher": "MATCH (p:Person)-[:APPEARED_IN]->(b:Book)-[:DIED_IN]->(l:Location)-[:IS_IN]->(r:Region) WITH r, AVG(p.age) AS avgAge MATCH (bt:Battle)-[:IS_IN]->(l:Location)-[:IS_IN]->(r:Region) WHERE bt.major_death = '1' WITH r, avgAge, COUNT(bt) AS totalBattlesWithDeaths RETURN r.name AS Region, avgAge, totalBattlesWithDeaths",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 326,
    "unique_id": "gdsc_data_3_1_2_6_Complex_Aggregation_326",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each region, find the average pageRank of persons located in that region and the total number of battles that occurred in that region.",
    "Cypher": "MATCH (p:Person)-[:APPEARED_IN]->(b:Book) -[:APPEARED_IN]-> (l:Location)-[:IS_IN]->(r:Region) WHERE p.pageRank IS NOT NULL WITH r, AVG(p.pageRank) AS avgPageRank MATCH (b:Battle)-[:IS_IN]->(l:Location)-[:IS_IN]->(r) WITH r, avgPageRank, COUNT(b) AS battleCount RETURN r.name AS Region, avgPageRank, battleCount",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 332,
    "unique_id": "gdsc_data_3_1_2_6_Complex_Aggregation_332",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each book, find the average pageRank of persons who appeared in it and the number of battles that occurred in the same year as the book's sequence number. Return the book name, average pageRank, and battle count.",
    "Cypher": "MATCH (b:Book)<-[:APPEARED_IN]-(p:Person) WITH b, avg(p.pageRank) AS avgPageRank MATCH (battle:Battle) WHERE battle.year = b.sequence WITH b, avgPageRank, count(battle) AS battleCount RETURN b.name, avgPageRank, battleCount",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 343,
    "unique_id": "gdsc_data_3_1_2_6_Complex_Aggregation_343",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each house, calculate the average pageRank of its members and the total number of books in which its members have appeared.",
    "Cypher": "MATCH (p:Person)-[:BELONGS_TO]->(h:House)-[:APPEARED_IN]->(b:Book) WITH h, AVG(p.pageRank) AS avgPageRank, count(b) AS totalBooks RETURN h.name, avgPageRank, totalBooks",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 351,
    "unique_id": "gdsc_data_3_1_2_6_Complex_Aggregation_351",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each region, calculate the average pageRank of persons who reside in that region and have also served as defender king in a battle. Return the region name and the average pageRank.",
    "Cypher": "MATCH (l:Location)-[:IS_IN]->(r:Region)<-[:IS_IN]-(b:Battle)<-[:DEFENDER_KING]-(p:Person) WITH r, AVG(p.pageRank) AS avgPageRank RETURN r.name AS Region, avgPageRank",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 367,
    "unique_id": "gdsc_data_3_1_2_6_Complex_Aggregation_367",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each Region, find the average pageRank of Persons who are located in the region and the total number of distinct cultures of those Persons.",
    "Cypher": "MATCH (l:Location)-[:IS_IN]->(r:Region)<-[:IS_IN]-(b:Battle)<-[:ATTACKER_COMMANDER|:DEFENDER_COMMANDER]-(p:Person) WITH r, AVG(p.pageRank) AS avgPageRank, COLLECT(DISTINCT p) AS peopleInRegion UNWIND peopleInRegion AS person MATCH (person)-[:MEMBER_OF_CULTURE]->(c:Culture) WITH r, avgPageRank, COLLECT(DISTINCT c) AS cultures RETURN r.name AS Region, avgPageRank, SIZE(cultures) AS DistinctCultureCount",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 458,
    "unique_id": "gdsc_data_3_1_2_6_Complex_Aggregation_458",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "What is the average age of people who belong to the 'first men' culture and have a pageRank greater than the average pageRank of all people?",
    "Cypher": "MATCH (c:Culture {name: 'first men'}) MATCH (p:Person)-[:MEMBER_OF_CULTURE]->(c) WITH avg(p.pageRank) AS avgPageRank, p MATCH (p:Person)-[:MEMBER_OF_CULTURE]->(c:Culture {name: 'first men'}) WHERE p.pageRank > avgPageRank RETURN avg(p.age)",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 478,
    "unique_id": "gdsc_data_3_1_2_6_Complex_Aggregation_478",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Content: Results only contain null or zero values.",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "Results returned successfully.",
    "neo4j_result_passed": 1,
    "content_validation": "Results only contain null or zero values.",
    "content_passed": 0
  },
  {
    "NL Question": "What is the average attacker size for battles in 'The Westerlands' region that were won by 'Lannister' house?",
    "Cypher": "MATCH (r:Region {name: 'The Westerlands'})<-[:IS_IN]-(b:Battle)<-[:ATTACKER]-(h:House {name: 'Lannister'}) WHERE (h)-[:ATTACKER]->(b) and (b)<-[at:ATTACKER]-(h) and at.outcome='win' RETURN avg(b.attacker_size)",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 480,
    "unique_id": "gdsc_data_3_1_2_6_Complex_Aggregation_480",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: PatternExpressions are not allowed to introduce new variables: 'at'. (line 1, column 145 (offset: 144))\n\"MATCH (r:Region {name: 'The Westerlands'})<-[:IS_IN]-(b:Battle)<-[:ATTACKER]-(h:House {name: 'Lannister'}) WHERE (h)-[:ATTACKER]->(b) and (b)<-[at:ATTACKER]-(h) and at.outcome='win' RETURN avg(b.attacker_size)\"\n                                                                                                                                                 ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "What is the average age of Kings who died in books with a sequence number greater than 3, grouped by the book in which they died?",
    "Cypher": "MATCH (k:King)-[:DIED_IN]->(b:Book) WHERE b.sequence > 3 WITH b, AVG(k.age) AS averageAge RETURN b.name, averageAge",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 484,
    "unique_id": "gdsc_data_3_1_2_6_Complex_Aggregation_484",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each book, calculate the average pageRank of persons who appeared in it and the number of battles that occurred in the same year. Return the book name, average person pageRank, and the count of battles.",
    "Cypher": "MATCH (p:Person)-[:APPEARED_IN]->(b:Book) WITH b, AVG(p.pageRank) AS avgPageRank MATCH (battle:Battle) WHERE battle.year = b.sequence WITH b, avgPageRank, COUNT(battle) AS battleCount RETURN b.name AS BookName, avgPageRank, battleCount",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 504,
    "unique_id": "gdsc_data_3_1_2_6_Complex_Aggregation_504",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each house, find the average pageRank of its members who participated as attacker commanders in battles and the average pageRank of its members who participated as defender commanders. Return the house name, average attacker commander pageRank, and average defender commander pageRank.",
    "Cypher": "MATCH (p:Person)-[:BELONGS_TO]->(h:House)-[:ATTACKER_COMMANDER]->(b:Battle) WITH h, AVG(p.pageRank) AS avgAttackerCommanderRank MATCH (p2:Person)-[:BELONGS_TO]->(h)-[:DEFENDER_COMMANDER]->(b) WITH h, avgAttackerCommanderRank, AVG(p2.pageRank) AS avgDefenderCommanderRank RETURN h.name, avgAttackerCommanderRank, avgDefenderCommanderRank",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 519,
    "unique_id": "gdsc_data_3_1_2_6_Complex_Aggregation_519",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each house, calculate the average pageRank of its members who served as attacker kings and the average pageRank of its members who served as defender kings in battles. Return the house name, average attacker king pageRank, and average defender king pageRank.",
    "Cypher": "MATCH (p:Person)-[:BELONGS_TO]->(h:House)-[:ATTACKER_KING]->(b:Battle) WITH h, AVG(p.pageRank) AS avgAttackerKingRank MATCH (p2:Person)-[:BELONGS_TO]->(h)-[:DEFENDER_KING]->(b) WITH h, avgAttackerKingRank, AVG(p2.pageRank) AS avgDefenderKingRank RETURN h.name, avgAttackerKingRank, avgDefenderKingRank",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 522,
    "unique_id": "gdsc_data_3_1_2_6_Complex_Aggregation_522",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each region, calculate the average pageRank of persons located in that region and the number of battles that took place there. Show the region name, average pageRank, and total battle count.",
    "Cypher": "MATCH (r:Region)<-[:IS_IN]-(l:Location)<-[:IS_IN]-(b:Battle)\nWITH r, COUNT(DISTINCT b) AS battleCount\nMATCH (r)<-[:IS_IN]-(l)<-[:IS_IN]-(p:Person)\nWITH r, battleCount, AVG(p.pageRank) AS avgPageRank\nRETURN r.name AS Region, avgPageRank, battleCount",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 550,
    "unique_id": "gdsc_data_3_1_2_6_Complex_Aggregation_550",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each book, what is the average pageRank of persons who appeared in it and also the number of battles that occurred in locations that are mentioned in that book? Return the book name, average pageRank, and battle count.",
    "Cypher": "MATCH (p:Person)-[:APPEARED_IN]->(b:Book) WITH b, AVG(p.pageRank) AS avgPageRank MATCH (battle:Battle)-[:IS_IN]->(location:Location) WHERE (battle)-[:IS_IN]->(location)-[:RELATED_TO]->(b) WITH b, avgPageRank, COUNT(DISTINCT battle) AS battleCount RETURN b.name AS Book, avgPageRank, battleCount",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 25,
    "unique_id": "gdsc_data_3_2_2_6_Complex_Aggregation_25",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "Calculate the average age of people who belong to House 'Stark' and appeared in 'A Game of Thrones', and compare it to the average age of people who belong to House 'Lannister' and appeared in 'A Clash of Kings'.",
    "Cypher": "MATCH (p:Person)-[:BELONGS_TO]->(h:House {name: 'Stark'})-[:APPEARED_IN]->(b:Book {name: 'A Game of Thrones'}) WITH avg(p.age) AS avgStarkAge MATCH (p2:Person)-[:BELONGS_TO]->(h2:House {name: 'Lannister'})-[:APPEARED_IN]->(b2:Book {name: 'A Clash of Kings'}) RETURN avgStarkAge, avg(p2.age) AS avgLannisterAge",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 57,
    "unique_id": "gdsc_data_3_2_2_6_Complex_Aggregation_57",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "Calculate the average pageRank of people who belong to the culture 'braavosi' and appeared in the book 'Feast for crows', and compare that to the average pageRank of people who belong to House 'Tarly' and have 'Commoner' status.",
    "Cypher": "MATCH (p:Person)-[:MEMBER_OF_CULTURE]->(c:Culture {name: 'braavosi'})-[:APPEARED_IN]->(b:Book {name: 'Feast for crows'}) WITH avg(p.pageRank) AS avgBraavosiPageRank MATCH (p2:Person)-[:BELONGS_TO]->(h:House {name: 'Tarly'})-[:HAS_STATUS]->(s:Status {name: 'Commoner'}) RETURN avgBraavosiPageRank, avg(p2.pageRank) AS avgTarlyCommonerPageRank",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 60,
    "unique_id": "gdsc_data_3_2_2_6_Complex_Aggregation_60",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each book, what is the average pageRank of characters who died in that book, and how many battles occurred in that year where the book was published?",
    "Cypher": "MATCH (d:Dead)-[:DIED_IN]->(b:Book) WITH b.name AS bookName, b.sequence AS bookSequence, AVG(d.pageRank) AS avgPageRank MATCH (battle:Battle) WHERE battle.year = bookSequence WITH bookName, avgPageRank, COUNT(battle) AS battleCount RETURN bookName, avgPageRank, battleCount",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 99,
    "unique_id": "gdsc_data_3_2_2_6_Complex_Aggregation_99",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each house, calculate the average pageRank of its members who died in book 3 and appeared in book 1. Also, find the total number of members in each house.",
    "Cypher": "MATCH (p:Person)-[:BELONGS_TO]->(h:House) WHERE p.book_of_death = '3' MATCH (p)-[:APPEARED_IN]->(b:Book) WHERE b.sequence = 1 WITH h.name AS houseName, p WITH houseName, AVG(p.pageRank) AS avgPageRank MATCH (all:Person)-[:BELONGS_TO]->(house:House) WHERE house.name = houseName WITH houseName, avgPageRank, COUNT(all) AS totalMembers RETURN houseName, avgPageRank, totalMembers",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 130,
    "unique_id": "gdsc_data_3_2_2_6_Complex_Aggregation_130",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Insufficient parameters for function 'count' (line 1, column 308 (offset: 307))\n\"MATCH (p:Person)-[:BELONGS_TO]->(h:House) WHERE p.book_of_death = '3' MATCH (p)-[:APPEARED_IN]->(b:Book) WHERE b.sequence = 1 WITH h.name AS houseName, p WITH houseName, AVG(p.pageRank) AS avgPageRank MATCH (all:Person)-[:BELONGS_TO]->(house:House) WHERE house.name = houseName WITH houseName, avgPageRank, COUNT(all) AS totalMembers RETURN houseName, avgPageRank, totalMembers\"\n                                                                                                                                                                                                                                                                                                                    ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each region, determine the average pageRank of persons located in that region and the number of distinct houses to which these persons belong. Return the region name, average pageRank, and the count of distinct houses.",
    "Cypher": "MATCH (p:Person)-[:BELONGS_TO]->(h:House) MATCH (l:Location)-[:IS_IN]->(r:Region)<-[:IS_IN]-(b:Battle)<-[:ATTACKER]-(h) WITH r, AVG(p.pageRank) AS avgPageRank, h MATCH (p)-[:BELONGS_TO]->(h) WITH r, avgPageRank, COUNT(DISTINCT h) AS distinctHouses RETURN r.name AS Region, avgPageRank, distinctHouses",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 150,
    "unique_id": "gdsc_data_3_2_2_6_Complex_Aggregation_150",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each house, what is the average pageRank of its members who participated as attacker commanders in battles, and how many battles did they command in?",
    "Cypher": "MATCH (p:Person)-[:BELONGS_TO]->(h:House)-[:ATTACKER_COMMANDER]->(b:Battle) WITH h.name AS houseName, p.pageRank AS pageRank, COUNT(b) AS battleCount RETURN houseName, AVG(pageRank) AS avgPageRank, SUM(battleCount) AS totalBattles",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 156,
    "unique_id": "gdsc_data_3_2_2_6_Complex_Aggregation_156",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "What is the average attacker size in battles that involved houses from the 'The Reach' region as defenders?",
    "Cypher": "MATCH (h:House)-[:DEFENDER]->(b:Battle) MATCH (l:Location)-[:IS_IN]->(r:Region {name: 'The Reach'}) WHERE (b)-[:IS_IN]->(l) WITH AVG(b.attacker_size) AS averageAttackerSize RETURN averageAttackerSize",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 157,
    "unique_id": "gdsc_data_3_2_2_6_Complex_Aggregation_157",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Content: Results only contain null or zero values.",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "Results returned successfully.",
    "neo4j_result_passed": 1,
    "content_validation": "Results only contain null or zero values.",
    "content_passed": 0
  },
  {
    "NL Question": "For each book, find the average PageRank of persons who appeared in it and the number of battles that occurred in the same year as the book's sequence number. Return the book name, average PageRank, and the count of battles.",
    "Cypher": "MATCH (p:Person)-[:APPEARED_IN]->(b:Book) WITH b, AVG(p.pageRank) AS avgPageRank MATCH (battle:Battle) WHERE battle.year = b.sequence WITH b.name AS bookName, avgPageRank, COUNT(battle) AS battleCount RETURN bookName, avgPageRank, battleCount",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 161,
    "unique_id": "gdsc_data_3_2_2_6_Complex_Aggregation_161",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each culture, determine the average age of persons belonging to that culture and the total number of battles where houses of that culture were attackers. Return the culture name, average age, and total battle count.",
    "Cypher": "MATCH (p:Person)-[:MEMBER_OF_CULTURE]->(c:Culture) WITH c, AVG(p.age) AS avgAge MATCH (h:House)-[:ATTACKER]->(battle:Battle) WHERE (h)-[:MEMBER_OF_CULTURE]->(c) WITH c.name AS cultureName, avgAge, COUNT(battle) AS battleCount RETURN cultureName, avgAge, battleCount",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 162,
    "unique_id": "gdsc_data_3_2_2_6_Complex_Aggregation_162",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each book, determine the average age of persons who died in that book and the total number of battles that occurred in the same year. Return the book name, average age of dead persons, and the count of battles.",
    "Cypher": "MATCH (p:Person)-[:DIED_IN]->(b:Book) WITH b, AVG(p.age) AS avgAge MATCH (battle:Battle) WHERE battle.year = b.sequence WITH b.name AS bookName, avgAge, COUNT(battle) AS battleCount RETURN bookName, avgAge, battleCount",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 165,
    "unique_id": "gdsc_data_3_2_2_6_Complex_Aggregation_165",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each book, what is the average pageRank of characters who appeared in it, and how many battles occurred in the same year as the book's sequence year?",
    "Cypher": "MATCH (p:Person)-[:APPEARED_IN]->(b:Book) WITH b, AVG(p.pageRank) AS avgPageRank MATCH (b)<-[:APPEARED_IN]-(:Person)<-[:ATTACKER_COMMANDER]-(battle:Battle) WHERE battle.year = b.sequence WITH b.name AS bookName, avgPageRank, COUNT(DISTINCT battle) AS battleCount RETURN bookName, avgPageRank, battleCount",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 179,
    "unique_id": "gdsc_data_3_2_2_6_Complex_Aggregation_179",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each region, calculate the average attacker size of battles that occurred there and the total number of major deaths reported in those battles. Return the region name, average attacker size, and total major deaths.",
    "Cypher": "MATCH (b:Battle)-[:IS_IN]->(l:Location)-[:IS_IN]->(r:Region)\nWITH r, AVG(b.attacker_size) AS avgAttackerSize, SUM(toInt(b.major_death)) AS totalMajorDeaths\nRETURN r.name, avgAttackerSize, totalMajorDeaths",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 185,
    "unique_id": "gdsc_data_3_2_2_6_Complex_Aggregation_185",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 2, column 54 (offset: 114))\n\"WITH r, AVG(b.attacker_size) AS avgAttackerSize, SUM(toInt(b.major_death)) AS totalMajorDeaths\"\n                                                      ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each house, determine the average pageRank of Persons belonging to that house who died in a specific book ('Clash of kings') and the number of battles where the house was an attacker. Return the house name, average pageRank, and battle count.",
    "Cypher": "MATCH (p:Person)-[:BELONGS_TO]->(h:House)-[:APPEARED_IN]->(b:Book {name: 'Clash of kings'}) WHERE (p)-[:DIED_IN]->(b) WITH h, AVG(p.pageRank) AS avgPageRank MATCH (h)-[:ATTACKER]->(bat:Battle) WITH h, avgPageRank, COUNT(bat) AS battleCount RETURN h.name, avgPageRank, battleCount",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 200,
    "unique_id": "gdsc_data_3_2_2_6_Complex_Aggregation_200",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each status, find the average age of people having that status and the number of books in which they appeared. Return the status name, average age, and book count.",
    "Cypher": "MATCH (p:Person)-[:HAS_STATUS]->(s:Status) WHERE p.age IS NOT NULL WITH s, AVG(p.age) AS avgAge MATCH (p2:Person)-[:HAS_STATUS]->(s) -[:APPEARED_IN]-> (b:Book) WITH s, avgAge, COUNT(DISTINCT b) AS bookCount RETURN s.name AS Status, avgAge, bookCount",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 207,
    "unique_id": "gdsc_data_3_2_2_6_Complex_Aggregation_207",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each region, calculate the average PageRank of persons related to each other in that region and the total number of battles that occurred in that region. Return the region name, average PageRank, and battle count.",
    "Cypher": "MATCH (l:Location)-[:IS_IN]->(r:Region)<-[:IS_IN]-(b:Battle) WITH r, COUNT(b) AS battleCount OPTIONAL MATCH (p1:Person)-[:RELATED_TO]->(p2:Person)-[:BELONGS_TO]->(h:House) WITH r.name AS regionName, AVG(p1.pageRank) AS avgPageRank, battleCount RETURN regionName, avgPageRank, battleCount",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 221,
    "unique_id": "gdsc_data_3_2_2_6_Complex_Aggregation_221",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each book, determine the average pageRank of characters appearing in that book and the number of battles that occurred in the same year as the book's sequence. Return the book name, average pageRank, and battle count.",
    "Cypher": "MATCH (b:Book)<-[:APPEARED_IN]-(p:Person) WITH b, AVG(p.pageRank) AS avgPageRank MATCH (b) WITH b, avgPageRank MATCH (bat:Battle) WHERE bat.year = b.sequence WITH b, avgPageRank, COUNT(bat) AS battleCount RETURN b.name AS Book, avgPageRank, battleCount",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 226,
    "unique_id": "gdsc_data_3_2_2_6_Complex_Aggregation_226",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "What is the average pageRank of people who interacted with 'Robb Stark' and appeared in the book 'Game of thrones'?",
    "Cypher": "MATCH (p:Person)-[r:INTERACTS]-(p2:Person {name: 'Robb Stark'}) WHERE (p)-[:APPEARED_IN]->(b:Book {name: 'Game of thrones'}) WITH AVG(p.pageRank) AS avgPageRank RETURN avgPageRank",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 252,
    "unique_id": "gdsc_data_3_2_2_6_Complex_Aggregation_252",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: PatternExpressions are not allowed to introduce new variables: 'b'. (line 1, column 92 (offset: 91))\n\"MATCH (p:Person)-[r:INTERACTS]-(p2:Person {name: 'Robb Stark'}) WHERE (p)-[:APPEARED_IN]->(b:Book {name: 'Game of thrones'}) WITH AVG(p.pageRank) AS avgPageRank RETURN avgPageRank\"\n                                                                                            ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "What is the average age of people who belong to house 'Lannister' and have similarity with 'Tyrion Lannister'?",
    "Cypher": "MATCH (p:Person)-[:BELONGS_TO]->(h:House {name: 'Lannister'}) MATCH (p)-[:SIMILARITY]-(p2:Person {name: 'Tyrion Lannister'}) WITH AVG(p.age) AS avgAge RETURN avgAge",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 253,
    "unique_id": "gdsc_data_3_2_2_6_Complex_Aggregation_253",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Content: Results only contain null or zero values.",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "Results returned successfully.",
    "neo4j_result_passed": 1,
    "content_validation": "Results only contain null or zero values.",
    "content_passed": 0
  },
  {
    "NL Question": "What is the average pageRank of people who are related to 'Stannis Baratheon' and belong to the culture 'westerman'?",
    "Cypher": "MATCH (p:Person)-[:RELATED_TO]->(p2:Person {name: 'Stannis Baratheon'}) MATCH (p)-[:MEMBER_OF_CULTURE]->(c:Culture {name: 'westerman'}) WITH AVG(p.pageRank) AS avgPageRank RETURN avgPageRank",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 255,
    "unique_id": "gdsc_data_3_2_2_6_Complex_Aggregation_255",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Content: Results only contain null or zero values.",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "Results returned successfully.",
    "neo4j_result_passed": 1,
    "content_validation": "Results only contain null or zero values.",
    "content_passed": 0
  },
  {
    "NL Question": "For each culture, determine the average pageRank of persons who are members of that culture and the count of battles that occurred in regions where that culture is present. Return the culture name, average person pageRank, and battle count.",
    "Cypher": "MATCH (c:Culture)<-[:MEMBER_OF_CULTURE]-(p:Person) WITH c, AVG(p.pageRank) AS avgPersonRank MATCH (c)<-[:MEMBER_OF_CULTURE]-(:Person)-[:BELONGS_TO]->(:House)-[:ATTACKER|DEFENDER]->(b:Battle)-[:IS_IN]->(l:Location)-[:IS_IN]->(r:Region) WHERE c.name = r.name WITH c, avgPersonRank, COUNT(DISTINCT b) AS battleCount RETURN c.name AS Culture, avgPersonRank, battleCount",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 282,
    "unique_id": "gdsc_data_3_2_2_6_Complex_Aggregation_282",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each region, calculate the average attacker_size of battles that occurred within it and the average pageRank of kings who were defender kings in those battles. Return the region name, average battle attacker size, and average defender king pageRank.",
    "Cypher": "MATCH (r:Region)<-[:IS_IN]-(b:Battle) WITH r, AVG(b.attacker_size) AS avgAttackerSize MATCH (r)<-[:IS_IN]-(b:Battle)<-[:DEFENDER_KING]-(k:King) WITH r, avgAttackerSize, AVG(k.pageRank) AS avgKingRank RETURN r.name AS Region, avgAttackerSize, avgKingRank",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 283,
    "unique_id": "gdsc_data_3_2_2_6_Complex_Aggregation_283",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "What is the average age of people who belong to the culture 'stormlands', grouped by their status?",
    "Cypher": "MATCH (p:Person)-[:MEMBER_OF_CULTURE]->(c:Culture {name: 'stormlands'})-[:HAS_STATUS]->(s:Status) WITH s, p.age AS personAge RETURN s.name AS StatusName, AVG(personAge) AS AverageAge",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 290,
    "unique_id": "gdsc_data_3_2_2_6_Complex_Aggregation_290",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "What is the average pageRank of knights and kings, grouped by their gender, who appeared in the book 'Storm of swords'?",
    "Cypher": "MATCH (n) WHERE (n:Knight OR n:King) AND EXISTS(n.gender) AND EXISTS(n.pageRank) MATCH (n)-[:APPEARED_IN]->(b:Book {name: 'Storm of swords'}) WITH n.gender AS gender, n.pageRank AS pageRank RETURN gender, AVG(pageRank) AS averagePageRank",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 296,
    "unique_id": "gdsc_data_3_2_2_6_Complex_Aggregation_296",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: The property existence syntax `... exists(variable.property)` is no longer supported. Please use `variable.property IS NOT NULL` instead. (line 1, column 42 (offset: 41))\n\"MATCH (n) WHERE (n:Knight OR n:King) AND EXISTS(n.gender) AND EXISTS(n.pageRank) MATCH (n)-[:APPEARED_IN]->(b:Book {name: 'Storm of swords'}) WITH n.gender AS gender, n.pageRank AS pageRank RETURN gender, AVG(pageRank) AS averagePageRank\"\n                                          ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each region, find the average age of Persons who belong to houses that participated as attackers in battles within that region. Also, count the total number of battles in each region. Return the region name, the average attacker age, and the total battle count.",
    "Cypher": "MATCH (r:Region)<-[:IS_IN]-(b:Battle)<-[:ATTACKER]-(h:House)<-[:BELONGS_TO]-(p:Person)\nWITH r, AVG(p.age) AS avgAttackerAge, count(b) as battleCount\nRETURN r.name AS Region, avgAttackerAge, battleCount",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 318,
    "unique_id": "gdsc_data_3_2_2_6_Complex_Aggregation_318",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "What is the average pageRank of people who are related to both Robb Stark and Tyrion Lannister?",
    "Cypher": "MATCH (p:Person)-[:RELATED_TO]->(r1:Person {name: 'Robb Stark'}) MATCH (p)-[:RELATED_TO]->(r2:Person {name: 'Tyrion Lannister'}) WHERE p.pageRank IS NOT NULL RETURN AVG(p.pageRank) AS averagePageRank",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 325,
    "unique_id": "gdsc_data_3_2_2_6_Complex_Aggregation_325",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Content: Results only contain null or zero values.",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "Results returned successfully.",
    "neo4j_result_passed": 1,
    "content_validation": "Results only contain null or zero values.",
    "content_passed": 0
  },
  {
    "NL Question": "For each culture, what is the average age of people who are members of that culture and died in 'Feast for crows'?",
    "Cypher": "MATCH (p:Person)-[:MEMBER_OF_CULTURE]->(c:Culture) MATCH (p)-[:DIED_IN]->(b:Book {name: 'Feast for crows'}) WHERE p.age IS NOT NULL WITH c.name AS cultureName, p.age AS personAge RETURN cultureName, AVG(personAge) AS averageAge",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 326,
    "unique_id": "gdsc_data_3_2_2_6_Complex_Aggregation_326",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each culture, find the average age of its members and the number of members who have a title. Return the culture name, average age, and count of titled members.",
    "Cypher": "MATCH (c:Culture)<-[:MEMBER_OF_CULTURE]-(p:Person) WITH c, AVG(p.age) AS avgAge MATCH (c:Culture)<-[:MEMBER_OF_CULTURE]-(p:Person) WHERE EXISTS(p.title) WITH c, avgAge, COUNT(p) AS titledCount RETURN c.name AS Culture, avgAge, titledCount",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 332,
    "unique_id": "gdsc_data_3_2_2_6_Complex_Aggregation_332",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: The property existence syntax `... exists(variable.property)` is no longer supported. Please use `variable.property IS NOT NULL` instead. (line 1, column 138 (offset: 137))\n\"MATCH (c:Culture)<-[:MEMBER_OF_CULTURE]-(p:Person) WITH c, AVG(p.age) AS avgAge MATCH (c:Culture)<-[:MEMBER_OF_CULTURE]-(p:Person) WHERE EXISTS(p.title) WITH c, avgAge, COUNT(p) AS titledCount RETURN c.name AS Culture, avgAge, titledCount\"\n                                                                                                                                          ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each book, determine the average age of characters who died in that book and the number of battles that occurred in locations mentioned in that book. Display the book name, average age of deceased characters, and the count of battles.",
    "Cypher": "MATCH (p:Dead)-[:DIED_IN]->(b:Book) WHERE p.age IS NOT NULL WITH b, AVG(p.age) AS avgAge MATCH (b)-[:RELATED_TO]->(l:Location)<-[:IS_IN]-(battle:Battle) WITH b, avgAge, COUNT(DISTINCT battle) AS battleCount RETURN b.name AS BookName, avgAge, battleCount",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 339,
    "unique_id": "gdsc_data_3_2_2_6_Complex_Aggregation_339",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each region, what is the average attacker size in battles that occurred there, and what is the total number of major deaths recorded in those battles?",
    "Cypher": "MATCH (b:Battle)-[:IS_IN]->(l:Location)-[:IS_IN]->(r:Region) WITH r, AVG(b.attacker_size) AS avgAttackerSize, b.major_death AS majorDeath RETURN r.name, avgAttackerSize, SUM(toInt(majorDeath))",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 346,
    "unique_id": "gdsc_data_3_2_2_6_Complex_Aggregation_346",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 1, column 175 (offset: 174))\n\"MATCH (b:Battle)-[:IS_IN]->(l:Location)-[:IS_IN]->(r:Region) WITH r, AVG(b.attacker_size) AS avgAttackerSize, b.major_death AS majorDeath RETURN r.name, avgAttackerSize, SUM(toInt(majorDeath))\"\n                                                                                                                                                                               ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each book, find the average pageRank of characters who appeared in it and the number of battles that occurred in the same year as the book's release. Return the book name, average pageRank, and battle count.",
    "Cypher": "MATCH (p:Person)-[:APPEARED_IN]->(b:Book) WITH b, AVG(p.pageRank) AS avgPageRank MATCH (battle:Battle) WHERE battle.year = b.sequence WITH b.name AS bookName, avgPageRank, COUNT(battle) AS battleCount RETURN bookName, avgPageRank, battleCount",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 350,
    "unique_id": "gdsc_data_3_2_2_6_Complex_Aggregation_350",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each region, calculate the average pageRank of people located within it and the total number of battles fought in locations within that region. Return the region name, average pageRank, and battle count.",
    "Cypher": "MATCH (l:Location)-[:IS_IN]->(r:Region)<-[:BELONGS_TO]-(p:Person) WITH r, AVG(p.pageRank) AS avgPageRank MATCH (b:Battle)-[:IS_IN]->(l)-[:IS_IN]->(r) WITH r.name AS regionName, avgPageRank, COUNT(b) AS battleCount RETURN regionName, avgPageRank, battleCount",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 354,
    "unique_id": "gdsc_data_3_2_2_6_Complex_Aggregation_354",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each house, what is the average pageRank of persons who belong to that house and appeared in book 1, and how many such persons are there?",
    "Cypher": "MATCH (p:Person)-[:BELONGS_TO]->(h:House) MATCH (p)-[:APPEARED_IN]->(b:Book {sequence: 1}) WITH h.name AS houseName, p.pageRank AS pageRank RETURN houseName, avg(pageRank) AS averagePageRank, count(p) AS personCount",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 380,
    "unique_id": "gdsc_data_3_2_2_6_Complex_Aggregation_380",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `p` not defined (line 1, column 199 (offset: 198))\n\"MATCH (p:Person)-[:BELONGS_TO]->(h:House) MATCH (p)-[:APPEARED_IN]->(b:Book {sequence: 1}) WITH h.name AS houseName, p.pageRank AS pageRank RETURN houseName, avg(pageRank) AS averagePageRank, count(p) AS personCount\"\n                                                                                                                                                                                                       ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each battle type, what is the average attacker size, the average defender size, and the number of battles of that type that resulted in a major death?",
    "Cypher": "MATCH (b:Battle) WITH b.battle_type AS battleType, AVG(b.attacker_size) AS avgAttackerSize, AVG(b.defender_size) AS avgDefenderSize WHERE b.major_death = '1' WITH battleType, avgAttackerSize, avgDefenderSize MATCH (b2:Battle) WHERE b2.battle_type = battleType AND b2.major_death = '1' RETURN battleType, avgAttackerSize, avgDefenderSize, COUNT(b2) AS majorDeathCount",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 389,
    "unique_id": "gdsc_data_3_2_2_6_Complex_Aggregation_389",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: In a WITH/RETURN with DISTINCT or an aggregation, it is not possible to access variables declared before the WITH/RETURN: b (line 1, column 139 (offset: 138))\n\"MATCH (b:Battle) WITH b.battle_type AS battleType, AVG(b.attacker_size) AS avgAttackerSize, AVG(b.defender_size) AS avgDefenderSize WHERE b.major_death = '1' WITH battleType, avgAttackerSize, avgDefenderSize MATCH (b2:Battle) WHERE b2.battle_type = battleType AND b2.major_death = '1' RETURN battleType, avgAttackerSize, avgDefenderSize, COUNT(b2) AS majorDeathCount\"\n                                                                                                                                           ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each book, find the average pageRank of persons who appeared in it, and also calculate the number of battles that occurred in the same year as the book's release. Return the book name, average pageRank, and the count of battles.",
    "Cypher": "MATCH (p:Person)-[:APPEARED_IN]->(b:Book) WITH b, AVG(p.pageRank) AS avgPageRank MATCH (b)-[r:APPEARED_IN]-(p) WITH b.sequence as book_year, avgPageRank MATCH (battle:Battle) WHERE battle.year = book_year WITH  book_year, avgPageRank, COUNT(battle) AS battleCount RETURN book_year, avgPageRank, battleCount",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 392,
    "unique_id": "gdsc_data_3_2_2_6_Complex_Aggregation_392",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each book, find the average pageRank of persons who appeared in it and also calculate the number of battles that occurred in the same year as the book's publication year. Return the book name, average pageRank, and the count of contemporary battles.",
    "Cypher": "MATCH (p:Person)-[:APPEARED_IN]->(b:Book) WITH b, AVG(p.pageRank) AS avgPageRank MATCH (bt:Battle) WHERE bt.year = b.sequence WITH b.name AS bookName, avgPageRank, COUNT(bt) AS contemporaryBattles RETURN bookName, avgPageRank, contemporaryBattles",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 406,
    "unique_id": "gdsc_data_3_2_2_6_Complex_Aggregation_406",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each book, calculate the average age of persons who appeared in it and also determine the number of battles fought during the summer in the same year the book was published. Return the book name, the average age of persons, and the number of summer battles.",
    "Cypher": "MATCH (p:Person)-[:APPEARED_IN]->(b:Book) WITH b, AVG(p.age) AS avgAge MATCH (bt:Battle) WHERE bt.year = b.sequence AND bt.summer = '1' WITH b.name AS bookName, avgAge, bt RETURN bookName, avgAge, COUNT(bt) AS summerBattles",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 409,
    "unique_id": "gdsc_data_3_2_2_6_Complex_Aggregation_409",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each region, calculate the average pageRank of kings who are related to persons in that region, and also count the number of battles that occurred in that region. Return the region name, average pageRank of related kings, and the battle count.",
    "Cypher": "MATCH (p:Person)-[:BELONGS_TO]->(h:House) MATCH (h)-[:DEFENDER|ATTACKER]->(b:Battle)-[:IS_IN]->(l:Location)-[:IS_IN]->(r:Region) WITH r, p MATCH (k:King)-[:RELATED_TO]->(p) WITH r, AVG(k.pageRank) AS avgKingPageRank, b RETURN r.name AS regionName, avgKingPageRank, COUNT(b) AS battleCount",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 410,
    "unique_id": "gdsc_data_3_2_2_6_Complex_Aggregation_410",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `b` not defined (line 1, column 218 (offset: 217))\n\"MATCH (p:Person)-[:BELONGS_TO]->(h:House) MATCH (h)-[:DEFENDER|ATTACKER]->(b:Battle)-[:IS_IN]->(l:Location)-[:IS_IN]->(r:Region) WITH r, p MATCH (k:King)-[:RELATED_TO]->(p) WITH r, AVG(k.pageRank) AS avgKingPageRank, b RETURN r.name AS regionName, avgKingPageRank, COUNT(b) AS battleCount\"\n                                                                                                                                                                                                                          ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each culture, determine the average pageRank of persons who are members of that culture and appeared in a book and the average age of those members. Return the culture name, average pageRank, and average age.",
    "Cypher": "MATCH (p:Person)-[:MEMBER_OF_CULTURE]->(c:Culture)-[:APPEARED_IN]->(b:Book) WITH c, AVG(p.pageRank) AS avgPageRank, AVG(p.age) AS avgAge RETURN c.name, avgPageRank, avgAge",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 422,
    "unique_id": "gdsc_data_3_2_2_6_Complex_Aggregation_422",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each house, determine the average age of persons belonging to it who died in a book, and also provide the count of such persons.",
    "Cypher": "MATCH (p:Person)-[:BELONGS_TO]->(h:House) WHERE EXISTS(p.death_year) MATCH (p)-[:DIED_IN]->(b:Book) WITH h, AVG(p.age) AS avgAge, COUNT(p) AS personCount RETURN h.name AS HouseName, avgAge, personCount ORDER BY avgAge DESC",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 443,
    "unique_id": "gdsc_data_3_2_2_6_Complex_Aggregation_443",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: The property existence syntax `... exists(variable.property)` is no longer supported. Please use `variable.property IS NOT NULL` instead. (line 1, column 49 (offset: 48))\n\"MATCH (p:Person)-[:BELONGS_TO]->(h:House) WHERE EXISTS(p.death_year) MATCH (p)-[:DIED_IN]->(b:Book) WITH h, AVG(p.age) AS avgAge, COUNT(p) AS personCount RETURN h.name AS HouseName, avgAge, personCount ORDER BY avgAge DESC\"\n                                                 ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "Calculate the average age of Kings and Persons, grouped by their gender, and also find the number of individuals in each gender group. Return gender, average age, and count.",
    "Cypher": "MATCH (n) WHERE (n:King OR n:Person) WITH n.gender AS gender, toInteger(n.age) AS age WHERE age IS NOT NULL WITH gender, AVG(age) AS avgAge, COUNT(n) AS count RETURN gender, avgAge, count",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 456,
    "unique_id": "gdsc_data_3_2_2_6_Complex_Aggregation_456",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `n` not defined (line 1, column 148 (offset: 147))\n\"MATCH (n) WHERE (n:King OR n:Person) WITH n.gender AS gender, toInteger(n.age) AS age WHERE age IS NOT NULL WITH gender, AVG(age) AS avgAge, COUNT(n) AS count RETURN gender, avgAge, count\"\n                                                                                                                                                    ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "What is the average pageRank of people related to King Robb Stark compared to the average pageRank of people related to Dead Benfred Tallhart?",
    "Cypher": "MATCH (p:Person)-[:RELATED_TO]->(r:King {name: 'Robb Stark'}) WITH AVG(p.pageRank) AS avgRobbRank MATCH (p2:Person)-[:RELATED_TO]->(d:Dead {name: 'Benfred Tallhart'}) WITH avgRobbRank, AVG(p2.pageRank) AS avgBenfredRank RETURN avgRobbRank, avgBenfredRank, avgRobbRank - avgBenfredRank AS rankDifference",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 479,
    "unique_id": "gdsc_data_3_2_2_6_Complex_Aggregation_479",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each region, calculate the average attacker size of battles that occurred within it and the number of houses that defended in those battles. Return the region name, average attacker size, and the count of defending houses.",
    "Cypher": "MATCH (b:Battle)-[:IS_IN]->(r:Region) WITH r, AVG(b.attacker_size) AS avgAttackerSize MATCH (h:House)-[:DEFENDER]->(b) WITH r, avgAttackerSize, COUNT(DISTINCT h) AS defendingHouseCount RETURN r.name AS RegionName, avgAttackerSize, defendingHouseCount",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 486,
    "unique_id": "gdsc_data_3_2_2_6_Complex_Aggregation_486",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each region, calculate the average pageRank of persons who are related to a king in that region and the number of battles that occurred in that region. Return the region name, average pageRank, and battle count.",
    "Cypher": "MATCH (p:Person)-[:RELATED_TO]->(k:King)-[:IS_IN]->(r:Region) WITH r, AVG(p.pageRank) AS avgPageRank MATCH (b:Battle)-[:IS_IN]->(r) WITH r, avgPageRank, COUNT(b) AS battleCount RETURN r.name, avgPageRank, battleCount",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 500,
    "unique_id": "gdsc_data_3_2_2_6_Complex_Aggregation_500",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each culture, find the average pageRank of knights who are members of that culture and the number of books in which those knights have appeared. Return the culture name, average pageRank, and book count, ordering by book count in descending order.",
    "Cypher": "MATCH (k:Knight)-[:MEMBER_OF_CULTURE]->(c:Culture) WITH c, AVG(k.pageRank) AS avgPageRank MATCH (k:Knight)-[:MEMBER_OF_CULTURE]->(c:Culture)-[:APPEARED_IN]-(b:Book) WITH c, avgPageRank, COUNT(DISTINCT b) AS bookCount RETURN c.name AS CultureName, avgPageRank, bookCount ORDER BY bookCount DESC",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 515,
    "unique_id": "gdsc_data_3_2_2_6_Complex_Aggregation_515",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each house, calculate the average pageRank of its members who are alive and the average pageRank of its dead members. Return the house name, average alive pageRank, and average dead pageRank.",
    "Cypher": "MATCH (p:Person)-[:BELONGS_TO]->(h:House) WHERE NOT EXISTS(p.death_year) WITH h, AVG(p.pageRank) AS avgAliveRank MATCH (d:Dead)-[:BELONGS_TO]->(h) WITH h, avgAliveRank, AVG(d.pageRank) AS avgDeadRank RETURN h.name AS House, avgAliveRank, avgDeadRank",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 526,
    "unique_id": "gdsc_data_3_2_2_6_Complex_Aggregation_526",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: The property existence syntax `... exists(variable.property)` is no longer supported. Please use `variable.property IS NOT NULL` instead. (line 1, column 53 (offset: 52))\n\"MATCH (p:Person)-[:BELONGS_TO]->(h:House) WHERE NOT EXISTS(p.death_year) WITH h, AVG(p.pageRank) AS avgAliveRank MATCH (d:Dead)-[:BELONGS_TO]->(h) WITH h, avgAliveRank, AVG(d.pageRank) AS avgDeadRank RETURN h.name AS House, avgAliveRank, avgDeadRank\"\n                                                     ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each battle type, find the average attacker size and the total number of battles of that type.",
    "Cypher": "MATCH (b:Battle) WITH b.battle_type AS battleType, AVG(b.attacker_size) AS avgAttackerSize WITH battleType, avgAttackerSize, COUNT(b) AS battleCount RETURN battleType, avgAttackerSize, battleCount",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 534,
    "unique_id": "gdsc_data_3_2_2_6_Complex_Aggregation_534",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `b` not defined (line 1, column 132 (offset: 131))\n\"MATCH (b:Battle) WITH b.battle_type AS battleType, AVG(b.attacker_size) AS avgAttackerSize WITH battleType, avgAttackerSize, COUNT(b) AS battleCount RETURN battleType, avgAttackerSize, battleCount\"\n                                                                                                                                    ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each book, calculate the average pageRank of persons who appeared in it, and also find the number of distinct houses to which those persons belong. Return the book name, average pageRank, and the number of distinct houses.",
    "Cypher": "MATCH (p:Person)-[:APPEARED_IN]->(b:Book) WITH b, AVG(p.pageRank) AS avgPageRank, COLLECT(p) AS persons MATCH (person) IN persons-[:BELONGS_TO]->(h:House) WITH b, avgPageRank, COUNT(DISTINCT h) AS distinctHouses RETURN b.name AS Book, avgPageRank, distinctHouses",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 539,
    "unique_id": "gdsc_data_3_2_2_6_Complex_Aggregation_539",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'IN': expected a graph pattern, 'FOREACH', ',', 'ORDER BY', 'CALL', 'CREATE', 'LOAD CSV', 'DELETE', 'DETACH', 'FINISH', 'INSERT', 'LIMIT', 'MATCH', 'MERGE', 'NODETACH', 'OFFSET', 'OPTIONAL', 'REMOVE', 'RETURN', 'SET', 'SKIP', 'UNION', 'UNWIND', 'USE', 'USING', 'WHERE', 'WITH' or <EOF> (line 1, column 120 (offset: 119))\n\"MATCH (p:Person)-[:APPEARED_IN]->(b:Book) WITH b, AVG(p.pageRank) AS avgPageRank, COLLECT(p) AS persons MATCH (person) IN persons-[:BELONGS_TO]->(h:House) WITH b, avgPageRank, COUNT(DISTINCT h) AS distinctHouses RETURN b.name AS Book, avgPageRank, distinctHouses\"\n                                                                                                                        ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each culture, determine the average age of persons who are members of that culture and also count the number of distinct titles held by those persons. Return the culture name, average age, and the count of distinct titles.",
    "Cypher": "MATCH (p:Person)-[:MEMBER_OF_CULTURE]->(c:Culture) WITH c, AVG(p.age) AS avgAge, COLLECT(p) AS persons WITH c, avgAge, COLLECT(DISTINCT person.title) AS titles RETURN c.name AS Culture, avgAge, SIZE(titles) AS distinctTitles",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 540,
    "unique_id": "gdsc_data_3_2_2_6_Complex_Aggregation_540",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `person` not defined (line 1, column 137 (offset: 136))\n\"MATCH (p:Person)-[:MEMBER_OF_CULTURE]->(c:Culture) WITH c, AVG(p.age) AS avgAge, COLLECT(p) AS persons WITH c, avgAge, COLLECT(DISTINCT person.title) AS titles RETURN c.name AS Culture, avgAge, SIZE(titles) AS distinctTitles\"\n                                                                                                                                         ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each status type, calculate the average pageRank of persons having that status and the number of distinct books in which those persons have appeared. Return the status name, average pageRank, and the count of distinct books.",
    "Cypher": "MATCH (p:Person)-[:HAS_STATUS]->(s:Status) WITH s, AVG(p.pageRank) AS avgPageRank, COLLECT(p) AS persons MATCH (person) IN persons-[:APPEARED_IN]->(b:Book) WITH s, avgPageRank, COUNT(DISTINCT b) AS distinctBooks RETURN s.name AS Status, avgPageRank, distinctBooks",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 542,
    "unique_id": "gdsc_data_3_2_2_6_Complex_Aggregation_542",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'IN': expected a graph pattern, 'FOREACH', ',', 'ORDER BY', 'CALL', 'CREATE', 'LOAD CSV', 'DELETE', 'DETACH', 'FINISH', 'INSERT', 'LIMIT', 'MATCH', 'MERGE', 'NODETACH', 'OFFSET', 'OPTIONAL', 'REMOVE', 'RETURN', 'SET', 'SKIP', 'UNION', 'UNWIND', 'USE', 'USING', 'WHERE', 'WITH' or <EOF> (line 1, column 121 (offset: 120))\n\"MATCH (p:Person)-[:HAS_STATUS]->(s:Status) WITH s, AVG(p.pageRank) AS avgPageRank, COLLECT(p) AS persons MATCH (person) IN persons-[:APPEARED_IN]->(b:Book) WITH s, avgPageRank, COUNT(DISTINCT b) AS distinctBooks RETURN s.name AS Status, avgPageRank, distinctBooks\"\n                                                                                                                         ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each region, compute the average pageRank of persons located in that region and the total number of battles fought within that region. Return the region name, average pageRank, and battle count.",
    "Cypher": "MATCH (l:Location)-[:IS_IN]->(r:Region)<-[:IS_IN]-(b:Battle) WITH r, COUNT(DISTINCT b) AS battleCount MATCH (l:Location)-[:IS_IN]->(r:Region)<-[:IS_IN]-(b:Battle)<-[:ATTACKER_COMMANDER]-(p:Person) WITH r, battleCount, AVG(p.pageRank) AS avgPageRank RETURN r.name AS regionName, avgPageRank, battleCount",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 557,
    "unique_id": "gdsc_data_3_2_2_6_Complex_Aggregation_557",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  }
]