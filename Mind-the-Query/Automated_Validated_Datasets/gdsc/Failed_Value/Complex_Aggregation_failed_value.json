[
  {
    "NL Question": "For each battle location, determine the average attacker size and defender size for battles that occurred in the summer. Return the location name, average attacker size, and average defender size.",
    "Cypher": "MATCH (b:Battle)-[:IS_IN]->(l:Location) WHERE b.summer = '1' WITH l, b.attacker_size AS attackerSize, b.defender_size AS defenderSize RETURN l.name AS Location, avg(attackerSize) AS AverageAttackerSize, avg(defenderSize) AS AverageDefenderSize",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 81,
    "unique_id": "gdsc_data_3_1_2_6_Complex_Aggregation_81",
    "pipeline_stage": "FAILED_VALUE",
    "schema_validation": "✅ Query is valid according to schema!",
    "runtime_validation": "Passed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "Results returned successfully.",
    "neo4j_result_passed": 1,
    "content_validation": "Results contain non-null, non-zero values.",
    "content_passed": 1,
    "failure_reason": "❌ Value '1' for property 'summer' not found in the NL question.",
    "value_validation": "❌ Value '1' for property 'summer' not found in the NL question."
  },
  {
    "NL Question": "What is the average pageRank of people who interacted with Tyrion Lannister in 'Clash of kings', and how many interactions did they have on average with him in that book?",
    "Cypher": "MATCH (p:Person)-[r:INTERACTS {book: 2}]->(t:Person {name: 'Tyrion Lannister'}) WITH p, AVG(p.pageRank) AS avgPageRank, COUNT(r) AS interactionCount RETURN avgPageRank, AVG(interactionCount) AS avgInteractions",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 84,
    "unique_id": "gdsc_data_3_1_2_6_Complex_Aggregation_84",
    "pipeline_stage": "FAILED_VALUE",
    "schema_validation": "✅ Query is valid according to schema!",
    "runtime_validation": "Passed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "Results returned successfully.",
    "neo4j_result_passed": 1,
    "content_validation": "Results contain non-null, non-zero values.",
    "content_passed": 1,
    "failure_reason": "❌ Value '2' for property 'book' not found in the NL question.",
    "value_validation": "❌ Value '2' for property 'book' not found in the NL question."
  },
  {
    "NL Question": "What is the average attacker_size of battles that House Stark lost, and how does it compare to the average defender_size of those battles?",
    "Cypher": "MATCH (h:House {name: 'Stark'})-[r:ATTACKER]-(b:Battle) WHERE r.outcome = 'loss' WITH AVG(b.attacker_size) AS avgAttackerSize, AVG(b.defender_size) AS avgDefenderSize RETURN avgAttackerSize, avgDefenderSize",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 149,
    "unique_id": "gdsc_data_3_1_2_6_Complex_Aggregation_149",
    "pipeline_stage": "FAILED_VALUE",
    "schema_validation": "✅ Query is valid according to schema!",
    "runtime_validation": "Passed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "Results returned successfully.",
    "neo4j_result_passed": 1,
    "content_validation": "Results contain non-null, non-zero values.",
    "content_passed": 1,
    "failure_reason": "❌ Value 'loss' for property 'outcome' not found in the NL question.",
    "value_validation": "❌ Value 'loss' for property 'outcome' not found in the NL question."
  },
  {
    "NL Question": "For each region, calculate the average attacker size of battles that are located in that region and occurred in the summer. Return the region name and the average attacker size.",
    "Cypher": "MATCH (b:Battle)-[:IS_IN]->(l:Location)-[:IS_IN]->(r:Region) WHERE b.summer = '1' WITH r.name AS regionName, b.attacker_size AS attackerSize RETURN regionName, AVG(attackerSize) AS averageAttackerSize",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 396,
    "unique_id": "gdsc_data_3_1_2_6_Complex_Aggregation_396",
    "pipeline_stage": "FAILED_VALUE",
    "schema_validation": "✅ Query is valid according to schema!",
    "runtime_validation": "Passed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "Results returned successfully.",
    "neo4j_result_passed": 1,
    "content_validation": "Results contain non-null, non-zero values.",
    "content_passed": 1,
    "failure_reason": "❌ Value '1' for property 'summer' not found in the NL question.",
    "value_validation": "❌ Value '1' for property 'summer' not found in the NL question."
  },
  {
    "NL Question": "What is the average pageRank of Kings who participated as attackers in battles during the summer, and how many such Kings are there?",
    "Cypher": "MATCH (k:King)-[:ATTACKER_KING]->(b:Battle {summer: '1'}) WITH avg(k.pageRank) AS averagePageRank, count(k) AS kingCount RETURN averagePageRank, kingCount",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 431,
    "unique_id": "gdsc_data_3_1_2_6_Complex_Aggregation_431",
    "pipeline_stage": "FAILED_VALUE",
    "schema_validation": "✅ Query is valid according to schema!",
    "runtime_validation": "Passed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "Results returned successfully.",
    "neo4j_result_passed": 1,
    "content_validation": "Results contain non-null, non-zero values.",
    "content_passed": 1,
    "failure_reason": "❌ Value '1' for property 'summer' not found in the NL question.",
    "value_validation": "❌ Value '1' for property 'summer' not found in the NL question."
  },
  {
    "NL Question": "What is the average attacker size for battles that House Stark won, and how does it compare to the average defender size in those same battles?",
    "Cypher": "MATCH (h:House {name: 'Stark'})-[r:ATTACKER {outcome: 'win'}]->(b:Battle) WITH AVG(b.attacker_size) AS avgAttackerSize, AVG(b.defender_size) AS avgDefenderSize RETURN avgAttackerSize, avgDefenderSize",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 532,
    "unique_id": "gdsc_data_3_1_2_6_Complex_Aggregation_532",
    "pipeline_stage": "FAILED_VALUE",
    "schema_validation": "✅ Query is valid according to schema!",
    "runtime_validation": "Passed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "Results returned successfully.",
    "neo4j_result_passed": 1,
    "content_validation": "Results contain non-null, non-zero values.",
    "content_passed": 1,
    "failure_reason": "❌ Value 'win' for property 'outcome' not found in the NL question.",
    "value_validation": "❌ Value 'win' for property 'outcome' not found in the NL question."
  },
  {
    "NL Question": "For each Region, find the average attacker size of battles that occurred within it, only considering battles with a major death. Return the Region name and the average attacker size.",
    "Cypher": "MATCH (r:Region)<-[:IS_IN]-(l:Location)<-[:IS_IN]-(b:Battle) WHERE b.major_death = '1' WITH r, AVG(b.attacker_size) AS avgAttackerSize RETURN r.name AS Region, avgAttackerSize",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 39,
    "unique_id": "gdsc_data_3_2_2_6_Complex_Aggregation_39",
    "pipeline_stage": "FAILED_VALUE",
    "schema_validation": "✅ Query is valid according to schema!",
    "runtime_validation": "Passed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "Results returned successfully.",
    "neo4j_result_passed": 1,
    "content_validation": "Results contain non-null, non-zero values.",
    "content_passed": 1,
    "failure_reason": "❌ Value '1' for property 'major_death' not found in the NL question.",
    "value_validation": "❌ Value '1' for property 'major_death' not found in the NL question."
  },
  {
    "NL Question": "For each `Battle` that `House` `ATTACKER` won, what is the average `attacker_size` and `defender_size`?",
    "Cypher": "MATCH (h:House)-[a:ATTACKER {outcome: 'win'}]->(b:Battle) WITH b, h.name AS houseName, AVG(b.attacker_size) AS avgAttackerSize, AVG(b.defender_size) AS avgDefenderSize RETURN b.name,houseName, avgAttackerSize, avgDefenderSize",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 80,
    "unique_id": "gdsc_data_3_2_2_6_Complex_Aggregation_80",
    "pipeline_stage": "FAILED_VALUE",
    "schema_validation": "✅ Query is valid according to schema!",
    "runtime_validation": "Passed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "Results returned successfully.",
    "neo4j_result_passed": 1,
    "content_validation": "Results contain non-null, non-zero values.",
    "content_passed": 1,
    "failure_reason": "❌ Value 'win' for property 'outcome' not found in the NL question.",
    "value_validation": "❌ Value 'win' for property 'outcome' not found in the NL question."
  },
  {
    "NL Question": "What is the average age of Kings who commanded an attacking army in battles that occurred in the summer, and how does this compare to the average age of all Kings?",
    "Cypher": "MATCH (k:King)-[:ATTACKER_COMMANDER]->(b:Battle) WHERE b.summer = '1' WITH AVG(k.age) AS avgAttackerKingAge MATCH (all:King) WITH avgAttackerKingAge, AVG(all.age) AS overallAvgKingAge RETURN avgAttackerKingAge, overallAvgKingAge",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 129,
    "unique_id": "gdsc_data_3_2_2_6_Complex_Aggregation_129",
    "pipeline_stage": "FAILED_VALUE",
    "schema_validation": "✅ Query is valid according to schema!",
    "runtime_validation": "Passed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "Results returned successfully.",
    "neo4j_result_passed": 1,
    "content_validation": "Results contain non-null, non-zero values.",
    "content_passed": 1,
    "failure_reason": "❌ Value '1' for property 'summer' not found in the NL question.",
    "value_validation": "❌ Value '1' for property 'summer' not found in the NL question."
  },
  {
    "NL Question": "For each culture, find the average pageRank of persons belonging to that culture who died in a specific book, and also count the total number of battles where the attacker size was greater than 1000. Return the culture name, average pageRank, and battle count.",
    "Cypher": "MATCH (c:Culture)<-[:MEMBER_OF_CULTURE]-(p:Person)-[:DIED_IN]->(b:Book {name: 'Game of thrones'}) WITH c, AVG(p.pageRank) AS avgPageRank MATCH (bat:Battle) WHERE bat.attacker_size > 1000 WITH c, avgPageRank, COUNT(bat) AS battleCount RETURN c.name AS Culture, avgPageRank, battleCount",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 228,
    "unique_id": "gdsc_data_3_2_2_6_Complex_Aggregation_228",
    "pipeline_stage": "FAILED_VALUE",
    "schema_validation": "✅ Query is valid according to schema!",
    "runtime_validation": "Passed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "Results returned successfully.",
    "neo4j_result_passed": 1,
    "content_validation": "Results contain non-null, non-zero values.",
    "content_passed": 1,
    "failure_reason": "❌ Value 'Game of thrones' for property 'name' not found in the NL question.",
    "value_validation": "❌ Value 'Game of thrones' for property 'name' not found in the NL question."
  },
  {
    "NL Question": "For each battle type, what is the average attacker size where the battle was won by the attacker?",
    "Cypher": "MATCH (h:House)-[a:ATTACKER]->(b:Battle) WHERE a.outcome = 'win' WITH b.battle_type AS battleType, b.attacker_size AS attackerSize WITH battleType, AVG(attackerSize) AS avgAttackerSize RETURN battleType, avgAttackerSize",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 254,
    "unique_id": "gdsc_data_3_2_2_6_Complex_Aggregation_254",
    "pipeline_stage": "FAILED_VALUE",
    "schema_validation": "✅ Query is valid according to schema!",
    "runtime_validation": "Passed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "Results returned successfully.",
    "neo4j_result_passed": 1,
    "content_validation": "Results contain non-null, non-zero values.",
    "content_passed": 1,
    "failure_reason": "❌ Value 'win' for property 'outcome' not found in the NL question.",
    "value_validation": "❌ Value 'win' for property 'outcome' not found in the NL question."
  },
  {
    "NL Question": "For each battle type, what is the average attacker size and defender size in battles that occurred in the summer?",
    "Cypher": "MATCH (b:Battle) WHERE b.summer = '1' AND b.attacker_size IS NOT NULL AND b.defender_size IS NOT NULL WITH b.battle_type AS battleType, b.attacker_size AS attackerSize, b.defender_size AS defenderSize RETURN battleType, AVG(attackerSize) AS averageAttackerSize, AVG(defenderSize) AS averageDefenderSize",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 324,
    "unique_id": "gdsc_data_3_2_2_6_Complex_Aggregation_324",
    "pipeline_stage": "FAILED_VALUE",
    "schema_validation": "✅ Query is valid according to schema!",
    "runtime_validation": "Passed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "Results returned successfully.",
    "neo4j_result_passed": 1,
    "content_validation": "Results contain non-null, non-zero values.",
    "content_passed": 1,
    "failure_reason": "❌ Value '1' for property 'summer' not found in the NL question.",
    "value_validation": "❌ Value '1' for property 'summer' not found in the NL question."
  },
  {
    "NL Question": "For each book, what is the average pageRank of people who appeared in it, and how many unique houses do those people belong to?",
    "Cypher": "MATCH (p:Person)-[:APPEARED_IN]->(b:Book) WITH b, AVG(p.pageRank) AS avgPageRank, COLLECT(DISTINCT p.community) AS communities UNWIND communities AS community MATCH (p2:Person {community: community})-[r:BELONGS_TO]->(h:House) WITH b, avgPageRank, COLLECT(DISTINCT h.name) AS houses RETURN b.name, avgPageRank, SIZE(houses)",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 427,
    "unique_id": "gdsc_data_3_2_2_6_Complex_Aggregation_427",
    "pipeline_stage": "FAILED_VALUE",
    "schema_validation": "✅ Query is valid according to schema!",
    "runtime_validation": "Passed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "Results returned successfully.",
    "neo4j_result_passed": 1,
    "content_validation": "Results contain non-null, non-zero values.",
    "content_passed": 1,
    "failure_reason": "❌ Value 'community' for property 'community' not found in the NL question.",
    "value_validation": "❌ Value 'community' for property 'community' not found in the NL question."
  },
  {
    "NL Question": "For each battle type, find the average attacker size and the average defender size in battles that occurred in the summer.",
    "Cypher": "MATCH (b:Battle) WHERE b.summer = '1' WITH b.battle_type AS battleType, b.attacker_size AS attackerSize, b.defender_size AS defenderSize WITH battleType, AVG(attackerSize) AS avgAttackerSize, AVG(defenderSize) AS avgDefenderSize RETURN battleType, avgAttackerSize, avgDefenderSize",
    "source_dataset": "gdsc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 428,
    "unique_id": "gdsc_data_3_2_2_6_Complex_Aggregation_428",
    "pipeline_stage": "FAILED_VALUE",
    "schema_validation": "✅ Query is valid according to schema!",
    "runtime_validation": "Passed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "Results returned successfully.",
    "neo4j_result_passed": 1,
    "content_validation": "Results contain non-null, non-zero values.",
    "content_passed": 1,
    "failure_reason": "❌ Value '1' for property 'summer' not found in the NL question.",
    "value_validation": "❌ Value '1' for property 'summer' not found in the NL question."
  }
]