[
  {
    "NL Question": "For each person, calculate the total number of matches they played in and the average 'score' property value from the 'PLAYED_IN' relationships. Return the person's name, total matches played, and average score.",
    "Cypher": "MATCH (p:Person)-[r:PLAYED_IN]->(m:Match)\nWITH p, COUNT(m) AS totalMatches, AVG(toInt(r.score)) AS avgScore\nRETURN p.name AS personName, totalMatches, avgScore",
    "source_dataset": "wwc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 2,
    "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_2",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 2, column 39 (offset: 80))\n\"WITH p, COUNT(m) AS totalMatches, AVG(toInt(r.score)) AS avgScore\"\n                                       ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each tournament, calculate the total number of teams that participated and the average number of players per team. Return the tournament name, total teams, and average players per team.",
    "Cypher": "MATCH (t:Tournament)<-[:PARTICIPATED_IN]-(team:Team)<-[:NAMED]-(s:Squad)<-[:IN_SQUAD]-(p:Person) WITH t, team, COUNT(DISTINCT p) AS playerCount WITH t, COUNT(DISTINCT team) AS teamCount, AVG(playerCount) AS avgPlayersPerTeam RETURN t.name AS tournamentName, teamCount, avgPlayersPerTeam",
    "source_dataset": "wwc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 21,
    "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_21",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each player who played in a match during the 'Germany 2011' tournament, calculate the total number of goals they scored and the average number of minutes they played. Return the player's name, total goals, and average minutes played.",
    "Cypher": "MATCH (p:Person)-[pi:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'Germany 2011'})\nWITH p, pi, m\nOPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m)\nWITH p, SUM(toInt(sg.minute)) AS totalGoals, AVG(toInt(pi.minuteOn)) AS avgMinutesPlayed\nRETURN p.name AS playerName, totalGoals, avgMinutesPlayed",
    "source_dataset": "wwc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 30,
    "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_30",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 4, column 13 (offset: 169))\n\"WITH p, SUM(toInt(sg.minute)) AS totalGoals, AVG(toInt(pi.minuteOn)) AS avgMinutesPlayed\"\n             ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each team that participated in the 'USA 1999' tournament, calculate the average number of goals scored per match where the score property is available, and also find the total number of matches played by each team.",
    "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'USA 1999'}) MATCH (t)-[r:PLAYED_IN]->(m:Match) WHERE r.score IS NOT NULL WITH t, m, r.score AS scorePerMatch WITH t, COUNT(m) AS totalMatches, COLLECT(scorePerMatch) AS scores RETURN t.name AS teamName, toFloat(SUM(scores))/totalMatches AS avgGoalsPerMatch, totalMatches",
    "source_dataset": "wwc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 45,
    "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_45",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Type mismatch: expected Float, Integer or Duration but was List<Boolean>, List<Float>, List<Integer>, List<Number>, List<Point>, List<String>, List<Duration>, List<Date>, List<Time>, List<LocalTime>, List<LocalDateTime>, List<DateTime>, List<List<Boolean>>, List<List<Float>>, List<List<Integer>>, List<List<Number>>, List<List<Point>>, List<List<String>>, List<List<Duration>>, List<List<Date>>, List<List<Time>>, List<List<LocalTime>>, List<List<LocalDateTime>> or List<List<DateTime>> (line 1, column 276 (offset: 275))\n\"MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'USA 1999'}) MATCH (t)-[r:PLAYED_IN]->(m:Match) WHERE r.score IS NOT NULL WITH t, m, r.score AS scorePerMatch WITH t, COUNT(m) AS totalMatches, COLLECT(scorePerMatch) AS scores RETURN t.name AS teamName, toFloat(SUM(scores))/totalMatches AS avgGoalsPerMatch, totalMatches\"\n                                                                                                                                                                                                                                                                                    ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each player who played in the 'USA 1999' tournament, what is the total number of goals they scored, and what is the average number of minutes they played in each match?",
    "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament {name: 'USA 1999'}) OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m) WITH p, m, COUNT(sg) AS goalsScored OPTIONAL MATCH (p)-[pi:PLAYED_IN]->(m) WHERE pi.minuteOn IS NOT NULL WITH p, m, goalsScored, pi.minuteOn AS minuteOnField WITH p, goalsScored, COLLECT(toInt(replace(minuteOnField, '''', ''))) AS minutesPlayedList WITH p, goalsScored, REDUCE(total = 0, minute IN minutesPlayedList | total + minute) AS totalMinutesPlayed, SIZE(minutesPlayedList) AS matchesPlayed RETURN p.name AS playerName, SUM(goalsScored) AS totalGoals, CASE WHEN matchesPlayed > 0 THEN toFloat(totalMinutesPlayed) / matchesPlayed ELSE 0 END AS avgMinutesPlayed",
    "source_dataset": "wwc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 46,
    "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_46",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input '''': expected an expression, ')' or ',' (line 1, column 353 (offset: 352))\n\"MATCH (p:Person)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament {name: 'USA 1999'}) OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m) WITH p, m, COUNT(sg) AS goalsScored OPTIONAL MATCH (p)-[pi:PLAYED_IN]->(m) WHERE pi.minuteOn IS NOT NULL WITH p, m, goalsScored, pi.minuteOn AS minuteOnField WITH p, goalsScored, COLLECT(toInt(replace(minuteOnField, '''', ''))) AS minutesPlayedList WITH p, goalsScored, REDUCE(total = 0, minute IN minutesPlayedList | total + minute) AS totalMinutesPlayed, SIZE(minutesPlayedList) AS matchesPlayed RETURN p.name AS playerName, SUM(goalsScored) AS totalGoals, CASE WHEN matchesPlayed > 0 THEN toFloat(totalMinutesPlayed) / matchesPlayed ELSE 0 END AS avgMinutesPlayed\"\n                                                                                                                                                                                                                                                                                                                                                                 ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each tournament, calculate the total number of goals scored and the average age of players who scored in matches within that tournament. Return the tournament name, total goals scored, and average player age.",
    "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[sg:SCORED_GOAL]-(p:Person) WHERE p.dob IS NOT NULL WITH tour, p, COUNT(sg) AS goalsPerPlayer, m.date AS matchDate WITH tour, p, goalsPerPlayer, date(matchDate).year AS matchYear WITH tour, p, goalsPerPlayer, matchYear, p.dob AS playerDob WITH tour, p, goalsPerPlayer, matchYear, playerDob.year AS playerYear, playerDob.month AS playerMonth, playerDob.day AS playerDay WITH tour, p, goalsPerPlayer, matchYear, date({year: playerYear, month: playerMonth, day: playerDay}) AS birthDate WITH tour, p, goalsPerPlayer, matchYear, birthDate, matchYear - playerYear AS playerAge  WITH tour, p, goalsPerPlayer, playerAge WITH tour, SUM(goalsPerPlayer) AS totalGoals, AVG(playerAge) AS avgPlayerAge RETURN tour.name AS tournamentName, totalGoals, avgPlayerAge",
    "source_dataset": "wwc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 56,
    "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_56",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `playerYear` not defined (line 1, column 602 (offset: 601))\n\"MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[sg:SCORED_GOAL]-(p:Person) WHERE p.dob IS NOT NULL WITH tour, p, COUNT(sg) AS goalsPerPlayer, m.date AS matchDate WITH tour, p, goalsPerPlayer, date(matchDate).year AS matchYear WITH tour, p, goalsPerPlayer, matchYear, p.dob AS playerDob WITH tour, p, goalsPerPlayer, matchYear, playerDob.year AS playerYear, playerDob.month AS playerMonth, playerDob.day AS playerDay WITH tour, p, goalsPerPlayer, matchYear, date({year: playerYear, month: playerMonth, day: playerDay}) AS birthDate WITH tour, p, goalsPerPlayer, matchYear, birthDate, matchYear - playerYear AS playerAge  WITH tour, p, goalsPerPlayer, playerAge WITH tour, SUM(goalsPerPlayer) AS totalGoals, AVG(playerAge) AS avgPlayerAge RETURN tour.name AS tournamentName, totalGoals, avgPlayerAge\"\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each team that participated in the 'Germany 2011' tournament, find the average number of goals scored per match and the total number of players who played for the team in those matches. Return the team name, average goals per match, and total players.",
    "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'Germany 2011'}) MATCH (t)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour) WITH t, m, r.score AS matchScore OPTIONAL MATCH (p:Person)-[:PLAYED_IN]->(m) WHERE p-[:REPRESENTS]->(t) WITH t, m, SUM(matchScore) AS totalScore, COUNT(DISTINCT p) AS totalPlayers WHERE totalScore IS NOT NULL WITH t, toFloat(SUM(totalScore)) AS totalGoals, COUNT(DISTINCT m) AS totalMatches, SUM(totalPlayers) AS totalPlayersPlayed RETURN t.name AS teamName, CASE WHEN totalMatches = 0 THEN 0 ELSE totalGoals / totalMatches END AS avgGoalsPerMatch, totalPlayersPlayed",
    "source_dataset": "wwc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 57,
    "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_57",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input ':': expected an expression (line 1, column 223 (offset: 222))\n\"MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'Germany 2011'}) MATCH (t)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour) WITH t, m, r.score AS matchScore OPTIONAL MATCH (p:Person)-[:PLAYED_IN]->(m) WHERE p-[:REPRESENTS]->(t) WITH t, m, SUM(matchScore) AS totalScore, COUNT(DISTINCT p) AS totalPlayers WHERE totalScore IS NOT NULL WITH t, toFloat(SUM(totalScore)) AS totalGoals, COUNT(DISTINCT m) AS totalMatches, SUM(totalPlayers) AS totalPlayersPlayed RETURN t.name AS teamName, CASE WHEN totalMatches = 0 THEN 0 ELSE totalGoals / totalMatches END AS avgGoalsPerMatch, totalPlayersPlayed\"\n                                                                                                                                                                                                                               ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each squad, determine the average age of players in the squad and the total number of matches in which players from that squad scored goals. Return the squad ID, average player age, and total matches with goals.",
    "Cypher": "MATCH (s:Squad)<-[:IN_SQUAD]-(p:Person) WHERE p.dob IS NOT NULL WITH s, p, p.dob AS playerDob WITH s, p, playerDob.year AS playerYear, playerDob.month AS playerMonth, playerDob.day AS playerDay WITH s, p, date({year: playerYear, month: playerMonth, day: playerDay}) AS birthDate WITH s, p, date() AS currentDate, duration.between(birthDate, currentDate).years AS playerAge OPTIONAL MATCH (p)-[:SCORED_GOAL]->(m:Match) WITH s, AVG(playerAge) AS avgPlayerAge, COUNT(DISTINCT m) AS matchesWithGoals RETURN s.id AS squadId, avgPlayerAge, matchesWithGoals",
    "source_dataset": "wwc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 59,
    "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_59",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `currentDate` not defined (line 1, column 342 (offset: 341))\n\"MATCH (s:Squad)<-[:IN_SQUAD]-(p:Person) WHERE p.dob IS NOT NULL WITH s, p, p.dob AS playerDob WITH s, p, playerDob.year AS playerYear, playerDob.month AS playerMonth, playerDob.day AS playerDay WITH s, p, date({year: playerYear, month: playerMonth, day: playerDay}) AS birthDate WITH s, p, date() AS currentDate, duration.between(birthDate, currentDate).years AS playerAge OPTIONAL MATCH (p)-[:SCORED_GOAL]->(m:Match) WITH s, AVG(playerAge) AS avgPlayerAge, COUNT(DISTINCT m) AS matchesWithGoals RETURN s.id AS squadId, avgPlayerAge, matchesWithGoals\"\n                                                                                                                                                                                                                                                                                                                                                      ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each tournament after 2000, find the average age of players who scored goals and the total number of goals scored. Return the tournament name, average player age, and total goals.",
    "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[:SCORED_GOAL]-(p:Person)\nWHERE tour.year > 2000 AND p.dob IS NOT NULL\nWITH tour, p, m\nWITH tour, p, m.date.year - p.dob.year AS playerAge\nWITH tour, AVG(playerAge) AS avgPlayerAge, COUNT(m) AS totalGoals\nRETURN tour.name AS tournamentName, avgPlayerAge, totalGoals",
    "source_dataset": "wwc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 65,
    "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_65",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `m` not defined (line 5, column 50 (offset: 241))\n\"WITH tour, AVG(playerAge) AS avgPlayerAge, COUNT(m) AS totalGoals\"\n                                                  ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each team, calculate the total number of matches they played and the average penalty score across those matches. Return the team name, total matches played, and average penalty score.",
    "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match) WHERE r.penaltyScore IS NOT NULL WITH t, COUNT(m) AS totalMatches, AVG(toInt(r.penaltyScore)) AS avgPenaltyScore RETURN t.name AS teamName, totalMatches, avgPenaltyScore",
    "source_dataset": "wwc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 85,
    "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_85",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 1, column 112 (offset: 111))\n\"MATCH (t:Team)-[r:PLAYED_IN]->(m:Match) WHERE r.penaltyScore IS NOT NULL WITH t, COUNT(m) AS totalMatches, AVG(toInt(r.penaltyScore)) AS avgPenaltyScore RETURN t.name AS teamName, totalMatches, avgPenaltyScore\"\n                                                                                                                ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each team that participated in the 'USA 1999' tournament, calculate the total number of matches played and the average goals scored per match. Return the team name, total matches, and average goals per match.",
    "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'USA 1999'})-[r:PLAYED_IN]-(m:Match) WHERE r.score IS NOT NULL WITH t, COUNT(m) AS matchCount, SUM(r.score) AS totalGoals RETURN t.name AS teamName, matchCount AS totalMatches, toFloat(totalGoals)/matchCount AS avgGoalsPerMatch",
    "source_dataset": "wwc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 99,
    "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_99",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each player who played in the 'Germany 2011' tournament, calculate the total number of goals they scored and the average number of minutes they played per match. Return the player's name, total goals, and average minutes played.",
    "Cypher": "MATCH (p:Person)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'Germany 2011'}) WHERE r.score IS NOT NULL WITH p, m, r.score AS goals, toInteger(replace(r.minuteOn, '''', '')) AS minutesPlayed WITH p, SUM(goals) AS totalGoals, AVG(minutesPlayed) AS avgMinutesPlayed RETURN p.name AS playerName, totalGoals, avgMinutesPlayed",
    "source_dataset": "wwc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 100,
    "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_100",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input '''': expected an expression, ')' or ',' (line 1, column 189 (offset: 188))\n\"MATCH (p:Person)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'Germany 2011'}) WHERE r.score IS NOT NULL WITH p, m, r.score AS goals, toInteger(replace(r.minuteOn, '''', '')) AS minutesPlayed WITH p, SUM(goals) AS totalGoals, AVG(minutesPlayed) AS avgMinutesPlayed RETURN p.name AS playerName, totalGoals, avgMinutesPlayed\"\n                                                                                                                                                                                             ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each person, determine the total number of goals they scored and the average number of minutes they played in each match where the 'minuteOn' property is available. Return the person's name, total goals scored, and average minutes played.",
    "Cypher": "MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match) WITH p, COUNT(sg) AS totalGoals OPTIONAL MATCH (p)-[pi:PLAYED_IN]->(m) WHERE pi.minuteOn IS NOT NULL WITH p, totalGoals, AVG(toFloat(replace(pi.minuteOn, '''', ''))) AS avgMinutesPlayed RETURN p.name AS personName, totalGoals, avgMinutesPlayed",
    "source_dataset": "wwc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 107,
    "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_107",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input '''': expected an expression, ')' or ',' (line 1, column 202 (offset: 201))\n\"MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match) WITH p, COUNT(sg) AS totalGoals OPTIONAL MATCH (p)-[pi:PLAYED_IN]->(m) WHERE pi.minuteOn IS NOT NULL WITH p, totalGoals, AVG(toFloat(replace(pi.minuteOn, '''', ''))) AS avgMinutesPlayed RETURN p.name AS personName, totalGoals, avgMinutesPlayed\"\n                                                                                                                                                                                                          ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each team that participated in the 'Sweden 1995' tournament, calculate the total number of goals scored by all players from that team and the average number of minutes played by those players. Return the team name, total goals scored, and average minutes played.",
    "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'Sweden 1995'}) MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match)<-[:PLAYED_IN]-(t) WITH t, p, COUNT(sg) AS goalsByPlayer OPTIONAL MATCH (p)-[pi:PLAYED_IN]->(m) WHERE pi.minuteOn IS NOT NULL WITH t, SUM(goalsByPlayer) AS totalGoals, AVG(toFloat(replace(pi.minuteOn, '''', ''))) AS avgMinutesPlayed RETURN t.name AS teamName, totalGoals, avgMinutesPlayed",
    "source_dataset": "wwc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 109,
    "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_109",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input '''': expected an expression, ')' or ',' (line 1, column 323 (offset: 322))\n\"MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'Sweden 1995'}) MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match)<-[:PLAYED_IN]-(t) WITH t, p, COUNT(sg) AS goalsByPlayer OPTIONAL MATCH (p)-[pi:PLAYED_IN]->(m) WHERE pi.minuteOn IS NOT NULL WITH t, SUM(goalsByPlayer) AS totalGoals, AVG(toFloat(replace(pi.minuteOn, '''', ''))) AS avgMinutesPlayed RETURN t.name AS teamName, totalGoals, avgMinutesPlayed\"\n                                                                                                                                                                                                                                                                                                                                   ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each squad, determine the number of distinct tournaments they participated in and the average number of goals scored by players in the squad across all matches. Return the squad ID, number of tournaments, and average goals per player.",
    "Cypher": "MATCH (s:Squad)-[:FOR]->(tour:Tournament) WITH s, tour MATCH (p:Person)-[:IN_SQUAD]->(s)-[:FOR]->(tour) OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(tour) WITH s, tour, p, COUNT(sg) AS goalsPerPlayer WITH s, COUNT(DISTINCT tour) AS totalTournaments, COLLECT(goalsPerPlayer) AS goalsList RETURN s.id AS squadId, totalTournaments, REDUCE(s = 0, x IN goalsList | s + x) / toFloat(SIZE(COLLECT(DISTINCT p))) AS avgGoalsPerPlayer",
    "source_dataset": "wwc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 123,
    "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_123",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `p` not defined (line 1, column 421 (offset: 420))\n\"MATCH (s:Squad)-[:FOR]->(tour:Tournament) WITH s, tour MATCH (p:Person)-[:IN_SQUAD]->(s)-[:FOR]->(tour) OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(tour) WITH s, tour, p, COUNT(sg) AS goalsPerPlayer WITH s, COUNT(DISTINCT tour) AS totalTournaments, COLLECT(goalsPerPlayer) AS goalsList RETURN s.id AS squadId, totalTournaments, REDUCE(s = 0, x IN goalsList | s + x) / toFloat(SIZE(COLLECT(DISTINCT p))) AS avgGoalsPerPlayer\"\n                                                                                                                                                                                                                                                                                                                                                                                                                                     ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each tournament, compute the total number of teams that participated and the average number of players per team. Return the tournament name, total teams, and average players per team.",
    "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament) WITH tour, t MATCH (p:Person)-[:REPRESENTS]->(t) WITH tour, t, COUNT(p) AS playerCount WITH tour, COLLECT(playerCount) AS playerCounts, COUNT(DISTINCT t) AS totalTeams RETURN tour.name AS tournamentName, totalTeams, REDUCE(s = 0, pc IN playerCounts | s + pc * 1.0) / SIZE(playerCounts) AS avgPlayersPerTeam;",
    "source_dataset": "wwc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 127,
    "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_127",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Type mismatch: expected Float, Integer or Duration but was Number (line 1, column 270 (offset: 269))\n\"MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament) WITH tour, t MATCH (p:Person)-[:REPRESENTS]->(t) WITH tour, t, COUNT(p) AS playerCount WITH tour, COLLECT(playerCount) AS playerCounts, COUNT(DISTINCT t) AS totalTeams RETURN tour.name AS tournamentName, totalTeams, REDUCE(s = 0, pc IN playerCounts | s + pc * 1.0) / SIZE(playerCounts) AS avgPlayersPerTeam;\"\n                                                                                                                                                                                                                                                                              ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each tournament, determine the average number of goals scored by players from each team participating in that tournament. Return the tournament name and the average goals scored per team.",
    "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[sg:SCORED_GOAL]-(p:Person)-[:REPRESENTS]->(t:Team)-[:PARTICIPATED_IN]->(tour) WITH tour, t, COUNT(sg) AS teamGoalsPerMatch WITH tour, COLLECT(teamGoalsPerMatch) AS teamGoals RETURN tour.name AS tournamentName, REDUCE(s = 0, goals IN teamGoals | s + goals * 1.0) / SIZE(teamGoals) AS avgGoalsPerTeam;",
    "source_dataset": "wwc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 129,
    "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_129",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Type mismatch: expected Float, Integer or Duration but was Number (line 1, column 265 (offset: 264))\n\"MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[sg:SCORED_GOAL]-(p:Person)-[:REPRESENTS]->(t:Team)-[:PARTICIPATED_IN]->(tour) WITH tour, t, COUNT(sg) AS teamGoalsPerMatch WITH tour, COLLECT(teamGoalsPerMatch) AS teamGoals RETURN tour.name AS tournamentName, REDUCE(s = 0, goals IN teamGoals | s + goals * 1.0) / SIZE(teamGoals) AS avgGoalsPerTeam;\"\n                                                                                                                                                                                                                                                                         ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each tournament, calculate the average age of players who scored at least one goal in a match during that tournament. Return the tournament name and the average age of the goal scorers.",
    "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[sg:SCORED_GOAL]-(p:Person) WHERE p.dob IS NOT NULL WITH tour, p, tour.year - p.dob.year AS playerAge WITH tour, COLLECT(playerAge) AS playerAges RETURN tour.name AS tournamentName, REDUCE(s = 0, age IN playerAges | s + age * 1.0) / SIZE(playerAges) AS avgAgeOfGoalScorers;",
    "source_dataset": "wwc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 130,
    "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_130",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Type mismatch: expected Float, Integer or Duration but was Number (line 1, column 236 (offset: 235))\n\"MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[sg:SCORED_GOAL]-(p:Person) WHERE p.dob IS NOT NULL WITH tour, p, tour.year - p.dob.year AS playerAge WITH tour, COLLECT(playerAge) AS playerAges RETURN tour.name AS tournamentName, REDUCE(s = 0, age IN playerAges | s + age * 1.0) / SIZE(playerAges) AS avgAgeOfGoalScorers;\"\n                                                                                                                                                                                                                                            ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each player who played in a match during the 'China 2007' tournament, calculate the average number of minutes they played. Return the player's name and the average minutes played.",
    "Cypher": "MATCH (p:Person)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament {name: 'China 2007'}) WHERE r.minuteOn IS NOT NULL WITH p, r.minuteOn AS minuteOn, m, t WITH p, SPLIT(minuteOn, '''')[0] AS minuteNumber WHERE all(c in split(minuteNumber, '') where c in ['0','1','2','3','4','5','6','7','8','9']) WITH p, toInteger(minuteNumber) AS minuteOnInt RETURN p.name AS playerName, avg(minuteOnInt) AS averageMinutesPlayed",
    "source_dataset": "wwc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 165,
    "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_165",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input '''': expected an expression, ')' or ',' (line 1, column 189 (offset: 188))\n\"MATCH (p:Person)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament {name: 'China 2007'}) WHERE r.minuteOn IS NOT NULL WITH p, r.minuteOn AS minuteOn, m, t WITH p, SPLIT(minuteOn, '''')[0] AS minuteNumber WHERE all(c in split(minuteNumber, '') where c in ['0','1','2','3','4','5','6','7','8','9']) WITH p, toInteger(minuteNumber) AS minuteOnInt RETURN p.name AS playerName, avg(minuteOnInt) AS averageMinutesPlayed\"\n                                                                                                                                                                                             ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each team that participated in the 'Canada 2015' tournament, calculate the total number of matches they played and the average number of goals scored in those matches. Return the team name, total matches, and average goals per match.",
    "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'Canada 2015'}) MATCH (t)-[r:PLAYED_IN]->(m:Match) WITH t, COUNT(m) AS totalMatches, SUM(r.score) AS totalGoals WHERE r.score IS NOT NULL RETURN t.name AS teamName, totalMatches, CASE WHEN totalMatches > 0 THEN toFloat(totalGoals) / totalMatches ELSE 0 END AS avgGoalsPerMatch",
    "source_dataset": "wwc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 189,
    "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_189",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: In a WITH/RETURN with DISTINCT or an aggregation, it is not possible to access variables declared before the WITH/RETURN: r (line 1, column 178 (offset: 177))\n\"MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'Canada 2015'}) MATCH (t)-[r:PLAYED_IN]->(m:Match) WITH t, COUNT(m) AS totalMatches, SUM(r.score) AS totalGoals WHERE r.score IS NOT NULL RETURN t.name AS teamName, totalMatches, CASE WHEN totalMatches > 0 THEN toFloat(totalGoals) / totalMatches ELSE 0 END AS avgGoalsPerMatch\"\n                                                                                                                                                                                  ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each tournament, determine the average number of goals scored per match and the total number of teams that participated. Return the tournament name, average goals per match, and total teams.",
    "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[r:PLAYED_IN]-(:Person) WHERE r.score IS NOT NULL WITH tour, m, SUM(r.score) AS totalGoals OPTIONAL MATCH (team:Team)-[:PARTICIPATED_IN]->(tour) WITH tour, AVG(totalGoals) AS avgGoalsPerMatch, COUNT(DISTINCT team) AS totalTeams RETURN tour.name AS tournamentName, avgGoalsPerMatch, totalTeams",
    "source_dataset": "wwc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 197,
    "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_197",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "What is the average number of goals scored by players representing 'Argentina' in all matches, and what is the total number of matches they played?",
    "Cypher": "MATCH (t:Team {name: 'Argentina'})<-[:REPRESENTS]-(p:Person)-[sg:SCORED_GOAL]->(m:Match)\nWITH t, p, m\nWITH t, COUNT(sg) AS goals, COUNT(DISTINCT m) AS matches\nRETURN t.name AS teamName, toFloat(SUM(goals))/matches AS avgGoalsPerMatch, matches AS totalMatchesPlayed",
    "source_dataset": "wwc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 213,
    "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_213",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `sg` not defined (line 3, column 15 (offset: 116))\n\"WITH t, COUNT(sg) AS goals, COUNT(DISTINCT m) AS matches\"\n               ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each player who played in a match during the 'Germany 2011' tournament, calculate the total number of matches they played in that tournament and the average 'score' value from the 'PLAYED_IN' relationships. Return the player's name, the total matches played, and the average score.",
    "Cypher": "MATCH (p:Person)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament {name: 'Germany 2011'})\nWITH p, COUNT(m) AS totalMatches, AVG(toInt(r.score)) AS avgScore\nRETURN p.name AS playerName, totalMatches, avgScore",
    "source_dataset": "wwc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 220,
    "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_220",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 2, column 39 (offset: 136))\n\"WITH p, COUNT(m) AS totalMatches, AVG(toInt(r.score)) AS avgScore\"\n                                       ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each squad, calculate the total number of players who are coaches and the average number of goals scored by all players in matches. Return the squad ID, the number of coach players, and the average goals per player.",
    "Cypher": "MATCH (s:Squad)<-[:IN_SQUAD]-(p:Person)\nOPTIONAL MATCH (p)-[:COACH_FOR]->(s)\nWITH s, p, CASE WHEN p-[:COACH_FOR]->(s) THEN 1 ELSE 0 END AS isCoach\nOPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(:Match)\nWITH s,SUM(isCoach) AS coachCount, p, COUNT(sg) AS goalsPerPlayer\nWITH s, coachCount, AVG(goalsPerPlayer) AS avgGoalsPerPlayer\nRETURN s.id AS squadId, coachCount, avgGoalsPerPlayer",
    "source_dataset": "wwc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 221,
    "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_221",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'WHEN': expected an expression, 'FOREACH', ',', 'AS', 'ORDER BY', 'CALL', 'CREATE', 'LOAD CSV', 'DELETE', 'DETACH', 'FINISH', 'INSERT', 'LIMIT', 'MATCH', 'MERGE', 'NODETACH', 'OFFSET', 'OPTIONAL', 'REMOVE', 'RETURN', 'SET', 'SKIP', 'UNION', 'UNWIND', 'USE', 'WHERE', 'WITH' or <EOF> (line 3, column 17 (offset: 93))\n\"WITH s, p, CASE WHEN p-[:COACH_FOR]->(s) THEN 1 ELSE 0 END AS isCoach\"\n                 ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each team, calculate the total number of matches they played in the 'Sweden 1995' tournament and the average number of goals scored per match by that team. Return the team name, total matches, and average goals per match.",
    "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'Sweden 1995'}) WHERE r.score IS NOT NULL WITH t, m, r, tour COUNT(m) AS matchCount, SUM(r.score) AS totalGoals RETURN t.name AS teamName, matchCount AS totalMatches, toFloat(totalGoals)/matchCount AS avgGoalsPerMatch;",
    "source_dataset": "wwc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 224,
    "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_224",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'COUNT': expected an expression, 'FOREACH', ',', 'AS', 'ORDER BY', 'CALL', 'CREATE', 'LOAD CSV', 'DELETE', 'DETACH', 'FINISH', 'INSERT', 'LIMIT', 'MATCH', 'MERGE', 'NODETACH', 'OFFSET', 'OPTIONAL', 'REMOVE', 'RETURN', 'SET', 'SKIP', 'UNION', 'UNWIND', 'USE', 'WHERE', 'WITH' or <EOF> (line 1, column 144 (offset: 143))\n\"MATCH (t:Team)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'Sweden 1995'}) WHERE r.score IS NOT NULL WITH t, m, r, tour COUNT(m) AS matchCount, SUM(r.score) AS totalGoals RETURN t.name AS teamName, matchCount AS totalMatches, toFloat(totalGoals)/matchCount AS avgGoalsPerMatch;\"\n                                                                                                                                                ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each person who played in a match, find the total number of matches they played and the average score in those matches. Return the person's name, the total number of matches, and the average score, ordering by the average score in descending order.",
    "Cypher": "MATCH (p:Person)-[r:PLAYED_IN]->(m:Match) WHERE r.score IS NOT NULL WITH p, COUNT(m) AS matchCount, AVG(r.score) AS avgScore RETURN p.name AS playerName, matchCount, avgScore ORDER BY avgScore DESC;",
    "source_dataset": "wwc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 225,
    "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_225",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each team, calculate the total number of goals scored and the average number of goals scored per match they played in France 2019. Return the team name, total goals, and average goals per match.",
    "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'France 2019'}) OPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m) WHERE p-[:REPRESENTS]->(t) WITH t, m, COUNT(sg) AS goalsPerMatch, tour WITH t, SUM(goalsPerMatch) AS totalGoals, COUNT(m) AS totalMatches RETURN t.name AS teamName, totalGoals, CASE WHEN totalMatches > 0 THEN toFloat(totalGoals) / totalMatches ELSE 0 END AS avgGoalsPerMatch;",
    "source_dataset": "wwc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 231,
    "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_231",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input ':': expected an expression (line 1, column 156 (offset: 155))\n\"MATCH (t:Team)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'France 2019'}) OPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m) WHERE p-[:REPRESENTS]->(t) WITH t, m, COUNT(sg) AS goalsPerMatch, tour WITH t, SUM(goalsPerMatch) AS totalGoals, COUNT(m) AS totalMatches RETURN t.name AS teamName, totalGoals, CASE WHEN totalMatches > 0 THEN toFloat(totalGoals) / totalMatches ELSE 0 END AS avgGoalsPerMatch;\"\n                                                                                                                                                            ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each tournament, determine the team that scored the most goals. Return the tournament name, the team's name, and the total goals scored by that team in the tournament.",
    "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[r:PLAYED_IN]-(team:Team) OPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m) WHERE p-[:REPRESENTS]->(team) WITH tour, team, COUNT(sg) AS totalGoals ORDER BY tour.name, totalGoals DESC WITH tour, COLLECT({team: team, totalGoals: totalGoals}) AS scorers RETURN tour.name AS tournamentName, scorers[0].team.name AS teamName, scorers[0].totalGoals AS totalGoals;",
    "source_dataset": "wwc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 232,
    "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_232",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input ':': expected an expression (line 1, column 137 (offset: 136))\n\"MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[r:PLAYED_IN]-(team:Team) OPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m) WHERE p-[:REPRESENTS]->(team) WITH tour, team, COUNT(sg) AS totalGoals ORDER BY tour.name, totalGoals DESC WITH tour, COLLECT({team: team, totalGoals: totalGoals}) AS scorers RETURN tour.name AS tournamentName, scorers[0].team.name AS teamName, scorers[0].totalGoals AS totalGoals;\"\n                                                                                                                                         ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each player who played in a match during the 'Canada 2015' tournament, calculate the average score of the matches they played in. Return the player's name and the average score.",
    "Cypher": "MATCH (p:Person)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament {name: 'Canada 2015'}) WHERE r.score IS NOT NULL WITH p, AVG(toInt(r.score)) AS avgScore RETURN p.name AS playerName, avgScore;",
    "source_dataset": "wwc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 233,
    "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_233",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 1, column 136 (offset: 135))\n\"MATCH (p:Person)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament {name: 'Canada 2015'}) WHERE r.score IS NOT NULL WITH p, AVG(toInt(r.score)) AS avgScore RETURN p.name AS playerName, avgScore;\"\n                                                                                                                                        ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each team, determine the total number of goals scored in all matches and the average number of goals scored per match. Return the team's name, total goals, and average goals per match.",
    "Cypher": "MATCH (t:Team)-[:PLAYED_IN]->(m:Match)<-[sg:SCORED_GOAL]-(p:Person)\nWITH t, m, SUM(toInt(sg.minute)) AS totalGoalsPerMatch\nWITH t, COUNT(DISTINCT m) AS totalMatches, SUM(totalGoalsPerMatch) AS totalGoals\nRETURN t.name AS teamName, totalGoals, CASE WHEN totalMatches > 0 THEN toFloat(totalGoals) / totalMatches ELSE 0 END AS avgGoalsPerMatch",
    "source_dataset": "wwc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 260,
    "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_260",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 2, column 16 (offset: 83))\n\"WITH t, m, SUM(toInt(sg.minute)) AS totalGoalsPerMatch\"\n                ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each team that participated in a tournament, determine the average number of goals scored per match and the total number of matches played. Return the team name, average goals per match, and total matches played.",
    "Cypher": "MATCH (t:Team)-[:PLAYED_IN]->(m:Match) WHERE m.id IN [(t)-[:PLAYED_IN]->(m2:Match) RETURN m2.id] WITH t, m OPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m) WITH t, COUNT(DISTINCT m) AS totalMatches, SUM(CASE WHEN sg IS NOT NULL THEN 1 ELSE 0 END) AS totalGoals RETURN t.name AS teamName, CASE WHEN totalMatches > 0 THEN toFloat(totalGoals) / totalMatches ELSE 0 END AS avgGoalsPerMatch, totalMatches",
    "source_dataset": "wwc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 267,
    "unique_id": "wwc_data_3_1_2_6_Complex_Aggregation_267",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'RETURN': expected an expression (line 1, column 84 (offset: 83))\n\"MATCH (t:Team)-[:PLAYED_IN]->(m:Match) WHERE m.id IN [(t)-[:PLAYED_IN]->(m2:Match) RETURN m2.id] WITH t, m OPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m) WITH t, COUNT(DISTINCT m) AS totalMatches, SUM(CASE WHEN sg IS NOT NULL THEN 1 ELSE 0 END) AS totalGoals RETURN t.name AS teamName, CASE WHEN totalMatches > 0 THEN toFloat(totalGoals) / totalMatches ELSE 0 END AS avgGoalsPerMatch, totalMatches\"\n                                                                                    ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each tournament, calculate the total number of goals scored and the average number of players who scored in each match. Return the tournament name, total goals, and average scorers per match.",
    "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[sg:SCORED_GOAL]-(p:Person)\nWITH tour, m, COUNT(DISTINCT p) AS scorersPerMatch\nWITH tour, m, scorersPerMatch, SUM(CASE WHEN sg IS NOT NULL THEN 1 ELSE 0 END) AS goalsScored\nWITH tour, AVG(scorersPerMatch) AS avgScorersPerMatch, SUM(goalsScored) AS totalGoals\nRETURN tour.name AS tournamentName, totalGoals, avgScorersPerMatch",
    "source_dataset": "wwc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 7,
    "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_7",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `sg` not defined (line 3, column 46 (offset: 177))\n\"WITH tour, m, scorersPerMatch, SUM(CASE WHEN sg IS NOT NULL THEN 1 ELSE 0 END) AS goalsScored\"\n                                              ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For matches in the 'France 2019' tournament, calculate the average 'score' property of the 'PLAYED_IN' relationships and the total number of matches where the 'score' property is not null.",
    "Cypher": "MATCH (m:Match)-[:IN_TOURNAMENT]->(t:Tournament {name: 'France 2019'})\nOPTIONAL MATCH (p:Person)-[r:PLAYED_IN]->(m)\nWHERE r.score IS NOT NULL\nWITH m, r.score AS score\nWITH m, AVG(score) AS avgScore\nWITH m, COUNT(DISTINCT m) AS matchesWithScore\nRETURN avgScore, matchesWithScore",
    "source_dataset": "wwc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 25,
    "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_25",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `avgScore` not defined (line 7, column 8 (offset: 251))\n\"RETURN avgScore, matchesWithScore\"\n        ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each tournament, find the team that scored the highest total goals. Return the tournament name, team name, and the total goals scored by that team in the tournament.",
    "Cypher": "MATCH (tour:Tournament)<-[:PARTICIPATED_IN]-(t:Team)-[r:PLAYED_IN]->(m:Match) WHERE r.score IS NOT NULL WITH tour, t, SUM(r.score) AS totalGoals ORDER BY tour.name, totalGoals DESC WITH tour, COLLECT({team: t, totalGoals: totalGoals}) AS scorers UNWIND scorers[0..0] AS topScorer RETURN tour.name AS tournamentName, topScorer.team.name AS teamName, topScorer.totalGoals AS totalGoals;",
    "source_dataset": "wwc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 36,
    "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_36",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each player who played in a match during the 'USA 1999' tournament, calculate the total number of goals they scored and the average time (in minutes) at which they scored their goals. Return the player's name, total goals, and average scoring minute.",
    "Cypher": "MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'USA 1999'}) WITH p, sg, m WHERE sg.minute IS NOT NULL AND toInteger(replace(sg.minute, \"'+.*\", '')) > 0 WITH p, toInteger(replace(sg.minute, \"'+.*\", '')) AS scoringMinute, m WITH p, AVG(scoringMinute) AS avgScoringMinute, COUNT(m) AS totalGoals RETURN p.name AS playerName, totalGoals, avgScoringMinute;",
    "source_dataset": "wwc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 37,
    "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_37",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each team that participated in the 'USA 1999' tournament, find the number of matches they played and the average number of goals scored in each of their matches where the 'minuteOn' property is not null. Return the team name, the number of matches played, and the average goals scored.",
    "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'USA 1999'}) MATCH (t)-[r:PLAYED_IN]->(m:Match) WHERE r.minuteOn IS NOT NULL WITH t, COUNT(m) AS matchCount, AVG(r.score) AS avgGoalsScored RETURN t.name AS teamName, matchCount, avgGoalsScored;",
    "source_dataset": "wwc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 39,
    "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_39",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each player, determine the total number of goals scored and the number of tournaments they played in. Then calculate the average goals scored per tournament. Return the player's name, total goals, total tournaments, and average goals per tournament.",
    "Cypher": "MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament) WITH p, COUNT(sg) AS totalGoals, COLLECT(DISTINCT t.id) AS tournaments PLAYED_IN MATCH (p)-[:PLAYED_IN]->(m2:Match) WITH p,totalGoals, tournaments RETURN p.name AS playerName, totalGoals, SIZE(tournaments) AS totalTournaments, CASE WHEN SIZE(tournaments) = 0 THEN 0 ELSE toFloat(totalGoals) / SIZE(tournaments) END AS avgGoalsPerTournament",
    "source_dataset": "wwc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 57,
    "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_57",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'PLAYED_IN': expected 'FOREACH', ',', 'ORDER BY', 'CALL', 'CREATE', 'LOAD CSV', 'DELETE', 'DETACH', 'FINISH', 'INSERT', 'LIMIT', 'MATCH', 'MERGE', 'NODETACH', 'OFFSET', 'OPTIONAL', 'REMOVE', 'RETURN', 'SET', 'SKIP', 'UNION', 'UNWIND', 'USE', 'WHERE', 'WITH' or <EOF> (line 1, column 150 (offset: 149))\n\"MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament) WITH p, COUNT(sg) AS totalGoals, COLLECT(DISTINCT t.id) AS tournaments PLAYED_IN MATCH (p)-[:PLAYED_IN]->(m2:Match) WITH p,totalGoals, tournaments RETURN p.name AS playerName, totalGoals, SIZE(tournaments) AS totalTournaments, CASE WHEN SIZE(tournaments) = 0 THEN 0 ELSE toFloat(totalGoals) / SIZE(tournaments) END AS avgGoalsPerTournament\"\n                                                                                                                                                      ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each stage of matches, determine the average penalty score and the total number of matches played in that stage. Return the stage name, the average penalty score, and the total matches.",
    "Cypher": "MATCH (m:Match) WHERE m.stage IS NOT NULL WITH m.stage AS matchStage, m OPTIONAL MATCH (p:Person)-[r:PLAYED_IN]->(m) WHERE r.penaltyScore IS NOT NULL WITH matchStage, COUNT(m) AS totalMatches, AVG(toInt(r.penaltyScore)) AS avgPenaltyScore RETURN matchStage, avgPenaltyScore, totalMatches",
    "source_dataset": "wwc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 60,
    "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_60",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 1, column 198 (offset: 197))\n\"MATCH (m:Match) WHERE m.stage IS NOT NULL WITH m.stage AS matchStage, m OPTIONAL MATCH (p:Person)-[r:PLAYED_IN]->(m) WHERE r.penaltyScore IS NOT NULL WITH matchStage, COUNT(m) AS totalMatches, AVG(toInt(r.penaltyScore)) AS avgPenaltyScore RETURN matchStage, avgPenaltyScore, totalMatches\"\n                                                                                                                                                                                                      ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each tournament in 1995, calculate the average number of goals scored by players who were coached for squads in that tournament. Return the tournament name and the average number of goals.",
    "Cypher": "MATCH (tour:Tournament)<-[:FOR]-(s:Squad)<-[:COACH_FOR]-(coach:Person)-[:IN_SQUAD]->(player:Person)-[sg:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(tour) WHERE tour.year = 1995 WITH tour, coach, COUNT(sg) AS goalsScored RETURN tour.name AS tournamentName, AVG(goalsScored) AS averageGoalsScored;",
    "source_dataset": "wwc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 74,
    "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_74",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each team, determine the total number of matches played and the average number of minutes played per match. Return the team name, total matches, and average minutes played.",
    "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match)\nWHERE r.minuteOn IS NOT NULL\nWITH t, COUNT(m) AS totalMatches, COLLECT(toInt(r.minuteOn)) AS minutesPlayed\nWITH t, totalMatches, REDUCE(s = 0, x IN minutesPlayed | s + x) AS totalMinutes\nRETURN t.name AS teamName, totalMatches, CASE WHEN totalMatches > 0 THEN toFloat(totalMinutes) / totalMatches ELSE 0 END AS avgMinutesPlayed",
    "source_dataset": "wwc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 78,
    "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_78",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 3, column 43 (offset: 111))\n\"WITH t, COUNT(m) AS totalMatches, COLLECT(toInt(r.minuteOn)) AS minutesPlayed\"\n                                           ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each team, calculate the total number of matches they played and the average number of goals scored by their players in those matches. Return the team name, total matches played, and average goals scored per match.",
    "Cypher": "MATCH (t:Team)-[:PLAYED_IN]->(m:Match)<-[sg:SCORED_GOAL]-(p:Person) WITH t, m, SUM(toInt(sg.minute)) AS totalGoals WHERE totalGoals IS NOT NULL WITH t, COUNT(DISTINCT m) AS matchCount, totalGoals RETURN t.name AS teamName, matchCount AS totalMatches, toFloat(totalGoals)/matchCount AS avgGoalsPerMatch",
    "source_dataset": "wwc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 84,
    "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_84",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 1, column 84 (offset: 83))\n\"MATCH (t:Team)-[:PLAYED_IN]->(m:Match)<-[sg:SCORED_GOAL]-(p:Person) WITH t, m, SUM(toInt(sg.minute)) AS totalGoals WHERE totalGoals IS NOT NULL WITH t, COUNT(DISTINCT m) AS matchCount, totalGoals RETURN t.name AS teamName, matchCount AS totalMatches, toFloat(totalGoals)/matchCount AS avgGoalsPerMatch\"\n                                                                                    ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each tournament, find the team that played the most matches and calculate the average number of goals scored by that team across all their matches in the tournament. Return the tournament name, the team name, and the average goals scored.",
    "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[:PLAYED_IN]-(t:Team) WITH tour, t, COUNT(m) AS matchCount ORDER BY tour.id, matchCount DESC WITH tour, COLLECT({team: t, matchCount: matchCount}) AS teams MATCH (teams[0].team)-[:PLAYED_IN]->(m2:Match)-[:IN_TOURNAMENT]->(tour) OPTIONAL MATCH (teams[0].team)-[sg:SCORED_GOAL]->(m2) WITH tour, teams[0].team AS topTeam, COUNT(sg) AS totalGoals, COUNT(m2) AS totalMatches RETURN tour.name AS tournamentName, topTeam.name AS teamName, CASE WHEN totalMatches = 0 THEN 0 ELSE toFloat(totalGoals) / totalMatches END AS avgGoals",
    "source_dataset": "wwc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 88,
    "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_88",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input '[': expected a graph pattern, a parameter, ')', ':', 'IS', 'WHERE' or '{' (line 1, column 222 (offset: 221))\n\"MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[:PLAYED_IN]-(t:Team) WITH tour, t, COUNT(m) AS matchCount ORDER BY tour.id, matchCount DESC WITH tour, COLLECT({team: t, matchCount: matchCount}) AS teams MATCH (teams[0].team)-[:PLAYED_IN]->(m2:Match)-[:IN_TOURNAMENT]->(tour) OPTIONAL MATCH (teams[0].team)-[sg:SCORED_GOAL]->(m2) WITH tour, teams[0].team AS topTeam, COUNT(sg) AS totalGoals, COUNT(m2) AS totalMatches RETURN tour.name AS tournamentName, topTeam.name AS teamName, CASE WHEN totalMatches = 0 THEN 0 ELSE toFloat(totalGoals) / totalMatches END AS avgGoals\"\n                                                                                                                                                                                                                              ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each team that participated in the 'Sweden 1995' tournament, determine the number of matches they played and the average score in those matches. Return the team name, match count, and average score.",
    "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'Sweden 1995'})\nMATCH (t)-[r:PLAYED_IN]->(m:Match)\nWITH t, COUNT(m) AS matchCount, AVG(toInt(r.score)) AS avgScore\nRETURN t.name AS teamName, matchCount, avgScore",
    "source_dataset": "wwc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 99,
    "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_99",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 3, column 37 (offset: 146))\n\"WITH t, COUNT(m) AS matchCount, AVG(toInt(r.score)) AS avgScore\"\n                                     ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each player who played in a match during the 'Sweden 1995' tournament, find the total number of goals they scored and the average number of minutes they played. Return the player's name, total goals, and average minutes.",
    "Cypher": "MATCH (p:Person)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'Sweden 1995'})\nOPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m)\nWITH p, COUNT(sg) AS totalGoals, AVG(toInt(r.minuteOn)) AS avgMinutes\nRETURN p.name AS playerName, totalGoals, avgMinutes",
    "source_dataset": "wwc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 100,
    "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_100",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 3, column 38 (offset: 178))\n\"WITH p, COUNT(sg) AS totalGoals, AVG(toInt(r.minuteOn)) AS avgMinutes\"\n                                      ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each team, calculate the total number of matches they played and the average penalty score across all matches. Return the team name, total matches, and average penalty score.",
    "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match) WHERE r.penaltyScore IS NOT NULL WITH t, COUNT(m) AS totalMatches, AVG(toInt(r.penaltyScore)) AS avgPenaltyScore RETURN t.name AS teamName, totalMatches, avgPenaltyScore",
    "source_dataset": "wwc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 112,
    "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_112",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 1, column 112 (offset: 111))\n\"MATCH (t:Team)-[r:PLAYED_IN]->(m:Match) WHERE r.penaltyScore IS NOT NULL WITH t, COUNT(m) AS totalMatches, AVG(toInt(r.penaltyScore)) AS avgPenaltyScore RETURN t.name AS teamName, totalMatches, avgPenaltyScore\"\n                                                                                                                ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each person, find the total number of matches they played and the average number of minutes they played in each match. Return the person's name, total matches played, and average minutes played.",
    "Cypher": "MATCH (p:Person)-[r:PLAYED_IN]->(m:Match) WHERE r.minuteOn IS NOT NULL WITH p, COUNT(m) AS totalMatches, AVG(toInt(r.minuteOn)) AS avgMinutesPlayed RETURN p.name AS personName, totalMatches, avgMinutesPlayed",
    "source_dataset": "wwc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 114,
    "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_114",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 1, column 110 (offset: 109))\n\"MATCH (p:Person)-[r:PLAYED_IN]->(m:Match) WHERE r.minuteOn IS NOT NULL WITH p, COUNT(m) AS totalMatches, AVG(toInt(r.minuteOn)) AS avgMinutesPlayed RETURN p.name AS personName, totalMatches, avgMinutesPlayed\"\n                                                                                                              ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each team that participated in the 'USA 2003' tournament, calculate the total number of players and the average number of goals scored by each player in matches. Return the team name, total players, and average goals per player.",
    "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'USA 2003'})\nOPTIONAL MATCH (p:Person)-[:REPRESENTS]->(t)-[:PLAYED_IN]->(m:Match)\nOPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m)\nWITH t, COUNT(DISTINCT p) AS totalPlayers, COUNT(sg) AS totalGoals,totalPlayers\nRETURN t.name AS teamName, totalPlayers, CASE WHEN totalPlayers = 0 THEN 0 ELSE toFloat(totalGoals) / totalPlayers END AS avgGoalsPerPlayer",
    "source_dataset": "wwc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 158,
    "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_158",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `totalPlayers` not defined (line 4, column 68 (offset: 249))\n\"WITH t, COUNT(DISTINCT p) AS totalPlayers, COUNT(sg) AS totalGoals,totalPlayers\"\n                                                                    ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each player who participated in matches, determine the total number of matches they played and the average score in those matches. Return the player's name, total matches played, and average score, ordering by average score in descending order.",
    "Cypher": "MATCH (p:Person)-[r:PLAYED_IN]->(m:Match) WHERE r.score IS NOT NULL WITH p, COUNT(m) AS totalMatches, SUM(r.score) AS totalScore RETURN p.name AS playerName, totalMatches, CASE WHEN totalMatches > 0 THEN toFloat(totalScore) / totalMatches ELSE 0 END AS avgScore ORDER BY avgScore DESC",
    "source_dataset": "wwc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 169,
    "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_169",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "What is the average number of goals scored by 'Petra Damm' in matches and the total number of matches she played in?",
    "Cypher": "MATCH (p:Person {name: 'Petra Damm'})-[r:SCORED_GOAL]->(m:Match) WITH p, COUNT(m) AS totalMatches, AVG(toInt(r.minute)) AS avgGoalsPerMatch RETURN p.name AS playerName, totalMatches, avgGoalsPerMatch",
    "source_dataset": "wwc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 177,
    "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_177",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 1, column 104 (offset: 103))\n\"MATCH (p:Person {name: 'Petra Damm'})-[r:SCORED_GOAL]->(m:Match) WITH p, COUNT(m) AS totalMatches, AVG(toInt(r.minute)) AS avgGoalsPerMatch RETURN p.name AS playerName, totalMatches, avgGoalsPerMatch\"\n                                                                                                        ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "Considering matches where 'Chen Yufeng' played, what is the average 'score' in those matches and the total number of matches where 'Chen Yufeng' started?",
    "Cypher": "MATCH (p:Person {name: 'Chen Yufeng'})-[r:PLAYED_IN]->(m:Match) WITH p, r, m WHERE r.type = 'Started' WITH p, COUNT(m) AS totalMatchesStarted, AVG(toInt(r.score)) AS avgScoreInMatches RETURN p.name AS playerName, totalMatchesStarted, avgScoreInMatches",
    "source_dataset": "wwc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 179,
    "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_179",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 1, column 148 (offset: 147))\n\"MATCH (p:Person {name: 'Chen Yufeng'})-[r:PLAYED_IN]->(m:Match) WITH p, r, m WHERE r.type = 'Started' WITH p, COUNT(m) AS totalMatchesStarted, AVG(toInt(r.score)) AS avgScoreInMatches RETURN p.name AS playerName, totalMatchesStarted, avgScoreInMatches\"\n                                                                                                                                                    ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each player who played in a match during the year 2011, calculate the total number of matches they played and the average score in those matches. Return the player's name, total matches played, and average score.",
    "Cypher": "MATCH (p:Person)-[r:PLAYED_IN]->(m:Match)\nWHERE m.date.year = 2011\nWITH p, m, r\nWITH p, COUNT(m) AS totalMatches, SUM(toInt(r.score)) AS totalScore\nRETURN p.name AS playerName, totalMatches, CASE WHEN totalMatches = 0 THEN 0 ELSE toFloat(totalScore) / totalMatches END AS averageScore",
    "source_dataset": "wwc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 184,
    "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_184",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 4, column 39 (offset: 118))\n\"WITH p, COUNT(m) AS totalMatches, SUM(toInt(r.score)) AS totalScore\"\n                                       ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each tournament, find the team with the highest average 'score' in the 'PLAYED_IN' relationship. Return the tournament name, the team name, and the average score.",
    "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament)\nWITH tour, t, AVG(toInt(r.score)) AS avgScore\nORDER BY tour.name, avgScore DESC\nWITH tour, COLLECT({team: t, avgScore: avgScore}) AS teamScores\nRETURN tour.name AS tournamentName, teamScores[0].team.name AS teamName, teamScores[0].avgScore AS averageScore",
    "source_dataset": "wwc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 185,
    "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_185",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 2, column 19 (offset: 94))\n\"WITH tour, t, AVG(toInt(r.score)) AS avgScore\"\n                   ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each team that participated in the 'USA 1999' tournament, calculate the total number of goals scored and the average number of goals scored per match. Return the team name, total goals, and average goals per match.",
    "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'USA 1999'}) MATCH (t)-[r:PLAYED_IN]->(m:Match) OPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m) WHERE t-[:PLAYED_IN]->m WITH t, m, COUNT(sg) AS matchGoals WITH t, SUM(matchGoals) AS totalGoals, COUNT(m) AS totalMatches RETURN t.name AS teamName, totalGoals, CASE WHEN totalMatches > 0 THEN toFloat(totalGoals) / totalMatches ELSE 0 END AS avgGoalsPerMatch",
    "source_dataset": "wwc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 190,
    "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_190",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input ':': expected an expression (line 1, column 165 (offset: 164))\n\"MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'USA 1999'}) MATCH (t)-[r:PLAYED_IN]->(m:Match) OPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m) WHERE t-[:PLAYED_IN]->m WITH t, m, COUNT(sg) AS matchGoals WITH t, SUM(matchGoals) AS totalGoals, COUNT(m) AS totalMatches RETURN t.name AS teamName, totalGoals, CASE WHEN totalMatches > 0 THEN toFloat(totalGoals) / totalMatches ELSE 0 END AS avgGoalsPerMatch\"\n                                                                                                                                                                     ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each player who played in a match during the 'China 2007' tournament, determine the total number of goals they scored and the average time (in minutes) when they scored a goal. Return the player's name, total goals, and average goal time.",
    "Cypher": "MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'China 2007'}) WITH p, m, sg WHERE sg.minute IS NOT NULL WITH p, COLLECT(toFloat(replace(sg.minute, \"'\", ''))) AS goalTimes, COUNT(sg) AS totalGoals RETURN p.name AS playerName, totalGoals, avg(goalTimes) AS averageGoalTime;",
    "source_dataset": "wwc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 234,
    "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_234",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Type mismatch: expected Float, Integer or Duration but was List<Float> (line 1, column 282 (offset: 281))\n\"MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'China 2007'}) WITH p, m, sg WHERE sg.minute IS NOT NULL WITH p, COLLECT(toFloat(replace(sg.minute, \"'\", ''))) AS goalTimes, COUNT(sg) AS totalGoals RETURN p.name AS playerName, totalGoals, avg(goalTimes) AS averageGoalTime;\"\n                                                                                                                                                                                                                                                                                          ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each team, calculate the total number of players who represent them and the average age of those players. Return the team name, total player count, and average age.",
    "Cypher": "MATCH (p:Person)-[:REPRESENTS]->(t:Team) WHERE p.dob IS NOT NULL WITH t, p, date() - date(p.dob) AS ageInDays WITH t, p, ageInDays.years AS ageInYears WITH t, COUNT(DISTINCT p) AS totalPlayers, AVG(ageInYears) AS averageAge RETURN t.name AS teamName, totalPlayers, averageAge;",
    "source_dataset": "wwc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 235,
    "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_235",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Type mismatch: expected Duration but was Date (line 1, column 86 (offset: 85))\n\"MATCH (p:Person)-[:REPRESENTS]->(t:Team) WHERE p.dob IS NOT NULL WITH t, p, date() - date(p.dob) AS ageInDays WITH t, p, ageInDays.years AS ageInYears WITH t, COUNT(DISTINCT p) AS totalPlayers, AVG(ageInYears) AS averageAge RETURN t.name AS teamName, totalPlayers, averageAge;\"\n                                                                                      ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each player who played in a match during the 'Canada 2015' tournament, calculate the total number of goals they scored and the average time (in minutes) at which they scored their goals. Return the player's name, total goals, and average scoring minute.",
    "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'Canada 2015'}) OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m) WITH p, m,sg,toFloat(replace(sg.minute, '''','')) AS minute where sg.minute is not null WITH p, COUNT(sg) AS totalGoals, AVG(minute) AS avgScoringMinute RETURN p.name AS playerName, totalGoals, avgScoringMinute",
    "source_dataset": "wwc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 240,
    "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_240",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input '''': expected an expression, ')' or ',' (line 1, column 183 (offset: 182))\n\"MATCH (p:Person)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'Canada 2015'}) OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m) WITH p, m,sg,toFloat(replace(sg.minute, '''','')) AS minute where sg.minute is not null WITH p, COUNT(sg) AS totalGoals, AVG(minute) AS avgScoringMinute RETURN p.name AS playerName, totalGoals, avgScoringMinute\"\n                                                                                                                                                                                       ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each player who played in a match, find the average score in matches where they played and the total number of matches they played. Return the player's name, average score, and total matches played.",
    "Cypher": "MATCH (p:Person)-[r:PLAYED_IN]->(m:Match)\nWHERE r.score IS NOT NULL\nWITH p, COUNT(m) AS totalMatches, AVG(toInt(r.score)) AS avgScore\nRETURN p.name AS playerName, avgScore, totalMatches",
    "source_dataset": "wwc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 247,
    "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_247",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 3, column 39 (offset: 106))\n\"WITH p, COUNT(m) AS totalMatches, AVG(toInt(r.score)) AS avgScore\"\n                                       ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each team that participated in the 'Sweden 1995' tournament, find the average number of players in their squads and the total number of goals scored by the team's players across all matches. Return the team name, average squad size, and total goals.",
    "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'Sweden 1995'}) MATCH (t)-[:NAMED]->(s:Squad)<-[:IN_SQUAD]-(p:Person) OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m:Match) WHERE t-[:PLAYED_IN]->m WITH t, COUNT(DISTINCT p) AS squadSize, SUM(CASE WHEN sg IS NOT NULL THEN 1 ELSE 0 END) AS totalGoals RETURN t.name AS teamName, AVG(squadSize) AS avgSquadSize, totalGoals",
    "source_dataset": "wwc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 254,
    "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_254",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input ':': expected an expression (line 1, column 186 (offset: 185))\n\"MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'Sweden 1995'}) MATCH (t)-[:NAMED]->(s:Squad)<-[:IN_SQUAD]-(p:Person) OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m:Match) WHERE t-[:PLAYED_IN]->m WITH t, COUNT(DISTINCT p) AS squadSize, SUM(CASE WHEN sg IS NOT NULL THEN 1 ELSE 0 END) AS totalGoals RETURN t.name AS teamName, AVG(squadSize) AS avgSquadSize, totalGoals\"\n                                                                                                                                                                                          ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each team that participated in a tournament, calculate the total number of matches they played and the average score in those matches. Return the team name, total matches, and average score.",
    "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match) WITH t, COUNT(m) AS matchCount, SUM(toInt(r.score)) AS totalScore RETURN t.name AS teamName, matchCount AS totalMatches, CASE WHEN matchCount > 0 THEN toFloat(totalScore) / matchCount ELSE 0 END AS avgScore",
    "source_dataset": "wwc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 274,
    "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_274",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 1, column 77 (offset: 76))\n\"MATCH (t:Team)-[r:PLAYED_IN]->(m:Match) WITH t, COUNT(m) AS matchCount, SUM(toInt(r.score)) AS totalScore RETURN t.name AS teamName, matchCount AS totalMatches, CASE WHEN matchCount > 0 THEN toFloat(totalScore) / matchCount ELSE 0 END AS avgScore\"\n                                                                             ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each tournament, find the team with the highest average score across all matches they played in that tournament. Return the tournament name, the team name, and the average score.",
    "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[r:PLAYED_IN]-(t:Team) WITH tour, t, AVG(toInt(r.score)) AS avgScore ORDER BY tour.name, avgScore DESC WITH tour, COLLECT({team: t.name, avgScore: avgScore}) AS teamScores RETURN tour.name AS tournamentName, teamScores[0].team AS teamName, teamScores[0].avgScore AS avgScore",
    "source_dataset": "wwc",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 275,
    "unique_id": "wwc_data_3_2_2_6_Complex_Aggregation_275",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 1, column 95 (offset: 94))\n\"MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[r:PLAYED_IN]-(t:Team) WITH tour, t, AVG(toInt(r.score)) AS avgScore ORDER BY tour.name, avgScore DESC WITH tour, COLLECT({team: t.name, avgScore: avgScore}) AS teamScores RETURN tour.name AS tournamentName, teamScores[0].team AS teamName, teamScores[0].avgScore AS avgScore\"\n                                                                                               ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each team, calculate the total number of matches they played and the average score in those matches. Return the team name, total matches played, and average score.",
    "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match) WITH t, COUNT(m) AS totalMatches, AVG(toInt(r.score)) AS avgScore RETURN t.name AS teamName, totalMatches, avgScore",
    "source_dataset": "wwc",
    "source_chunk": "data_3_3_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 8,
    "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_8",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 1, column 79 (offset: 78))\n\"MATCH (t:Team)-[r:PLAYED_IN]->(m:Match) WITH t, COUNT(m) AS totalMatches, AVG(toInt(r.score)) AS avgScore RETURN t.name AS teamName, totalMatches, avgScore\"\n                                                                               ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each tournament, find the team with the highest average 'score' in the PLAYED_IN relationships. Return the tournament name, team name, and the highest average score.",
    "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament) WITH tour, t, AVG(toInt(r.score)) AS avgScorePerTeam ORDER BY tour.name, avgScorePerTeam DESC WITH tour, COLLECT({team: t, avgScore: avgScorePerTeam}) AS teamScores RETURN tour.name AS tournamentName, teamScores[0].team.name AS teamName, teamScores[0].avgScore AS highestAvgScore",
    "source_dataset": "wwc",
    "source_chunk": "data_3_3_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 10,
    "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_10",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 1, column 95 (offset: 94))\n\"MATCH (t:Team)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament) WITH tour, t, AVG(toInt(r.score)) AS avgScorePerTeam ORDER BY tour.name, avgScorePerTeam DESC WITH tour, COLLECT({team: t, avgScore: avgScorePerTeam}) AS teamScores RETURN tour.name AS tournamentName, teamScores[0].team.name AS teamName, teamScores[0].avgScore AS highestAvgScore\"\n                                                                                               ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each player who played in a match during the 'China 2007' tournament, calculate the total number of goals they scored and the average number of minutes they played per match. Return the player's name, total goals scored, and average minutes played.",
    "Cypher": "MATCH (p:Person)-[pi:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament {name: 'China 2007'}) OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m) WITH p, pi, COUNT(sg) AS totalGoals WHERE pi.minuteOn IS NOT NULL WITH p, totalGoals, COLLECT(toFloat(replace(pi.minuteOn, \"'\", ''))) AS minutes  RETURN p.name AS playerName, totalGoals,  CASE WHEN size(minutes) > 0 THEN avg(minutes) ELSE 0 END AS avgMinutesPlayed",
    "source_dataset": "wwc",
    "source_chunk": "data_3_3_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 58,
    "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_58",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Type mismatch: expected Float, Integer or Duration but was List<Float> (line 1, column 364 (offset: 363))\n\"MATCH (p:Person)-[pi:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament {name: 'China 2007'}) OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m) WITH p, pi, COUNT(sg) AS totalGoals WHERE pi.minuteOn IS NOT NULL WITH p, totalGoals, COLLECT(toFloat(replace(pi.minuteOn, \"'\", ''))) AS minutes  RETURN p.name AS playerName, totalGoals,  CASE WHEN size(minutes) > 0 THEN avg(minutes) ELSE 0 END AS avgMinutesPlayed\"\n                                                                                                                                                                                                                                                                                                                                                                            ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "What is the average number of goals scored by Wu Weiying in each match they played in?",
    "Cypher": "MATCH (p:Person {name: 'Wu Weiying'})-[sg:SCORED_GOAL]->(m:Match)\nWITH p, COUNT(sg) AS goalsPerMatch, COUNT(m) AS totalMatches\nRETURN p.name AS playerName, toFloat(SUM(goalsPerMatch)) / totalMatches AS avgGoalsPerMatch",
    "source_dataset": "wwc",
    "source_chunk": "data_3_3_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 79,
    "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_79",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Aggregation column contains implicit grouping expressions. For example, in 'RETURN n.a, n.a + n.b + count(*)' the aggregation expression 'n.a + n.b + count(*)' includes the implicit grouping key 'n.b'. It may be possible to rewrite the query by extracting these grouping/aggregation expressions into a preceding WITH clause. Illegal expression(s): totalMatches (line 3, column 60 (offset: 186))\n\"RETURN p.name AS playerName, toFloat(SUM(goalsPerMatch)) / totalMatches AS avgGoalsPerMatch\"\n                                                            ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each tournament year, calculate the total number of goals scored by all players and the average age of the players who scored those goals. Return the tournament year, total goals scored, and average player age.",
    "Cypher": "MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament)\nWHERE p.dob IS NOT NULL\nWITH tour.year AS tournamentYear, p, COUNT(sg) AS goalsScored\nWITH tournamentYear, p, goalsScored, tour.year - p.dob.year AS playerAge\nWITH tournamentYear, SUM(goalsScored) AS totalGoals, AVG(playerAge) AS avgPlayerAge\nRETURN tournamentYear, totalGoals, avgPlayerAge",
    "source_dataset": "wwc",
    "source_chunk": "data_3_3_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 102,
    "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_102",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `tour` not defined (line 4, column 38 (offset: 204))\n\"WITH tournamentYear, p, goalsScored, tour.year - p.dob.year AS playerAge\"\n                                      ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each tournament, determine the team with the highest average score in 'PLAYED_IN' relationships, and return the tournament name, the team's name, and the team's average score.",
    "Cypher": "MATCH (t:Team)-[pi:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament)\nWITH tour, t, AVG(toInt(pi.score)) AS avgScore\nORDER BY tour.id, avgScore DESC\nWITH tour, COLLECT({team: t, avgScore: avgScore}) AS teamScores\nRETURN tour.name AS tournamentName, teamScores[0].team.name AS teamName, teamScores[0].avgScore AS highestAvgScore",
    "source_dataset": "wwc",
    "source_chunk": "data_3_3_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 122,
    "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_122",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 2, column 19 (offset: 95))\n\"WITH tour, t, AVG(toInt(pi.score)) AS avgScore\"\n                   ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each player who played in a match during 'Sweden 1995', calculate the average number of minutes they played. Return the player's name and their average minutes played.",
    "Cypher": "MATCH (p:Person)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament {name: 'Sweden 1995'}) WHERE r.minuteOn IS NOT NULL WITH p, r.minuteOn AS minuteOn UNWIND split(minuteOn, '''') as time WITH p, toInteger(time[0]) as minutesOn WITH p, AVG(minutesOn) AS avgMinutesPlayed RETURN p.name AS playerName, avgMinutesPlayed",
    "source_dataset": "wwc",
    "source_chunk": "data_3_3_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 137,
    "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_137",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input '''': expected an expression, ')' or ',' (line 1, column 183 (offset: 182))\n\"MATCH (p:Person)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament {name: 'Sweden 1995'}) WHERE r.minuteOn IS NOT NULL WITH p, r.minuteOn AS minuteOn UNWIND split(minuteOn, '''') as time WITH p, toInteger(time[0]) as minutesOn WITH p, AVG(minutesOn) AS avgMinutesPlayed RETURN p.name AS playerName, avgMinutesPlayed\"\n                                                                                                                                                                                       ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each person, find the average number of tournaments they played in per year since their birth. Return the person's name, birth year, and average tournaments per year.",
    "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament)\nWITH p, t.year AS tournamentYear, p.dob.year AS birthYear\nWITH p, COLLECT(DISTINCT tournamentYear) AS tournamentYears, birthYear\nWITH p, SIZE(tournamentYears) AS numberOfTournaments, birthYear\nWITH p, numberOfTournaments, CASE WHEN birthYear IS NOT NULL THEN (datetime().year - birthYear) ELSE 0 END AS age\nRETURN p.name AS personName, birthYear, CASE WHEN age > 0 THEN toFloat(numberOfTournaments) / age ELSE 0 END AS avgTournamentsPerYear",
    "source_dataset": "wwc",
    "source_chunk": "data_3_3_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 149,
    "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_149",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `birthYear` not defined (line 6, column 30 (offset: 410))\n\"RETURN p.name AS personName, birthYear, CASE WHEN age > 0 THEN toFloat(numberOfTournaments) / age ELSE 0 END AS avgTournamentsPerYear\"\n                              ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each player, determine the total number of tournaments they participated in as a coach and the average number of matches played by squads they coached in those tournaments. Return the player's name, the number of tournaments coached, and the average matches played by their squads.",
    "Cypher": "MATCH (p:Person)-[:COACH_FOR]->(s:Squad)-[:FOR]->(tour:Tournament) MATCH (s)-[:NAMED]->(t:Team)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour) WITH p, tour, COUNT(DISTINCT m) AS matchesPlayedPerSquad WITH p, COUNT(DISTINCT tour) AS tournamentsCoached, AVG(matchesPlayedPerSquad) AS avgMatchesPlayedBySquad RETURN p.name AS coachName, tournamentsCoached, avgMatchesPlayedBySquad",
    "source_dataset": "wwc",
    "source_chunk": "data_3_3_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 158,
    "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_158",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each tournament, determine the total number of goals scored and the average number of goals scored by players who represent teams from 'Ecuador'. Return the tournament name, total goals scored, and average goals scored by Ecuador players.",
    "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[:PLAYED_IN]-(p:Person)-[:REPRESENTS]->(t:Team {name: 'Ecuador'}) OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m) WITH tour, COUNT(sg) AS ecuadorGoals, m MATCH (m)-[:IN_TOURNAMENT]->(tour) OPTIONAL MATCH (:Person)-[sg_all:SCORED_GOAL]->(m) WITH tour, ecuadorGoals, COUNT(sg_all) AS totalGoals WHERE t.name = 'Ecuador' RETURN tour.name AS tournamentName, totalGoals, AVG(ecuadorGoals) AS avgEcuadorGoals",
    "source_dataset": "wwc",
    "source_chunk": "data_3_3_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 171,
    "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_171",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `t` not defined (line 1, column 346 (offset: 345))\n\"MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[:PLAYED_IN]-(p:Person)-[:REPRESENTS]->(t:Team {name: 'Ecuador'}) OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m) WITH tour, COUNT(sg) AS ecuadorGoals, m MATCH (m)-[:IN_TOURNAMENT]->(tour) OPTIONAL MATCH (:Person)-[sg_all:SCORED_GOAL]->(m) WITH tour, ecuadorGoals, COUNT(sg_all) AS totalGoals WHERE t.name = 'Ecuador' RETURN tour.name AS tournamentName, totalGoals, AVG(ecuadorGoals) AS avgEcuadorGoals\"\n                                                                                                                                                                                                                                                                                                                                                          ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each player who played in a match on '1995-06-07', calculate the total number of goals they scored and the average number of minutes they played in those matches. Return the player's name, total goals, and average minutes played.",
    "Cypher": "MATCH (p:Person)-[r:PLAYED_IN]->(m:Match {date: date('1995-06-07')}) OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m) WITH p, r, COUNT(sg) AS totalGoals, COLLECT(toInt(r.minuteOn)) AS minutesPlayedList WITH p, totalGoals, REDUCE(s = 0, i IN minutesPlayedList | s + i) AS totalMinutes, SIZE(minutesPlayedList) AS matchCount RETURN p.name AS playerName, totalGoals, CASE WHEN matchCount > 0 THEN toFloat(totalMinutes) / matchCount ELSE 0 END AS avgMinutesPlayed",
    "source_dataset": "wwc",
    "source_chunk": "data_3_3_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 184,
    "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_184",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 1, column 155 (offset: 154))\n\"MATCH (p:Person)-[r:PLAYED_IN]->(m:Match {date: date('1995-06-07')}) OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m) WITH p, r, COUNT(sg) AS totalGoals, COLLECT(toInt(r.minuteOn)) AS minutesPlayedList WITH p, totalGoals, REDUCE(s = 0, i IN minutesPlayedList | s + i) AS totalMinutes, SIZE(minutesPlayedList) AS matchCount RETURN p.name AS playerName, totalGoals, CASE WHEN matchCount > 0 THEN toFloat(totalMinutes) / matchCount ELSE 0 END AS avgMinutesPlayed\"\n                                                                                                                                                           ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each tournament, calculate the total number of teams that participated and the average number of players per team across all squads in that tournament. Return the tournament name, total teams, and average players per team.",
    "Cypher": "MATCH (tour:Tournament)<-[:PARTICIPATED_IN]-(team:Team)-[:NAMED]->(squad:Squad)<-[:IN_SQUAD]-(person:Person) WITH tour, team, squad, COUNT(person) AS playerCount WITH tour, team, AVG(playerCount) AS avgPlayersPerTeam GROUP BY tour.name WITH tour.name AS tournamentName, COUNT(DISTINCT team) AS totalTeams, AVG(avgPlayersPerTeam) AS avgPlayersPerTeam RETURN tournamentName, totalTeams, avgPlayersPerTeam",
    "source_dataset": "wwc",
    "source_chunk": "data_3_3_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 189,
    "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_189",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'GROUP': expected 'FOREACH', ',', 'ORDER BY', 'CALL', 'CREATE', 'LOAD CSV', 'DELETE', 'DETACH', 'FINISH', 'INSERT', 'LIMIT', 'MATCH', 'MERGE', 'NODETACH', 'OFFSET', 'OPTIONAL', 'REMOVE', 'RETURN', 'SET', 'SKIP', 'UNION', 'UNWIND', 'USE', 'WHERE', 'WITH' or <EOF> (line 1, column 218 (offset: 217))\n\"MATCH (tour:Tournament)<-[:PARTICIPATED_IN]-(team:Team)-[:NAMED]->(squad:Squad)<-[:IN_SQUAD]-(person:Person) WITH tour, team, squad, COUNT(person) AS playerCount WITH tour, team, AVG(playerCount) AS avgPlayersPerTeam GROUP BY tour.name WITH tour.name AS tournamentName, COUNT(DISTINCT team) AS totalTeams, AVG(avgPlayersPerTeam) AS avgPlayersPerTeam RETURN tournamentName, totalTeams, avgPlayersPerTeam\"\n                                                                                                                                                                                                                          ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each team that played in the 'USA 2003' tournament, find the average score of their players in all matches they played. Return the team name and the average score.",
    "Cypher": "MATCH (team:Team)-[:PARTICIPATED_IN]->(tournament:Tournament {name: 'USA 2003'}) MATCH (person:Person)-[playedIn:PLAYED_IN]->(match:Match) WHERE (person)-[:REPRESENTS]->(team) WITH team, AVG(toInt(playedIn.score)) AS averageScore RETURN team.name AS teamName, averageScore",
    "source_dataset": "wwc",
    "source_chunk": "data_3_3_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 190,
    "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_190",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 1, column 192 (offset: 191))\n\"MATCH (team:Team)-[:PARTICIPATED_IN]->(tournament:Tournament {name: 'USA 2003'}) MATCH (person:Person)-[playedIn:PLAYED_IN]->(match:Match) WHERE (person)-[:REPRESENTS]->(team) WITH team, AVG(toInt(playedIn.score)) AS averageScore RETURN team.name AS teamName, averageScore\"\n                                                                                                                                                                                                ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each person who played in a match, determine the total number of goals they scored and the average 'score' value from the PLAYED_IN relationships across all matches. Return the person's name, total goals scored, and average score.",
    "Cypher": "MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match)\nWITH p, COUNT(sg) AS totalGoals\nOPTIONAL MATCH (p)-[pi:PLAYED_IN]->(m2:Match)\nWITH p, totalGoals, AVG(toInt(pi.score)) AS avgScore\nRETURN p.name AS playerName, totalGoals, avgScore",
    "source_dataset": "wwc",
    "source_chunk": "data_3_3_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 219,
    "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_219",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 4, column 25 (offset: 147))\n\"WITH p, totalGoals, AVG(toInt(pi.score)) AS avgScore\"\n                         ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each team, determine the total number of matches where they scored more than 1 goal and calculate the average minute at which they scored their first goal in those matches. Return the team name, the count of matches with more than 1 goal, and the average minute of their first goal.",
    "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match)\nWHERE toInteger(r.score) > 1\nWITH t, m, toInteger(r.score) as score\nOPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m)\nWITH t, m, score, COLLECT(toInteger(sg.minute)) AS goalMinutes\nWHERE size(goalMinutes) > 0\nWITH t, m, score, MIN(goalMinutes[0]) AS firstGoalMinute\nWITH t, COUNT(DISTINCT m) AS matchesWithMoreThanOneGoal, AVG(firstGoalMinute) AS avgFirstGoalMinute\nRETURN t.name AS teamName, matchesWithMoreThanOneGoal, avgFirstGoalMinute",
    "source_dataset": "wwc",
    "source_chunk": "data_3_3_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 221,
    "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_221",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each squad, calculate the total number of players and the average number of matches played by each player in the 'Canada 2015' tournament. Return the squad ID, total players, and average matches played per player.",
    "Cypher": "MATCH (s:Squad)-[:FOR]->(t:Tournament {name: 'Canada 2015'})<-[:IN_TOURNAMENT]-(m:Match)<-[:PLAYED_IN]-(p:Person)-[:IN_SQUAD]->(s)\nWITH s, p, COUNT(m) AS matchesPlayed\nWITH s, COUNT(DISTINCT p) AS totalPlayers, COLLECT(matchesPlayed) AS matchesPerPlayer\nRETURN s.id AS squadId, totalPlayers, REDUCE(acc = 0, m IN matchesPerPlayer | acc + m * 1.0) / totalPlayers AS avgMatchesPerPlayer",
    "source_dataset": "wwc",
    "source_chunk": "data_3_3_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 227,
    "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_227",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Type mismatch: expected Float, Integer or Duration but was Number (line 4, column 39 (offset: 292))\n\"RETURN s.id AS squadId, totalPlayers, REDUCE(acc = 0, m IN matchesPerPlayer | acc + m * 1.0) / totalPlayers AS avgMatchesPerPlayer\"\n                                       ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each team that participated in the 'Germany 2011' tournament, find the average number of goals scored per match and the total number of matches played. Return the team name, average goals per match, and total matches played.",
    "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'Germany 2011'})-[<-[:IN_TOURNAMENT]-(m:Match)<-[r:PLAYED_IN]-(t) WHERE r.score IS NOT NULL WITH t, COUNT(DISTINCT m) AS totalMatches, SUM(r.score) AS totalGoals RETURN t.name AS teamName, CASE WHEN totalMatches = 0 THEN 0 ELSE toFloat(totalGoals) / totalMatches END AS avgGoalsPerMatch, totalMatches",
    "source_dataset": "wwc",
    "source_chunk": "data_3_3_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 246,
    "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_246",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input '<': expected a parameter, a variable name, '*', ':', 'IS', 'WHERE', ']' or '{' (line 1, column 78 (offset: 77))\n\"MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'Germany 2011'})-[<-[:IN_TOURNAMENT]-(m:Match)<-[r:PLAYED_IN]-(t) WHERE r.score IS NOT NULL WITH t, COUNT(DISTINCT m) AS totalMatches, SUM(r.score) AS totalGoals RETURN t.name AS teamName, CASE WHEN totalMatches = 0 THEN 0 ELSE toFloat(totalGoals) / totalMatches END AS avgGoalsPerMatch, totalMatches\"\n                                                                              ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each player who played in matches during the 'Sweden 1995' tournament, calculate the total number of minutes they played and the average number of goals they scored per match. Return the player's name, total minutes played, and average goals per match.",
    "Cypher": "MATCH (p:Person)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'Sweden 1995'}) WHERE r.minuteOn IS NOT NULL WITH p, m, r.minuteOn AS minutes, r.score AS score OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m) WITH p, SUM(toInt(minutes)) AS totalMinutes, COUNT(sg) AS totalGoals, COUNT(DISTINCT m) AS totalMatches RETURN p.name AS playerName, totalMinutes, CASE WHEN totalMatches = 0 THEN 0 ELSE toFloat(totalGoals) / totalMatches END AS avgGoalsPerMatch",
    "source_dataset": "wwc",
    "source_chunk": "data_3_3_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 247,
    "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_247",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 1, column 234 (offset: 233))\n\"MATCH (p:Person)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'Sweden 1995'}) WHERE r.minuteOn IS NOT NULL WITH p, m, r.minuteOn AS minutes, r.score AS score OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m) WITH p, SUM(toInt(minutes)) AS totalMinutes, COUNT(sg) AS totalGoals, COUNT(DISTINCT m) AS totalMatches RETURN p.name AS playerName, totalMinutes, CASE WHEN totalMatches = 0 THEN 0 ELSE toFloat(totalGoals) / totalMatches END AS avgGoalsPerMatch\"\n                                                                                                                                                                                                                                          ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each player, determine the total number of tournaments they participated in and the average number of matches they played per tournament. Return the player's name, the number of tournaments, and the average matches per tournament.",
    "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament) WITH p, t, COUNT(m) AS matchesPerTournament WITH p, COUNT(DISTINCT t) AS totalTournaments, COLLECT(matchesPerTournament) AS matchesList RETURN p.name AS playerName, totalTournaments, CASE WHEN totalTournaments > 0 THEN toFloat(SUM(matchesList)) / totalTournaments ELSE 0 END AS avgMatchesPerTournament",
    "source_dataset": "wwc",
    "source_chunk": "data_3_3_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 268,
    "unique_id": "wwc_data_3_3_2_6_Complex_Aggregation_268",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Type mismatch: expected Float, Integer or Duration but was List<Integer> (line 1, column 306 (offset: 305))\n\"MATCH (p:Person)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament) WITH p, t, COUNT(m) AS matchesPerTournament WITH p, COUNT(DISTINCT t) AS totalTournaments, COLLECT(matchesPerTournament) AS matchesList RETURN p.name AS playerName, totalTournaments, CASE WHEN totalTournaments > 0 THEN toFloat(SUM(matchesList)) / totalTournaments ELSE 0 END AS avgMatchesPerTournament\"\n                                                                                                                                                                                                                                                                                                                  ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each team, calculate the total number of goals scored in all matches and the average number of goals scored per match where they played as 'Home'.",
    "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match) WHERE r.type = 'Home' WITH t, COUNT(m) AS totalMatches, SUM(r.score) AS totalGoals RETURN t.name AS teamName, totalGoals, CASE WHEN totalMatches > 0 THEN toFloat(totalGoals) / totalMatches ELSE 0 END AS avgGoalsPerMatch",
    "source_dataset": "wwc",
    "source_chunk": "data_3_4_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 17,
    "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_17",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each team that participated in the 'Sweden 1995' tournament, calculate the average score of their players across all matches. Return the team name and the average score.",
    "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'Sweden 1995'}) MATCH (p:Person)-[r:PLAYED_IN]->(m:Match) WHERE (p)-[:REPRESENTS]->(t) WITH t, p, AVG(toInt(r.score)) AS avgScorePerPlayer RETURN t.name AS teamName, avg(avgScorePerPlayer) AS avgTeamScore",
    "source_dataset": "wwc",
    "source_chunk": "data_3_4_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 21,
    "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_21",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 1, column 162 (offset: 161))\n\"MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'Sweden 1995'}) MATCH (p:Person)-[r:PLAYED_IN]->(m:Match) WHERE (p)-[:REPRESENTS]->(t) WITH t, p, AVG(toInt(r.score)) AS avgScorePerPlayer RETURN t.name AS teamName, avg(avgScorePerPlayer) AS avgTeamScore\"\n                                                                                                                                                                  ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each team that participated in the 'Germany 2011' tournament, compute the total number of goals scored and the average number of goals scored per match. Return the team name, total goals, and average goals per match.",
    "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'Germany 2011'})-[<-[:IN_TOURNAMENT]-(m:Match)\nOPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m)\nWITH t, m, COUNT(sg) AS goals\nWITH t, COUNT(m) AS totalMatches, SUM(goals) AS totalGoals\nRETURN t.name AS teamName, totalGoals, toFloat(totalGoals) / totalMatches AS avgGoalsPerMatch",
    "source_dataset": "wwc",
    "source_chunk": "data_3_4_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 29,
    "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_29",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input '<': expected a parameter, a variable name, '*', ':', 'IS', 'WHERE', ']' or '{' (line 1, column 78 (offset: 77))\n\"MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'Germany 2011'})-[<-[:IN_TOURNAMENT]-(m:Match)\"\n                                                                              ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each team, calculate the total number of matches they played and the average penalty score they achieved across all matches. Return the team name, total matches played, and average penalty score.",
    "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match) WHERE r.penaltyScore IS NOT NULL WITH t, COUNT(m) AS totalMatches, AVG(toInt(r.penaltyScore)) AS avgPenaltyScore RETURN t.name AS teamName, totalMatches, avgPenaltyScore;",
    "source_dataset": "wwc",
    "source_chunk": "data_3_4_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 39,
    "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_39",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 1, column 112 (offset: 111))\n\"MATCH (t:Team)-[r:PLAYED_IN]->(m:Match) WHERE r.penaltyScore IS NOT NULL WITH t, COUNT(m) AS totalMatches, AVG(toInt(r.penaltyScore)) AS avgPenaltyScore RETURN t.name AS teamName, totalMatches, avgPenaltyScore;\"\n                                                                                                                ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each team that participated in the 'Canada 2015' tournament, determine the average number of goals scored by players representing that team. Return the team name and the average goals scored by its players.",
    "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'Canada 2015'})<-[:IN_TOURNAMENT]-(m:Match)<-[:PLAYED_IN]-(p:Person)-[sg:SCORED_GOAL]->(m)\nWHERE p-[:REPRESENTS]->t\nWITH t, COUNT(sg) AS totalGoals, COUNT(DISTINCT p) AS numPlayers\nRETURN t.name AS teamName, toFloat(totalGoals) / numPlayers AS avgGoalsPerPlayer",
    "source_dataset": "wwc",
    "source_chunk": "data_3_4_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 46,
    "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_46",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input ':': expected an expression (line 2, column 10 (offset: 159))\n\"WHERE p-[:REPRESENTS]->t\"\n          ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each person who played in a match, determine the total number of goals they scored and calculate the average number of goals scored per match. Return the person's name, total goals scored, total matches played, and average goals per match.",
    "Cypher": "MATCH (p:Person)-[r:SCORED_GOAL]->(m:Match) WITH p, COUNT(m) AS totalGoals, COLLECT(DISTINCT m) AS matches PLAYED_IN (p)-[:PLAYED_IN]->(m2:Match) WITH p, totalGoals, size(matches) AS totalMatches RETURN p.name AS playerName, totalGoals, totalMatches, CASE WHEN totalMatches = 0 THEN 0 ELSE toFloat(totalGoals) / totalMatches END AS avgGoalsPerMatch",
    "source_dataset": "wwc",
    "source_chunk": "data_3_4_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 50,
    "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_50",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'PLAYED_IN': expected 'FOREACH', ',', 'ORDER BY', 'CALL', 'CREATE', 'LOAD CSV', 'DELETE', 'DETACH', 'FINISH', 'INSERT', 'LIMIT', 'MATCH', 'MERGE', 'NODETACH', 'OFFSET', 'OPTIONAL', 'REMOVE', 'RETURN', 'SET', 'SKIP', 'UNION', 'UNWIND', 'USE', 'WHERE', 'WITH' or <EOF> (line 1, column 108 (offset: 107))\n\"MATCH (p:Person)-[r:SCORED_GOAL]->(m:Match) WITH p, COUNT(m) AS totalGoals, COLLECT(DISTINCT m) AS matches PLAYED_IN (p)-[:PLAYED_IN]->(m2:Match) WITH p, totalGoals, size(matches) AS totalMatches RETURN p.name AS playerName, totalGoals, totalMatches, CASE WHEN totalMatches = 0 THEN 0 ELSE toFloat(totalGoals) / totalMatches END AS avgGoalsPerMatch\"\n                                                                                                            ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each team that played in a match in the year 2011, calculate the total number of goals scored and the average number of minutes played by the players of that team. Return the team name, total goals scored, and average minutes played.",
    "Cypher": "MATCH (t:Team)-[:PLAYED_IN]->(m:Match)\nWHERE m.date.year = 2011\nOPTIONAL MATCH (p:Person)-[pi:PLAYED_IN]->(m)\nWHERE (p)-[:REPRESENTS]->(t)\nWITH t, m, p, pi.minuteOn as minuteOn\nOPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m)\nWITH t, m, p, minuteOn, COUNT(sg) AS goalsPerMatch\nWITH t, SUM(goalsPerMatch) AS totalGoals, AVG(toInt(minuteOn)) AS avgMinutesPlayed\nRETURN t.name AS teamName, totalGoals, avgMinutesPlayed",
    "source_dataset": "wwc",
    "source_chunk": "data_3_4_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 60,
    "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_60",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 8, column 47 (offset: 315))\n\"WITH t, SUM(goalsPerMatch) AS totalGoals, AVG(toInt(minuteOn)) AS avgMinutesPlayed\"\n                                               ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each person, calculate the total number of goals they scored and the average number of minutes they played in each match. Return the person's name, the total goals scored and the average minutes played.",
    "Cypher": "MATCH (p:Person)-[r:PLAYED_IN]->(m:Match) WITH p, m, r.minuteOn AS minuteOn OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m) WITH p, SUM(toInt(sg.minute)) AS totalGoals, AVG(toInt(minuteOn)) AS avgMinutesPlayed RETURN p.name AS PersonName, totalGoals, avgMinutesPlayed",
    "source_dataset": "wwc",
    "source_chunk": "data_3_4_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 72,
    "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_72",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 1, column 130 (offset: 129))\n\"MATCH (p:Person)-[r:PLAYED_IN]->(m:Match) WITH p, m, r.minuteOn AS minuteOn OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m) WITH p, SUM(toInt(sg.minute)) AS totalGoals, AVG(toInt(minuteOn)) AS avgMinutesPlayed RETURN p.name AS PersonName, totalGoals, avgMinutesPlayed\"\n                                                                                                                                  ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each player, calculate the total number of matches played in the 'France 2019' tournament and the average 'score' they achieved in those matches. Return the player's name, the total matches played, and the average score.",
    "Cypher": "MATCH (p:Person)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'France 2019'}) WHERE r.score IS NOT NULL WITH p, COUNT(m) AS totalMatches, AVG(r.score) AS averageScore RETURN p.name AS playerName, totalMatches, averageScore",
    "source_dataset": "wwc",
    "source_chunk": "data_3_4_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 79,
    "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_79",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each person who played in a match, find the average 'score' and 'penaltyScore' from the 'PLAYED_IN' relationship. Return the person's name, average score, and average penalty score.",
    "Cypher": "MATCH (p:Person)-[r:PLAYED_IN]->(m:Match)\nWHERE r.score IS NOT NULL AND r.penaltyScore IS NOT NULL\nWITH p, AVG(toInt(r.score)) AS avgScore, AVG(toInt(r.penaltyScore)) AS avgPenaltyScore\nRETURN p.name AS playerName, avgScore, avgPenaltyScore",
    "source_dataset": "wwc",
    "source_chunk": "data_3_4_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 86,
    "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_86",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 3, column 13 (offset: 111))\n\"WITH p, AVG(toInt(r.score)) AS avgScore, AVG(toInt(r.penaltyScore)) AS avgPenaltyScore\"\n             ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each tournament, find the team with the highest average 'score' in the 'PLAYED_IN' relationships across all matches. Return the tournament name and the name of the team with the highest average score.",
    "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[r:PLAYED_IN]-(t:Team)\nWHERE r.score IS NOT NULL\nWITH tour, t, AVG(toInt(r.score)) AS avgScore\nORDER BY tour.id, avgScore DESC\nWITH tour, COLLECT({team: t, avgScore: avgScore}) AS teamScores\nRETURN tour.name AS tournamentName, teamScores[0].team.name AS teamWithHighestAvgScore",
    "source_dataset": "wwc",
    "source_chunk": "data_3_4_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 88,
    "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_88",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 3, column 19 (offset: 120))\n\"WITH tour, t, AVG(toInt(r.score)) AS avgScore\"\n                   ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each player born before 1980, calculate the total number of goals they scored and the average score of the matches they played in. Return the player's name, total goals, and average match score.",
    "Cypher": "MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match)\nWHERE p.dob.year < 1980\nWITH p, COUNT(sg) AS totalGoals, m\nOPTIONAL MATCH (p)-[pi:PLAYED_IN]->(m)\nWITH p, totalGoals, AVG(toInt(pi.score)) AS avgMatchScore\nRETURN p.name AS playerName, totalGoals, avgMatchScore",
    "source_dataset": "wwc",
    "source_chunk": "data_3_4_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 122,
    "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_122",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 5, column 25 (offset: 167))\n\"WITH p, totalGoals, AVG(toInt(pi.score)) AS avgMatchScore\"\n                         ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each person, find the tournaments in which they played, and determine the average number of goals they scored per tournament. Return the person's name, the number of tournaments, and their average goals per tournament.",
    "Cypher": "MATCH (p:Person)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament) WHERE r.score IS NOT NULL WITH p, t, SUM(r.score) AS totalGoalsPerTournament WITH p, COLLECT(t.name) AS tournaments, AVG(totalGoalsPerTournament) AS avgGoalsPerTournament RETURN p.name AS personName, SIZE(tournaments) AS numberOfTournaments, avgGoalsPerTournament;",
    "source_dataset": "wwc",
    "source_chunk": "data_3_4_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 128,
    "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_128",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each year, find the average number of goals scored in matches played in that year. Return the year and the average number of goals scored.",
    "Cypher": "MATCH (m:Match)<-[sg:SCORED_GOAL]-(p:Person) WITH m.date.year AS matchYear, COUNT(sg) AS totalGoals RETURN matchYear, toFloat(totalGoals) / count(m) AS avgGoalsPerMatch",
    "source_dataset": "wwc",
    "source_chunk": "data_3_4_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 136,
    "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_136",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `m` not defined (line 1, column 147 (offset: 146))\n\"MATCH (m:Match)<-[sg:SCORED_GOAL]-(p:Person) WITH m.date.year AS matchYear, COUNT(sg) AS totalGoals RETURN matchYear, toFloat(totalGoals) / count(m) AS avgGoalsPerMatch\"\n                                                                                                                                                   ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For the 'Sweden 1995' tournament, what is the average number of goals scored by each team in their matches, and what is the total number of matches played by all teams?",
    "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'Sweden 1995'}) WHERE r.score IS NOT NULL WITH tour, t, COUNT(m) AS matchesPlayed, SUM(r.score) AS totalGoalsPerTeam WITH tour, t, matchesPlayed, totalGoalsPerTeam RETURN tour.name AS tournamentName, t.name AS teamName, matchesPlayed, totalGoalsPerTeam, toFloat(totalGoalsPerTeam)/matchesPlayed AS avgGoalsPerMatch, SUM(matchesPlayed) OVER (PARTITION BY tour.name) AS totalMatchesPlayed",
    "source_dataset": "wwc",
    "source_chunk": "data_3_4_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 140,
    "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_140",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'OVER': expected an expression, 'FOREACH', ',', 'AS', 'ORDER BY', 'CALL', 'CREATE', 'LOAD CSV', 'DELETE', 'DETACH', 'FINISH', 'INSERT', 'LIMIT', 'MATCH', 'MERGE', 'NODETACH', 'OFFSET', 'OPTIONAL', 'REMOVE', 'RETURN', 'SET', 'SKIP', 'UNION', 'UNWIND', 'USE', 'WITH' or <EOF> (line 1, column 418 (offset: 417))\n\"MATCH (t:Team)-[r:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'Sweden 1995'}) WHERE r.score IS NOT NULL WITH tour, t, COUNT(m) AS matchesPlayed, SUM(r.score) AS totalGoalsPerTeam WITH tour, t, matchesPlayed, totalGoalsPerTeam RETURN tour.name AS tournamentName, t.name AS teamName, matchesPlayed, totalGoalsPerTeam, toFloat(totalGoalsPerTeam)/matchesPlayed AS avgGoalsPerMatch, SUM(matchesPlayed) OVER (PARTITION BY tour.name) AS totalMatchesPlayed\"\n                                                                                                                                                                                                                                                                                                                                                                                                                                  ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each player who played in a match during 'Canada 2015', determine the total number of goals they scored and the average number of minutes they played. Return the player's name, total goals, and average minutes played, only considering players who scored at least one goal.",
    "Cypher": "MATCH (p:Person)-[pi:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(t:Tournament {name: 'Canada 2015'})\nOPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m)\nWHERE EXISTS {MATCH (p)-[:SCORED_GOAL]->(:Match)}\nWITH p, SUM(toInt(sg.minute)) AS totalMinutesPlayed, COUNT(sg) AS totalGoals\nRETURN p.name AS playerName, totalGoals, toFloat(totalMinutesPlayed)/COUNT(DISTINCT m) AS avgMinutesPlayed",
    "source_dataset": "wwc",
    "source_chunk": "data_3_4_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 149,
    "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_149",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `m` not defined (line 5, column 85 (offset: 350))\n\"RETURN p.name AS playerName, totalGoals, toFloat(totalMinutesPlayed)/COUNT(DISTINCT m) AS avgMinutesPlayed\"\n                                                                                     ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each person, find the total number of matches they played and the average penalty score they achieved across those matches. Return the person's name, total matches played, and average penalty score.",
    "Cypher": "MATCH (p:Person)-[r:PLAYED_IN]->(m:Match) WHERE r.penaltyScore IS NOT NULL WITH p, COUNT(m) AS totalMatches, AVG(toInt(r.penaltyScore)) AS avgPenaltyScore RETURN p.name AS personName, totalMatches, avgPenaltyScore",
    "source_dataset": "wwc",
    "source_chunk": "data_3_4_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 156,
    "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_156",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 1, column 114 (offset: 113))\n\"MATCH (p:Person)-[r:PLAYED_IN]->(m:Match) WHERE r.penaltyScore IS NOT NULL WITH p, COUNT(m) AS totalMatches, AVG(toInt(r.penaltyScore)) AS avgPenaltyScore RETURN p.name AS personName, totalMatches, avgPenaltyScore\"\n                                                                                                                  ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each tournament held after the year 2000, determine the average number of goals scored in each match and the total number of participating teams. Return the tournament name, average goals per match, and total team count.",
    "Cypher": "MATCH (tour:Tournament)<-[:PARTICIPATED_IN]-(t:Team)-[:PLAYED_IN]->(m:Match)<-[sg:SCORED_GOAL]-(p:Person) WHERE tour.year > 2000 WITH tour, m, COUNT(sg) AS goalsPerMatch WITH tour, AVG(goalsPerMatch) AS avgGoalsPerMatch, t RETURN tour.name AS tournamentName, avgGoalsPerMatch, COUNT(DISTINCT t) AS totalTeams",
    "source_dataset": "wwc",
    "source_chunk": "data_3_4_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 164,
    "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_164",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `t` not defined (line 1, column 222 (offset: 221))\n\"MATCH (tour:Tournament)<-[:PARTICIPATED_IN]-(t:Team)-[:PLAYED_IN]->(m:Match)<-[sg:SCORED_GOAL]-(p:Person) WHERE tour.year > 2000 WITH tour, m, COUNT(sg) AS goalsPerMatch WITH tour, AVG(goalsPerMatch) AS avgGoalsPerMatch, t RETURN tour.name AS tournamentName, avgGoalsPerMatch, COUNT(DISTINCT t) AS totalTeams\"\n                                                                                                                                                                                                                              ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each tournament, calculate the average age of players who scored at least one goal. Return the tournament name and the average age.",
    "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[sg:SCORED_GOAL]-(p:Person) WHERE p.dob IS NOT NULL WITH tour, p, m.date AS matchDate, p.dob AS playerDob WITH tour, p, duration.between(date(playerDob), date(matchDate)).years AS playerAge COLLECT (playerAge) AS playerAges WITH tour, AVG(playerAges) AS avgAge RETURN tour.name AS tournamentName, avgAge",
    "source_dataset": "wwc",
    "source_chunk": "data_3_4_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 193,
    "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_193",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'COLLECT': expected 'FOREACH', ',', 'ORDER BY', 'CALL', 'CREATE', 'LOAD CSV', 'DELETE', 'DETACH', 'FINISH', 'INSERT', 'LIMIT', 'MATCH', 'MERGE', 'NODETACH', 'OFFSET', 'OPTIONAL', 'REMOVE', 'RETURN', 'SET', 'SKIP', 'UNION', 'UNWIND', 'USE', 'WHERE', 'WITH' or <EOF> (line 1, column 244 (offset: 243))\n\"MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[sg:SCORED_GOAL]-(p:Person) WHERE p.dob IS NOT NULL WITH tour, p, m.date AS matchDate, p.dob AS playerDob WITH tour, p, duration.between(date(playerDob), date(matchDate)).years AS playerAge COLLECT (playerAge) AS playerAges WITH tour, AVG(playerAges) AS avgAge RETURN tour.name AS tournamentName, avgAge\"\n                                                                                                                                                                                                                                                    ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each player, find the total number of tournaments they participated in and the average number of goals they scored per tournament. Return the player's name, the number of tournaments, and the average goals per tournament, ordering by average goals in descending order.",
    "Cypher": "MATCH (p:Person)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament) OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m) WITH p, tour, COUNT(sg) AS goalsPerTournament, COLLECT(DISTINCT tour.id) AS tournaments  RETURN p.name AS playerName, SIZE(tournaments) AS numberOfTournaments,  CASE WHEN SIZE(tournaments) = 0 THEN 0 ELSE toFloat(SUM(goalsPerTournament)) / SIZE(tournaments) END AS avgGoalsPerTournament ORDER BY avgGoalsPerTournament DESC;",
    "source_dataset": "wwc",
    "source_chunk": "data_3_4_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 205,
    "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_205",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Aggregation column contains implicit grouping expressions. For example, in 'RETURN n.a, n.a + n.b + count(*)' the aggregation expression 'n.a + n.b + count(*)' includes the implicit grouping key 'n.b'. It may be possible to rewrite the query by extracting these grouping/aggregation expressions into a preceding WITH clause. Illegal expression(s): tournaments (line 1, column 295 (offset: 294))\n\"MATCH (p:Person)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament) OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m) WITH p, tour, COUNT(sg) AS goalsPerTournament, COLLECT(DISTINCT tour.id) AS tournaments  RETURN p.name AS playerName, SIZE(tournaments) AS numberOfTournaments,  CASE WHEN SIZE(tournaments) = 0 THEN 0 ELSE toFloat(SUM(goalsPerTournament)) / SIZE(tournaments) END AS avgGoalsPerTournament ORDER BY avgGoalsPerTournament DESC;\"\n                                                                                                                                                                                                                                                                                                       ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each player born before '1970-01-01', calculate the total number of matches they played in and the average score in those matches. Return the player's name, total matches, and average score.",
    "Cypher": "MATCH (p:Person) WHERE date(p.dob) < date('1970-01-01') MATCH (p)-[r:PLAYED_IN]->(m:Match) WITH p, COUNT(m) AS totalMatches, AVG(toInt(r.score)) AS avgScore RETURN p.name AS playerName, totalMatches, avgScore",
    "source_dataset": "wwc",
    "source_chunk": "data_3_4_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 212,
    "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_212",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 1, column 130 (offset: 129))\n\"MATCH (p:Person) WHERE date(p.dob) < date('1970-01-01') MATCH (p)-[r:PLAYED_IN]->(m:Match) WITH p, COUNT(m) AS totalMatches, AVG(toInt(r.score)) AS avgScore RETURN p.name AS playerName, totalMatches, avgScore\"\n                                                                                                                                  ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each tournament, determine the team with the highest average number of goals scored per match. Return the tournament name, the team name, and the average goals scored by that team.",
    "Cypher": "MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[:PLAYED_IN]-(t:Team) WITH tour, t, AVG(toInt(m.id)) AS avgGoalsPerMatch ORDER BY tour.id, avgGoalsPerMatch DESC WITH tour, COLLECT({team: t, avgGoals: avgGoalsPerMatch}) AS teamScores RETURN tour.name AS tournamentName, teamScores[0].team.name AS teamName, teamScores[0].avgGoals AS avgGoals",
    "source_dataset": "wwc",
    "source_chunk": "data_3_4_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 213,
    "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_213",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 1, column 94 (offset: 93))\n\"MATCH (tour:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[:PLAYED_IN]-(t:Team) WITH tour, t, AVG(toInt(m.id)) AS avgGoalsPerMatch ORDER BY tour.id, avgGoalsPerMatch DESC WITH tour, COLLECT({team: t, avgGoals: avgGoalsPerMatch}) AS teamScores RETURN tour.name AS tournamentName, teamScores[0].team.name AS teamName, teamScores[0].avgGoals AS avgGoals\"\n                                                                                              ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each team that participated in the 'France 2019' tournament, find the average number of goals scored by players from that team per match. Return the team name and the average goals per match.",
    "Cypher": "MATCH (t:Team)-[:PARTICIPATED_IN]->(tour:Tournament {name: 'France 2019'}) \nOPTIONAL MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match)<-[:PLAYED_IN]-(t)\nWITH t, m, COUNT(sg) AS goals\nWITH t, COUNT(DISTINCT m) AS totalMatches, SUM(goals) AS totalGoals\nRETURN t.name AS teamName, CASE WHEN totalMatches > 0 THEN toFloat(SUM(totalGoals)) / totalMatches ELSE 0 END AS avgGoalsPerMatch",
    "source_dataset": "wwc",
    "source_chunk": "data_3_4_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 218,
    "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_218",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Aggregation column contains implicit grouping expressions. For example, in 'RETURN n.a, n.a + n.b + count(*)' the aggregation expression 'n.a + n.b + count(*)' includes the implicit grouping key 'n.b'. It may be possible to rewrite the query by extracting these grouping/aggregation expressions into a preceding WITH clause. Illegal expression(s): totalMatches (line 5, column 38 (offset: 283))\n\"RETURN t.name AS teamName, CASE WHEN totalMatches > 0 THEN toFloat(SUM(totalGoals)) / totalMatches ELSE 0 END AS avgGoalsPerMatch\"\n                                      ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each team, determine the total number of matches they played and the average 'score' in the PLAYED_IN relationship across all matches. Return the team's name, total matches played, and the average score.",
    "Cypher": "MATCH (t:Team)-[r:PLAYED_IN]->(m:Match) WITH t, COUNT(m) AS totalMatches, AVG(toInt(r.score)) AS avgScore RETURN t.name AS teamName, totalMatches, avgScore",
    "source_dataset": "wwc",
    "source_chunk": "data_3_4_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 225,
    "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_225",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 1, column 79 (offset: 78))\n\"MATCH (t:Team)-[r:PLAYED_IN]->(m:Match) WITH t, COUNT(m) AS totalMatches, AVG(toInt(r.score)) AS avgScore RETURN t.name AS teamName, totalMatches, avgScore\"\n                                                                               ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each person, find the total number of matches they played and the average 'penaltyScore' in the PLAYED_IN relationship across all matches. Return the person's name, total matches played, and the average penalty score.",
    "Cypher": "MATCH (p:Person)-[r:PLAYED_IN]->(m:Match) WITH p, COUNT(m) AS totalMatches, AVG(toInt(r.penaltyScore)) AS avgPenaltyScore RETURN p.name AS personName, totalMatches, avgPenaltyScore",
    "source_dataset": "wwc",
    "source_chunk": "data_3_4_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 226,
    "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_226",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 1, column 81 (offset: 80))\n\"MATCH (p:Person)-[r:PLAYED_IN]->(m:Match) WITH p, COUNT(m) AS totalMatches, AVG(toInt(r.penaltyScore)) AS avgPenaltyScore RETURN p.name AS personName, totalMatches, avgPenaltyScore\"\n                                                                                 ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each squad, calculate the average age of players in the squad and the total number of goals scored by players in the squad across all matches. Return the squad ID, average player age, and total goals.",
    "Cypher": "MATCH (s:Squad)<-[:IN_SQUAD]-(p:Person)\nOPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m:Match)\nWHERE p.dob IS NOT NULL\nWITH s, p, sg\nWITH s, collect(DISTINCT p.dob) as player_dobs, COUNT(sg) AS totalGoals\nWITH s, REDUCE(s = 0, dob IN player_dobs | s + (date().year - dob.year)) * 1.0 / size(player_dobs) AS avgAge, totalGoals\nRETURN s.id AS squadId, avgAge, totalGoals",
    "source_dataset": "wwc",
    "source_chunk": "data_3_4_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 234,
    "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_234",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Runtime Error: {code: Neo.ClientError.Statement.ArithmeticError} {message: / by zero}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For the 'Sweden 1995' tournament, what is the average number of goals scored per team and the total number of matches played?",
    "Cypher": "MATCH (tour:Tournament {name: 'Sweden 1995'})<-[:IN_TOURNAMENT]-(m:Match)<-[r:PLAYED_IN]-(t:Team) WHERE r.score IS NOT NULL WITH tour, t, COUNT(m) AS matchesPlayed, SUM(r.score) AS totalGoalsPerTeam WITH tour, AVG(totalGoalsPerTeam) AS avgGoalsPerTeam, COUNT(DISTINCT m) AS totalMatches RETURN tour.name AS tournamentName, avgGoalsPerTeam, totalMatches",
    "source_dataset": "wwc",
    "source_chunk": "data_3_4_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 238,
    "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_238",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `m` not defined (line 1, column 269 (offset: 268))\n\"MATCH (tour:Tournament {name: 'Sweden 1995'})<-[:IN_TOURNAMENT]-(m:Match)<-[r:PLAYED_IN]-(t:Team) WHERE r.score IS NOT NULL WITH tour, t, COUNT(m) AS matchesPlayed, SUM(r.score) AS totalGoalsPerTeam WITH tour, AVG(totalGoalsPerTeam) AS avgGoalsPerTeam, COUNT(DISTINCT m) AS totalMatches RETURN tour.name AS tournamentName, avgGoalsPerTeam, totalMatches\"\n                                                                                                                                                                                                                                                                             ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each person who played in a match, find the total number of goals they scored and the average number of minutes they played per match. Return the person's name, total goals scored, and average minutes played.",
    "Cypher": "MATCH (p:Person)-[r:PLAYED_IN]->(m:Match) WHERE r.minuteOn IS NOT NULL WITH p, COUNT(m) AS matchCount, SUM(toInt(r.minuteOn)) AS totalMinutesPlayed OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m2:Match) WITH p, matchCount, totalMinutesPlayed, COUNT(sg) AS totalGoalsScored RETURN p.name AS playerName, totalGoalsScored, CASE WHEN matchCount = 0 THEN 0 ELSE toFloat(totalMinutesPlayed) / matchCount END AS avgMinutesPlayed;",
    "source_dataset": "wwc",
    "source_chunk": "data_3_4_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 246,
    "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_246",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'toInt' (line 1, column 108 (offset: 107))\n\"MATCH (p:Person)-[r:PLAYED_IN]->(m:Match) WHERE r.minuteOn IS NOT NULL WITH p, COUNT(m) AS matchCount, SUM(toInt(r.minuteOn)) AS totalMinutesPlayed OPTIONAL MATCH (p)-[sg:SCORED_GOAL]->(m2:Match) WITH p, matchCount, totalMinutesPlayed, COUNT(sg) AS totalGoalsScored RETURN p.name AS playerName, totalGoalsScored, CASE WHEN matchCount = 0 THEN 0 ELSE toFloat(totalMinutesPlayed) / matchCount END AS avgMinutesPlayed;\"\n                                                                                                            ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For matches played in the 'USA 1999' tournament, find the average 'score' value for each 'stage' of the tournament. Return the stage and the average score.",
    "Cypher": "MATCH (m:Match)-[:IN_TOURNAMENT]->(t:Tournament {name: 'USA 1999'})-[r:PLAYED_IN]-(team:Team) WHERE r.score IS NOT NULL WITH m.stage AS stage, AVG(r.score) AS avgScore RETURN stage, avgScore",
    "source_dataset": "wwc",
    "source_chunk": "data_3_4_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 249,
    "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_249",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each stage of the matches, what is the average score in 'PLAYED_IN' relationships and the total number of matches in that stage? Return the stage, average score, and total matches.",
    "Cypher": "MATCH (m:Match)-[r:PLAYED_IN]->(t:Team)\nWHERE r.score IS NOT NULL\nWITH m.stage AS stage, r.score AS score\nWITH stage, AVG(score) AS averageScore, COUNT(*) AS totalMatches\nRETURN stage, averageScore, totalMatches",
    "source_dataset": "wwc",
    "source_chunk": "data_3_4_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 255,
    "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_255",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each person who played in a match during the 'Germany 2011' tournament, compute the total number of goals they scored and the average time (minute) at which they scored each goal. Return the person's name, total goals scored, and average goal scoring minute.",
    "Cypher": "MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'Germany 2011'}) WHERE sg.minute IS NOT NULL WITH p, toInteger(replace(sg.minute, '''', '')) AS goalMinute, m OPTIONAL MATCH (p)-[sg2:SCORED_GOAL]->(m2:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'Germany 2011'}) WITH p, AVG(goalMinute) AS avgGoalMinute, COUNT(DISTINCT m2) AS totalGoals RETURN p.name AS playerName, totalGoals, avgGoalMinute",
    "source_dataset": "wwc",
    "source_chunk": "data_3_4_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 267,
    "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_267",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input '''': expected an expression, ')' or ',' (line 1, column 172 (offset: 171))\n\"MATCH (p:Person)-[sg:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'Germany 2011'}) WHERE sg.minute IS NOT NULL WITH p, toInteger(replace(sg.minute, '''', '')) AS goalMinute, m OPTIONAL MATCH (p)-[sg2:SCORED_GOAL]->(m2:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'Germany 2011'}) WITH p, AVG(goalMinute) AS avgGoalMinute, COUNT(DISTINCT m2) AS totalGoals RETURN p.name AS playerName, totalGoals, avgGoalMinute\"\n                                                                                                                                                                            ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each squad, calculate the total number of distinct persons who are both coaches and players in that squad. Return the squad ID and the count of such persons.",
    "Cypher": "MATCH (p:Person)-[:IN_SQUAD]->(s:Squad) WITH s, COLLECT(p) AS players MATCH (c:Person)-[:COACH_FOR]->(s) WITH s, players, COLLECT(c) AS coaches RETURN s.id AS squadId, SIZE(INTERSECTION(players, coaches)) AS bothCount",
    "source_dataset": "wwc",
    "source_chunk": "data_3_4_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 269,
    "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_269",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Unknown function 'INTERSECTION' (line 1, column 174 (offset: 173))\n\"MATCH (p:Person)-[:IN_SQUAD]->(s:Squad) WITH s, COLLECT(p) AS players MATCH (c:Person)-[:COACH_FOR]->(s) WITH s, players, COLLECT(c) AS coaches RETURN s.id AS squadId, SIZE(INTERSECTION(players, coaches)) AS bothCount\"\n                                                                                                                                                                              ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each tournament, determine the average age of players who scored at least one goal. Return the tournament name and the average age of the goal-scoring players.",
    "Cypher": "MATCH (p:Person)-[:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament) WHERE p.dob IS NOT NULL WITH tour, p, tour.year - p.dob.year AS playerAge WITH tour, COLLECT(playerAge) AS playerAges RETURN tour.name AS tournamentName, avg(playerAges) AS averageAgeOfGoalScorers",
    "source_dataset": "wwc",
    "source_chunk": "data_3_4_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 270,
    "unique_id": "wwc_data_3_4_2_6_Complex_Aggregation_270",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Type mismatch: expected Float, Integer or Duration but was List<Float>, List<Integer>, List<Duration>, List<Date>, List<Time>, List<LocalTime>, List<LocalDateTime> or List<DateTime> (line 1, column 238 (offset: 237))\n\"MATCH (p:Person)-[:SCORED_GOAL]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament) WHERE p.dob IS NOT NULL WITH tour, p, tour.year - p.dob.year AS playerAge WITH tour, COLLECT(playerAge) AS playerAges RETURN tour.name AS tournamentName, avg(playerAges) AS averageAgeOfGoalScorers\"\n                                                                                                                                                                                                                                              ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  }
]