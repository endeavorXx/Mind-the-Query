[
  {
    "NL Question": "For each tournament, find the team that played the most matches. Return the tournament name, team name, and the number of matches played by that team in that tournament.",
    "Cypher": "MATCH (team:Team)-[:PARTICIPATED_IN]->(tournament:Tournament) WITH tournament, team MATCH (team)-[:PLAYED_IN]->(match:Match)-[:IN_TOURNAMENT]->(tournament) WITH tournament, team, count(match) AS matchCount ORDER BY matchCount DESC WITH tournament, COLLECT({team: team, matchCount: matchCount}) AS teamMatches UNWIND teamMatches[0..1] AS topTeam MATCH (topTeam)-[:team]->(team2:Team) RETURN tournament.name AS tournamentName, topTeam.team.name AS teamName, topTeam.matchCount AS matchCount",
    "source_dataset": "wwc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Retrieval.json",
    "original_index": 261,
    "unique_id": "wwc_data_3_1_2_6_Complex_Retrieval_261",
    "pipeline_stage": "FAILED_SCHEMA",
    "failure_reason": "❌ Relationship type `team` is not in the schema.",
    "schema_validation": "❌ Relationship type `team` is not in the schema."
  },
  {
    "NL Question": "For each tournament, identify the team that scored the most goals across all matches in that tournament. Return the tournament name, team name, and the total goals scored by that team.",
    "Cypher": "MATCH (t:Tournament)<-[:IN_TOURNAMENT]-(m:Match)<-[:PLAYED_IN]-(team:Team)\nWITH t.name AS tournamentName, team.name AS teamName, SUM(team.score) AS totalScore\nORDER BY totalScore DESC\nWITH tournamentName, COLLECT({team: teamName, score: totalScore}) AS teamScores\nUNWIND teamScores AS ts\nWITH tournamentName, ts.team AS team, ts.score AS score, head(teamScores).score AS maxScore\nWHERE score = maxScore\nRETURN tournamentName, team, score",
    "source_dataset": "wwc",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Retrieval.json",
    "original_index": 274,
    "unique_id": "wwc_data_3_1_2_6_Complex_Retrieval_274",
    "pipeline_stage": "FAILED_SCHEMA",
    "failure_reason": "❌ Attribute `score` does not exist in node `Team`.",
    "schema_validation": "❌ Attribute `score` does not exist in node `Team`."
  },
  {
    "NL Question": "For each team that played in matches during the 'Canada 2015' tournament, find the average score of the 'PLAYED_IN' relationship across all their matches in that tournament. Return the team's name and the average score.",
    "Cypher": "MATCH (t:Team)-[:PLAYED_IN]->(m:Match)-[:IN_TOURNAMENT]->(tour:Tournament {name: 'Canada 2015'}) WITH t, AVG(t.score) AS avgScore RETURN t.name AS teamName, avgScore",
    "source_dataset": "wwc",
    "source_chunk": "data_3_3_2_6",
    "original_file": "Complex_Retrieval.json",
    "original_index": 16,
    "unique_id": "wwc_data_3_3_2_6_Complex_Retrieval_16",
    "pipeline_stage": "FAILED_SCHEMA",
    "failure_reason": "❌ Attribute `score` does not exist in node `Team`.",
    "schema_validation": "❌ Attribute `score` does not exist in node `Team`."
  }
]