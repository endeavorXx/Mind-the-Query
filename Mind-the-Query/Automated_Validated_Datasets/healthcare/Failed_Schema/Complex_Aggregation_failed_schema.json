[
  {
    "NL Question": "What are the top 3 most frequent indications for drugs prescribed in therapies associated with cases reported by 'Physician', along with the count of cases for each indication?",
    "Cypher": "MATCH (c:Case)-[:REPORTED_BY]->(rs:ReportSource {name: 'Physician'}), (c)-[:RECEIVED]->(t:Therapy)-[:PRESCRIBED]->(d:Drug) WITH c, t MATCH (t)-[p:PRESCRIBED]->(d) WITH p.indication AS indication, COUNT(c) AS caseCount ORDER BY caseCount DESC LIMIT 3 RETURN indication, caseCount",
    "source_dataset": "healthcare",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 143,
    "unique_id": "healthcare_data_3_1_2_6_Complex_Aggregation_143",
    "pipeline_stage": "FAILED_SCHEMA",
    "failure_reason": "❌ Attribute `indication` not in relationship `PRESCRIBED`.",
    "schema_validation": "❌ Attribute `indication` not in relationship `PRESCRIBED`."
  },
  {
    "NL Question": "What are the top 3 most frequent 'route' values used for drugs prescribed in therapies associated with cases falling under the 'Adolescent' age group?",
    "Cypher": "MATCH (c:Case)-[:FALLS_UNDER]->(ag:AgeGroup {ageGroup: 'Adolescent'}), (c)-[:RECEIVED]->(t:Therapy)-[:PRESCRIBED]->(d:Drug) WITH c, t MATCH (c)-[:RECEIVED]->(t)-[rel:PRESCRIBED]->(d) RETURN rel.route AS Route, COUNT(rel.route) AS Frequency ORDER BY Frequency DESC LIMIT 3",
    "source_dataset": "healthcare",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 178,
    "unique_id": "healthcare_data_3_1_2_6_Complex_Aggregation_178",
    "pipeline_stage": "FAILED_SCHEMA",
    "failure_reason": "❌ Attribute `route` not in relationship `PRESCRIBED`.\n❌ Attribute `route` not in relationship `PRESCRIBED`.",
    "schema_validation": "❌ Attribute `route` not in relationship `PRESCRIBED`.\n❌ Attribute `route` not in relationship `PRESCRIBED`."
  },
  {
    "NL Question": "Considering cases registered by 'JAZZ', what is the average age of patients who were prescribed 'AUGMENTIN', grouped by the route of administration for that drug, and how many cases are there for each route?",
    "Cypher": "MATCH (m:Manufacturer {manufacturerName: 'JAZZ'})-[:REGISTERED]->(c:Case)-[:RECEIVED]->(t:Therapy)-[p:PRESCRIBED]->(d:Drug {name: 'AUGMENTIN'}) RETURN p.route AS route, AVG(c.age) AS averageAge, COUNT(c) AS caseCount",
    "source_dataset": "healthcare",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 347,
    "unique_id": "healthcare_data_3_1_2_6_Complex_Aggregation_347",
    "pipeline_stage": "FAILED_SCHEMA",
    "failure_reason": "❌ Attribute `route` not in relationship `PRESCRIBED`.",
    "schema_validation": "❌ Attribute `route` not in relationship `PRESCRIBED`."
  },
  {
    "NL Question": "Among cases where the reporter's occupation is 'Hospital', what are the top 3 most frequent routes of administration for drugs prescribed in therapies associated with these cases, and how many times does each route appear?",
    "Cypher": "MATCH (c:Case)-[:REPORTED_BY]->(rs:ReportSource {name: 'Hospital'}), (c)-[:RECEIVED]->(t:Therapy)-[:PRESCRIBED]->(d:Drug) WITH c, t MATCH (t)-[p:PRESCRIBED]->(d) WITH p.route AS route, COUNT(*) AS routeCount ORDER BY routeCount DESC LIMIT 3 RETURN route, routeCount",
    "source_dataset": "healthcare",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 431,
    "unique_id": "healthcare_data_3_1_2_6_Complex_Aggregation_431",
    "pipeline_stage": "FAILED_SCHEMA",
    "failure_reason": "❌ Attribute `route` not in relationship `PRESCRIBED`.",
    "schema_validation": "❌ Attribute `route` not in relationship `PRESCRIBED`."
  },
  {
    "NL Question": "Find the number of cases where the drug 'POTASSIUM' was prescribed, grouped by the start year of the prescription.",
    "Cypher": "MATCH (t:Therapy)-[:PRESCRIBED]->(d:Drug {name: 'POTASSIUM'}) WITH t MATCH (c:Case)-[:RECEIVED]->(t) RETURN t.startYear AS startYear, COUNT(c) AS caseCount",
    "source_dataset": "healthcare",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 543,
    "unique_id": "healthcare_data_3_1_2_6_Complex_Aggregation_543",
    "pipeline_stage": "FAILED_SCHEMA",
    "failure_reason": "❌ Attribute `startYear` does not exist in node `Therapy`.",
    "schema_validation": "❌ Attribute `startYear` does not exist in node `Therapy`."
  },
  {
    "NL Question": "What are the top 3 most frequent routes of administration for drugs prescribed in therapies associated with cases reported by 'Consumer'?",
    "Cypher": "MATCH (c:Case)-[:REPORTED_BY]->(r:ReportSource {name: 'Consumer'}), (c)-[:RECEIVED]->(t:Therapy)-[:PRESCRIBED]->(d:Drug) WITH c, t, d MATCH (t)-[p:PRESCRIBED]->(d) RETURN p.route AS route, COUNT(*) AS frequency ORDER BY frequency DESC LIMIT 3",
    "source_dataset": "healthcare",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 626,
    "unique_id": "healthcare_data_3_1_2_6_Complex_Aggregation_626",
    "pipeline_stage": "FAILED_SCHEMA",
    "failure_reason": "❌ Attribute `route` not in relationship `PRESCRIBED`.",
    "schema_validation": "❌ Attribute `route` not in relationship `PRESCRIBED`."
  },
  {
    "NL Question": "How many cases reported by 'Health Professional' involved therapies where 'ATEZOLIZUMAB' was prescribed, grouped by the start year of the therapy?",
    "Cypher": "MATCH (c:Case)-[:REPORTED_BY]->(r:ReportSource {name: 'Health Professional'}), (c)-[:RECEIVED]->(t:Therapy)-[:PRESCRIBED]->(d:Drug {name: 'ATEZOLIZUMAB'}) RETURN t.startYear AS startYear, COUNT(c) AS totalCases",
    "source_dataset": "healthcare",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 655,
    "unique_id": "healthcare_data_3_1_2_6_Complex_Aggregation_655",
    "pipeline_stage": "FAILED_SCHEMA",
    "failure_reason": "❌ Attribute `startYear` does not exist in node `Therapy`.",
    "schema_validation": "❌ Attribute `startYear` does not exist in node `Therapy`."
  },
  {
    "NL Question": "What are the top 3 most frequent indications for drugs prescribed in therapies, along with the count of prescriptions for each indication?",
    "Cypher": "MATCH (t:Therapy)-[p:PRESCRIBED]->(d:Drug) WITH p.indication AS indication, COUNT(*) AS prescriptionCount ORDER BY prescriptionCount DESC LIMIT 3 RETURN indication, prescriptionCount",
    "source_dataset": "healthcare",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 730,
    "unique_id": "healthcare_data_3_1_2_6_Complex_Aggregation_730",
    "pipeline_stage": "FAILED_SCHEMA",
    "failure_reason": "❌ Attribute `indication` not in relationship `PRESCRIBED`.",
    "schema_validation": "❌ Attribute `indication` not in relationship `PRESCRIBED`."
  },
  {
    "NL Question": "What are the top 3 most frequent indications for drugs prescribed in therapies, along with the count of cases for each indication?",
    "Cypher": "MATCH (c:Case)-[:RECEIVED]->(t:Therapy)-[p:PRESCRIBED]->(d:Drug) WITH p.indication AS indication, COUNT(c) AS caseCount ORDER BY caseCount DESC LIMIT 3 RETURN indication, caseCount",
    "source_dataset": "healthcare",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 956,
    "unique_id": "healthcare_data_3_1_2_6_Complex_Aggregation_956",
    "pipeline_stage": "FAILED_SCHEMA",
    "failure_reason": "❌ Attribute `indication` not in relationship `PRESCRIBED`.",
    "schema_validation": "❌ Attribute `indication` not in relationship `PRESCRIBED`."
  },
  {
    "NL Question": "Among cases where the reporter occupation is 'Consumer', what are the top 3 most frequent routes of administration for primary suspect drugs?",
    "Cypher": "MATCH (c:Case)-[:REPORTED_BY]->(rs:ReportSource), (c)-[rel:IS_PRIMARY_SUSPECT]->(d:Drug) WHERE rs.reporterOccupation = 'Consumer' RETURN rel.route AS route, COUNT(*) AS frequency ORDER BY frequency DESC LIMIT 3",
    "source_dataset": "healthcare",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 977,
    "unique_id": "healthcare_data_3_1_2_6_Complex_Aggregation_977",
    "pipeline_stage": "FAILED_SCHEMA",
    "failure_reason": "❌ Attribute `reporterOccupation` does not exist in node `ReportSource`.",
    "schema_validation": "❌ Attribute `reporterOccupation` does not exist in node `ReportSource`."
  }
]