[
  {
    "NL Question": "What is the average rank of legislators on committees, grouped by their party, and what is the total number of committees?",
    "Cypher": "MATCH (l:Legislator)-[:SERVES_ON]->(c:Committee) , (l)-[:IS_MEMBER_OF]->(p:Party) WITH p.name AS partyName, l, AVG(l.rank) AS avgRank MATCH (committee:Committee) WITH partyName AS partyName, avgRank AS avgRank, count(committee) as totalCommittees RETURN partyName, avgRank, totalCommittees",
    "source_dataset": "legis_graph",
    "source_chunk": "data_2_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 130,
    "unique_id": "legis_graph_data_2_1_2_6_Complex_Aggregation_130",
    "pipeline_stage": "FAILED_SCHEMA",
    "failure_reason": "❌ Attribute `rank` does not exist in node `Legislator`.",
    "schema_validation": "❌ Attribute `rank` does not exist in node `Legislator`."
  },
  {
    "NL Question": "Considering only bills referred to committees of type 'senate', what is the average number of legislators who voted 'Yea' on each bill?",
    "Cypher": "MATCH (c:Committee)<-[:REFERRED_TO]-(b:Bill)<-[:VOTED_ON]-(l:Legislator) WHERE c.type = 'senate' AND l.vote = 'Yea' WITH b, COUNT(l) AS legislatorCount RETURN AVG(legislatorCount) AS AverageLegislators",
    "source_dataset": "legis_graph",
    "source_chunk": "data_2_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 165,
    "unique_id": "legis_graph_data_2_1_2_6_Complex_Aggregation_165",
    "pipeline_stage": "FAILED_SCHEMA",
    "failure_reason": "❌ Attribute `vote` does not exist in node `Legislator`.",
    "schema_validation": "❌ Attribute `vote` does not exist in node `Legislator`."
  },
  {
    "NL Question": "What is the average number of committees that legislators from each party serve on, and what is the average rank they hold on those committees?",
    "Cypher": "MATCH (l:Legislator)-[:SERVES_ON]->(c:Committee) WITH l.party AS party, l, COUNT(c) AS committeeCount, AVG(l.SERVES_ON.rank) AS averageRank RETURN party, AVG(committeeCount) AS averageCommittees, AVG(averageRank) AS overallAverageRank",
    "source_dataset": "legis_graph",
    "source_chunk": "data_2_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 16,
    "unique_id": "legis_graph_data_2_2_2_6_Complex_Aggregation_16",
    "pipeline_stage": "FAILED_SCHEMA",
    "failure_reason": "❌ Attribute `SERVES_ON` does not exist in node `Legislator`.",
    "schema_validation": "❌ Attribute `SERVES_ON` does not exist in node `Legislator`."
  }
]