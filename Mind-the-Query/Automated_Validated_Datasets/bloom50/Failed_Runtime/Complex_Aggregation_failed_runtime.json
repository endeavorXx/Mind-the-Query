[
  {
    "NL Question": "For each AccountHolder, what is the average balance of their BankAccounts and CreditCards combined, and how many total accounts (BankAccounts and CreditCards) do they possess?",
    "Cypher": "MATCH (ah:AccountHolder) OPTIONAL MATCH (ah)-[:HAS_BANKACCOUNT]->(ba:BankAccount) OPTIONAL MATCH (ah)-[:HAS_CREDITCARD]->(cc:CreditCard) WITH ah, COLLECT(ba.balance) AS bankBalances, COLLECT(cc.balance) AS creditCardBalances, SIZE(COLLECT(ba)) + SIZE(COLLECT(cc)) AS totalAccounts WITH ah, bankBalances + creditCardBalances AS allBalances, totalAccounts RETURN ah.fullName, AVG(toFloat(x) IN allBalances WHERE x IS NOT NULL) AS averageBalance, totalAccounts",
    "source_dataset": "bloom50",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 36,
    "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_36",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'WHERE': expected an expression, ')' or ',' (line 1, column 405 (offset: 404))\n\"MATCH (ah:AccountHolder) OPTIONAL MATCH (ah)-[:HAS_BANKACCOUNT]->(ba:BankAccount) OPTIONAL MATCH (ah)-[:HAS_CREDITCARD]->(cc:CreditCard) WITH ah, COLLECT(ba.balance) AS bankBalances, COLLECT(cc.balance) AS creditCardBalances, SIZE(COLLECT(ba)) + SIZE(COLLECT(cc)) AS totalAccounts WITH ah, bankBalances + creditCardBalances AS allBalances, totalAccounts RETURN ah.fullName, AVG(toFloat(x) IN allBalances WHERE x IS NOT NULL) AS averageBalance, totalAccounts\"\n                                                                                                                                                                                                                                                                                                                                                                                                                     ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "What is the average purchase amount for purchases made with BankCards, grouped by the provider of the PhoneNumber associated with the MoneyTransfer that used the BankCard?",
    "Cypher": "MATCH (p:Purchase)-[:WITH_CARD]->(bc:BankCard)<-[:SEND]-(mt:MoneyTransfer)-[:WITH]->(pn:PhoneNumber) WITH pn.provider AS provider, p.amount AS amount RETURN provider, AVG(amount) AS averagePurchaseAmount",
    "source_dataset": "bloom50",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 37,
    "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_37",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each state, what is the average balance of BankAccounts held by AccountHolders who have an address in that state, and how many such AccountHolders are there?",
    "Cypher": "MATCH (ah:AccountHolder)-[:HAS_ADDRESS]->(a:Address) WHERE a.state IS NOT NULL WITH a.state AS state, ah OPTIONAL MATCH (ah)-[:HAS_BANKACCOUNT]->(ba:BankAccount) WITH state, ah, COLLECT(ba.balance) AS balances WHERE state IS NOT NULL RETURN state, AVG(toFloat(x) IN balances WHERE x IS NOT NULL) AS averageBalance, COUNT(DISTINCT ah) AS accountHolderCount",
    "source_dataset": "bloom50",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 38,
    "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_38",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'WHERE': expected an expression, ')' or ',' (line 1, column 276 (offset: 275))\n\"MATCH (ah:AccountHolder)-[:HAS_ADDRESS]->(a:Address) WHERE a.state IS NOT NULL WITH a.state AS state, ah OPTIONAL MATCH (ah)-[:HAS_BANKACCOUNT]->(ba:BankAccount) WITH state, ah, COLLECT(ba.balance) AS balances WHERE state IS NOT NULL RETURN state, AVG(toFloat(x) IN balances WHERE x IS NOT NULL) AS averageBalance, COUNT(DISTINCT ah) AS accountHolderCount\"\n                                                                                                                                                                                                                                                                                    ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each state, what is the average balance of unsecured loans held by flagged account holders residing in that state?",
    "Cypher": "MATCH (f:Flagged)-[:HAS_ADDRESS]->(a:Address)-[:HAS_UNSECUREDLOAN]->(ul:UnsecuredLoan) WITH a.state AS State, ul.balance AS LoanBalance RETURN State, avg(LoanBalance) AS AverageLoanBalance",
    "source_dataset": "bloom50",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 80,
    "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_80",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each state, what is the average balance of credit cards held by account holders who have an address in that state?",
    "Cypher": "MATCH (ah:AccountHolder)-[:HAS_ADDRESS]->(a:Address)-[:HAS_ADDRESS]-(s:State) WITH ah, s MATCH (ah)-[:HAS_CREDITCARD]->(cc:CreditCard) RETURN s.name, avg(cc.balance) AS AverageCreditCardBalance",
    "source_dataset": "bloom50",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 95,
    "unique_id": "bloom50_data_3_2_2_6_Complex_Aggregation_95",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "What is the average balance of CreditCards held by AccountHolders, grouped by the state where the AccountHolder's address is located?",
    "Cypher": "MATCH (ah:AccountHolder)-[:HAS_ADDRESS]->(ad:Address)-[:HAS_CREDITCARD]->(cc:CreditCard)\nWITH ad.state AS state, COLLECT(cc.balance) AS balances\nRETURN state, avg(toFloat(balances[0])) AS averageBalance",
    "source_dataset": "bloom50",
    "source_chunk": "data_3_3_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 23,
    "unique_id": "bloom50_data_3_3_2_6_Complex_Aggregation_23",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "What is the average amount of purchases made by Logins at each Shop, grouped by the business type of the shop?",
    "Cypher": "MATCH (sh:Shop)<-[:FOR_SHOP]-(l:Login)-[:WITH_LOGIN]->(p:Purchase)\nWITH sh.business AS businessType, COLLECT(p.amount) AS amounts\nRETURN businessType, avg(toFloat(amounts[0])) AS averagePurchaseAmount",
    "source_dataset": "bloom50",
    "source_chunk": "data_3_3_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 25,
    "unique_id": "bloom50_data_3_3_2_6_Complex_Aggregation_25",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "What is the average amount of money transferred per day and the total number of money transfers that involved phone numbers with 'Loud and Clear' as the provider?",
    "Cypher": "MATCH (mt:MoneyTransfer)-[r:WITH]->(pn:PhoneNumber) WHERE pn.provider = 'Loud and Clear' WITH mt.transactionDate AS transactionDate, mt.amount AS amount, pn.phone AS phone, r.lastUsed AS lastUsed RETURN transactionDate, AVG(amount) AS averageAmount, COUNT(mt) AS totalTransfers",
    "source_dataset": "bloom50",
    "source_chunk": "data_3_3_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 70,
    "unique_id": "bloom50_data_3_3_2_6_Complex_Aggregation_70",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `mt` not defined (line 1, column 257 (offset: 256))\n\"MATCH (mt:MoneyTransfer)-[r:WITH]->(pn:PhoneNumber) WHERE pn.provider = 'Loud and Clear' WITH mt.transactionDate AS transactionDate, mt.amount AS amount, pn.phone AS phone, r.lastUsed AS lastUsed RETURN transactionDate, AVG(amount) AS averageAmount, COUNT(mt) AS totalTransfers\"\n                                                                                                                                                                                                                                                                 ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each financial institute, what is the average balance of the bank accounts they manage and the total number of bank accounts associated with them?",
    "Cypher": "MATCH (ba:BankAccount)-[:FROM]->(fi:FinancialInstitute) WITH fi.name AS instituteName, ba.balance AS balance RETURN instituteName, AVG(balance) AS averageBalance, COUNT(ba) AS totalAccounts",
    "source_dataset": "bloom50",
    "source_chunk": "data_3_3_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 71,
    "unique_id": "bloom50_data_3_3_2_6_Complex_Aggregation_71",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `ba` not defined (line 1, column 170 (offset: 169))\n\"MATCH (ba:BankAccount)-[:FROM]->(fi:FinancialInstitute) WITH fi.name AS instituteName, ba.balance AS balance RETURN instituteName, AVG(balance) AS averageBalance, COUNT(ba) AS totalAccounts\"\n                                                                                                                                                                          ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "What is the average purchase amount and the total number of purchases made using bank cards with a balance greater than $3000?",
    "Cypher": "MATCH (p:Purchase)-[:WITH_CARD]->(bc:BankCard) WHERE bc.balance > 3000 WITH p.amount AS purchaseAmount, bc.accountNumber AS accountNumber RETURN AVG(purchaseAmount) AS averagePurchaseAmount, COUNT(p) AS totalPurchases",
    "source_dataset": "bloom50",
    "source_chunk": "data_3_3_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 72,
    "unique_id": "bloom50_data_3_3_2_6_Complex_Aggregation_72",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `p` not defined (line 1, column 198 (offset: 197))\n\"MATCH (p:Purchase)-[:WITH_CARD]->(bc:BankCard) WHERE bc.balance > 3000 WITH p.amount AS purchaseAmount, bc.accountNumber AS accountNumber RETURN AVG(purchaseAmount) AS averagePurchaseAmount, COUNT(p) AS totalPurchases\"\n                                                                                                                                                                                                      ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "What is the average balance of CreditCards held by AccountHolders, grouped by the state of the AccountHolder's Address, and what is the total number of CreditCards in each state?",
    "Cypher": "MATCH (ah:AccountHolder)-[:HAS_ADDRESS]->(a:Address)-[:HAS_CREDITCARD]->(cc:CreditCard) WITH a.state AS state, cc.balance AS balance MATCH (ah:AccountHolder)-[:HAS_ADDRESS]->(a:Address)-[:HAS_CREDITCARD]->(cc:CreditCard) WHERE a.state = state WITH state, avg(balance) AS averageBalance, count(cc) AS creditCardCount RETURN state, averageBalance, creditCardCount",
    "source_dataset": "bloom50",
    "source_chunk": "data_3_3_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 79,
    "unique_id": "bloom50_data_3_3_2_6_Complex_Aggregation_79",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "What is the average balance of bank accounts held by account holders who have an address in 'Arizona'?",
    "Cypher": "MATCH (ah:AccountHolder)-[:HAS_ADDRESS]->(addr:Address {state: 'Arizona'})-[:HAS_BANKACCOUNT]->(ba:BankAccount) RETURN avg(ba.balance) AS averageBalance",
    "source_dataset": "bloom50",
    "source_chunk": "data_3_3_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 107,
    "unique_id": "bloom50_data_3_3_2_6_Complex_Aggregation_107",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Content: Results only contain null or zero values.",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "Results returned successfully.",
    "neo4j_result_passed": 1,
    "content_validation": "Results only contain null or zero values.",
    "content_passed": 0
  },
  {
    "NL Question": "For each state, what is the average balance of credit cards associated with account holders who have an address in that state?",
    "Cypher": "MATCH (ah:AccountHolder)-[:HAS_ADDRESS]->(addr:Address)-[:HAS_CREDITCARD]->(cc:CreditCard) WITH addr.state AS state, cc.balance AS balance RETURN state, avg(balance) AS averageBalance",
    "source_dataset": "bloom50",
    "source_chunk": "data_3_3_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 109,
    "unique_id": "bloom50_data_3_3_2_6_Complex_Aggregation_109",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each provider of PhoneNumbers, what is the average number of times the phone number has been touched?",
    "Cypher": "MATCH (p:PhoneNumber) RETURN p.provider AS Provider, avg(p.touched) AS AverageTouched GROUP BY p.provider",
    "source_dataset": "bloom50",
    "source_chunk": "data_3_3_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 127,
    "unique_id": "bloom50_data_3_3_2_6_Complex_Aggregation_127",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'GROUP': expected 'FOREACH', ',', 'ORDER BY', 'CALL', 'CREATE', 'LOAD CSV', 'DELETE', 'DETACH', 'FINISH', 'INSERT', 'LIMIT', 'MATCH', 'MERGE', 'NODETACH', 'OFFSET', 'OPTIONAL', 'REMOVE', 'RETURN', 'SET', 'SKIP', 'UNION', 'UNWIND', 'USE', 'WITH' or <EOF> (line 1, column 87 (offset: 86))\n\"MATCH (p:PhoneNumber) RETURN p.provider AS Provider, avg(p.touched) AS AverageTouched GROUP BY p.provider\"\n                                                                                       ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each AccountHolder, calculate the average balance of their CreditCards and BankAccounts combined.",
    "Cypher": "MATCH (ah:AccountHolder)-[:HAS_CREDITCARD]->(cc:CreditCard) WITH ah, collect(cc.balance) AS creditCardBalances MATCH (ah)-[:HAS_BANKACCOUNT]->(ba:BankAccount) WITH ah, creditCardBalances, collect(ba.balance) AS bankAccountBalances WITH ah, creditCardBalances + bankAccountBalances AS allBalances RETURN ah.fullName AS AccountHolderName, avg(balance) AS AverageBalance UNWIND allBalances AS balance",
    "source_dataset": "bloom50",
    "source_chunk": "data_3_3_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 130,
    "unique_id": "bloom50_data_3_3_2_6_Complex_Aggregation_130",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `balance` not defined (line 1, column 342 (offset: 341))\n\"MATCH (ah:AccountHolder)-[:HAS_CREDITCARD]->(cc:CreditCard) WITH ah, collect(cc.balance) AS creditCardBalances MATCH (ah)-[:HAS_BANKACCOUNT]->(ba:BankAccount) WITH ah, creditCardBalances, collect(ba.balance) AS bankAccountBalances WITH ah, creditCardBalances + bankAccountBalances AS allBalances RETURN ah.fullName AS AccountHolderName, avg(balance) AS AverageBalance UNWIND allBalances AS balance\"\n                                                                                                                                                                                                                                                                                                                                                      ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "What is the average balance of CreditCards held by AccountHolders and Flagged entities, and what is the total number of distinct credit cards involved?",
    "Cypher": "MATCH (ah:AccountHolder)-[:HAS_CREDITCARD]->(cc:CreditCard) WITH cc.balance AS balance, cc.accountNumber AS accountNumber UNION MATCH (f:Flagged)-[:HAS_CREDITCARD]->(cc:CreditCard) WITH cc.balance AS balance, cc.accountNumber AS accountNumber RETURN AVG(balance) AS averageBalance, COUNT(DISTINCT accountNumber) AS totalCreditCards",
    "source_dataset": "bloom50",
    "source_chunk": "data_3_4_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 2,
    "unique_id": "bloom50_data_3_4_2_6_Complex_Aggregation_2",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Query cannot conclude with WITH (must be a RETURN clause, a FINISH clause, an update clause, a unit subquery call, or a procedure call with no YIELD). (line 1, column 61 (offset: 60))\n\"MATCH (ah:AccountHolder)-[:HAS_CREDITCARD]->(cc:CreditCard) WITH cc.balance AS balance, cc.accountNumber AS accountNumber UNION MATCH (f:Flagged)-[:HAS_CREDITCARD]->(cc:CreditCard) WITH cc.balance AS balance, cc.accountNumber AS accountNumber RETURN AVG(balance) AS averageBalance, COUNT(DISTINCT accountNumber) AS totalCreditCards\"\n                                                             ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "What is the average balance across all BankAccounts, CreditCards, and UnsecuredLoans, and what is the total count of these financial accounts?",
    "Cypher": "MATCH (ba:BankAccount) WITH ba.balance AS balance, 'BankAccount' AS type UNION ALL MATCH (cc:CreditCard) WITH cc.balance AS balance, 'CreditCard' AS type UNION ALL MATCH (ul:UnsecuredLoan) WITH ul.balance AS balance, 'UnsecuredLoan' AS type RETURN AVG(balance) AS averageBalance, COUNT(*) AS totalAccounts",
    "source_dataset": "bloom50",
    "source_chunk": "data_3_4_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 4,
    "unique_id": "bloom50_data_3_4_2_6_Complex_Aggregation_4",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Query cannot conclude with WITH (must be a RETURN clause, a FINISH clause, an update clause, a unit subquery call, or a procedure call with no YIELD). (line 1, column 24 (offset: 23))\n\"MATCH (ba:BankAccount) WITH ba.balance AS balance, 'BankAccount' AS type UNION ALL MATCH (cc:CreditCard) WITH cc.balance AS balance, 'CreditCard' AS type UNION ALL MATCH (ul:UnsecuredLoan) WITH ul.balance AS balance, 'UnsecuredLoan' AS type RETURN AVG(balance) AS averageBalance, COUNT(*) AS totalAccounts\"\n                        ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "What is the average limit of CreditCards associated with AccountHolders who have an Address in the state of 'Nebraska'?",
    "Cypher": "MATCH (ah:AccountHolder)-[:HAS_ADDRESS]->(a:Address {state: 'Nebraska'})-<-[:HAS_CREDITCARD]-(cc:CreditCard) RETURN avg(cc.limit) AS AverageCreditCardLimit",
    "source_dataset": "bloom50",
    "source_chunk": "data_3_4_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 9,
    "unique_id": "bloom50_data_3_4_2_6_Complex_Aggregation_9",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input '<': expected '-' (line 1, column 74 (offset: 73))\n\"MATCH (ah:AccountHolder)-[:HAS_ADDRESS]->(a:Address {state: 'Nebraska'})-<-[:HAS_CREDITCARD]-(cc:CreditCard) RETURN avg(cc.limit) AS AverageCreditCardLimit\"\n                                                                          ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "What is the average loan amount of UnsecuredLoans held by Flagged entities who also have a PhoneNumber provided by 'KPA Tel'?",
    "Cypher": "MATCH (f:Flagged)-[:HAS_PHONENUMBER]->(pn:PhoneNumber {provider: 'KPA Tel'})<-[:HAS_UNSECUREDLOAN]-(ul:UnsecuredLoan) RETURN avg(ul.loanAmount) AS AverageLoanAmount",
    "source_dataset": "bloom50",
    "source_chunk": "data_3_4_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 11,
    "unique_id": "bloom50_data_3_4_2_6_Complex_Aggregation_11",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Content: Results only contain null or zero values.",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "Results returned successfully.",
    "neo4j_result_passed": 1,
    "content_validation": "Results only contain null or zero values.",
    "content_passed": 0
  },
  {
    "NL Question": "For each state, what is the average balance of bank accounts held by account holders who have addresses in that state?",
    "Cypher": "MATCH (ah:AccountHolder)-[:HAS_ADDRESS]->(a:Address)-[:HAS_BANKACCOUNT]<-(ba:BankAccount) WITH a.state AS state, ba.balance AS accountBalance RETURN state, avg(accountBalance) AS averageBalance",
    "source_dataset": "bloom50",
    "source_chunk": "data_3_4_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 43,
    "unique_id": "bloom50_data_3_4_2_6_Complex_Aggregation_43",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input '<': expected '-' (line 1, column 72 (offset: 71))\n\"MATCH (ah:AccountHolder)-[:HAS_ADDRESS]->(a:Address)-[:HAS_BANKACCOUNT]<-(ba:BankAccount) WITH a.state AS state, ba.balance AS accountBalance RETURN state, avg(accountBalance) AS averageBalance\"\n                                                                        ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "What is the average loan amount for UnsecuredLoans associated with AccountHolders, grouped by the state of the AccountHolder's address?",
    "Cypher": "MATCH (ah:AccountHolder)-[:HAS_ADDRESS]->(a:Address)-[:HAS_UNSECUREDLOAN]->(ul:UnsecuredLoan) RETURN a.state AS State, avg(ul.loanAmount) AS AverageLoanAmount",
    "source_dataset": "bloom50",
    "source_chunk": "data_3_4_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 74,
    "unique_id": "bloom50_data_3_4_2_6_Complex_Aggregation_74",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "What is the average balance of CreditCards held by AccountHolders, grouped by the state of their address?",
    "Cypher": "MATCH (ah:AccountHolder)-[:HAS_ADDRESS]->(addr:Address)-[:HAS_CREDITCARD]->(cc:CreditCard)\nRETURN addr.state, avg(cc.balance) AS averageCreditCardBalance",
    "source_dataset": "bloom50",
    "source_chunk": "data_3_4_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 80,
    "unique_id": "bloom50_data_3_4_2_6_Complex_Aggregation_80",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each Shop, calculate the total amount of Purchases made through Logins associated with that Shop, and the average amount of those Purchases.",
    "Cypher": "MATCH (s:Shop)<-[:FOR_SHOP]-(l:Login)-[:WITH_LOGIN]->(p:Purchase)\nRETURN s.name, sum(p.amount) AS totalPurchaseAmount, avg(p.amount) AS averagePurchaseAmount",
    "source_dataset": "bloom50",
    "source_chunk": "data_3_4_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 81,
    "unique_id": "bloom50_data_3_4_2_6_Complex_Aggregation_81",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each provider of phone numbers, what is the average amount of money transferred with those phone numbers, and how many money transfers are associated with each provider?",
    "Cypher": "MATCH (mt:MoneyTransfer)-[:WITH]->(pn:PhoneNumber) WITH pn, mt MATCH (pn:PhoneNumber) WITH pn.provider AS provider, mt.amount AS amount WITH provider, AVG(amount) AS averageAmount, mt WITH provider, averageAmount, COUNT(mt) AS numberOfTransfers RETURN provider, averageAmount, numberOfTransfers",
    "source_dataset": "bloom50",
    "source_chunk": "data_3_4_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 88,
    "unique_id": "bloom50_data_3_4_2_6_Complex_Aggregation_88",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `mt` not defined (line 1, column 182 (offset: 181))\n\"MATCH (mt:MoneyTransfer)-[:WITH]->(pn:PhoneNumber) WITH pn, mt MATCH (pn:PhoneNumber) WITH pn.provider AS provider, mt.amount AS amount WITH provider, AVG(amount) AS averageAmount, mt WITH provider, averageAmount, COUNT(mt) AS numberOfTransfers RETURN provider, averageAmount, numberOfTransfers\"\n                                                                                                                                                                                      ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each provider of PhoneNumber, what is the average amount of MoneyTransfers that used that PhoneNumber, and what is the total balance of all BankAccounts that also sent these MoneyTransfers?",
    "Cypher": "MATCH (mt:MoneyTransfer)-[:WITH]->(pn:PhoneNumber) WITH pn, avg(mt.amount) AS AverageTransferAmount MATCH (mt)-[:SEND]->(ba:BankAccount) WITH pn, AverageTransferAmount, collect(ba.balance) AS balances RETURN pn.provider, AverageTransferAmount, sum(balances) AS TotalBankAccountBalance",
    "source_dataset": "bloom50",
    "source_chunk": "data_3_4_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 95,
    "unique_id": "bloom50_data_3_4_2_6_Complex_Aggregation_95",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Type mismatch: expected Float, Integer or Duration but was List<Boolean>, List<Float>, List<Integer>, List<Number>, List<Point>, List<String>, List<Duration>, List<Date>, List<Time>, List<LocalTime>, List<LocalDateTime>, List<DateTime>, List<List<Boolean>>, List<List<Float>>, List<List<Integer>>, List<List<Number>>, List<List<Point>>, List<List<String>>, List<List<Duration>>, List<List<Date>>, List<List<Time>>, List<List<LocalTime>>, List<List<LocalDateTime>> or List<List<DateTime>> (line 1, column 249 (offset: 248))\n\"MATCH (mt:MoneyTransfer)-[:WITH]->(pn:PhoneNumber) WITH pn, avg(mt.amount) AS AverageTransferAmount MATCH (mt)-[:SEND]->(ba:BankAccount) WITH pn, AverageTransferAmount, collect(ba.balance) AS balances RETURN pn.provider, AverageTransferAmount, sum(balances) AS TotalBankAccountBalance\"\n                                                                                                                                                                                                                                                         ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "What is the average amount of purchases made with BankCards, grouped by the business type of the shop where the purchase was made, and how many purchases were made for each business type?",
    "Cypher": "MATCH (p:Purchase)-[:WITH_CARD]->(bc:BankCard) WITH p MATCH (p)-[:WITH_LOGIN]->(l:Login)-[:FOR_SHOP]->(s:Shop) WITH s.business AS business, p.amount AS amount MATCH (p:Purchase)-[:WITH_CARD]->(bc:BankCard)-[:WITH_LOGIN]->(l:Login)-[:FOR_SHOP]->(s:Shop) WHERE s.business = business WITH business, AVG(amount) AS averageAmount, COUNT(p) AS purchaseCount RETURN business, averageAmount, purchaseCount",
    "source_dataset": "bloom50",
    "source_chunk": "data_3_4_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 109,
    "unique_id": "bloom50_data_3_4_2_6_Complex_Aggregation_109",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each state, what is the average balance of bank accounts held by account holders living in that state, and how many account holders are in each state?",
    "Cypher": "MATCH (ah:AccountHolder)-[:HAS_ADDRESS]->(a:Address) -[:LOCATED_IN]->(s:State)<-[:HAS_BANKACCOUNT]-(ba:BankAccount) WITH s.name AS stateName, ba.balance AS accountBalance, ah.UniqueId AS accountHolderId WITH stateName, avg(accountBalance) AS averageBalance, count(DISTINCT accountHolderId) AS accountHolderCount RETURN stateName, averageBalance, accountHolderCount",
    "source_dataset": "bloom50",
    "source_chunk": "data_3_4_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 122,
    "unique_id": "bloom50_data_3_4_2_6_Complex_Aggregation_122",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "What is the average amount of purchases made with BankCards that have latePayments greater than 0, grouped by the state of the DeliveryAddress?",
    "Cypher": "MATCH (bc:BankCard {latePayments: {gte: 0.0}})-[:WITH_CARD]-(p:Purchase)-[:DELIVERED_AT]->(da:DeliveryAddress) WITH da.state AS DeliveryState, p.amount AS PurchaseAmount RETURN DeliveryState, avg(PurchaseAmount) AS AveragePurchaseAmount",
    "source_dataset": "bloom50",
    "source_chunk": "data_3_4_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 135,
    "unique_id": "bloom50_data_3_4_2_6_Complex_Aggregation_135",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each provider of PhoneNumbers, what is the average amount of MoneyTransfers made using those phone numbers, and how many MoneyTransfers were made with each provider?",
    "Cypher": "MATCH (mt:MoneyTransfer)-[:WITH]->(pn:PhoneNumber) WITH pn, mt.amount AS amount WHERE pn.provider IS NOT NULL WITH pn.provider AS provider, AVG(amount) AS averageAmount, COUNT(mt) AS transferCount RETURN provider, averageAmount, transferCount",
    "source_dataset": "bloom50",
    "source_chunk": "data_3_5_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 3,
    "unique_id": "bloom50_data_3_5_2_6_Complex_Aggregation_3",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `mt` not defined (line 1, column 177 (offset: 176))\n\"MATCH (mt:MoneyTransfer)-[:WITH]->(pn:PhoneNumber) WITH pn, mt.amount AS amount WHERE pn.provider IS NOT NULL WITH pn.provider AS provider, AVG(amount) AS averageAmount, COUNT(mt) AS transferCount RETURN provider, averageAmount, transferCount\"\n                                                                                                                                                                                 ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each state, what is the average balance of bank accounts held by account holders residing in that state, and how many account holders are in each state?",
    "Cypher": "MATCH (ah:AccountHolder)-[:HAS_ADDRESS]->(a:Address) MATCH (ah)-[:HAS_BANKACCOUNT]->(ba:BankAccount) WITH a.state AS state, ah, ba.balance AS balance COLLECT(ah.UniqueId) AS accountHoldersInState WITH state, AVG(balance) AS averageBalance, SIZE(accountHoldersInState) AS numberOfAccountHolders RETURN state, averageBalance, numberOfAccountHolders",
    "source_dataset": "bloom50",
    "source_chunk": "data_3_5_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 8,
    "unique_id": "bloom50_data_3_5_2_6_Complex_Aggregation_8",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'COLLECT': expected 'FOREACH', ',', 'ORDER BY', 'CALL', 'CREATE', 'LOAD CSV', 'DELETE', 'DETACH', 'FINISH', 'INSERT', 'LIMIT', 'MATCH', 'MERGE', 'NODETACH', 'OFFSET', 'OPTIONAL', 'REMOVE', 'RETURN', 'SET', 'SKIP', 'UNION', 'UNWIND', 'USE', 'WHERE', 'WITH' or <EOF> (line 1, column 151 (offset: 150))\n\"MATCH (ah:AccountHolder)-[:HAS_ADDRESS]->(a:Address) MATCH (ah)-[:HAS_BANKACCOUNT]->(ba:BankAccount) WITH a.state AS state, ah, ba.balance AS balance COLLECT(ah.UniqueId) AS accountHoldersInState WITH state, AVG(balance) AS averageBalance, SIZE(accountHoldersInState) AS numberOfAccountHolders RETURN state, averageBalance, numberOfAccountHolders\"\n                                                                                                                                                       ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each AccountHolder, what is the total balance across all their BankAccounts and CreditCards combined, and the count of these accounts?",
    "Cypher": "MATCH (ah:AccountHolder) OPTIONAL MATCH (ah)-[:HAS_BANKACCOUNT]->(ba:BankAccount) OPTIONAL MATCH (ah)-[:HAS_CREDITCARD]->(cc:CreditCard) WITH ah, collect(ba.balance) AS bankBalances, collect(cc.balance) AS creditCardBalances, size(collect(ba)) + size(collect(cc)) AS totalAccounts WITH ah, coalesce(sum(bankBalances),0) + coalesce(sum(creditCardBalances),0) AS totalBalance, totalAccounts RETURN ah.fullName AS AccountHolderName, totalBalance, totalAccounts",
    "source_dataset": "bloom50",
    "source_chunk": "data_3_5_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 18,
    "unique_id": "bloom50_data_3_5_2_6_Complex_Aggregation_18",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Type mismatch: expected Float, Integer or Duration but was List<Boolean>, List<Float>, List<Integer>, List<Number>, List<Point>, List<String>, List<Duration>, List<Date>, List<Time>, List<LocalTime>, List<LocalDateTime>, List<DateTime>, List<List<Boolean>>, List<List<Float>>, List<List<Integer>>, List<List<Number>>, List<List<Point>>, List<List<String>>, List<List<Duration>>, List<List<Date>>, List<List<Time>>, List<List<LocalTime>>, List<List<LocalDateTime>> or List<List<DateTime>> (line 1, column 304 (offset: 303))\n\"MATCH (ah:AccountHolder) OPTIONAL MATCH (ah)-[:HAS_BANKACCOUNT]->(ba:BankAccount) OPTIONAL MATCH (ah)-[:HAS_CREDITCARD]->(cc:CreditCard) WITH ah, collect(ba.balance) AS bankBalances, collect(cc.balance) AS creditCardBalances, size(collect(ba)) + size(collect(cc)) AS totalAccounts WITH ah, coalesce(sum(bankBalances),0) + coalesce(sum(creditCardBalances),0) AS totalBalance, totalAccounts RETURN ah.fullName AS AccountHolderName, totalBalance, totalAccounts\"\n                                                                                                                                                                                                                                                                                                                ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each state, what is the average balance of bank accounts held by account holders residing in that state, and how many account holders are considered in each state's average?",
    "Cypher": "MATCH (ah:AccountHolder)-[:HAS_ADDRESS]->(addr:Address)-[:HAS_BANKACCOUNT]->(ba:BankAccount) WITH addr.state AS state, AVG(ba.balance) AS avgBalance, COUNT(ah) AS accountHolderCount RETURN state, avgBalance, accountHolderCount",
    "source_dataset": "bloom50",
    "source_chunk": "data_3_5_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 22,
    "unique_id": "bloom50_data_3_5_2_6_Complex_Aggregation_22",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "What is the average amount of purchases made with bank cards, grouped by the provider of the phone number used in the money transfer associated with each purchase?",
    "Cypher": "MATCH (p:Purchase)-[:WITH_CARD]->(bc:BankCard)<-[:SEND]-(mt:MoneyTransfer)-[:WITH]->(pn:PhoneNumber) WITH pn.provider AS provider, AVG(p.amount) AS avgPurchaseAmount RETURN provider, avgPurchaseAmount",
    "source_dataset": "bloom50",
    "source_chunk": "data_3_5_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 23,
    "unique_id": "bloom50_data_3_5_2_6_Complex_Aggregation_23",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "What is the average amount of money transfers associated with phone numbers using the provider 'Interstate Mob', and what is the total number of such transfers?",
    "Cypher": "MATCH (mt:MoneyTransfer)-[r:WITH]->(pn:PhoneNumber) WHERE pn.provider = 'Interstate Mob' WITH mt, pn COUNT(mt) AS totalTransfers, AVG(mt.amount) AS averageAmount RETURN totalTransfers, averageAmount",
    "source_dataset": "bloom50",
    "source_chunk": "data_3_5_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 42,
    "unique_id": "bloom50_data_3_5_2_6_Complex_Aggregation_42",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'COUNT': expected an expression, 'FOREACH', ',', 'AS', 'ORDER BY', 'CALL', 'CREATE', 'LOAD CSV', 'DELETE', 'DETACH', 'FINISH', 'INSERT', 'LIMIT', 'MATCH', 'MERGE', 'NODETACH', 'OFFSET', 'OPTIONAL', 'REMOVE', 'RETURN', 'SET', 'SKIP', 'UNION', 'UNWIND', 'USE', 'WHERE', 'WITH' or <EOF> (line 1, column 102 (offset: 101))\n\"MATCH (mt:MoneyTransfer)-[r:WITH]->(pn:PhoneNumber) WHERE pn.provider = 'Interstate Mob' WITH mt, pn COUNT(mt) AS totalTransfers, AVG(mt.amount) AS averageAmount RETURN totalTransfers, averageAmount\"\n                                                                                                      ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "What is the average purchase amount made with BankCards that have a balance greater than 4000, and how many purchases meet this criteria?",
    "Cypher": "MATCH (p:Purchase)-[:WITH_CARD]->(bc:BankCard) WHERE bc.balance > 4000 WITH p, bc COUNT(p) AS purchaseCount, AVG(p.amount) AS averagePurchaseAmount RETURN purchaseCount, averagePurchaseAmount",
    "source_dataset": "bloom50",
    "source_chunk": "data_3_5_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 44,
    "unique_id": "bloom50_data_3_5_2_6_Complex_Aggregation_44",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'COUNT': expected an expression, 'FOREACH', ',', 'AS', 'ORDER BY', 'CALL', 'CREATE', 'LOAD CSV', 'DELETE', 'DETACH', 'FINISH', 'INSERT', 'LIMIT', 'MATCH', 'MERGE', 'NODETACH', 'OFFSET', 'OPTIONAL', 'REMOVE', 'RETURN', 'SET', 'SKIP', 'UNION', 'UNWIND', 'USE', 'WHERE', 'WITH' or <EOF> (line 1, column 83 (offset: 82))\n\"MATCH (p:Purchase)-[:WITH_CARD]->(bc:BankCard) WHERE bc.balance > 4000 WITH p, bc COUNT(p) AS purchaseCount, AVG(p.amount) AS averagePurchaseAmount RETURN purchaseCount, averagePurchaseAmount\"\n                                                                                   ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each state, what is the average amount of purchases delivered there, and how many distinct delivery addresses are in each state?",
    "Cypher": "MATCH (p:Purchase)-[:DELIVERED_AT]->(da:DeliveryAddress)\nWITH p, da\nMATCH (da)-[:HAS_ADDRESS]->(s:State)\nWITH s.name AS stateName, p.amount AS purchaseAmount, da\nWITH stateName, AVG(purchaseAmount) AS averagePurchaseAmount, COUNT(DISTINCT da) AS distinctAddresses\nRETURN stateName, averagePurchaseAmount, distinctAddresses",
    "source_dataset": "bloom50",
    "source_chunk": "data_3_5_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 52,
    "unique_id": "bloom50_data_3_5_2_6_Complex_Aggregation_52",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "What is the average balance of CreditCards held by AccountHolders, grouped by the state of their address, and how many CreditCards are in each state group?",
    "Cypher": "MATCH (ah:AccountHolder)-[:HAS_ADDRESS]->(ad:Address)-[:HAS_CREDITCARD]->(cc:CreditCard) WITH ad.state AS state, cc.balance AS balance MATCH (ah2:AccountHolder)-[:HAS_ADDRESS]->(ad2:Address)-[:HAS_CREDITCARD]->(cc2:CreditCard) WHERE ad2.state = state WITH state, AVG(balance) AS averageBalance, COUNT(cc2) AS totalCards RETURN state, averageBalance, totalCards",
    "source_dataset": "bloom50",
    "source_chunk": "data_3_5_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 79,
    "unique_id": "bloom50_data_3_5_2_6_Complex_Aggregation_79",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "What is the average amount of purchases made with BankCards, grouped by the provider of the PhoneNumber associated with MoneyTransfer used in the purchase, and how many purchases fall into each provider group?",
    "Cypher": "MATCH (p:Purchase)-[:WITH_CARD]->(bc:BankCard)-[:WITH]->(mt:MoneyTransfer)-[:WITH]->(pn:PhoneNumber) WITH pn.provider AS provider, p.amount AS amount MATCH (p2:Purchase)-[:WITH_CARD]->(bc2:BankCard)-[:WITH]->(mt2:MoneyTransfer)-[:WITH]->(pn2:PhoneNumber) WHERE pn2.provider = provider WITH provider, AVG(amount) AS averageAmount, COUNT(p2) AS totalPurchases RETURN provider, averageAmount, totalPurchases",
    "source_dataset": "bloom50",
    "source_chunk": "data_3_5_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 80,
    "unique_id": "bloom50_data_3_5_2_6_Complex_Aggregation_80",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each state where AccountHolders reside, what is the average balance of their UnsecuredLoans, and how many UnsecuredLoans exist in each state?",
    "Cypher": "MATCH (ah:AccountHolder)-[:HAS_ADDRESS]->(ad:Address)-[:HAS_UNSECUREDLOAN]->(ul:UnsecuredLoan) WITH ad.state AS state, ul.balance AS balance MATCH (ah2:AccountHolder)-[:HAS_ADDRESS]->(ad2:Address)-[:HAS_UNSECUREDLOAN]->(ul2:UnsecuredLoan) WHERE ad2.state = state WITH state, AVG(balance) AS averageBalance, COUNT(ul2) AS totalLoans RETURN state, averageBalance, totalLoans",
    "source_dataset": "bloom50",
    "source_chunk": "data_3_5_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 81,
    "unique_id": "bloom50_data_3_5_2_6_Complex_Aggregation_81",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  }
]