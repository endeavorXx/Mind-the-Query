[
  {
    "NL Question": "What is the average number of movies watched by male and female users, and what is the difference between these averages?",
    "Cypher": "MATCH (u:User)-[w:WATCHED]->(m:Movie) WITH u.gender AS gender, u, COUNT(m) AS moviesWatchedPerUser WITH gender, AVG(moviesWatchedPerUser) AS averageMoviesWatchedPerGender WITH COLLECT({gender: gender, average: averageMoviesWatchedPerGender}) AS genderAverages RETURN genderAverages[0].average - genderAverages[1].average AS differenceInAverages",
    "source_dataset": "er",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 79,
    "unique_id": "er_data_3_1_2_6_Complex_Aggregation_79",
    "pipeline_stage": "FAILED_VALUE",
    "schema_validation": "✅ Query is valid according to schema!",
    "runtime_validation": "Passed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "Results returned successfully.",
    "neo4j_result_passed": 1,
    "content_validation": "Results contain non-null, non-zero values.",
    "content_passed": 1,
    "failure_reason": "❌ Value 'gender' for property 'gender' not found in the NL question.\n❌ Value 'averageMoviesWatchedPerGender' for property 'average' not found in the NL question.",
    "value_validation": "❌ Value 'gender' for property 'gender' not found in the NL question.\n❌ Value 'averageMoviesWatchedPerGender' for property 'average' not found in the NL question."
  },
  {
    "NL Question": "What is the average number of distinct genres watched by users who use a specific IP address, and how many such users are there?",
    "Cypher": "MATCH (u:User)-[:USES]->(ip:IpAddress {address: '247.145.254.232'})-[w:WATCHED]->(m:Movie)-[:HAS]->(g:Genre) WITH u, COLLECT(DISTINCT g.name) AS genresWatched, COUNT(DISTINCT g.name) AS numberOfGenresWatched WITH AVG(numberOfGenresWatched) AS averageGenresWatched, COUNT(u) as numberOfUsers RETURN averageGenresWatched, numberOfUsers",
    "source_dataset": "er",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 81,
    "unique_id": "er_data_3_1_2_6_Complex_Aggregation_81",
    "pipeline_stage": "FAILED_VALUE",
    "schema_validation": "✅ Query is valid according to schema!",
    "runtime_validation": "Passed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "Results returned successfully.",
    "neo4j_result_passed": 1,
    "content_validation": "Results contain non-null, non-zero values.",
    "content_passed": 1,
    "failure_reason": "❌ Value '247.145.254.232' for property 'address' not found in the NL question.",
    "value_validation": "❌ Value '247.145.254.232' for property 'address' not found in the NL question."
  },
  {
    "NL Question": "What is the average number of times users with a specific gender watched movies belonging to the 'Horror' genre? Return the gender and the average watch count.",
    "Cypher": "MATCH (u:User)-[w:WATCHED]->(m:Movie)-[:HAS]->(g:Genre) WHERE u.gender = 'Female' AND g.name = 'Horror' RETURN u.gender AS Gender, AVG(w.watchCount) AS AverageWatchCount",
    "source_dataset": "er",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 137,
    "unique_id": "er_data_3_1_2_6_Complex_Aggregation_137",
    "pipeline_stage": "FAILED_VALUE",
    "schema_validation": "✅ Query is valid according to schema!",
    "runtime_validation": "Passed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "Results returned successfully.",
    "neo4j_result_passed": 1,
    "content_validation": "Results contain non-null, non-zero values.",
    "content_passed": 1,
    "failure_reason": "❌ Value 'Female' for property 'gender' not found in the NL question.",
    "value_validation": "❌ Value 'Female' for property 'gender' not found in the NL question."
  },
  {
    "NL Question": "What is the average number of movies watched by female and male users, and what is the difference between these averages?",
    "Cypher": "MATCH (u:User)-[w:WATCHED]->(m:Movie) WITH u.gender AS gender, u, COUNT(m) AS moviesWatchedPerUser WITH gender, AVG(moviesWatchedPerUser) AS avgMoviesWatchedPerGender WITH collect({gender: gender, avgMovies: avgMoviesWatchedPerGender}) AS genderData UNWIND genderData AS g1 UNWIND genderData AS g2 WITH g1, g2 WHERE g1.gender = 'Female' AND g2.gender = 'Male' RETURN g1.avgMovies - g2.avgMovies AS differenceInAverages",
    "source_dataset": "er",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 165,
    "unique_id": "er_data_3_1_2_6_Complex_Aggregation_165",
    "pipeline_stage": "FAILED_VALUE",
    "schema_validation": "✅ Query is valid according to schema!",
    "runtime_validation": "Passed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "Results returned successfully.",
    "neo4j_result_passed": 1,
    "content_validation": "Results contain non-null, non-zero values.",
    "content_passed": 1,
    "failure_reason": "❌ Value 'gender' for property 'gender' not found in the NL question.\n❌ Value 'avgMoviesWatchedPerGender' for property 'avgMovies' not found in the NL question.",
    "value_validation": "❌ Value 'gender' for property 'gender' not found in the NL question.\n❌ Value 'avgMoviesWatchedPerGender' for property 'avgMovies' not found in the NL question."
  },
  {
    "NL Question": "For each state, what is the average number of movies watched by users, and what is the most frequent genre watched by users in that state?",
    "Cypher": "MATCH (u:User)-[w:WATCHED]->(m:Movie)-[:HAS]->(g:Genre) WITH u.state AS state, w.watchCount AS watchCount, g.name AS genre WITH state, AVG(watchCount) AS avgWatchCount, collect(genre) AS genres UNWIND genres AS genre WITH state, avgWatchCount, genre, COUNT(genre) AS genreCount ORDER BY genreCount DESC WITH state, avgWatchCount, COLLECT({genre: genre, count: genreCount}) AS genreCounts WITH state, avgWatchCount, genreCounts[0].genre AS mostFrequentGenre RETURN state, avgWatchCount, mostFrequentGenre",
    "source_dataset": "er",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 171,
    "unique_id": "er_data_3_1_2_6_Complex_Aggregation_171",
    "pipeline_stage": "FAILED_VALUE",
    "schema_validation": "✅ Query is valid according to schema!",
    "runtime_validation": "Passed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "Results returned successfully.",
    "neo4j_result_passed": 1,
    "content_validation": "Results contain non-null, non-zero values.",
    "content_passed": 1,
    "failure_reason": "❌ Value 'genreCount' for property 'count' not found in the NL question.",
    "value_validation": "❌ Value 'genreCount' for property 'count' not found in the NL question."
  },
  {
    "NL Question": "For each genre, what is the average watch count of movies in that genre, and what is the title of the movie with the highest watch count in that genre?",
    "Cypher": "MATCH (g:Genre)<-[:HAS]-(m:Movie)<-[w:WATCHED]-(u:User) WITH g.name AS genre, AVG(w.watchCount) AS avgWatchCount, COLLECT({movie: m.title, watchCount: w.watchCount}) AS movieWatchCounts UNWIND movieWatchCounts AS movieWatch WITH genre, avgWatchCount, movieWatch ORDER BY movieWatch.watchCount DESC WITH genre, avgWatchCount, COLLECT(movieWatch)[0] AS topMovie RETURN genre, avgWatchCount, topMovie.movie AS topMovieTitle",
    "source_dataset": "er",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 316,
    "unique_id": "er_data_3_1_2_6_Complex_Aggregation_316",
    "pipeline_stage": "FAILED_VALUE",
    "schema_validation": "✅ Query is valid according to schema!",
    "runtime_validation": "Passed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "Results returned successfully.",
    "neo4j_result_passed": 1,
    "content_validation": "Results contain non-null, non-zero values.",
    "content_passed": 1,
    "failure_reason": "❌ Value 'm.title' for property 'movie' not found in the NL question.\n❌ Value 'w.watchCount' for property 'watchCount' not found in the NL question.",
    "value_validation": "❌ Value 'm.title' for property 'movie' not found in the NL question.\n❌ Value 'w.watchCount' for property 'watchCount' not found in the NL question."
  },
  {
    "NL Question": "What is the average number of movies watched by female users compared to male users, and what is the difference in their average watch counts?",
    "Cypher": "MATCH (u:User)-[w:WATCHED]->(m:Movie) WITH u.gender AS gender, COUNT(m) AS moviesWatched WHERE u.gender IS NOT NULL WITH gender, AVG(moviesWatched) AS averageMoviesWatchedPerGender WITH collect({gender: gender, avg: averageMoviesWatchedPerGender}) AS genderAverages WITH genderAverages[0].avg AS femaleAvg, genderAverages[1].avg AS maleAvg RETURN femaleAvg, maleAvg, femaleAvg - maleAvg AS difference",
    "source_dataset": "er",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 396,
    "unique_id": "er_data_3_1_2_6_Complex_Aggregation_396",
    "pipeline_stage": "FAILED_VALUE",
    "schema_validation": "✅ Query is valid according to schema!",
    "runtime_validation": "Passed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "Results returned successfully.",
    "neo4j_result_passed": 1,
    "content_validation": "Results contain non-null, non-zero values.",
    "content_passed": 1,
    "failure_reason": "❌ Value 'gender' for property 'gender' not found in the NL question.\n❌ Value 'averageMoviesWatchedPerGender' for property 'avg' not found in the NL question.",
    "value_validation": "❌ Value 'gender' for property 'gender' not found in the NL question.\n❌ Value 'averageMoviesWatchedPerGender' for property 'avg' not found in the NL question."
  },
  {
    "NL Question": "What is the average number of movies watched by users with a specific last name for each genre, and what is the total number of users with that last name who have watched movies of that genre?",
    "Cypher": "MATCH (u:User)-[w:WATCHED]->(m:Movie)-[:HAS]->(g:Genre) WHERE u.lastName = 'Allmen' WITH g.name AS genre, u, w.watchCount AS watchCount RETURN genre, AVG(watchCount) AS averageWatchCount, COUNT(DISTINCT u) AS totalUsers",
    "source_dataset": "er",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 410,
    "unique_id": "er_data_3_1_2_6_Complex_Aggregation_410",
    "pipeline_stage": "FAILED_VALUE",
    "schema_validation": "✅ Query is valid according to schema!",
    "runtime_validation": "Passed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "Results returned successfully.",
    "neo4j_result_passed": 1,
    "content_validation": "Results contain non-null, non-zero values.",
    "content_passed": 1,
    "failure_reason": "❌ Value 'Allmen' for property 'lastName' not found in the NL question.",
    "value_validation": "❌ Value 'Allmen' for property 'lastName' not found in the NL question."
  },
  {
    "NL Question": "What is the average watch count for movies released after the year 2000, grouped by genre, considering only users with a 'gmail.com' email address?",
    "Cypher": "MATCH (u:User {email: 'jmewis33@tripadvisor.com'})-[w:WATCHED]->(m:Movie) WHERE m.year > 2000 WITH m, w MATCH (m)-[:HAS]->(g:Genre) RETURN g.name AS genre, AVG(w.watchCount) AS averageWatchCount",
    "source_dataset": "er",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 424,
    "unique_id": "er_data_3_1_2_6_Complex_Aggregation_424",
    "pipeline_stage": "FAILED_VALUE",
    "schema_validation": "✅ Query is valid according to schema!",
    "runtime_validation": "Passed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "Results returned successfully.",
    "neo4j_result_passed": 1,
    "content_validation": "Results contain non-null, non-zero values.",
    "content_passed": 1,
    "failure_reason": "❌ Value 'jmewis33@tripadvisor.com' for property 'email' not found in the NL question.",
    "value_validation": "❌ Value 'jmewis33@tripadvisor.com' for property 'email' not found in the NL question."
  },
  {
    "NL Question": "For each state, what is the average number of movies watched by users using a specific IP address, and how many distinct users are in each state using that IP address?",
    "Cypher": "MATCH (u:User)-[uses:USES]->(ip:IpAddress) WHERE ip.address = '193.250.194.86' WITH u MATCH (u)-[w:WATCHED]->(m:Movie) WITH u.state AS state, w.watchCount AS watchCount, u WITH state, AVG(watchCount) AS avgWatchCount, COUNT(DISTINCT u) AS userCount RETURN state, avgWatchCount, userCount",
    "source_dataset": "er",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 528,
    "unique_id": "er_data_3_1_2_6_Complex_Aggregation_528",
    "pipeline_stage": "FAILED_VALUE",
    "schema_validation": "✅ Query is valid according to schema!",
    "runtime_validation": "Passed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "Results returned successfully.",
    "neo4j_result_passed": 1,
    "content_validation": "Results contain non-null, non-zero values.",
    "content_passed": 1,
    "failure_reason": "❌ Value '193.250.194.86' for property 'address' not found in the NL question.",
    "value_validation": "❌ Value '193.250.194.86' for property 'address' not found in the NL question."
  },
  {
    "NL Question": "For each movie genre, what is the average watch count of movies released after the year 2000, considering only users with a phone number starting with '198'?",
    "Cypher": "MATCH (u:User {phone: '198-872-3177'})-[w:WATCHED]->(m:Movie)-[:HAS]->(g:Genre) WHERE m.year > 2000 RETURN g.name AS genre, avg(w.watchCount) AS averageWatchCount",
    "source_dataset": "er",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 213,
    "unique_id": "er_data_3_2_2_6_Complex_Aggregation_213",
    "pipeline_stage": "FAILED_VALUE",
    "schema_validation": "✅ Query is valid according to schema!",
    "runtime_validation": "Passed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "Results returned successfully.",
    "neo4j_result_passed": 1,
    "content_validation": "Results contain non-null, non-zero values.",
    "content_passed": 1,
    "failure_reason": "❌ Value '198-872-3177' for property 'phone' not found in the NL question.",
    "value_validation": "❌ Value '198-872-3177' for property 'phone' not found in the NL question."
  },
  {
    "NL Question": "What is the average number of distinct genres watched by users who use a specific IP address, and how many users use that IP address?",
    "Cypher": "MATCH (u:User)-[:USES]->(ip:IpAddress) WHERE ip.address = '209.255.88.64' WITH u MATCH (u)-[w:WATCHED]->(m:Movie)-[:HAS]->(g:Genre) WITH u, COUNT(DISTINCT g) AS distinctGenresWatched WITH AVG(distinctGenresWatched) AS avgDistinctGenres, COUNT(u) AS totalUsers RETURN avgDistinctGenres, totalUsers",
    "source_dataset": "er",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 226,
    "unique_id": "er_data_3_2_2_6_Complex_Aggregation_226",
    "pipeline_stage": "FAILED_VALUE",
    "schema_validation": "✅ Query is valid according to schema!",
    "runtime_validation": "Passed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "Results returned successfully.",
    "neo4j_result_passed": 1,
    "content_validation": "Results contain non-null, non-zero values.",
    "content_passed": 1,
    "failure_reason": "❌ Value '209.255.88.64' for property 'address' not found in the NL question.",
    "value_validation": "❌ Value '209.255.88.64' for property 'address' not found in the NL question."
  },
  {
    "NL Question": "For each state, what is the average number of movies watched by female users compared to the average number of movies watched by male users?",
    "Cypher": "MATCH (u:User)-[w:WATCHED]->(m:Movie) WITH u.state AS state, u.gender AS gender, u, COUNT(m) AS moviesWatchedPerUser WITH state, gender, AVG(moviesWatchedPerUser) AS avgMoviesWatchedPerUser WHERE gender IN ['Male', 'Female'] WITH state, COLLECT({gender: gender, avgMoviesWatched: avgMoviesWatchedPerUser}) AS genderData UNWIND genderData AS gd WITH state, gd.gender AS gender, gd.avgMoviesWatched AS avgMoviesWatched RETURN state, gender, avgMoviesWatched",
    "source_dataset": "er",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 227,
    "unique_id": "er_data_3_2_2_6_Complex_Aggregation_227",
    "pipeline_stage": "FAILED_VALUE",
    "schema_validation": "✅ Query is valid according to schema!",
    "runtime_validation": "Passed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "Results returned successfully.",
    "neo4j_result_passed": 1,
    "content_validation": "Results contain non-null, non-zero values.",
    "content_passed": 1,
    "failure_reason": "❌ Value 'gender' for property 'gender' not found in the NL question.\n❌ Value 'avgMoviesWatchedPerUser' for property 'avgMoviesWatched' not found in the NL question.",
    "value_validation": "❌ Value 'gender' for property 'gender' not found in the NL question.\n❌ Value 'avgMoviesWatchedPerUser' for property 'avgMoviesWatched' not found in the NL question."
  },
  {
    "NL Question": "What is the total number of movies watched by female and male users, broken down by genre, considering only users whose email contains 'tinypic.com'?",
    "Cypher": "MATCH (u:User {email: 'hdanielovitch4j@tinypic.com'})-[w:WATCHED]->(m:Movie)-[:HAS]->(g:Genre) RETURN u.gender AS gender, g.name AS genre, COUNT(m) AS totalMoviesWatched",
    "source_dataset": "er",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 542,
    "unique_id": "er_data_3_2_2_6_Complex_Aggregation_542",
    "pipeline_stage": "FAILED_VALUE",
    "schema_validation": "✅ Query is valid according to schema!",
    "runtime_validation": "Passed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "Results returned successfully.",
    "neo4j_result_passed": 1,
    "content_validation": "Results contain non-null, non-zero values.",
    "content_passed": 1,
    "failure_reason": "❌ Value 'hdanielovitch4j@tinypic.com' for property 'email' not found in the NL question.",
    "value_validation": "❌ Value 'hdanielovitch4j@tinypic.com' for property 'email' not found in the NL question."
  },
  {
    "NL Question": "What is the average number of movies watched by users who use a specific IP address, and what is the total number of such users?",
    "Cypher": "MATCH (u:User)-[:USES]->(ip:IpAddress {address: '20.150.212.216'})-[w:WATCHED]->(m:Movie) WITH u, COUNT(m) AS moviesWatchedPerUser WITH AVG(moviesWatchedPerUser) AS averageMoviesWatched, COUNT(DISTINCT u) AS totalUsers RETURN averageMoviesWatched, totalUsers",
    "source_dataset": "er",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 548,
    "unique_id": "er_data_3_2_2_6_Complex_Aggregation_548",
    "pipeline_stage": "FAILED_VALUE",
    "schema_validation": "✅ Query is valid according to schema!",
    "runtime_validation": "Passed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "Results returned successfully.",
    "neo4j_result_passed": 1,
    "content_validation": "Results contain non-null, non-zero values.",
    "content_passed": 1,
    "failure_reason": "❌ Value '20.150.212.216' for property 'address' not found in the NL question.",
    "value_validation": "❌ Value '20.150.212.216' for property 'address' not found in the NL question."
  }
]