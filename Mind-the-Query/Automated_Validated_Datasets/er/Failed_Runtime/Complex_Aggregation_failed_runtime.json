[
  {
    "NL Question": "What is the average number of movies watched by users who use a specific IP address, and what is the total number of users using that IP address?",
    "Cypher": "MATCH (u:User)-[:USES]->(ip:IpAddress)-<-[:USES]-(otherUser) WITH ip, otherUser MATCH (otherUser)-[w:WATCHED]->(m:Movie) WITH ip.address AS ipAddress, otherUser, COUNT(m) AS moviesWatchedPerUser WITH ipAddress, AVG(moviesWatchedPerUser) AS avgMoviesWatched, COUNT(DISTINCT otherUser) AS totalUsersPerIpAddress RETURN ipAddress, avgMoviesWatched, totalUsersPerIpAddress",
    "source_dataset": "er",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 23,
    "unique_id": "er_data_3_1_2_6_Complex_Aggregation_23",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input '<': expected '-' (line 1, column 40 (offset: 39))\n\"MATCH (u:User)-[:USES]->(ip:IpAddress)-<-[:USES]-(otherUser) WITH ip, otherUser MATCH (otherUser)-[w:WATCHED]->(m:Movie) WITH ip.address AS ipAddress, otherUser, COUNT(m) AS moviesWatchedPerUser WITH ipAddress, AVG(moviesWatchedPerUser) AS avgMoviesWatched, COUNT(DISTINCT otherUser) AS totalUsersPerIpAddress RETURN ipAddress, avgMoviesWatched, totalUsersPerIpAddress\"\n                                        ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each IP address, what is the average and maximum number of times users using that IP address have watched a movie?",
    "Cypher": "MATCH (u:User)-[:USES]->(ip:IpAddress)-[w:WATCHED]->(m:Movie) WITH ip.address AS ipAddress, AVG(w.watchCount) AS avgWatchCount, MAX(w.watchCount) AS maxWatchCount RETURN ipAddress, avgWatchCount, maxWatchCount",
    "source_dataset": "er",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 73,
    "unique_id": "er_data_3_1_2_6_Complex_Aggregation_73",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each state, what is the average number of movies watched by users, and what is the maximum watchCount given by any user in that state?",
    "Cypher": "MATCH (u:User)-[w:WATCHED]->(m:Movie) WITH u.state AS state, u, w.watchCount AS watchCount, COUNT(m) AS moviesWatchedPerUser WITH state, AVG(moviesWatchedPerUser) AS averageMoviesWatched, MAX(watchCount) AS maxWatchCount FROM state RETURN state, averageMoviesWatched, maxWatchCount",
    "source_dataset": "er",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 80,
    "unique_id": "er_data_3_1_2_6_Complex_Aggregation_80",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'FROM': expected 'FOREACH', ',', 'ORDER BY', 'CALL', 'CREATE', 'LOAD CSV', 'DELETE', 'DETACH', 'FINISH', 'INSERT', 'LIMIT', 'MATCH', 'MERGE', 'NODETACH', 'OFFSET', 'OPTIONAL', 'REMOVE', 'RETURN', 'SET', 'SKIP', 'UNION', 'UNWIND', 'USE', 'WHERE', 'WITH' or <EOF> (line 1, column 222 (offset: 221))\n\"MATCH (u:User)-[w:WATCHED]->(m:Movie) WITH u.state AS state, u, w.watchCount AS watchCount, COUNT(m) AS moviesWatchedPerUser WITH state, AVG(moviesWatchedPerUser) AS averageMoviesWatched, MAX(watchCount) AS maxWatchCount FROM state RETURN state, averageMoviesWatched, maxWatchCount\"\n                                                                                                                                                                                                                              ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "What is the average number of movies watched by users using a specific IP address, and how many distinct genres are associated with those movies?",
    "Cypher": "MATCH (u:User)-[w:WATCHED]->(m:Movie)<-[:HAS]-(g:Genre), (u)-[:USES]->(ip:IpAddress) WITH ip.address AS ipAddress, u, m WITH ipAddress, u, COUNT(m) AS moviesWatchedPerUser, COLLECT(DISTINCT m) AS moviesWatched WITH ipAddress, AVG(moviesWatchedPerUser) AS avgMoviesWatched, moviesWatched UNWIND moviesWatched AS movie MATCH (movie)-[:HAS]->(g:Genre) WITH ipAddress, avgMoviesWatched, COUNT(DISTINCT g) AS distinctGenreCount RETURN ipAddress, avgMoviesWatched, distinctGenreCount",
    "source_dataset": "er",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 86,
    "unique_id": "er_data_3_1_2_6_Complex_Aggregation_86",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each genre, what is the average watch count of movies in that genre, and how many distinct users have watched movies of that genre?",
    "Cypher": "MATCH (u:User)-[w:WATCHED]->(m:Movie)-[:HAS]->(g:Genre) WITH g.name AS genre, u, w.watchCount AS watchCount COLLECT(watchCount) AS watchesPerUserPerGenre WITH genre, AVG(watchesPerUserPerGenre) AS avgWatchCount, COUNT(DISTINCT u) AS totalUsersPerGenre RETURN genre, avgWatchCount, totalUsersPerGenre",
    "source_dataset": "er",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 92,
    "unique_id": "er_data_3_1_2_6_Complex_Aggregation_92",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'COLLECT': expected 'FOREACH', ',', 'ORDER BY', 'CALL', 'CREATE', 'LOAD CSV', 'DELETE', 'DETACH', 'FINISH', 'INSERT', 'LIMIT', 'MATCH', 'MERGE', 'NODETACH', 'OFFSET', 'OPTIONAL', 'REMOVE', 'RETURN', 'SET', 'SKIP', 'UNION', 'UNWIND', 'USE', 'WHERE', 'WITH' or <EOF> (line 1, column 109 (offset: 108))\n\"MATCH (u:User)-[w:WATCHED]->(m:Movie)-[:HAS]->(g:Genre) WITH g.name AS genre, u, w.watchCount AS watchCount COLLECT(watchCount) AS watchesPerUserPerGenre WITH genre, AVG(watchesPerUserPerGenre) AS avgWatchCount, COUNT(DISTINCT u) AS totalUsersPerGenre RETURN genre, avgWatchCount, totalUsersPerGenre\"\n                                                                                                             ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each country, what is the average number of movies watched per user, considering only users who have watched more than one movie?",
    "Cypher": "MATCH (u:User)-[w:WATCHED]->(m:Movie) WITH u.country AS country, u, COUNT(m) AS moviesWatched WHERE moviesWatched > 1 WITH country, u COLLECT(moviesWatched) AS moviesWatchedByUserPerCountry WITH country, AVG(moviesWatchedByUserPerCountry) AS avgMoviesWatchedPerUser RETURN country, avgMoviesWatchedPerUser",
    "source_dataset": "er",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 93,
    "unique_id": "er_data_3_1_2_6_Complex_Aggregation_93",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'COLLECT': expected an expression, 'FOREACH', ',', 'AS', 'ORDER BY', 'CALL', 'CREATE', 'LOAD CSV', 'DELETE', 'DETACH', 'FINISH', 'INSERT', 'LIMIT', 'MATCH', 'MERGE', 'NODETACH', 'OFFSET', 'OPTIONAL', 'REMOVE', 'RETURN', 'SET', 'SKIP', 'UNION', 'UNWIND', 'USE', 'WHERE', 'WITH' or <EOF> (line 1, column 135 (offset: 134))\n\"MATCH (u:User)-[w:WATCHED]->(m:Movie) WITH u.country AS country, u, COUNT(m) AS moviesWatched WHERE moviesWatched > 1 WITH country, u COLLECT(moviesWatched) AS moviesWatchedByUserPerCountry WITH country, AVG(moviesWatchedByUserPerCountry) AS avgMoviesWatchedPerUser RETURN country, avgMoviesWatchedPerUser\"\n                                                                                                                                       ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "What is the average number of movies watched by users using each IP address, and how many distinct users use each IP address?",
    "Cypher": "MATCH (u:User)-[w:WATCHED]->(m:Movie), (u)-[:USES]->(ip:IpAddress) WITH ip.address AS ipAddress, u, w.watchCount AS watchCount COLLECT(watchCount) AS watchesPerUserPerIp WITH ipAddress, AVG(watchesPerUserPerIp) AS avgWatchCount, COUNT(DISTINCT u) AS totalUsersPerIp RETURN ipAddress, avgWatchCount, totalUsersPerIp",
    "source_dataset": "er",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 94,
    "unique_id": "er_data_3_1_2_6_Complex_Aggregation_94",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'COLLECT': expected 'FOREACH', ',', 'ORDER BY', 'CALL', 'CREATE', 'LOAD CSV', 'DELETE', 'DETACH', 'FINISH', 'INSERT', 'LIMIT', 'MATCH', 'MERGE', 'NODETACH', 'OFFSET', 'OPTIONAL', 'REMOVE', 'RETURN', 'SET', 'SKIP', 'UNION', 'UNWIND', 'USE', 'WHERE', 'WITH' or <EOF> (line 1, column 128 (offset: 127))\n\"MATCH (u:User)-[w:WATCHED]->(m:Movie), (u)-[:USES]->(ip:IpAddress) WITH ip.address AS ipAddress, u, w.watchCount AS watchCount COLLECT(watchCount) AS watchesPerUserPerIp WITH ipAddress, AVG(watchesPerUserPerIp) AS avgWatchCount, COUNT(DISTINCT u) AS totalUsersPerIp RETURN ipAddress, avgWatchCount, totalUsersPerIp\"\n                                                                                                                                ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each gender, what is the average number of movies watched by users, and what is the average year of those movies?",
    "Cypher": "MATCH (u:User)-[w:WATCHED]->(m:Movie) WITH u.gender AS gender, u, m.year AS movieYear COLLECT(movieYear) AS movieYearsWatchedByUserPerGender WITH gender, AVG(movieYearsWatchedByUserPerGender) AS avgMovieYear, COUNT(DISTINCT u) AS totalUsersPerGender RETURN gender, avgMovieYear, totalUsersPerGender",
    "source_dataset": "er",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 95,
    "unique_id": "er_data_3_1_2_6_Complex_Aggregation_95",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'COLLECT': expected 'FOREACH', ',', 'ORDER BY', 'CALL', 'CREATE', 'LOAD CSV', 'DELETE', 'DETACH', 'FINISH', 'INSERT', 'LIMIT', 'MATCH', 'MERGE', 'NODETACH', 'OFFSET', 'OPTIONAL', 'REMOVE', 'RETURN', 'SET', 'SKIP', 'UNION', 'UNWIND', 'USE', 'WHERE', 'WITH' or <EOF> (line 1, column 87 (offset: 86))\n\"MATCH (u:User)-[w:WATCHED]->(m:Movie) WITH u.gender AS gender, u, m.year AS movieYear COLLECT(movieYear) AS movieYearsWatchedByUserPerGender WITH gender, AVG(movieYearsWatchedByUserPerGender) AS avgMovieYear, COUNT(DISTINCT u) AS totalUsersPerGender RETURN gender, avgMovieYear, totalUsersPerGender\"\n                                                                                       ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "What is the average watch count for movies watched by users in each state, considering only users who use IP addresses from the '251.142.118.162' address?",
    "Cypher": "MATCH (u:User)-[:USES]->(ip:IpAddress {address: '251.142.118.162'})-[w:WATCHED]->(m:Movie) WITH u.state AS state, AVG(w.watchCount) AS averageWatchCount RETURN state, averageWatchCount",
    "source_dataset": "er",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 114,
    "unique_id": "er_data_3_1_2_6_Complex_Aggregation_114",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each movie title, find the average watch count of users who watched the movie and the number of distinct genres associated with that movie.",
    "Cypher": "MATCH (m:Movie)-[:HAS]->(g:Genre)<-[w:WATCHED]-(u:User) WITH m.title AS movieTitle, AVG(w.watchCount) AS averageWatchCount, COUNT(DISTINCT g) AS distinctGenreCount RETURN movieTitle, averageWatchCount, distinctGenreCount",
    "source_dataset": "er",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 115,
    "unique_id": "er_data_3_1_2_6_Complex_Aggregation_115",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each genre, what is the average watch count of movies in that genre, and what is the total number of users who have watched movies in that genre?",
    "Cypher": "MATCH (u:User)-[w:WATCHED]->(m:Movie)-[:HAS]->(g:Genre) WITH g.name AS genre, AVG(w.watchCount) AS avgWatchCount, COUNT(DISTINCT u) AS userCount WHERE w.watchCount IS NOT NULL RETURN genre, avgWatchCount, userCount",
    "source_dataset": "er",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 120,
    "unique_id": "er_data_3_1_2_6_Complex_Aggregation_120",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: In a WITH/RETURN with DISTINCT or an aggregation, it is not possible to access variables declared before the WITH/RETURN: w (line 1, column 152 (offset: 151))\n\"MATCH (u:User)-[w:WATCHED]->(m:Movie)-[:HAS]->(g:Genre) WITH g.name AS genre, AVG(w.watchCount) AS avgWatchCount, COUNT(DISTINCT u) AS userCount WHERE w.watchCount IS NOT NULL RETURN genre, avgWatchCount, userCount\"\n                                                                                                                                                        ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "What is the average number of movies watched by users, grouped by their gender and state, and list the top 3 gender-state combinations with the highest average watch count?",
    "Cypher": "MATCH (u:User)-[w:WATCHED]->(m:Movie) WITH u.gender AS gender, u.state AS state, AVG(w.watchCount) AS avgWatchCount WHERE w.watchCount IS NOT NULL RETURN gender, state, avgWatchCount ORDER BY avgWatchCount DESC LIMIT 3",
    "source_dataset": "er",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 121,
    "unique_id": "er_data_3_1_2_6_Complex_Aggregation_121",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: In a WITH/RETURN with DISTINCT or an aggregation, it is not possible to access variables declared before the WITH/RETURN: w (line 1, column 123 (offset: 122))\n\"MATCH (u:User)-[w:WATCHED]->(m:Movie) WITH u.gender AS gender, u.state AS state, AVG(w.watchCount) AS avgWatchCount WHERE w.watchCount IS NOT NULL RETURN gender, state, avgWatchCount ORDER BY avgWatchCount DESC LIMIT 3\"\n                                                                                                                           ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each movie year, what is the average watch count for movies released in that year, and how many distinct genres are associated with movies from that year?",
    "Cypher": "MATCH (u:User)-[w:WATCHED]->(m:Movie)-[:HAS]->(g:Genre) WITH m.year AS movieYear, AVG(w.watchCount) AS avgWatchCount, COUNT(DISTINCT g) AS genreCount WHERE w.watchCount IS NOT NULL RETURN movieYear, avgWatchCount, genreCount",
    "source_dataset": "er",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 122,
    "unique_id": "er_data_3_1_2_6_Complex_Aggregation_122",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: In a WITH/RETURN with DISTINCT or an aggregation, it is not possible to access variables declared before the WITH/RETURN: w (line 1, column 157 (offset: 156))\n\"MATCH (u:User)-[w:WATCHED]->(m:Movie)-[:HAS]->(g:Genre) WITH m.year AS movieYear, AVG(w.watchCount) AS avgWatchCount, COUNT(DISTINCT g) AS genreCount WHERE w.watchCount IS NOT NULL RETURN movieYear, avgWatchCount, genreCount\"\n                                                                                                                                                             ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "What is the average number of movies watched by users using each distinct IP address, and what is the total number of users who use each IP address?",
    "Cypher": "MATCH (u:User)-[w:WATCHED]->(m:Movie), (u)-[:USES]->(ip:IpAddress) WITH ip.address AS ipAddress, AVG(w.watchCount) AS avgWatchCount, COUNT(DISTINCT u) AS userCount WHERE w.watchCount IS NOT NULL RETURN ipAddress, avgWatchCount, userCount",
    "source_dataset": "er",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 123,
    "unique_id": "er_data_3_1_2_6_Complex_Aggregation_123",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: In a WITH/RETURN with DISTINCT or an aggregation, it is not possible to access variables declared before the WITH/RETURN: w (line 1, column 171 (offset: 170))\n\"MATCH (u:User)-[w:WATCHED]->(m:Movie), (u)-[:USES]->(ip:IpAddress) WITH ip.address AS ipAddress, AVG(w.watchCount) AS avgWatchCount, COUNT(DISTINCT u) AS userCount WHERE w.watchCount IS NOT NULL RETURN ipAddress, avgWatchCount, userCount\"\n                                                                                                                                                                           ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "What is the average watch count for movies watched by users who use the IP address '247.225.91.175', and what is the total number of movies watched by these users?",
    "Cypher": "MATCH (u:User)-[:USES]->(ip:IpAddress {address: '247.225.91.175'})-[w:WATCHED]->(m:Movie) WITH u, w RETURN AVG(w.watchCount) AS averageWatchCount, COUNT(m) AS totalMoviesWatched",
    "source_dataset": "er",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 129,
    "unique_id": "er_data_3_1_2_6_Complex_Aggregation_129",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `m` not defined (line 1, column 154 (offset: 153))\n\"MATCH (u:User)-[:USES]->(ip:IpAddress {address: '247.225.91.175'})-[w:WATCHED]->(m:Movie) WITH u, w RETURN AVG(w.watchCount) AS averageWatchCount, COUNT(m) AS totalMoviesWatched\"\n                                                                                                                                                          ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each genre, what is the average watch count of movies in that genre, considering only users who use the IP address '70.93.192.173'?",
    "Cypher": "MATCH (u:User)-[:USES]->(ip:IpAddress {address: '70.93.192.173'})-[w:WATCHED]->(m:Movie)-[:HAS]->(g:Genre) RETURN g.name AS genre, avg(w.watchCount) AS averageWatchCount",
    "source_dataset": "er",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 183,
    "unique_id": "er_data_3_1_2_6_Complex_Aggregation_183",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "What is the average watchCount for each genre, considering only movies released after the year 2000, and only including genres that have at least 5 movies?",
    "Cypher": "MATCH (m:Movie)-[:HAS]->(g:Genre)<-[w:WATCHED]-(u:User) WHERE m.year > 2000 WITH g.name AS genre, m, SUM(w.watchCount) AS totalWatchCount, COUNT(m) AS movieCount WHERE movieCount >= 5 RETURN genre, AVG(totalWatchCount)",
    "source_dataset": "er",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 190,
    "unique_id": "er_data_3_1_2_6_Complex_Aggregation_190",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "What is the average number of users using each IP address, considering only IP addresses used by more than 2 users, and only including users whose first name starts with 'R'?",
    "Cypher": "MATCH (u:User)-[:USES]->(ip:IpAddress) WHERE u.firstName STARTS WITH 'R' WITH ip.address AS ipAddress, COUNT(u) AS userCount WHERE userCount > 2 RETURN ipAddress, AVG(userCount)",
    "source_dataset": "er",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 192,
    "unique_id": "er_data_3_1_2_6_Complex_Aggregation_192",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "What is the average number of distinct genres watched by users who use the IP address '243.162.50.43'?",
    "Cypher": "MATCH (u:User)-[:USES]->(ip:IpAddress {address: '243.162.50.43'})-[w:WATCHED]->(m:Movie)-[:HAS]->(g:Genre) WITH u, COLLECT(DISTINCT g.name) AS genresWatched RETURN AVG(SIZE(genresWatched)) AS averageDistinctGenresWatched",
    "source_dataset": "er",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 233,
    "unique_id": "er_data_3_1_2_6_Complex_Aggregation_233",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Content: Results only contain null or zero values.",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "Results returned successfully.",
    "neo4j_result_passed": 1,
    "content_validation": "Results only contain null or zero values.",
    "content_passed": 0
  },
  {
    "NL Question": "What is the average year of movies watched by female users in each state, and what is the total number of movies watched by female users in each state?",
    "Cypher": "MATCH (u:User)-[:WATCHED]->(m:Movie) WHERE u.gender = 'Female' WITH u.state AS state, m.year AS movieYear, u WITH state, AVG(movieYear) AS avgMovieYear, COUNT(m) AS totalMoviesWatched WHERE u.state IS NOT NULL RETURN state, avgMovieYear, totalMoviesWatched ORDER BY state",
    "source_dataset": "er",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 242,
    "unique_id": "er_data_3_1_2_6_Complex_Aggregation_242",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `m` not defined (line 1, column 160 (offset: 159))\n\"MATCH (u:User)-[:WATCHED]->(m:Movie) WHERE u.gender = 'Female' WITH u.state AS state, m.year AS movieYear, u WITH state, AVG(movieYear) AS avgMovieYear, COUNT(m) AS totalMoviesWatched WHERE u.state IS NOT NULL RETURN state, avgMovieYear, totalMoviesWatched ORDER BY state\"\n                                                                                                                                                                ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "What is the average number of movies watched by users from each state, considering only users who have watched more than 5 movies in total, and what is the total number of such users in each state?",
    "Cypher": "MATCH (u:User)-[w:WATCHED]->(m:Movie) WITH u.state AS state, u, COUNT(m) AS moviesWatchedPerUser WHERE moviesWatchedPerUser > 5 WITH state, AVG(moviesWatchedPerUser) AS averageMoviesWatched, COUNT(u) AS totalUsers FROM User WHERE User.state IS NOT NULL RETURN state, averageMoviesWatched, totalUsers",
    "source_dataset": "er",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 249,
    "unique_id": "er_data_3_1_2_6_Complex_Aggregation_249",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'FROM': expected 'FOREACH', ',', 'ORDER BY', 'CALL', 'CREATE', 'LOAD CSV', 'DELETE', 'DETACH', 'FINISH', 'INSERT', 'LIMIT', 'MATCH', 'MERGE', 'NODETACH', 'OFFSET', 'OPTIONAL', 'REMOVE', 'RETURN', 'SET', 'SKIP', 'UNION', 'UNWIND', 'USE', 'WHERE', 'WITH' or <EOF> (line 1, column 215 (offset: 214))\n\"MATCH (u:User)-[w:WATCHED]->(m:Movie) WITH u.state AS state, u, COUNT(m) AS moviesWatchedPerUser WHERE moviesWatchedPerUser > 5 WITH state, AVG(moviesWatchedPerUser) AS averageMoviesWatched, COUNT(u) AS totalUsers FROM User WHERE User.state IS NOT NULL RETURN state, averageMoviesWatched, totalUsers\"\n                                                                                                                                                                                                                       ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "What is the average number of movies watched by female users compared to male users, and how many users are in each gender group?",
    "Cypher": "MATCH (u:User)-[w:WATCHED]->(m:Movie) WITH u.gender AS gender, w.watchCount AS watchCount RETURN gender, AVG(watchCount) AS averageWatchCount, COUNT(u) AS totalUsers",
    "source_dataset": "er",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 263,
    "unique_id": "er_data_3_1_2_6_Complex_Aggregation_263",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `u` not defined (line 1, column 150 (offset: 149))\n\"MATCH (u:User)-[w:WATCHED]->(m:Movie) WITH u.gender AS gender, w.watchCount AS watchCount RETURN gender, AVG(watchCount) AS averageWatchCount, COUNT(u) AS totalUsers\"\n                                                                                                                                                      ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "What is the average number of movies watched by male users from 'US' compared to female users from 'US'?",
    "Cypher": "MATCH (u:User {gender: 'Male', country: 'US'})-[w:WATCHED]->(m:Movie) WITH COUNT(m) AS MaleMovieCount MATCH (u2:User {gender: 'Female', country: 'US'})-[w2:WATCHED]->(m2:Movie) WITH MaleMovieCount, COUNT(m2) AS FemaleMovieCount RETURN (1.0 * MaleMovieCount) / (SELECT COUNT(u3:User {gender: 'Male', country: 'US'})) AS AvgMaleMovies, (1.0 * FemaleMovieCount) / (SELECT COUNT(u4:User {gender: 'Female', country: 'US'})) AS AvgFemaleMovies",
    "source_dataset": "er",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 268,
    "unique_id": "er_data_3_1_2_6_Complex_Aggregation_268",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'COUNT': expected an expression (line 1, column 269 (offset: 268))\n\"MATCH (u:User {gender: 'Male', country: 'US'})-[w:WATCHED]->(m:Movie) WITH COUNT(m) AS MaleMovieCount MATCH (u2:User {gender: 'Female', country: 'US'})-[w2:WATCHED]->(m2:Movie) WITH MaleMovieCount, COUNT(m2) AS FemaleMovieCount RETURN (1.0 * MaleMovieCount) / (SELECT COUNT(u3:User {gender: 'Male', country: 'US'})) AS AvgMaleMovies, (1.0 * FemaleMovieCount) / (SELECT COUNT(u4:User {gender: 'Female', country: 'US'})) AS AvgFemaleMovies\"\n                                                                                                                                                                                                                                                                             ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each state in the 'US', what is the average number of movies watched by users from that state, and what is the total number of distinct genres watched by these users?",
    "Cypher": "MATCH (u:User {country: 'US'})-[w:WATCHED]->(m:Movie)-[:HAS]->(g:Genre) WITH u.state AS State, u, m, g MATCH (u)-[w2:WATCHED]->(m2:Movie) WITH State, u, COLLECT(DISTINCT g.name) AS Genres, COUNT(m2) AS MovieCount RETURN State, (1.0 * MovieCount) / (SELECT COUNT(u2:User {country: 'US', state: State}) WHERE u2.state IS NOT NULL) AS AvgMoviesWatched, SIZE(Genres) AS DistinctGenresWatched",
    "source_dataset": "er",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 269,
    "unique_id": "er_data_3_1_2_6_Complex_Aggregation_269",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'COUNT': expected an expression (line 1, column 257 (offset: 256))\n\"MATCH (u:User {country: 'US'})-[w:WATCHED]->(m:Movie)-[:HAS]->(g:Genre) WITH u.state AS State, u, m, g MATCH (u)-[w2:WATCHED]->(m2:Movie) WITH State, u, COLLECT(DISTINCT g.name) AS Genres, COUNT(m2) AS MovieCount RETURN State, (1.0 * MovieCount) / (SELECT COUNT(u2:User {country: 'US', state: State}) WHERE u2.state IS NOT NULL) AS AvgMoviesWatched, SIZE(Genres) AS DistinctGenresWatched\"\n                                                                                                                                                                                                                                                                 ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "What is the average number of movies watched by users using a specific IP address?",
    "Cypher": "MATCH (u:User)-[:WATCHED]->(m:Movie), (u)-[:USES]->(ip:IpAddress) RETURN ip.address AS IpAddress, AVG(w.watchCount) AS AverageWatchCount",
    "source_dataset": "er",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 283,
    "unique_id": "er_data_3_1_2_6_Complex_Aggregation_283",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `w` not defined (line 1, column 103 (offset: 102))\n\"MATCH (u:User)-[:WATCHED]->(m:Movie), (u)-[:USES]->(ip:IpAddress) RETURN ip.address AS IpAddress, AVG(w.watchCount) AS AverageWatchCount\"\n                                                                                                       ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "What is the most common genre among users who use the IP address '229.123.59.185'?",
    "Cypher": "MATCH (u:User)-[:USES]->(ip:IpAddress {address: '229.123.59.185'})-[w:WATCHED]->(m:Movie)-[:HAS]->(g:Genre) WITH g.name AS genreName, COUNT(*) AS genreCount ORDER BY genreCount DESC LIMIT 1 RETURN genreName",
    "source_dataset": "er",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 291,
    "unique_id": "er_data_3_1_2_6_Complex_Aggregation_291",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "What is the average number of movies watched by users using each distinct IP address? Return the IP address and the average number of movies watched, ordered by the average number of movies in descending order.",
    "Cypher": "MATCH (u:User)-[:USES]->(ip:IpAddress)-[:WATCHED]->(m:Movie) WITH ip.address AS IpAddress, COUNT(m) AS MovieCount RETURN IpAddress, AVG(MovieCount) AS AverageMoviesWatched ORDER BY AverageMoviesWatched DESC",
    "source_dataset": "er",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 296,
    "unique_id": "er_data_3_1_2_6_Complex_Aggregation_296",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "What is the average number of movies watched by users using each distinct IP address, and what is the total number of users who have used each IP address?",
    "Cypher": "MATCH (u:User)-[:USES]->(ip:IpAddress)-[:WATCHED]-(m:Movie) WITH ip.address AS ipAddress, u, COUNT(m) AS watchedCount RETURN ipAddress, AVG(watchedCount) AS averageWatched, COUNT(DISTINCT u) AS distinctUserCount ORDER BY ipAddress",
    "source_dataset": "er",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 303,
    "unique_id": "er_data_3_1_2_6_Complex_Aggregation_303",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "What is the average watch count for movies released each year, grouped by genre, and what is the maximum average watch count across all genres for each year?",
    "Cypher": "MATCH (m:Movie)-[:HAS]->(g:Genre)<-[w:WATCHED]-(u:User) WITH m.year AS year, g.name AS genre, AVG(w.watchCount) AS avgWatchCount WITH year, genre, avgWatchCount ORDER BY avgWatchCount DESC WITH year, COLLECT({genre: genre, avgWatchCount: avgWatchCount})[0] AS topGenre RETURN year, topGenre.genre AS topGenre, topGenre.avgWatchCount AS maxAvgWatchCount",
    "source_dataset": "er",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 318,
    "unique_id": "er_data_3_1_2_6_Complex_Aggregation_318",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "What is the total number of movies watched by users using each unique IP address, and what is the average watch count for those users?",
    "Cypher": "MATCH (u:User)-[w:WATCHED]->(m:Movie), (u)-[:USES]->(ip:IpAddress) WITH ip.address AS ipAddress, u, w.watchCount AS watchCount RETURN ipAddress, COUNT(m) AS totalMoviesWatched, AVG(watchCount) AS averageWatchCount",
    "source_dataset": "er",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 338,
    "unique_id": "er_data_3_1_2_6_Complex_Aggregation_338",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `m` not defined (line 1, column 152 (offset: 151))\n\"MATCH (u:User)-[w:WATCHED]->(m:Movie), (u)-[:USES]->(ip:IpAddress) WITH ip.address AS ipAddress, u, w.watchCount AS watchCount RETURN ipAddress, COUNT(m) AS totalMoviesWatched, AVG(watchCount) AS averageWatchCount\"\n                                                                                                                                                        ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each movie genre, what is the average number of movies watched by users from each country? Return the genre and the average number of movies watched per user per country.",
    "Cypher": "MATCH (u:User)-[w:WATCHED]->(m:Movie)-[:HAS]->(g:Genre) WITH g.name AS genre, u.country AS country, m RETURN genre, country, COUNT(m) AS movieCount RETURN genre, country, AVG(movieCount) AS averageMoviesWatched",
    "source_dataset": "er",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 340,
    "unique_id": "er_data_3_1_2_6_Complex_Aggregation_340",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: RETURN can only be used at the end of the query. (line 1, column 103 (offset: 102))\n\"MATCH (u:User)-[w:WATCHED]->(m:Movie)-[:HAS]->(g:Genre) WITH g.name AS genre, u.country AS country, m RETURN genre, country, COUNT(m) AS movieCount RETURN genre, country, AVG(movieCount) AS averageMoviesWatched\"\n                                                                                                       ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "What is the average number of movies watched by users using each unique IP address?",
    "Cypher": "MATCH (u:User)-[:USES]->(ip:IpAddress)-[:WATCHED]->(m:Movie) WITH ip.address AS IPAddress, u, COUNT(m) AS MovieCount RETURN IPAddress, AVG(MovieCount) AS AverageMoviesWatched",
    "source_dataset": "er",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 345,
    "unique_id": "er_data_3_1_2_6_Complex_Aggregation_345",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each state, what is the average number of movies watched by users, and what is the average number of distinct genres they have watched?",
    "Cypher": "MATCH (u:User)-[w:WATCHED]->(m:Movie)-[:HAS]->(g:Genre) RETURN u.state AS State, AVG(w.watchCount) AS AverageMoviesWatched, AVG(COUNT(DISTINCT g)) AS AverageDistinctGenresWatched",
    "source_dataset": "er",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 347,
    "unique_id": "er_data_3_1_2_6_Complex_Aggregation_347",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Can't use aggregate functions inside of aggregate functions. (line 1, column 129 (offset: 128))\n\"MATCH (u:User)-[w:WATCHED]->(m:Movie)-[:HAS]->(g:Genre) RETURN u.state AS State, AVG(w.watchCount) AS AverageMoviesWatched, AVG(COUNT(DISTINCT g)) AS AverageDistinctGenresWatched\"\n                                                                                                                                 ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "What is the average number of movies watched by users who use a specific IP address? Return the IP address and the average number of movies watched.",
    "Cypher": "MATCH (u:User)-[:USES]->(ip:IpAddress)-[:WATCHED]->(m:Movie) WITH ip, COUNT(m) AS movieCount RETURN ip.address AS IPAddress, AVG(movieCount) AS AverageMoviesWatched",
    "source_dataset": "er",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 373,
    "unique_id": "er_data_3_1_2_6_Complex_Aggregation_373",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "What is the total number of movies watched by users using each unique IP address?",
    "Cypher": "MATCH (u:User)-[:USES]->(ip:IpAddress)-[:WATCHED]->(m:Movie) RETURN ip.address AS IpAddress, COUNT(m) AS TotalMoviesWatched",
    "source_dataset": "er",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 387,
    "unique_id": "er_data_3_1_2_6_Complex_Aggregation_387",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each movie genre, find the user with the highest watchCount and the average watchCount for all users who watched movies of that genre.",
    "Cypher": "MATCH (u:User)-[w:WATCHED]->(m:Movie)-[:HAS]->(g:Genre) WITH g.name AS Genre, u, w.watchCount ORDER BY w.watchCount DESC WITH Genre, COLLECT({user: u, watchCount: w.watchCount}) AS UserWatchCounts UNWIND UserWatchCounts AS UserWatchCount WITH Genre, UserWatchCount.user AS User, UserWatchCount.watchCount AS WatchCount WITH Genre, User, WatchCount, COLLECT(WatchCount) AS AllWatchCounts RETURN Genre, User.firstName + ' ' + User.lastName AS UserFullName, WatchCount AS MaxWatchCount, AVG(toFloat(WatchCount)) AS AverageWatchCount",
    "source_dataset": "er",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 389,
    "unique_id": "er_data_3_1_2_6_Complex_Aggregation_389",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Expression in WITH must be aliased (use AS) (line 1, column 82 (offset: 81))\n\"MATCH (u:User)-[w:WATCHED]->(m:Movie)-[:HAS]->(g:Genre) WITH g.name AS Genre, u, w.watchCount ORDER BY w.watchCount DESC WITH Genre, COLLECT({user: u, watchCount: w.watchCount}) AS UserWatchCounts UNWIND UserWatchCounts AS UserWatchCount WITH Genre, UserWatchCount.user AS User, UserWatchCount.watchCount AS WatchCount WITH Genre, User, WatchCount, COLLECT(WatchCount) AS AllWatchCounts RETURN Genre, User.firstName + ' ' + User.lastName AS UserFullName, WatchCount AS MaxWatchCount, AVG(toFloat(WatchCount)) AS AverageWatchCount\"\n                                                                                  ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each genre, what is the average year of the movies associated with it, and how many movies are associated with each genre?",
    "Cypher": "MATCH (m:Movie)-[:HAS]->(g:Genre) WITH g.name AS genreName, AVG(m.year) AS avgYear, COUNT(m) AS movieCount WHERE m.year IS NOT NULL RETURN genreName, avgYear, movieCount",
    "source_dataset": "er",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 414,
    "unique_id": "er_data_3_1_2_6_Complex_Aggregation_414",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: In a WITH/RETURN with DISTINCT or an aggregation, it is not possible to access variables declared before the WITH/RETURN: m (line 1, column 114 (offset: 113))\n\"MATCH (m:Movie)-[:HAS]->(g:Genre) WITH g.name AS genreName, AVG(m.year) AS avgYear, COUNT(m) AS movieCount WHERE m.year IS NOT NULL RETURN genreName, avgYear, movieCount\"\n                                                                                                                  ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "What is the maximum and minimum watchCount for movies watched by users, grouped by the gender of the users?",
    "Cypher": "MATCH (u:User)-[w:WATCHED]->(m:Movie) WITH u.gender AS gender, MAX(w.watchCount) AS maxWatchCount, MIN(w.watchCount) AS minWatchCount WHERE w.watchCount IS NOT NULL RETURN gender, maxWatchCount, minWatchCount",
    "source_dataset": "er",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 415,
    "unique_id": "er_data_3_1_2_6_Complex_Aggregation_415",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: In a WITH/RETURN with DISTINCT or an aggregation, it is not possible to access variables declared before the WITH/RETURN: w (line 1, column 141 (offset: 140))\n\"MATCH (u:User)-[w:WATCHED]->(m:Movie) WITH u.gender AS gender, MAX(w.watchCount) AS maxWatchCount, MIN(w.watchCount) AS minWatchCount WHERE w.watchCount IS NOT NULL RETURN gender, maxWatchCount, minWatchCount\"\n                                                                                                                                             ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each movie, what is the average watchCount by users and the number of distinct countries of the users who watched it?",
    "Cypher": "MATCH (u:User)-[w:WATCHED]->(m:Movie) WITH m.title AS movieTitle, AVG(w.watchCount) AS avgWatchCount, COUNT(DISTINCT u.country) AS distinctCountryCount WHERE w.watchCount IS NOT NULL RETURN movieTitle, avgWatchCount, distinctCountryCount",
    "source_dataset": "er",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 417,
    "unique_id": "er_data_3_1_2_6_Complex_Aggregation_417",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: In a WITH/RETURN with DISTINCT or an aggregation, it is not possible to access variables declared before the WITH/RETURN: w (line 1, column 159 (offset: 158))\n\"MATCH (u:User)-[w:WATCHED]->(m:Movie) WITH m.title AS movieTitle, AVG(w.watchCount) AS avgWatchCount, COUNT(DISTINCT u.country) AS distinctCountryCount WHERE w.watchCount IS NOT NULL RETURN movieTitle, avgWatchCount, distinctCountryCount\"\n                                                                                                                                                               ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "What is the average number of distinct genres watched by users who use the IP address '133.198.156.5'?",
    "Cypher": "MATCH (u:User)-[:USES]->(ip:IpAddress {address: '133.198.156.5'})-[w:WATCHED]->(m:Movie)-[:HAS]->(g:Genre) WITH u, COLLECT(DISTINCT g.name) AS genres RETURN AVG(SIZE(genres)) AS averageDistinctGenres",
    "source_dataset": "er",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 422,
    "unique_id": "er_data_3_1_2_6_Complex_Aggregation_422",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Content: Results only contain null or zero values.",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "Results returned successfully.",
    "neo4j_result_passed": 1,
    "content_validation": "Results only contain null or zero values.",
    "content_passed": 0
  },
  {
    "NL Question": "For each state, what is the average number of movies watched by female users compared to male users?",
    "Cypher": "MATCH (u:User)-[w:WATCHED]->(m:Movie) WITH u.state AS state, u.gender AS gender, COUNT(m) AS movieCount WITH state, gender, AVG(movieCount) AS avgMovieCount GROUP BY state RETURN state, AVG(CASE WHEN gender = 'Female' THEN avgMovieCount ELSE null END) AS avgFemaleMovies, AVG(CASE WHEN gender = 'Male' THEN avgMovieCount ELSE null END) AS avgMaleMovies",
    "source_dataset": "er",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 423,
    "unique_id": "er_data_3_1_2_6_Complex_Aggregation_423",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'GROUP': expected 'FOREACH', ',', 'ORDER BY', 'CALL', 'CREATE', 'LOAD CSV', 'DELETE', 'DETACH', 'FINISH', 'INSERT', 'LIMIT', 'MATCH', 'MERGE', 'NODETACH', 'OFFSET', 'OPTIONAL', 'REMOVE', 'RETURN', 'SET', 'SKIP', 'UNION', 'UNWIND', 'USE', 'WHERE', 'WITH' or <EOF> (line 1, column 158 (offset: 157))\n\"MATCH (u:User)-[w:WATCHED]->(m:Movie) WITH u.state AS state, u.gender AS gender, COUNT(m) AS movieCount WITH state, gender, AVG(movieCount) AS avgMovieCount GROUP BY state RETURN state, AVG(CASE WHEN gender = 'Female' THEN avgMovieCount ELSE null END) AS avgFemaleMovies, AVG(CASE WHEN gender = 'Male' THEN avgMovieCount ELSE null END) AS avgMaleMovies\"\n                                                                                                                                                              ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "What is the average number of times a movie has been watched by users who use a specific IP address, and what is the total number of users who use that IP address?",
    "Cypher": "MATCH (u:User)-[:USES]->(ip:IpAddress {address: '237.17.123.33'})-[w:WATCHED]->(m:Movie) WITH ip, COUNT(w) AS watchCount, u WITH ip, AVG(watchCount) AS avgWatchCount, COLLECT(DISTINCT u) AS distinctUsers RETURN ip.address, avgWatchCount, SIZE(distinctUsers) AS totalUsers",
    "source_dataset": "er",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 445,
    "unique_id": "er_data_3_1_2_6_Complex_Aggregation_445",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each combination of genre and country, what is the average number of movies watched and the total number of users?",
    "Cypher": "MATCH (u:User)-[w:WATCHED]->(m:Movie)-[:HAS]->(g:Genre) WITH u.country AS country, g.name AS genre, w WITH country, genre, w, u MATCH (u)-[w:WATCHED]->(m:Movie)-[:HAS]->(g:Genre) WITH country, genre, AVG(w.watchCount) AS avgWatchCount, u RETURN country, genre, avgWatchCount, COUNT(DISTINCT u) AS totalUsers",
    "source_dataset": "er",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 452,
    "unique_id": "er_data_3_1_2_6_Complex_Aggregation_452",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `u` not defined (line 1, column 127 (offset: 126))\n\"MATCH (u:User)-[w:WATCHED]->(m:Movie)-[:HAS]->(g:Genre) WITH u.country AS country, g.name AS genre, w WITH country, genre, w, u MATCH (u)-[w:WATCHED]->(m:Movie)-[:HAS]->(g:Genre) WITH country, genre, AVG(w.watchCount) AS avgWatchCount, u RETURN country, genre, avgWatchCount, COUNT(DISTINCT u) AS totalUsers\"\n                                                                                                                               ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each genre, what is the average number of times a movie of that genre has been watched by users, and what is the total number of users who have watched movies of that genre?",
    "Cypher": "MATCH (g:Genre)<-[:HAS]-(m:Movie)<-[w:WATCHED]-(u:User) WITH g.name AS genre, m, SUM(w.watchCount) AS totalWatchCount, u RETURN genre, AVG(totalWatchCount) AS averageWatchCount, COUNT(DISTINCT u) AS totalUsers GROUP BY genre",
    "source_dataset": "er",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 463,
    "unique_id": "er_data_3_1_2_6_Complex_Aggregation_463",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'GROUP': expected 'FOREACH', ',', 'ORDER BY', 'CALL', 'CREATE', 'LOAD CSV', 'DELETE', 'DETACH', 'FINISH', 'INSERT', 'LIMIT', 'MATCH', 'MERGE', 'NODETACH', 'OFFSET', 'OPTIONAL', 'REMOVE', 'RETURN', 'SET', 'SKIP', 'UNION', 'UNWIND', 'USE', 'WITH' or <EOF> (line 1, column 211 (offset: 210))\n\"MATCH (g:Genre)<-[:HAS]-(m:Movie)<-[w:WATCHED]-(u:User) WITH g.name AS genre, m, SUM(w.watchCount) AS totalWatchCount, u RETURN genre, AVG(totalWatchCount) AS averageWatchCount, COUNT(DISTINCT u) AS totalUsers GROUP BY genre\"\n                                                                                                                                                                                                                   ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each state, what is the average number of movies watched by female users and the average number of movies watched by male users?",
    "Cypher": "MATCH (u:User)-[w:WATCHED]->(m:Movie) WITH u.state AS state, u.gender AS gender, COUNT(m) AS moviesWatched WHERE u.gender IS NOT NULL WITH state, gender, moviesWatched COLLECT({gender: gender, moviesWatched: moviesWatched}) AS genderData UNWIND genderData AS gd WITH state, gd.gender AS gender, gd.moviesWatched AS moviesWatched RETURN state, AVG(CASE WHEN gender = 'Female' THEN moviesWatched ELSE null END) AS avgMoviesWatchedFemale, AVG(CASE WHEN gender = 'Male' THEN moviesWatched ELSE null END) AS avgMoviesWatchedMale",
    "source_dataset": "er",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 479,
    "unique_id": "er_data_3_1_2_6_Complex_Aggregation_479",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'COLLECT': expected an expression, 'FOREACH', ',', 'AS', 'ORDER BY', 'CALL', 'CREATE', 'LOAD CSV', 'DELETE', 'DETACH', 'FINISH', 'INSERT', 'LIMIT', 'MATCH', 'MERGE', 'NODETACH', 'OFFSET', 'OPTIONAL', 'REMOVE', 'RETURN', 'SET', 'SKIP', 'UNION', 'UNWIND', 'USE', 'WHERE', 'WITH' or <EOF> (line 1, column 169 (offset: 168))\n\"MATCH (u:User)-[w:WATCHED]->(m:Movie) WITH u.state AS state, u.gender AS gender, COUNT(m) AS moviesWatched WHERE u.gender IS NOT NULL WITH state, gender, moviesWatched COLLECT({gender: gender, moviesWatched: moviesWatched}) AS genderData UNWIND genderData AS gd WITH state, gd.gender AS gender, gd.moviesWatched AS moviesWatched RETURN state, AVG(CASE WHEN gender = 'Female' THEN moviesWatched ELSE null END) AS avgMoviesWatchedFemale, AVG(CASE WHEN gender = 'Male' THEN moviesWatched ELSE null END) AS avgMoviesWatchedMale\"\n                                                                                                                                                                         ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each state, find the average number of movies watched per user from that state, and the total number of distinct genres watched by users from that state.",
    "Cypher": "MATCH (u:User)-[w:WATCHED]->(m:Movie)-[:HAS]->(g:Genre) WITH u.state AS state, u, m, g WHERE u.state IS NOT NULL WITH state, AVG(w.watchCount) AS avgWatchCount, COLLECT(DISTINCT g.name) AS distinctGenres RETURN state, avgWatchCount, SIZE(distinctGenres) AS distinctGenreCount",
    "source_dataset": "er",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 486,
    "unique_id": "er_data_3_1_2_6_Complex_Aggregation_486",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `w` not defined (line 1, column 130 (offset: 129))\n\"MATCH (u:User)-[w:WATCHED]->(m:Movie)-[:HAS]->(g:Genre) WITH u.state AS state, u, m, g WHERE u.state IS NOT NULL WITH state, AVG(w.watchCount) AS avgWatchCount, COLLECT(DISTINCT g.name) AS distinctGenres RETURN state, avgWatchCount, SIZE(distinctGenres) AS distinctGenreCount\"\n                                                                                                                                  ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "What is the average number of movies watched by users using a particular IP Address, and what is the total number of users using that IP Address?",
    "Cypher": "MATCH (u:User)-[:USES]->(ip:IpAddress)-[:WATCHED]-(m:Movie) WITH ip.address AS ipAddress, u, m WITH ipAddress, u, COLLECT(m) AS moviesWatchedPerUserPerIp WITH ipAddress, COUNT(DISTINCT moviesWatchedPerUserPerIp) AS distinctMovieCount, COUNT(u) AS totalUsersPerIp RETURN ipAddress, AVG(distinctMovieCount) AS averageMoviesWatched, totalUsersPerIp",
    "source_dataset": "er",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 515,
    "unique_id": "er_data_3_1_2_6_Complex_Aggregation_515",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "What is the average number of movies watched by users using each IP address, and what is the total number of distinct genres of movies watched by users using each IP address?",
    "Cypher": "MATCH (u:User)-[:USES]->(ip:IpAddress)-[w:WATCHED]->(m:Movie)-[:HAS]->(g:Genre) WITH ip.address AS ipAddress, COUNT(m) AS moviesWatched, COLLECT(DISTINCT g.name) AS genresWatched RETURN ipAddress, AVG(moviesWatched) AS averageMoviesWatched, SIZE(genresWatched) AS distinctGenreCount",
    "source_dataset": "er",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 9,
    "unique_id": "er_data_3_2_2_6_Complex_Aggregation_9",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "Which states have an average watch count greater than 2, and what is the total number of users in those states?",
    "Cypher": "MATCH (u:User)-[w:WATCHED]->(m:Movie) WITH u.state AS state, AVG(w.watchCount) AS averageWatchCount WHERE averageWatchCount > 2 WITH state, COUNT(u) AS totalUsers RETURN state, totalUsers",
    "source_dataset": "er",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 44,
    "unique_id": "er_data_3_2_2_6_Complex_Aggregation_44",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `u` not defined (line 1, column 147 (offset: 146))\n\"MATCH (u:User)-[w:WATCHED]->(m:Movie) WITH u.state AS state, AVG(w.watchCount) AS averageWatchCount WHERE averageWatchCount > 2 WITH state, COUNT(u) AS totalUsers RETURN state, totalUsers\"\n                                                                                                                                                   ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each genre, what is the average year of the movies belonging to that genre, and how many movies of that genre were released after the year 2000?",
    "Cypher": "MATCH (m:Movie)-[:HAS]->(g:Genre) WITH g.name AS genre, m WHERE m.year IS NOT NULL WITH genre, m.year AS movieYear WHERE movieYear > 2000 WITH genre, AVG(movieYear) AS avgYear, COUNT(m) AS moviesAfter2000 RETURN genre, avgYear, moviesAfter2000",
    "source_dataset": "er",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 50,
    "unique_id": "er_data_3_2_2_6_Complex_Aggregation_50",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `m` not defined (line 1, column 184 (offset: 183))\n\"MATCH (m:Movie)-[:HAS]->(g:Genre) WITH g.name AS genre, m WHERE m.year IS NOT NULL WITH genre, m.year AS movieYear WHERE movieYear > 2000 WITH genre, AVG(movieYear) AS avgYear, COUNT(m) AS moviesAfter2000 RETURN genre, avgYear, moviesAfter2000\"\n                                                                                                                                                                                        ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "What is the correlation between the year a movie was released and the average watch count of users who watched that movie?",
    "Cypher": "MATCH (u:User)-[w:WATCHED]->(m:Movie) WITH m.movieId AS movieId, m.year AS movieYear, AVG(w.watchCount) AS avgWatchCount WITH collect(movieYear) AS x, collect(avgWatchCount) AS y WITH reduce(accX = 0, n IN x | accX + n) AS sumX, reduce(accY = 0, n IN y | accY + n) AS sumY, reduce(accXY = 0, i IN range(0, size(x)-1) | accXY + x[i] * y[i]) AS sumXY, reduce(accX2 = 0, n IN x | accX2 + n^2) AS sumX2, reduce(accY2 = 0, n IN y | accY2 + n^2) AS sumY2, size(x) AS n RETURN (n * sumXY - sumX * sumY) / (sqrt(n * sumX2 - sumX^2) * sqrt(n * sumY2 - sumY^2)) AS correlation",
    "source_dataset": "er",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 53,
    "unique_id": "er_data_3_2_2_6_Complex_Aggregation_53",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Type mismatch: expected Float, Integer or Duration but was Number (line 1, column 509 (offset: 508))\n\"MATCH (u:User)-[w:WATCHED]->(m:Movie) WITH m.movieId AS movieId, m.year AS movieYear, AVG(w.watchCount) AS avgWatchCount WITH collect(movieYear) AS x, collect(avgWatchCount) AS y WITH reduce(accX = 0, n IN x | accX + n) AS sumX, reduce(accY = 0, n IN y | accY + n) AS sumY, reduce(accXY = 0, i IN range(0, size(x)-1) | accXY + x[i] * y[i]) AS sumXY, reduce(accX2 = 0, n IN x | accX2 + n^2) AS sumX2, reduce(accY2 = 0, n IN y | accY2 + n^2) AS sumY2, size(x) AS n RETURN (n * sumXY - sumX * sumY) / (sqrt(n * sumX2 - sumX^2) * sqrt(n * sumY2 - sumY^2)) AS correlation\"\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each state, what is the average number of movies watched by users, and what is the total number of distinct genres watched by users in that state?",
    "Cypher": "MATCH (u:User)-[w:WATCHED]->(m:Movie)-[:HAS]->(g:Genre) WITH u.state AS state, m, u WITH state, COUNT(m) AS moviesWatched, COLLECT(DISTINCT g.name) AS genresWatchedPerState, u RETURN state, AVG(moviesWatched) AS averageMoviesWatched, SIZE(genresWatchedPerState) AS totalGenresWatched",
    "source_dataset": "er",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 115,
    "unique_id": "er_data_3_2_2_6_Complex_Aggregation_115",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `g` not defined (line 1, column 141 (offset: 140))\n\"MATCH (u:User)-[w:WATCHED]->(m:Movie)-[:HAS]->(g:Genre) WITH u.state AS state, m, u WITH state, COUNT(m) AS moviesWatched, COLLECT(DISTINCT g.name) AS genresWatchedPerState, u RETURN state, AVG(moviesWatched) AS averageMoviesWatched, SIZE(genresWatchedPerState) AS totalGenresWatched\"\n                                                                                                                                             ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each state, what is the average number of times a user watches a movie, and what is the total number of users from that state who have watched at least one movie?",
    "Cypher": "MATCH (u:User)-[w:WATCHED]->(m:Movie) WITH u.state AS state, AVG(w.watchCount) AS avgWatchCount, COUNT(DISTINCT u) AS userCount WHERE w.watchCount > 0 RETURN state, avgWatchCount, userCount",
    "source_dataset": "er",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 141,
    "unique_id": "er_data_3_2_2_6_Complex_Aggregation_141",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: In a WITH/RETURN with DISTINCT or an aggregation, it is not possible to access variables declared before the WITH/RETURN: w (line 1, column 135 (offset: 134))\n\"MATCH (u:User)-[w:WATCHED]->(m:Movie) WITH u.state AS state, AVG(w.watchCount) AS avgWatchCount, COUNT(DISTINCT u) AS userCount WHERE w.watchCount > 0 RETURN state, avgWatchCount, userCount\"\n                                                                                                                                       ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "What is the average watch count for movies watched by users from each state, considering only users who have watched more than one movie?",
    "Cypher": "MATCH (u:User)-[w:WATCHED]->(m:Movie) WITH u.state AS state, u, COUNT(m) AS movieCount WHERE movieCount > 1 WITH state, AVG(w.watchCount) AS avgWatchCount RETURN state, avgWatchCount",
    "source_dataset": "er",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 147,
    "unique_id": "er_data_3_2_2_6_Complex_Aggregation_147",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `w` not defined (line 1, column 125 (offset: 124))\n\"MATCH (u:User)-[w:WATCHED]->(m:Movie) WITH u.state AS state, u, COUNT(m) AS movieCount WHERE movieCount > 1 WITH state, AVG(w.watchCount) AS avgWatchCount RETURN state, avgWatchCount\"\n                                                                                                                             ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "What is the average number of IpAddress used by users from each state, and what is the total number of users from that state who use at least one IpAddress?",
    "Cypher": "MATCH (u:User)-[:USES]->(ip:IpAddress) WITH u.state AS state, u, COUNT(DISTINCT ip) AS ipAddressesPerUser WITH state, AVG(ipAddressesPerUser) AS avgIpAddresses, COUNT(DISTINCT u) AS totalUsers FROM state RETURN state, avgIpAddresses, totalUsers",
    "source_dataset": "er",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 170,
    "unique_id": "er_data_3_2_2_6_Complex_Aggregation_170",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'FROM': expected 'FOREACH', ',', 'ORDER BY', 'CALL', 'CREATE', 'LOAD CSV', 'DELETE', 'DETACH', 'FINISH', 'INSERT', 'LIMIT', 'MATCH', 'MERGE', 'NODETACH', 'OFFSET', 'OPTIONAL', 'REMOVE', 'RETURN', 'SET', 'SKIP', 'UNION', 'UNWIND', 'USE', 'WHERE', 'WITH' or <EOF> (line 1, column 194 (offset: 193))\n\"MATCH (u:User)-[:USES]->(ip:IpAddress) WITH u.state AS state, u, COUNT(DISTINCT ip) AS ipAddressesPerUser WITH state, AVG(ipAddressesPerUser) AS avgIpAddresses, COUNT(DISTINCT u) AS totalUsers FROM state RETURN state, avgIpAddresses, totalUsers\"\n                                                                                                                                                                                                  ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each country, what is the average number of distinct genres watched by users, and what is the total number of movies watched across all genres?",
    "Cypher": "MATCH (u:User)-[w:WATCHED]->(m:Movie)-[:HAS]->(g:Genre) WITH u.country AS country, u, g WITH country, u, COUNT(DISTINCT g.name) AS distinctGenresWatchedByUser WITH country, AVG(distinctGenresWatchedByUser) AS avgDistinctGenres, g MATCH (u:User)-[w:WATCHED]->(m:Movie) WITH country, avgDistinctGenres, COUNT(m) AS totalMoviesWatched RETURN country, avgDistinctGenres, totalMoviesWatched",
    "source_dataset": "er",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 171,
    "unique_id": "er_data_3_2_2_6_Complex_Aggregation_171",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `g` not defined (line 1, column 229 (offset: 228))\n\"MATCH (u:User)-[w:WATCHED]->(m:Movie)-[:HAS]->(g:Genre) WITH u.country AS country, u, g WITH country, u, COUNT(DISTINCT g.name) AS distinctGenresWatchedByUser WITH country, AVG(distinctGenresWatchedByUser) AS avgDistinctGenres, g MATCH (u:User)-[w:WATCHED]->(m:Movie) WITH country, avgDistinctGenres, COUNT(m) AS totalMoviesWatched RETURN country, avgDistinctGenres, totalMoviesWatched\"\n                                                                                                                                                                                                                                     ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "What is the average watch count for movies watched by users who use a specific IP address, grouped by the state of the users?",
    "Cypher": "MATCH (u:User)-[uses:USES]->(ip:IpAddress)-[w:WATCHED]->(m:Movie) WITH u.state AS state, w.watchCount AS watchCount RETURN state, AVG(watchCount) AS averageWatchCount",
    "source_dataset": "er",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 177,
    "unique_id": "er_data_3_2_2_6_Complex_Aggregation_177",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each state, what is the average number of movies watched by users, and what is the average number of IpAddresses used by users?",
    "Cypher": "MATCH (u:User)-[w:WATCHED]->(m:Movie) WITH u.state AS state, u, COUNT(m) AS moviesWatched MATCH (u)-[uses:USES]->(ip:IpAddress) WITH state, AVG(moviesWatched) AS avgMoviesWatched, COUNT(DISTINCT ip) AS distinctIpAddresses WHERE u.state IS NOT NULL RETURN state, avgMoviesWatched, AVG(distinctIpAddresses) AS averageIpAddressesUsed",
    "source_dataset": "er",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 206,
    "unique_id": "er_data_3_2_2_6_Complex_Aggregation_206",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: In a WITH/RETURN with DISTINCT or an aggregation, it is not possible to access variables declared before the WITH/RETURN: u (line 1, column 229 (offset: 228))\n\"MATCH (u:User)-[w:WATCHED]->(m:Movie) WITH u.state AS state, u, COUNT(m) AS moviesWatched MATCH (u)-[uses:USES]->(ip:IpAddress) WITH state, AVG(moviesWatched) AS avgMoviesWatched, COUNT(DISTINCT ip) AS distinctIpAddresses WHERE u.state IS NOT NULL RETURN state, avgMoviesWatched, AVG(distinctIpAddresses) AS averageIpAddressesUsed\"\n                                                                                                                                                                                                                                     ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each genre, what is the average watch count of movies in that genre, considering only users who use the IP address '54.198.113.41'?",
    "Cypher": "MATCH (u:User)-[:USES]->(i:IpAddress {address: '54.198.113.41'})-[w:WATCHED]->(m:Movie)-[:HAS]->(g:Genre) RETURN g.name AS genre, avg(w.watchCount) AS averageWatchCount",
    "source_dataset": "er",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 211,
    "unique_id": "er_data_3_2_2_6_Complex_Aggregation_211",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "What is the average number of movies watched by users from each state who use a specific IP address '211.6.192.145'? Return the state and the average number of movies watched.",
    "Cypher": "MATCH (u:User)-[:USES]->(ip:IpAddress {address: '211.6.192.145'})-[w:WATCHED]->(m:Movie) RETURN u.state AS State, COUNT(m) AS NumberOfMoviesWatched",
    "source_dataset": "er",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 247,
    "unique_id": "er_data_3_2_2_6_Complex_Aggregation_247",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "What is the average watch count for movies watched by users who use a specific IP address, grouped by the genre of the movie?",
    "Cypher": "MATCH (u:User)-[:USES]->(ip:IpAddress {address: '169.230.198.192'})-[w:WATCHED]->(m:Movie)-[:HAS]->(g:Genre) RETURN g.name AS genre, AVG(w.watchCount) AS averageWatchCount",
    "source_dataset": "er",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 263,
    "unique_id": "er_data_3_2_2_6_Complex_Aggregation_263",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each genre, what is the average year of movies in that genre, considering only movies watched by users who use the IP address '43.225.45.58'?",
    "Cypher": "MATCH (u:User)-[:USES]->(ip:IpAddress {address: '43.225.45.58'})-[w:WATCHED]->(m:Movie)-[:HAS]->(g:Genre) WITH g.name AS genre, m.year AS movieYear RETURN genre, AVG(movieYear)",
    "source_dataset": "er",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 288,
    "unique_id": "er_data_3_2_2_6_Complex_Aggregation_288",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "What is the average watchCount for movies watched by users who use the IP address '143.112.72.245'?",
    "Cypher": "MATCH (u:User)-[:USES]->(ip:IpAddress {address: '143.112.72.245'})-[w:WATCHED]->(m:Movie) RETURN AVG(w.watchCount) AS averageWatchCount",
    "source_dataset": "er",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 304,
    "unique_id": "er_data_3_2_2_6_Complex_Aggregation_304",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Content: Results only contain null or zero values.",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "Results returned successfully.",
    "neo4j_result_passed": 1,
    "content_validation": "Results only contain null or zero values.",
    "content_passed": 0
  },
  {
    "NL Question": "For each movie genre, what is the average number of times a movie of that genre has been watched, and what is the total number of users who have watched movies of that genre?",
    "Cypher": "MATCH (g:Genre)<-[:HAS]-(m:Movie)<-[w:WATCHED]-(u:User) WITH g.name AS genre, COUNT(DISTINCT u) AS userCount, SUM(w.watchCount) AS totalWatchCount WHERE w.watchCount IS NOT NULL RETURN genre, AVG(w.watchCount) AS averageWatchCount, userCount",
    "source_dataset": "er",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 337,
    "unique_id": "er_data_3_2_2_6_Complex_Aggregation_337",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: In a WITH/RETURN with DISTINCT or an aggregation, it is not possible to access variables declared before the WITH/RETURN: w (line 1, column 154 (offset: 153))\n\"MATCH (g:Genre)<-[:HAS]-(m:Movie)<-[w:WATCHED]-(u:User) WITH g.name AS genre, COUNT(DISTINCT u) AS userCount, SUM(w.watchCount) AS totalWatchCount WHERE w.watchCount IS NOT NULL RETURN genre, AVG(w.watchCount) AS averageWatchCount, userCount\"\n                                                                                                                                                          ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each gender, what is the average number of movies watched per user, and what is the total number of users of that gender?",
    "Cypher": "MATCH (u:User)-[w:WATCHED]->(m:Movie) WITH u.gender AS gender, COUNT(m) AS movieCount, COUNT(DISTINCT u) AS userCount WHERE w.watchCount IS NOT NULL RETURN gender, AVG(w.watchCount) AS averageWatchCount, userCount",
    "source_dataset": "er",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 339,
    "unique_id": "er_data_3_2_2_6_Complex_Aggregation_339",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: In a WITH/RETURN with DISTINCT or an aggregation, it is not possible to access variables declared before the WITH/RETURN: w (line 1, column 125 (offset: 124))\n\"MATCH (u:User)-[w:WATCHED]->(m:Movie) WITH u.gender AS gender, COUNT(m) AS movieCount, COUNT(DISTINCT u) AS userCount WHERE w.watchCount IS NOT NULL RETURN gender, AVG(w.watchCount) AS averageWatchCount, userCount\"\n                                                                                                                             ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "What is the average watch count for movies released in each year, and how many distinct users watched movies released in each year?",
    "Cypher": "MATCH (u:User)-[w:WATCHED]->(m:Movie) WITH m.year AS movieYear, COUNT(DISTINCT u) AS userCount, SUM(w.watchCount) AS totalWatchCount WHERE w.watchCount IS NOT NULL RETURN movieYear, AVG(w.watchCount) AS averageWatchCount, userCount",
    "source_dataset": "er",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 340,
    "unique_id": "er_data_3_2_2_6_Complex_Aggregation_340",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: In a WITH/RETURN with DISTINCT or an aggregation, it is not possible to access variables declared before the WITH/RETURN: w (line 1, column 140 (offset: 139))\n\"MATCH (u:User)-[w:WATCHED]->(m:Movie) WITH m.year AS movieYear, COUNT(DISTINCT u) AS userCount, SUM(w.watchCount) AS totalWatchCount WHERE w.watchCount IS NOT NULL RETURN movieYear, AVG(w.watchCount) AS averageWatchCount, userCount\"\n                                                                                                                                            ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "What is the average number of times a movie of each genre is watched by users from the US, and how many distinct users from the US watched each genre?",
    "Cypher": "MATCH (u:User)-[w:WATCHED]->(m:Movie)-[:HAS]->(g:Genre) WHERE u.country = 'US' WITH g.name AS genre, w.watchCount AS watchCount, u WITH genre, AVG(watchCount) AS averageWatchCount, COUNT(DISTINCT u) AS distinctUsers FROM US RETURN genre, averageWatchCount, distinctUsers",
    "source_dataset": "er",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 347,
    "unique_id": "er_data_3_2_2_6_Complex_Aggregation_347",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'FROM': expected 'FOREACH', ',', 'ORDER BY', 'CALL', 'CREATE', 'LOAD CSV', 'DELETE', 'DETACH', 'FINISH', 'INSERT', 'LIMIT', 'MATCH', 'MERGE', 'NODETACH', 'OFFSET', 'OPTIONAL', 'REMOVE', 'RETURN', 'SET', 'SKIP', 'UNION', 'UNWIND', 'USE', 'WHERE', 'WITH' or <EOF> (line 1, column 217 (offset: 216))\n\"MATCH (u:User)-[w:WATCHED]->(m:Movie)-[:HAS]->(g:Genre) WHERE u.country = 'US' WITH g.name AS genre, w.watchCount AS watchCount, u WITH genre, AVG(watchCount) AS averageWatchCount, COUNT(DISTINCT u) AS distinctUsers FROM US RETURN genre, averageWatchCount, distinctUsers\"\n                                                                                                                                                                                                                         ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "What is the average number of movies watched by users using a specific IP address, and how many distinct users use each IP address?",
    "Cypher": "MATCH (u:User)-[:USES]->(ip:IpAddress)-[:WATCHED]-(m:Movie) WITH ip, u, COUNT(m) AS moviesWatched RETURN ip.address AS ipAddress, AVG(moviesWatched) AS averageMoviesWatched, COUNT(DISTINCT u) AS distinctUsers ORDER BY distinctUsers DESC",
    "source_dataset": "er",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 359,
    "unique_id": "er_data_3_2_2_6_Complex_Aggregation_359",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "What is the average number of movies watched by users from each country, grouped by the decade in which the movie was released?",
    "Cypher": "MATCH (u:User)-[w:WATCHED]->(m:Movie) WITH u.country AS country, (m.year - (m.year % 10)) AS decade, u RETURN country, decade, count(m) AS movieCount WITH country, decade, avg(movieCount) AS avgMovieCount RETURN country, decade, avgMovieCount",
    "source_dataset": "er",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 368,
    "unique_id": "er_data_3_2_2_6_Complex_Aggregation_368",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `m` not defined (line 1, column 134 (offset: 133))\n\"MATCH (u:User)-[w:WATCHED]->(m:Movie) WITH u.country AS country, (m.year - (m.year % 10)) AS decade, u RETURN country, decade, count(m) AS movieCount WITH country, decade, avg(movieCount) AS avgMovieCount RETURN country, decade, avgMovieCount\"\n                                                                                                                                      ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each genre, what is the average watchCount of movies in that genre, considering only users who use the IP address '210.193.25.57'?",
    "Cypher": "MATCH (u:User)-[:USES]->(ip:IpAddress {address: '210.193.25.57'})-[w:WATCHED]->(m:Movie)-[:HAS]->(g:Genre) RETURN g.name AS genre, AVG(w.watchCount) AS averageWatchCount",
    "source_dataset": "er",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 379,
    "unique_id": "er_data_3_2_2_6_Complex_Aggregation_379",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "What is the average year of movies watched by users, grouped by the gender of the user and only considering users who have watched more than one movie?",
    "Cypher": "MATCH (u:User)-[w:WATCHED]->(m:Movie) WITH u.gender AS gender, u, COUNT(m) AS watchedCount WHERE watchedCount > 1 WITH gender, AVG(m.year) AS averageMovieYear RETURN gender, averageMovieYear",
    "source_dataset": "er",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 381,
    "unique_id": "er_data_3_2_2_6_Complex_Aggregation_381",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `m` not defined (line 1, column 132 (offset: 131))\n\"MATCH (u:User)-[w:WATCHED]->(m:Movie) WITH u.gender AS gender, u, COUNT(m) AS watchedCount WHERE watchedCount > 1 WITH gender, AVG(m.year) AS averageMovieYear RETURN gender, averageMovieYear\"\n                                                                                                                                    ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "What is the correlation between the year a movie was released and the average watch count of that movie?",
    "Cypher": "MATCH (m:Movie)<-[w:WATCHED]-(u:User) WITH m.year AS movieYear, m, AVG(w.watchCount) AS averageWatchCount WITH COLLECT(movieYear) AS years, COLLECT(averageWatchCount) AS watchCounts WITH toFloat(REDUCE (s = 0, i IN Range(0, size(years)-1) | s + (years[i] - avg(years)) * (watchCounts[i] - avg(watchCounts)))) / stDevP(years) / stDevP(watchCounts) AS correlation RETURN correlation",
    "source_dataset": "er",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 396,
    "unique_id": "er_data_3_2_2_6_Complex_Aggregation_396",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid use of aggregating function avg(...) in this context (line 1, column 258 (offset: 257))\n\"MATCH (m:Movie)<-[w:WATCHED]-(u:User) WITH m.year AS movieYear, m, AVG(w.watchCount) AS averageWatchCount WITH COLLECT(movieYear) AS years, COLLECT(averageWatchCount) AS watchCounts WITH toFloat(REDUCE (s = 0, i IN Range(0, size(years)-1) | s + (years[i] - avg(years)) * (watchCounts[i] - avg(watchCounts)))) / stDevP(years) / stDevP(watchCounts) AS correlation RETURN correlation\"\n                                                                                                                                                                                                                                                                  ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "What is the average number of movies watched by users who use the IP address '230.198.93.117'?",
    "Cypher": "MATCH (u:User)-[:USES]->(ip:IpAddress {address: '230.198.93.117'})-[w:WATCHED]->(m:Movie) RETURN avg(w.watchCount) AS averageWatchCount",
    "source_dataset": "er",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 399,
    "unique_id": "er_data_3_2_2_6_Complex_Aggregation_399",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Content: Results only contain null or zero values.",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "Results returned successfully.",
    "neo4j_result_passed": 1,
    "content_validation": "Results only contain null or zero values.",
    "content_passed": 0
  },
  {
    "NL Question": "What is the average number of movies watched by users using each IP address, and what is the total number of distinct genres watched by users of each IP address?",
    "Cypher": "MATCH (u:User)-[:USES]->(ip:IpAddress)-[:WATCHED]->(m:Movie)-[:HAS]->(g:Genre) WITH ip.address AS ipAddress, u, m, g WITH ipAddress, u, COUNT(m) AS moviesWatched, COLLECT(DISTINCT g.name) AS genresWatched WITH ipAddress, AVG(moviesWatched) AS avgMoviesWatched, SIZE(genresWatched) AS distinctGenreCount RETURN ipAddress, avgMoviesWatched, distinctGenreCount",
    "source_dataset": "er",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 422,
    "unique_id": "er_data_3_2_2_6_Complex_Aggregation_422",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "What is the average number of distinct genres watched by users from each state, and what is the average number of movies watched by those users?",
    "Cypher": "MATCH (u:User)-[w:WATCHED]->(m:Movie)-[:HAS]->(g:Genre) WITH u.state AS state, u, g WITH state, u, COUNT(DISTINCT g.name) AS distinctGenresWatched, COLLECT(m) AS moviesWatchedPerUser WHERE u.state IS NOT NULL WITH state, AVG(distinctGenresWatched) AS averageDistinctGenres, AVG(SIZE(moviesWatchedPerUser)) AS averageMoviesWatchedPerUser RETURN state, averageDistinctGenres, averageMoviesWatchedPerUser",
    "source_dataset": "er",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 429,
    "unique_id": "er_data_3_2_2_6_Complex_Aggregation_429",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Variable `m` not defined (line 1, column 157 (offset: 156))\n\"MATCH (u:User)-[w:WATCHED]->(m:Movie)-[:HAS]->(g:Genre) WITH u.state AS state, u, g WITH state, u, COUNT(DISTINCT g.name) AS distinctGenresWatched, COLLECT(m) AS moviesWatchedPerUser WHERE u.state IS NOT NULL WITH state, AVG(distinctGenresWatched) AS averageDistinctGenres, AVG(SIZE(moviesWatchedPerUser)) AS averageMoviesWatchedPerUser RETURN state, averageDistinctGenres, averageMoviesWatchedPerUser\"\n                                                                                                                                                             ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "What is the average number of movies watched by male and female users from each state, and how many users of each gender are in each state?",
    "Cypher": "MATCH (u:User)-[w:WATCHED]->(m:Movie) WITH u.state AS state, u.gender AS gender, u, COUNT(m) AS moviesWatched GROUP BY state, gender ORDER BY state, gender RETURN state, gender, AVG(moviesWatched) AS averageMoviesWatched, COUNT(u) AS numberOfUsers",
    "source_dataset": "er",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 438,
    "unique_id": "er_data_3_2_2_6_Complex_Aggregation_438",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'GROUP': expected 'FOREACH', ',', 'ORDER BY', 'CALL', 'CREATE', 'LOAD CSV', 'DELETE', 'DETACH', 'FINISH', 'INSERT', 'LIMIT', 'MATCH', 'MERGE', 'NODETACH', 'OFFSET', 'OPTIONAL', 'REMOVE', 'RETURN', 'SET', 'SKIP', 'UNION', 'UNWIND', 'USE', 'WHERE', 'WITH' or <EOF> (line 1, column 111 (offset: 110))\n\"MATCH (u:User)-[w:WATCHED]->(m:Movie) WITH u.state AS state, u.gender AS gender, u, COUNT(m) AS moviesWatched GROUP BY state, gender ORDER BY state, gender RETURN state, gender, AVG(moviesWatched) AS averageMoviesWatched, COUNT(u) AS numberOfUsers\"\n                                                                                                               ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each gender, what is the average number of movies watched per user, and what is the total number of distinct IP addresses used by users of that gender?",
    "Cypher": "MATCH (u:User)-[w:WATCHED]->(m:Movie) WITH u.gender AS gender, u, COUNT(m) AS moviesWatchedPerUser MATCH (u)-[:USES]->(ip:IpAddress) WITH gender, AVG(moviesWatchedPerUser) AS avgMoviesWatched, ip RETURN gender, avgMoviesWatched, COUNT(DISTINCT ip.address) AS distinctIpAddressesUsed GROUP BY gender, avgMoviesWatched",
    "source_dataset": "er",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 444,
    "unique_id": "er_data_3_2_2_6_Complex_Aggregation_444",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'GROUP': expected 'FOREACH', ',', 'ORDER BY', 'CALL', 'CREATE', 'LOAD CSV', 'DELETE', 'DETACH', 'FINISH', 'INSERT', 'LIMIT', 'MATCH', 'MERGE', 'NODETACH', 'OFFSET', 'OPTIONAL', 'REMOVE', 'RETURN', 'SET', 'SKIP', 'UNION', 'UNWIND', 'USE', 'WITH' or <EOF> (line 1, column 284 (offset: 283))\n\"MATCH (u:User)-[w:WATCHED]->(m:Movie) WITH u.gender AS gender, u, COUNT(m) AS moviesWatchedPerUser MATCH (u)-[:USES]->(ip:IpAddress) WITH gender, AVG(moviesWatchedPerUser) AS avgMoviesWatched, ip RETURN gender, avgMoviesWatched, COUNT(DISTINCT ip.address) AS distinctIpAddressesUsed GROUP BY gender, avgMoviesWatched\"\n                                                                                                                                                                                                                                                                                            ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "What is the total number of movies watched by users who use the IP address '210.125.140.59', grouped by the genre of the movies they watched?",
    "Cypher": "MATCH (u:User)-[:USES]->(ip:IpAddress {address: '210.125.140.59'})-[w:WATCHED]->(m:Movie)-[:HAS]->(g:Genre) WITH g.name AS genre, COUNT(m) AS movieCount RETURN genre, movieCount",
    "source_dataset": "er",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 457,
    "unique_id": "er_data_3_2_2_6_Complex_Aggregation_457",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each gender, what is the average number of movies watched per user, and what is the total number of distinct genres watched by users of that gender?",
    "Cypher": "MATCH (u:User)-[w:WATCHED]->(m:Movie)-[:HAS]->(g:Genre) WITH u.gender AS gender, u, m, g RETURN gender, AVG(COUNT(m)) OVER (PARTITION BY gender) AS averageMoviesWatched, COUNT(DISTINCT g) AS totalDistinctGenresWatched",
    "source_dataset": "er",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 465,
    "unique_id": "er_data_3_2_2_6_Complex_Aggregation_465",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'OVER': expected an expression, 'FOREACH', ',', 'AS', 'ORDER BY', 'CALL', 'CREATE', 'LOAD CSV', 'DELETE', 'DETACH', 'FINISH', 'INSERT', 'LIMIT', 'MATCH', 'MERGE', 'NODETACH', 'OFFSET', 'OPTIONAL', 'REMOVE', 'RETURN', 'SET', 'SKIP', 'UNION', 'UNWIND', 'USE', 'WITH' or <EOF> (line 1, column 119 (offset: 118))\n\"MATCH (u:User)-[w:WATCHED]->(m:Movie)-[:HAS]->(g:Genre) WITH u.gender AS gender, u, m, g RETURN gender, AVG(COUNT(m)) OVER (PARTITION BY gender) AS averageMoviesWatched, COUNT(DISTINCT g) AS totalDistinctGenresWatched\"\n                                                                                                                       ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "What is the average number of movies watched by users who use a specific IP address, and what is the total number of distinct users who use that IP address?",
    "Cypher": "MATCH (u:User)-[:USES]->(ip:IpAddress)-<-[:USES]-(otherUser:User)-[w:WATCHED]->(m:Movie) WITH ip.address AS ipAddress, w.watchCount AS watchCount, otherUser RETURN ipAddress, AVG(watchCount) AS averageWatchCount, COUNT(DISTINCT otherUser) AS totalUsers",
    "source_dataset": "er",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 466,
    "unique_id": "er_data_3_2_2_6_Complex_Aggregation_466",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input '<': expected '-' (line 1, column 40 (offset: 39))\n\"MATCH (u:User)-[:USES]->(ip:IpAddress)-<-[:USES]-(otherUser:User)-[w:WATCHED]->(m:Movie) WITH ip.address AS ipAddress, w.watchCount AS watchCount, otherUser RETURN ipAddress, AVG(watchCount) AS averageWatchCount, COUNT(DISTINCT otherUser) AS totalUsers\"\n                                        ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each genre, what is the average number of movies watched by users who use the IP address '2.238.236.187'? Return the genre name and the average watch count.",
    "Cypher": "MATCH (u:User)-[:USES]->(ip:IpAddress {address: '2.238.236.187'})-[w:WATCHED]->(m:Movie)-[:HAS]->(g:Genre) RETURN g.name AS Genre, AVG(w.watchCount) AS AverageWatchCount",
    "source_dataset": "er",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 477,
    "unique_id": "er_data_3_2_2_6_Complex_Aggregation_477",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "What is the average number of users who have watched movies of a specific genre, grouped by the year the movie was released?",
    "Cypher": "MATCH (m:Movie)-[:HAS]->(g:Genre) WITH m.year AS movieYear, g MATCH (u:User)-[:WATCHED]->(m) WITH movieYear, g.name AS genreName, COUNT(DISTINCT u) AS userCount GROUP BY movieYear RETURN movieYear, AVG(userCount)",
    "source_dataset": "er",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 487,
    "unique_id": "er_data_3_2_2_6_Complex_Aggregation_487",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'GROUP': expected 'FOREACH', ',', 'ORDER BY', 'CALL', 'CREATE', 'LOAD CSV', 'DELETE', 'DETACH', 'FINISH', 'INSERT', 'LIMIT', 'MATCH', 'MERGE', 'NODETACH', 'OFFSET', 'OPTIONAL', 'REMOVE', 'RETURN', 'SET', 'SKIP', 'UNION', 'UNWIND', 'USE', 'WHERE', 'WITH' or <EOF> (line 1, column 162 (offset: 161))\n\"MATCH (m:Movie)-[:HAS]->(g:Genre) WITH m.year AS movieYear, g MATCH (u:User)-[:WATCHED]->(m) WITH movieYear, g.name AS genreName, COUNT(DISTINCT u) AS userCount GROUP BY movieYear RETURN movieYear, AVG(userCount)\"\n                                                                                                                                                                  ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each movie genre, what is the average watchCount of movies in that genre, considering only users who have watched more than one movie?",
    "Cypher": "MATCH (u:User)-[w:WATCHED]->(m:Movie)-[:HAS]->(g:Genre) WITH u, COUNT(m) AS watchedMovies, g, w WHERE watchedMovies > 1 WITH g.name AS genre, AVG(w.watchCount) AS avgWatchCount RETURN genre, avgWatchCount",
    "source_dataset": "er",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 533,
    "unique_id": "er_data_3_2_2_6_Complex_Aggregation_533",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "What is the average number of movies watched by users who use a specific IP address, grouped by the state of the user?",
    "Cypher": "MATCH (u:User)-[:USES]->(ip:IpAddress)-<-[:WATCHED]-(m:Movie) WITH u.state AS userState, COUNT(DISTINCT m) AS movieCount RETURN userState, AVG(movieCount)",
    "source_dataset": "er",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 534,
    "unique_id": "er_data_3_2_2_6_Complex_Aggregation_534",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input '<': expected '-' (line 1, column 40 (offset: 39))\n\"MATCH (u:User)-[:USES]->(ip:IpAddress)-<-[:WATCHED]-(m:Movie) WITH u.state AS userState, COUNT(DISTINCT m) AS movieCount RETURN userState, AVG(movieCount)\"\n                                        ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  },
  {
    "NL Question": "For each genre, what is the average watchCount of movies in that genre by users, considering only users who use the IP address '117.187.248.143'?",
    "Cypher": "MATCH (u:User)-[:USES]->(ip:IpAddress {address: '117.187.248.143'})-[w:WATCHED]->(m:Movie)-[:HAS]->(g:Genre) RETURN g.name AS genre, AVG(w.watchCount) AS averageWatchCount",
    "source_dataset": "er",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 540,
    "unique_id": "er_data_3_2_2_6_Complex_Aggregation_540",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "",
    "runtime_validation": "Failed",
    "neo4j_runtime_validation": "No runtime errors.",
    "neo4j_runtime_passed": 1,
    "neo4j_result_validation": "No results returned.",
    "neo4j_result_passed": 0,
    "content_validation": "No results returned.",
    "content_passed": 1
  },
  {
    "NL Question": "For each state, what is the average number of movies watched by female users, and what is the total number of female users?",
    "Cypher": "MATCH (u:User {gender: 'Female'})-[w:WATCHED]->(m:Movie) WITH u.state AS state, u, COUNT(m) AS moviesWatchedPerUser WITH state, AVG(moviesWatchedPerUser) AS averageMoviesWatched, COUNT(DISTINCT u) AS totalFemaleUsers FROM state GROUP BY state RETURN state, averageMoviesWatched, totalFemaleUsers",
    "source_dataset": "er",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 549,
    "unique_id": "er_data_3_2_2_6_Complex_Aggregation_549",
    "pipeline_stage": "FAILED_RUNTIME",
    "schema_validation": "✅ Query is valid according to schema!",
    "failure_reason": "Cypher Syntax Error: Generated Cypher Statement is not valid\n{code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'FROM': expected 'FOREACH', ',', 'ORDER BY', 'CALL', 'CREATE', 'LOAD CSV', 'DELETE', 'DETACH', 'FINISH', 'INSERT', 'LIMIT', 'MATCH', 'MERGE', 'NODETACH', 'OFFSET', 'OPTIONAL', 'REMOVE', 'RETURN', 'SET', 'SKIP', 'UNION', 'UNWIND', 'USE', 'WHERE', 'WITH' or <EOF> (line 1, column 218 (offset: 217))\n\"MATCH (u:User {gender: 'Female'})-[w:WATCHED]->(m:Movie) WITH u.state AS state, u, COUNT(m) AS moviesWatchedPerUser WITH state, AVG(moviesWatchedPerUser) AS averageMoviesWatched, COUNT(DISTINCT u) AS totalFemaleUsers FROM state GROUP BY state RETURN state, averageMoviesWatched, totalFemaleUsers\"\n                                                                                                                                                                                                                          ^}",
    "runtime_validation": "Failed",
    "content_validation": "Not applicable - runtime failed",
    "content_passed": 0
  }
]