[
  {
    "NL Question": "For each combination of genre and country, what is the total number of movies and the average watch count?",
    "Cypher": "MATCH (u:User {country:u.country})-[w:WATCHED]->(m:Movie)-[:HAS]->(g:Genre {name:g.name}) WITH g.name AS genre, u.country AS country, COUNT(DISTINCT m) AS movieCount, AVG(w.watchCount) AS avgWatchCount RETURN genre, country, movieCount, avgWatchCount",
    "source_dataset": "er",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 74,
    "unique_id": "er_data_3_1_2_6_Complex_Aggregation_74",
    "pipeline_stage": "FAILED_SCHEMA",
    "failure_reason": "❌ Malformed inline property: `.country` in node `User`.\n❌ Malformed inline property: `.name` in node `Genre`.",
    "schema_validation": "❌ Malformed inline property: `.country` in node `User`.\n❌ Malformed inline property: `.name` in node `Genre`."
  },
  {
    "NL Question": "What is the average number of movies watched by users using a specific IP address? Return the IP address and the average watch count.",
    "Cypher": "MATCH (u:User)-[:USES]->(ip:IpAddress)-[:WATCHED]->(m:Movie) WITH ip, AVG(u.watchCount) AS AverageWatchCount RETURN ip.address AS IpAddress, AverageWatchCount",
    "source_dataset": "er",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 135,
    "unique_id": "er_data_3_1_2_6_Complex_Aggregation_135",
    "pipeline_stage": "FAILED_SCHEMA",
    "failure_reason": "❌ Attribute `watchCount` does not exist in node `User`.",
    "schema_validation": "❌ Attribute `watchCount` does not exist in node `User`."
  },
  {
    "NL Question": "What is the average number of movies watched by users using each IP address, and what is the average user ID of those users?",
    "Cypher": "MATCH (u:User)-[r:USES]->(ip:IpAddress)-[:WATCHED]-(m:Movie) WITH ip.address AS ipAddress, AVG(r.watchCount) AS avgWatchCount, AVG(u.userId) AS avgUserId RETURN ipAddress, avgWatchCount, avgUserId",
    "source_dataset": "er",
    "source_chunk": "data_3_1_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 317,
    "unique_id": "er_data_3_1_2_6_Complex_Aggregation_317",
    "pipeline_stage": "FAILED_SCHEMA",
    "failure_reason": "❌ Attribute `watchCount` not in relationship `USES`.",
    "schema_validation": "❌ Attribute `watchCount` not in relationship `USES`."
  },
  {
    "NL Question": "What is the average watch count for movies watched by users who use a specific IP address, and how many users use that IP address?",
    "Cypher": "MATCH (u:User)-[:USES]->(ip:IpAddress)-[:WATCHED]->(m:Movie) WITH ip.address AS ipAddress, AVG(u.watchCount) AS averageWatchCount, COUNT(DISTINCT u) AS userCount RETURN ipAddress, averageWatchCount, userCount",
    "source_dataset": "er",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 240,
    "unique_id": "er_data_3_2_2_6_Complex_Aggregation_240",
    "pipeline_stage": "FAILED_SCHEMA",
    "failure_reason": "❌ Attribute `watchCount` does not exist in node `User`.",
    "schema_validation": "❌ Attribute `watchCount` does not exist in node `User`."
  },
  {
    "NL Question": "For each gender, what is the average number of movies watched by users of that gender who use a specific IP address, and how many users of that gender use that IP address?",
    "Cypher": "MATCH (u:User)-[:USES]->(ip:IpAddress) WHERE ip.address = '15.250.123.170' WITH u.gender AS gender, AVG(u.watchCount) AS averageWatchCount, COUNT(u) AS userCount RETURN gender, averageWatchCount, userCount",
    "source_dataset": "er",
    "source_chunk": "data_3_2_2_6",
    "original_file": "Complex_Aggregation.json",
    "original_index": 242,
    "unique_id": "er_data_3_2_2_6_Complex_Aggregation_242",
    "pipeline_stage": "FAILED_SCHEMA",
    "failure_reason": "❌ Attribute `watchCount` does not exist in node `User`.",
    "schema_validation": "❌ Attribute `watchCount` does not exist in node `User`."
  }
]